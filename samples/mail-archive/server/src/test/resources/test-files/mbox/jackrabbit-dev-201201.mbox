From dev-return-33694-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan  2 16:17:34 2012
Return-Path: <dev-return-33694-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4E622BD84
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon,  2 Jan 2012 16:17:34 +0000 (UTC)
Received: (qmail 96425 invoked by uid 500); 2 Jan 2012 16:17:33 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 96092 invoked by uid 500); 2 Jan 2012 16:17:32 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 95772 invoked by uid 99); 2 Jan 2012 16:17:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 16:17:32 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 16:09:49 +0000
Received: by wicr5 with SMTP id r5so19565760wic.1
        for <multiple recipients>; Mon, 02 Jan 2012 08:09:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:sender:from:date:x-google-sender-auth:message-id
         :subject:to:content-type;
        bh=20Sg1QVPpDwF2GY4VV8KZLqix8l9q+B2HvruCFOdkns=;
        b=JJCtMXmU9DNhDLzp5uNy8O6TGk/kjaw299QYsO9rphccMm6tF6+/gALD8EU3ZA3HXw
         /Dws+WM7/8GJBdEZN1KHGkDdVnViMRuzCMHwKbQSvv8DDrmoGIA+XXtjaeV0AoNdEhI7
         3dIfa5VA785LrOoPU0xB1/xJXSpKzoHPYOvno=
Received: by 10.180.107.134 with SMTP id hc6mr104024921wib.21.1325520550179;
 Mon, 02 Jan 2012 08:09:10 -0800 (PST)
MIME-Version: 1.0
Sender: jukka.zitting@gmail.com
Received: by 10.180.99.65 with HTTP; Mon, 2 Jan 2012 08:08:49 -0800 (PST)
From: Jukka Zitting <jukka@apache.org>
Date: Mon, 2 Jan 2012 17:08:49 +0100
X-Google-Sender-Auth: 2rsyuh953VsKSFUY2hehYAzMnrI
Message-ID: <CAOFYJNYp+DdEv6=hArV78p2aK8quXsEXBw7dKhFdZpOhT63vJw@mail.gmail.com>
Subject: [ANNOUNCE] Apache Jackrabbit 2.3.6 released
To: announce@apache.org, announce@jackrabbit.apache.org, 
	Jackrabbit Users <users@jackrabbit.apache.org>, 
	Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

The Apache Jackrabbit community is pleased to announce the release of
Apache Jackrabbit 2.3.6. The release is available for download at:

  http://jackrabbit.apache.org/downloads.html

See the full release notes below for details about this release.


Release Notes -- Apache Jackrabbit -- Version 2.3.6

Introduction
------------

This is Apache Jackrabbit(TM) 2.3, a fully compliant implementation of the
Content Repository for Java(TM) Technology API, version 2.0 (JCR 2.0) as
specified in the Java Specification Request 283 (JSR 283).

Apache Jackrabbit 2.3 is an unstable series of releases cut directly from
Jackrabbit trunk, with a focus on new features and other improvements.
For production use we recommend the latest stable 2.2 release.

Changes in Jackrabbit 2.3.6
---------------------------

New features

  [JCR-3005] Make it possible to get multiple nodes in one call via davex
  [JCR-3183] Add memory based bundle store

Improvements

  [JCR-3162] Index update overhead on cluster slave due to JCR-905
  [JCR-3172] implement PERSIST events for the EventJournal
  [JCR-3177] Remove jdk 1.4 restriction for jcr-tests
  [JCR-3178] Improve error messages for index aggregates

Bug fixes

  [JCR-2541] spi2dav : EventJournal not  implemented
  [JCR-2930] same named child nodes disappear on restore
  [JCR-3174] Destination URI should be normalized
  [JCR-3175] InputContextImpl: cannot upload file larger than 2GB
  [JCR-3176] JCARepositoryManager does not close InputStream

Changes in Jackrabbit 2.3.5
---------------------------

Improvements

  [JCR-2887] Split PrivilegeRegistry in a per-session manager instance ...
  [JCR-2906] Multivalued property sorted by last/random value
  [JCR-3138] Skip sync delay when changes are found
  [JCR-3161] Add JcrUtils.getPropertyTypeNames
  [JCR-3165] Consolidate compare behaviour for Value(s) and Comparable(s)
  [JCR-3167] Make Jackrabbit compile on Java 7
  [JCR-3170] Precompile JavaCC parsers in jackrabbit-spi-commons

Bug fixes

  [JCR-3159] LOWER operand with nested LOCALNAME operand not work with SQL2
  [JCR-3160] Session#move doesn't trigger rebuild of parent node aggregation
  [JCR-3163] NPE in RepositoryServiceImpl.getPropertyInfo()

Changes in Jackrabbit 2.3.4
---------------------------

New features

  [JCR-2936] JMX Bindings for Jackrabbit
  [JCR-3040] JMX Stats for the Session
  [JCR-3140] Add configurable hook for password validation
  [JCR-3154] Stats for Queries continued

Improvements

  [JCR-3129] It should be possible to create a non-transient Repository ...
  [JCR-3133] Query Stats should use the TimeSeries mechanism
  [JCR-3142] Create OSGi Bundles from jackrabbit-webdav and ...
  [JCR-3143] SessionImpl#isSupportedOption: Skip descriptor evaluation ...
  [JCR-3146] Text extraction may congest thread pool in the repository

Bug fixes

  [JCR-2539] spi2dav: Observation's user data not property handled
  [JCR-2540] spi2dav : move/reorder not properly handled by observation
  [JCR-2542] spi2dav: EventFilters not respected
  [JCR-3148] Using transactions still leads to memory leak
  [JCR-3149] AccessControlProvider#getEffectivePolicies for a set of ...
  [JCR-3151] SharedFieldCache can cause a memory leak
  [JCR-3152] AccessControlImporter does not import repo level ac content
  [JCR-3156] Group#getMembers may list inherited members multiple times

Changes in Jackrabbit 2.3.3
---------------------------

New features

  [JCR-3118] Configurable actions upon authorizable creation and removal

Improvements

  [JCR-1443] ake JCAManagedConnectionFactory non final, so it can be extended
  [JCR-2798] JCAManagedConnectionFactory should chain cause exception
  [JCR-3120] Change log level in UserManagerImpl#getAuthorizable(NodeImpl) ...
  [JCR-3127] Upgrade to Tika 0.10
  [JCR-3132] Test tooling updates
  [JCR-3135] Upgrade to Logback 1.0
  [JCR-3136] Add m2e lifecycle mappings for Eclipse Indigo
  [JCR-3141] Upgrade to Tika 1.0

Bug fixes

  [JCR-3093] Inconsistency between Session.getProperty and Node....
  [JCR-3110] QNodeTypeDefinitionImpl.getSerializablePropertyDefs() ...
  [JCR-3116] Cluster Node ID should be trimmed
  [JCR-3131] NPE in ItemManager when calling Session.save() with nothing ...
  [JCR-3139] missing sync in InternalVersionManagerImpl.externalUpdate ...

Changes in Jackrabbit 2.3.2
---------------------------

New features

  [JCR-3117] Stats for the PersistenceManager
  [JCR-3124] Stats for Queries

Improvements

  [JCR-2989] Support for embedded index aggregates
  [JCR-3098] Add hit miss statistics and logging to caches
  [JCR-3107] Speed up hierarchy cache initialization
  [JCR-3109] Move PersistenceManagerTest from o.a.j.core to o.a.j.core....
  [JCR-3114] expose PM for versioning manager so that the consistency ...
  [JCR-3119] Improve aggregate node indexing code
  [JCR-3122] QueryObjectModelImpl should execute queries as SessionOperation(s)

Bug fixes

  [JCR-2892] - Large fetch sizes have potentially deleterious effects on ...
  [JCR-3093] - Inconsistency between Session.getProperty and Node....
  [JCR-3108] - SQL2 ISDESCENDANTNODE can throw BooleanQuery#...
  [JCR-3111] - InternalVersionManagerBase; missing null check after getNode()
  [JCR-3112] - NodeTypeDefDiff.PropDefDiff.init() constraints change check ...
  [JCR-3115] - Versioning fixup leaves persistence in a state where the ...
  [JCR-3126] - The CredentialsWrapper should use a empty String as userId ...
  [JCR-3128] - Problem with formerly escaped JCR node names when upgrading ...

Changes in Jackrabbit 2.3.1
---------------------------

Improvements

  [JCR-3017] Version history recovery fails in case a version does not ...
  [JCR-3030] Permit using different tablespaces for tables and indexes ...
  [JCR-3084] Script for checking releases
  [JCR-3085] better diagnostics when version storage is broken
  [JCR-3091] Lucene Scorer implementations should handle the 'advance' ...
  [JCR-3102] InternalVersion.getFrozenNode confused about root version?

Bug fixes

  [JCR-2774] Access control for repository level API operations
  [JCR-3082] occasional index out of bounds exception while running ...
  [JCR-3086] potential infinite loop around InternalVersionImpl.getSuccessors
  [JCR-3089] javax.jcr.RepositoryException when a JOIN SQL2 query is ...
  [JCR-3090] setFetchSize() fails in getAllNodeIds()
  [JCR-3095] Move operation may turn AC caches stale
  [JCR-3101] recovery tool does not recover when version history can ...
  [JCR-3105] NPE when versioning operations are concurrent

In addition to the above-mentioned changes, this release contains
all the changes included up to the Apache Jackrabbit 2.3.0 release.

For more detailed information about all the changes in this and other
Jackrabbit releases, please see the Jackrabbit issue tracker at

    https://issues.apache.org/jira/browse/JCR

Release Contents
----------------

This release consists of a single source archive packaged as a zip file.
The archive can be unpacked with the jar tool from your JDK installation.
See the README.txt file for instructions on how to build this release.

The source archive is accompanied by SHA1 and MD5 checksums and a PGP
signature that you can use to verify the authenticity of your download.
The public key used for the PGP signature can be found at
https://svn.apache.org/repos/asf/jackrabbit/dist/KEYS.

About Apache Jackrabbit
-----------------------

Apache Jackrabbit is a fully conforming implementation of the Content
Repository for Java Technology API (JCR). A content repository is a
hierarchical content store with support for structured and unstructured
content, full text search, versioning, transactions, observation, and
more.

For more information, visit http://jackrabbit.apache.org/

About The Apache Software Foundation
------------------------------------

Established in 1999, The Apache Software Foundation provides organizational,
legal, and financial support for more than 100 freely-available,
collaboratively-developed Open Source projects. The pragmatic Apache License
enables individual and commercial users to easily deploy Apache software;
the Foundation's intellectual property framework limits the legal exposure
of its 2,500+ contributors.

For more information, visit http://www.apache.org/

From dev-return-33695-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan  2 16:18:45 2012
Return-Path: <dev-return-33695-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 43FE1BDEE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon,  2 Jan 2012 16:18:45 +0000 (UTC)
Received: (qmail 99186 invoked by uid 500); 2 Jan 2012 16:18:45 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 99151 invoked by uid 500); 2 Jan 2012 16:18:44 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 99144 invoked by uid 99); 2 Jan 2012 16:18:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 16:18:44 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.50 as permitted sender)
Received: from [74.125.82.50] (HELO mail-ww0-f50.google.com) (74.125.82.50)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 16:18:37 +0000
Received: by wgbdr11 with SMTP id dr11so26529725wgb.19
        for <dev@jackrabbit.apache.org>; Mon, 02 Jan 2012 08:18:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=oJoK/NCwc7ZZUtZzlE3I80zFIaA64h6612xBry2R9yA=;
        b=NeLBJp0H/NhjaINbhCU7o6wGR+900jft0Ro/kQ6gIVnchfmzZKHTL6ua8rTn/N7ypt
         7AjzUxyosg4MizDJhQkKZi/AqG5CHhsMGOqvjKOw0jmzbubwz/rxpKsEQrHgRSBv4SBt
         1AV41YHdHB4+dCIc/QRQ05fKIst9TpI2h03zk=
Received: by 10.227.200.19 with SMTP id eu19mr39210790wbb.12.1325521097155;
 Mon, 02 Jan 2012 08:18:17 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.99.65 with HTTP; Mon, 2 Jan 2012 08:17:56 -0800 (PST)
In-Reply-To: <CAOFYJNZQSm6UEuY0SPW9bVR92Dd4M-vix73PNVZN24RTPt6WeA@mail.gmail.com>
References: <CAOFYJNZQSm6UEuY0SPW9bVR92Dd4M-vix73PNVZN24RTPt6WeA@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Mon, 2 Jan 2012 17:17:56 +0100
Message-ID: <CAOFYJNYSVrZ6YgEPH+GbZ_qibhT9jBLZKbHLBoNnhxgKL5cUxQ@mail.gmail.com>
Subject: Re: Jackrabbit 2.4 release plan
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Tue, Dec 6, 2011 at 4:24 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> Two weeks later, on Tuesday Jan 3rd, and assuming no big problems have
> been detected, we'll then cut the stable 2.4.0 release candidate.

The 2.3.6 release announcement got delayed since I didn't have ssh
access required for staging the release over the holidays. The release
is finally now up and I just sent out the release announcement, but
it's probably best to give some time for people to try it out before
we cut 2.4.0.

And there hasn't been much work in trunk or the 2.4 branch since the
2.3.6, so also from that perspective we should let things rest a bit
longer before cutting the first stable 2.4 release.

Thus I suggest that we postpone the 2.4.0 cut date two weeks ahead to
Tuesday, Jan 17th. Any help before that in testing the 2.3.6 release
and pointing out any pending fixes in Jira will be much appreciated.

BR,

Jukka Zitting

From dev-return-33696-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan  2 16:52:54 2012
Return-Path: <dev-return-33696-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BCE65BE94
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon,  2 Jan 2012 16:52:54 +0000 (UTC)
Received: (qmail 36684 invoked by uid 500); 2 Jan 2012 16:52:54 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 36647 invoked by uid 500); 2 Jan 2012 16:52:54 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 36633 invoked by uid 99); 2 Jan 2012 16:52:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 16:52:54 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 16:52:52 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id AEE83134E37
	for <dev@jackrabbit.apache.org>; Mon,  2 Jan 2012 16:52:30 +0000 (UTC)
Date: Mon, 2 Jan 2012 16:52:30 +0000 (UTC)
From: "Lukas Kahwe Smith (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <894887769.58189.1325523150717.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-2543) spi2dav : Query offset not respected
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-2543?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13178455#comment-13178455 ] 

Lukas Kahwe Smith commented on JCR-2543:
----------------------------------------

so is this issue resolved now?
                
> spi2dav : Query offset not respected
> ------------------------------------
>
>                 Key: JCR-2543
>                 URL: https://issues.apache.org/jira/browse/JCR-2543
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, JCR 2.0, query
>    Affects Versions: 2.0
>            Reporter: angela
>         Attachments: patch_commit_ebebb62c3df0.patch
>
>
> the TCK query test SetOffsetTest fails in the setup jcr2spi - spi2dav(ex) - jcr-server.
> not sure whether it is due to missing implementation on client or server part of something completely different....

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33697-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan  2 17:52:55 2012
Return-Path: <dev-return-33697-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C2486B703
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon,  2 Jan 2012 17:52:55 +0000 (UTC)
Received: (qmail 568 invoked by uid 500); 2 Jan 2012 17:52:55 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 491 invoked by uid 500); 2 Jan 2012 17:52:55 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 484 invoked by uid 99); 2 Jan 2012 17:52:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 17:52:55 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 02 Jan 2012 17:52:52 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4877C1343D2
	for <dev@jackrabbit.apache.org>; Mon,  2 Jan 2012 17:52:31 +0000 (UTC)
Date: Mon, 2 Jan 2012 17:52:31 +0000 (UTC)
From: "Gustavo Orair (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <645274155.58298.1325526751298.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3197) ItemNotFoundException while adding a
 NT_FOLDER node inside rootNode
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

ItemNotFoundException while adding a NT_FOLDER node inside rootNode
-------------------------------------------------------------------

                 Key: JCR-3197
                 URL: https://issues.apache.org/jira/browse/JCR-3197
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-core
    Affects Versions: 2.3.3
         Environment: Linux Ubuntu, Glassfish 3.1.1, JackRabbitJCA 2.3.3.
            Reporter: Gustavo Orair
            Priority: Critical


I got an Strange ItemNotFoundException exception while adding a NT_FOLDER to the root node.

The code just calls:
	session.getRootNode().addNode(folderName, NodeType.NT_FOLDER);

The addNode method failed with ItemNotFoundException.

Relevant Stack trace:
Caused by: javax.jcr.ItemNotFoundException?: 9ea3aca6-c1b8-4955-9ece-546fd12ba5f1

    at org.apache.jackrabbit.core.ItemManager?.getItemData(ItemManager?.java:384) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.ItemManager?.getNode(ItemManager?.java:669) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.ItemManager?.getNode(ItemManager?.java:647) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.NodeImpl?.addNode(NodeImpl?.java:1286) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.session.AddNodeOperation?.perform(AddNodeOperation?.java:111) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.session.AddNodeOperation?.perform(AddNodeOperation?.java:37) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.session.SessionState?.perform(SessionState?.java:216) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.ItemImpl?.perform(ItemImpl?.java:91) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.NodeImpl?.addNodeWithUuid(NodeImpl?.java:1776) ~[jackrabbit-core-2.3.3.jar:na]
    at org.apache.jackrabbit.core.NodeImpl?.addNode(NodeImpl?.java:1736) ~[jackrabbit-core-2.3.3.jar:na]
    at econoinfo.commons.storage.impl.JCRStorage.obtemOuCriaPasta(JCRStorage.java:602) ~[SimpleStorageFacade-JcrStorage-2.2-SNAPSHOT.jar:na]
    at econoinfo.commons.storage.impl.JCRStorage.obtemOuCriaPasta(JCRStorage.java:608) ~[SimpleStorageFacade-JcrStorage-2.2-SNAPSHOT.jar:na]
    at econoinfo.commons.storage.impl.JCRStorage.obtemOuCriaPasta(JCRStorage.java:608) ~[SimpleStorageFacade-JcrStorage-2.2-SNAPSHOT.jar:na]
    at econoinfo.commons.storage.impl.JCRStorage.obtemOuCriaPasta(JCRStorage.java:608) ~[SimpleStorageFacade-JcrStorage-2.2-SNAPSHOT.jar:na]
    at econoinfo.commons.storage.impl.JCRStorage.add(JCRStorage.java:882) ~[SimpleStorageFacade-JcrStorage-2.2-SNAPSHOT.jar:na]
    at econoinfo.commons.storage.impl.JCRStorage.add(JCRStorage.java:400) ~[SimpleStorageFacade-JcrStorage-2.2-SNAPSHOT.jar:na]
    ... 146 common frames omitted



--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33698-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 12:05:30 2012
Return-Path: <dev-return-33698-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4D60D98FA
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 12:05:30 +0000 (UTC)
Received: (qmail 78692 invoked by uid 500); 3 Jan 2012 12:05:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 78312 invoked by uid 500); 3 Jan 2012 12:05:26 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 78297 invoked by uid 99); 3 Jan 2012 12:05:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 12:05:25 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 12:05:23 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4255B1360EC
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 12:04:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 12:04:39 +0000 (UTC)
From: "Jukka Zitting (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1011544432.129.1325592279273.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-2543) spi2dav : Query offset not respected
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-2543?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting resolved JCR-2543.
--------------------------------

       Resolution: Fixed
    Fix Version/s: 2.4
         Assignee: Jukka Zitting

The test indeed passes now, so in revision 1226750 I removed them from the known.issues exclusion list. Resolving as fixed.
                
> spi2dav : Query offset not respected
> ------------------------------------
>
>                 Key: JCR-2543
>                 URL: https://issues.apache.org/jira/browse/JCR-2543
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, JCR 2.0, query
>    Affects Versions: 2.0
>            Reporter: angela
>            Assignee: Jukka Zitting
>             Fix For: 2.4
>
>         Attachments: patch_commit_ebebb62c3df0.patch
>
>
> the TCK query test SetOffsetTest fails in the setup jcr2spi - spi2dav(ex) - jcr-server.
> not sure whether it is due to missing implementation on client or server part of something completely different....

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33699-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 15:15:27 2012
Return-Path: <dev-return-33699-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D74A59EEE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 15:15:26 +0000 (UTC)
Received: (qmail 63890 invoked by uid 500); 3 Jan 2012 15:15:26 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 63793 invoked by uid 500); 3 Jan 2012 15:15:25 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 63765 invoked by uid 99); 3 Jan 2012 15:15:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 15:15:25 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 15:15:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C2F9413697B
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 15:14:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 15:14:39 +0000 (UTC)
From: "angela (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1693972751.614.1325603679799.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Commented] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13178768#comment-13178768 ] 

angela commented on JCR-2859:
-----------------------------

imo loosing a lock token should be considered a mistake with the API consumer rather than something that
occurs on a regular basis. while i am fine with providing a fallback in case the token is indeed lost, i am
therefore not convinced that having a group that is allowed to see all lock tokens in the repository would be
a wise move. apart from the fact that i consider this an edge case that should not be used on a regular
basis, being member of a given group will not guarantee that a given user is allowed to lock/unlock a
given node but only expose the lock token (in contrast to the admin).

thus, i'm in favor of the latest patch by julian. however, -1 for allow breaking locks based on group membership.

                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>    Affects Versions: 2.2
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33700-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 15:49:27 2012
Return-Path: <dev-return-33700-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 03EE39514
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 15:49:27 +0000 (UTC)
Received: (qmail 21777 invoked by uid 500); 3 Jan 2012 15:49:26 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 21704 invoked by uid 500); 3 Jan 2012 15:49:26 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 21693 invoked by uid 99); 3 Jan 2012 15:49:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 15:49:26 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 15:49:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 359AB136BA2
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 15:48:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 15:48:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1130960130.706.1325605719220.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Commented] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13178789#comment-13178789 ] 

Julian Reschke commented on JCR-2859:
-------------------------------------

+1 for starting with a small change (thus leaving it to admins).

That being said, maybe we should also try to mitigate the effects of lost lock tokens? For instance, by changing the default timeout from "Infinity" to something reasonable? 
                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>    Affects Versions: 2.2
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33701-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 16:13:25 2012
Return-Path: <dev-return-33701-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 525A89FA8
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 16:13:25 +0000 (UTC)
Received: (qmail 61197 invoked by uid 500); 3 Jan 2012 16:13:24 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 61093 invoked by uid 500); 3 Jan 2012 16:13:24 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 61085 invoked by uid 99); 3 Jan 2012 16:13:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:13:24 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:13:23 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 87F041367F8
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 16:12:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 16:12:39 +0000 (UTC)
From: "angela (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <717317430.759.1325607159558.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Commented] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13178798#comment-13178798 ] 

angela commented on JCR-2859:
-----------------------------

> by changing the default timeout from "Infinity" to something reasonable

yes. that definitely makes sense... maybe we could even make the default timeout part of the workspace 
configuration as the preferred timeout may vary between different types of applications.
in any case we should clarify that as a general rule it is preferable to specify a reasonable timeout
suited for the situation when creating a new lock... LockManager#lock always takes a timeout hint, while 
Node.lock (which doesn't support it) has been deprecated as of JSR 283.
                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>    Affects Versions: 2.2
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33702-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 16:49:25 2012
Return-Path: <dev-return-33702-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 845379D79
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 16:49:25 +0000 (UTC)
Received: (qmail 35839 invoked by uid 500); 3 Jan 2012 16:49:25 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 35772 invoked by uid 500); 3 Jan 2012 16:49:25 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 35663 invoked by uid 99); 3 Jan 2012 16:49:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:49:24 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:49:23 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 88CB013666B
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 16:48:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 16:48:39 +0000 (UTC)
From: "Stefan Guggisberg (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2031956153.818.1325609319561.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <20830832.43268.1324675590659.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3194) ConcurrentModificationException in
 CacheManager.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3194?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13178810#comment-13178810 ] 

Stefan Guggisberg commented on JCR-3194:
----------------------------------------

only happens with log level set to DEBUG.


                
> ConcurrentModificationException in CacheManager.
> ------------------------------------------------
>
>                 Key: JCR-3194
>                 URL: https://issues.apache.org/jira/browse/JCR-3194
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.3.4
>            Reporter: Mat Lowery
>
> Using the test code below, I was able to produce this stack:
> java.util.ConcurrentModificationException
> 	at java.util.WeakHashMap$HashIterator.nextEntry(WeakHashMap.java:762)
> 	at java.util.WeakHashMap$KeyIterator.next(WeakHashMap.java:795)
> 	at org.apache.jackrabbit.core.cache.CacheManager.logCacheStats(CacheManager.java:164)
> 	at org.apache.jackrabbit.core.cache.CacheManager.cacheAccessed(CacheManager.java:137)
> 	at org.apache.jackrabbit.core.cache.AbstractCache.recordCacheAccess(AbstractCache.java:122)
> 	at org.apache.jackrabbit.core.cache.ConcurrentCache.get(ConcurrentCache.java:122)
> 	at org.apache.jackrabbit.core.state.MLRUItemStateCache.retrieve(MLRUItemStateCache.java:71)
> 	at org.apache.jackrabbit.core.state.ItemStateReferenceCache.retrieve(ItemStateReferenceCache.java:139)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getNonVirtualItemState(SharedItemStateManager.java:1716)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getItemState(SharedItemStateManager.java:268)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getNodeState(LocalItemStateManager.java:110)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getItemState(LocalItemStateManager.java:175)
> 	at org.apache.jackrabbit.core.state.XAItemStateManager.getItemState(XAItemStateManager.java:260)
> 	at org.apache.jackrabbit.core.state.SessionItemStateManager.getItemState(SessionItemStateManager.java:161)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:382)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.ItemManager.getRootNode(ItemManager.java:531)
> 	at org.apache.jackrabbit.core.SessionImpl.getRootNode(SessionImpl.java:760)
> 	at test.JackrabbitTest$1.run(JackrabbitTest.java:37)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
> 	at java.lang.Thread.run(Thread.java:662)
> -------------------------
> package test;
> import java.io.File;
> import java.util.concurrent.ExecutorService;
> import java.util.concurrent.Executors;
> import java.util.concurrent.TimeUnit;
> import java.util.concurrent.atomic.AtomicBoolean;
> import java.util.concurrent.atomic.AtomicInteger;
> import javax.jcr.Repository;
> import javax.jcr.RepositoryException;
> import javax.jcr.Session;
> import javax.jcr.SimpleCredentials;
> import org.apache.jackrabbit.core.TransientRepository;
> public class JackrabbitTest {
>  public static void main(final String[] args) throws Exception {
>    File dir = File.createTempFile("jackrabbit-test", "");
>    dir.delete();
>    dir.mkdir();
>    System.out.println("created temporary directory: " +
>        dir.getAbsolutePath());
>    dir.deleteOnExit();
>    final Repository jcrRepo = new TransientRepository(dir);
>    final AtomicBoolean passed = new AtomicBoolean(true);
>    final AtomicInteger counter = new AtomicInteger(0);
>    ExecutorService executor = Executors.newFixedThreadPool(50);
>    Runnable runnable = new Runnable() {
>      @Override
>      public void run() {
>        try {
>          Session session = jcrRepo.login(
>              new SimpleCredentials("admin",
>                  "admin".toCharArray()));
>          session.getRootNode().addNode("n" +
>                  counter.getAndIncrement()); //unique name
>          session.save();
>          session.logout();
>        } catch (RepositoryException e) {
>          e.printStackTrace();
>          passed.set(false);
>        }
>      }
>    };
>    System.out.println("Running threads");
>    for (int i = 0; i<  500; i++) {
>      executor.execute(runnable);
>    }
>    executor.shutdown(); //Disable new tasks from being submitted
>    if (!executor.awaitTermination(120, TimeUnit.SECONDS)) {
>      System.err.println("timeout");
>      System.exit(1);
>    }
>    if (!passed.get()) {
>      System.err.println("one or more threads got an exception");
>      System.exit(1);
>    } else {
>      System.out.println("all threads ran with no exceptions");
>      System.exit(0);
>    }
>  }
> }

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33703-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 16:49:26 2012
Return-Path: <dev-return-33703-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D012A9D94
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 16:49:26 +0000 (UTC)
Received: (qmail 36469 invoked by uid 500); 3 Jan 2012 16:49:26 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 36437 invoked by uid 500); 3 Jan 2012 16:49:26 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 36430 invoked by uid 99); 3 Jan 2012 16:49:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:49:26 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:49:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 3A608136666
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 16:48:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 16:48:39 +0000 (UTC)
From: "Jukka Zitting (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <455253259.813.1325609319240.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3198) Broken handling of outer join results
 over davex
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

Broken handling of outer join results over davex
------------------------------------------------

                 Key: JCR-3198
                 URL: https://issues.apache.org/jira/browse/JCR-3198
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-jcr-server, jackrabbit-spi2dav
    Affects Versions: 2.3.6
            Reporter: Jukka Zitting
            Assignee: Jukka Zitting


The davex join support added in JCR-3089 only works correctly when the join returns at least one row and none of the returned rows contain null values for any of the selectors. This should be reasonably straightforward to fix.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33704-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 16:51:27 2012
Return-Path: <dev-return-33704-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E12E29E3D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 16:51:27 +0000 (UTC)
Received: (qmail 39263 invoked by uid 500); 3 Jan 2012 16:51:27 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 39219 invoked by uid 500); 3 Jan 2012 16:51:27 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 39212 invoked by uid 99); 3 Jan 2012 16:51:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:51:27 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:51:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4728F1367E5
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 16:50:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 16:50:39 +0000 (UTC)
From: "Stefan Guggisberg (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <119221772.821.1325609439292.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <20830832.43268.1324675590659.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3194) ConcurrentModificationException in
 CacheManager.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3194?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13178811#comment-13178811 ] 

Stefan Guggisberg commented on JCR-3194:
----------------------------------------

this is a regression of JCR-3098
                
> ConcurrentModificationException in CacheManager.
> ------------------------------------------------
>
>                 Key: JCR-3194
>                 URL: https://issues.apache.org/jira/browse/JCR-3194
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.3.4
>            Reporter: Mat Lowery
>
> Using the test code below, I was able to produce this stack:
> java.util.ConcurrentModificationException
> 	at java.util.WeakHashMap$HashIterator.nextEntry(WeakHashMap.java:762)
> 	at java.util.WeakHashMap$KeyIterator.next(WeakHashMap.java:795)
> 	at org.apache.jackrabbit.core.cache.CacheManager.logCacheStats(CacheManager.java:164)
> 	at org.apache.jackrabbit.core.cache.CacheManager.cacheAccessed(CacheManager.java:137)
> 	at org.apache.jackrabbit.core.cache.AbstractCache.recordCacheAccess(AbstractCache.java:122)
> 	at org.apache.jackrabbit.core.cache.ConcurrentCache.get(ConcurrentCache.java:122)
> 	at org.apache.jackrabbit.core.state.MLRUItemStateCache.retrieve(MLRUItemStateCache.java:71)
> 	at org.apache.jackrabbit.core.state.ItemStateReferenceCache.retrieve(ItemStateReferenceCache.java:139)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getNonVirtualItemState(SharedItemStateManager.java:1716)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getItemState(SharedItemStateManager.java:268)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getNodeState(LocalItemStateManager.java:110)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getItemState(LocalItemStateManager.java:175)
> 	at org.apache.jackrabbit.core.state.XAItemStateManager.getItemState(XAItemStateManager.java:260)
> 	at org.apache.jackrabbit.core.state.SessionItemStateManager.getItemState(SessionItemStateManager.java:161)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:382)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.ItemManager.getRootNode(ItemManager.java:531)
> 	at org.apache.jackrabbit.core.SessionImpl.getRootNode(SessionImpl.java:760)
> 	at test.JackrabbitTest$1.run(JackrabbitTest.java:37)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
> 	at java.lang.Thread.run(Thread.java:662)
> -------------------------
> package test;
> import java.io.File;
> import java.util.concurrent.ExecutorService;
> import java.util.concurrent.Executors;
> import java.util.concurrent.TimeUnit;
> import java.util.concurrent.atomic.AtomicBoolean;
> import java.util.concurrent.atomic.AtomicInteger;
> import javax.jcr.Repository;
> import javax.jcr.RepositoryException;
> import javax.jcr.Session;
> import javax.jcr.SimpleCredentials;
> import org.apache.jackrabbit.core.TransientRepository;
> public class JackrabbitTest {
>  public static void main(final String[] args) throws Exception {
>    File dir = File.createTempFile("jackrabbit-test", "");
>    dir.delete();
>    dir.mkdir();
>    System.out.println("created temporary directory: " +
>        dir.getAbsolutePath());
>    dir.deleteOnExit();
>    final Repository jcrRepo = new TransientRepository(dir);
>    final AtomicBoolean passed = new AtomicBoolean(true);
>    final AtomicInteger counter = new AtomicInteger(0);
>    ExecutorService executor = Executors.newFixedThreadPool(50);
>    Runnable runnable = new Runnable() {
>      @Override
>      public void run() {
>        try {
>          Session session = jcrRepo.login(
>              new SimpleCredentials("admin",
>                  "admin".toCharArray()));
>          session.getRootNode().addNode("n" +
>                  counter.getAndIncrement()); //unique name
>          session.save();
>          session.logout();
>        } catch (RepositoryException e) {
>          e.printStackTrace();
>          passed.set(false);
>        }
>      }
>    };
>    System.out.println("Running threads");
>    for (int i = 0; i<  500; i++) {
>      executor.execute(runnable);
>    }
>    executor.shutdown(); //Disable new tasks from being submitted
>    if (!executor.awaitTermination(120, TimeUnit.SECONDS)) {
>      System.err.println("timeout");
>      System.exit(1);
>    }
>    if (!passed.get()) {
>      System.err.println("one or more threads got an exception");
>      System.exit(1);
>    } else {
>      System.out.println("all threads ran with no exceptions");
>      System.exit(0);
>    }
>  }
> }

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33705-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan  3 16:59:28 2012
Return-Path: <dev-return-33705-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0D14B914E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue,  3 Jan 2012 16:59:28 +0000 (UTC)
Received: (qmail 51832 invoked by uid 500); 3 Jan 2012 16:59:27 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 51793 invoked by uid 500); 3 Jan 2012 16:59:27 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 51786 invoked by uid 99); 3 Jan 2012 16:59:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:59:27 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 03 Jan 2012 16:59:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 68507136E8A
	for <dev@jackrabbit.apache.org>; Tue,  3 Jan 2012 16:58:39 +0000 (UTC)
Date: Tue, 3 Jan 2012 16:58:39 +0000 (UTC)
From: "Stefan Guggisberg (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <682004019.863.1325609919428.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <20830832.43268.1324675590659.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3194) ConcurrentModificationException in
 CacheManager.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3194?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Stefan Guggisberg resolved JCR-3194.
------------------------------------

    Resolution: Fixed

fixed in svn r1226863.
                
> ConcurrentModificationException in CacheManager.
> ------------------------------------------------
>
>                 Key: JCR-3194
>                 URL: https://issues.apache.org/jira/browse/JCR-3194
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.3.4
>            Reporter: Mat Lowery
>
> Using the test code below, I was able to produce this stack:
> java.util.ConcurrentModificationException
> 	at java.util.WeakHashMap$HashIterator.nextEntry(WeakHashMap.java:762)
> 	at java.util.WeakHashMap$KeyIterator.next(WeakHashMap.java:795)
> 	at org.apache.jackrabbit.core.cache.CacheManager.logCacheStats(CacheManager.java:164)
> 	at org.apache.jackrabbit.core.cache.CacheManager.cacheAccessed(CacheManager.java:137)
> 	at org.apache.jackrabbit.core.cache.AbstractCache.recordCacheAccess(AbstractCache.java:122)
> 	at org.apache.jackrabbit.core.cache.ConcurrentCache.get(ConcurrentCache.java:122)
> 	at org.apache.jackrabbit.core.state.MLRUItemStateCache.retrieve(MLRUItemStateCache.java:71)
> 	at org.apache.jackrabbit.core.state.ItemStateReferenceCache.retrieve(ItemStateReferenceCache.java:139)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getNonVirtualItemState(SharedItemStateManager.java:1716)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getItemState(SharedItemStateManager.java:268)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getNodeState(LocalItemStateManager.java:110)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getItemState(LocalItemStateManager.java:175)
> 	at org.apache.jackrabbit.core.state.XAItemStateManager.getItemState(XAItemStateManager.java:260)
> 	at org.apache.jackrabbit.core.state.SessionItemStateManager.getItemState(SessionItemStateManager.java:161)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:382)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.ItemManager.getRootNode(ItemManager.java:531)
> 	at org.apache.jackrabbit.core.SessionImpl.getRootNode(SessionImpl.java:760)
> 	at test.JackrabbitTest$1.run(JackrabbitTest.java:37)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
> 	at java.lang.Thread.run(Thread.java:662)
> -------------------------
> package test;
> import java.io.File;
> import java.util.concurrent.ExecutorService;
> import java.util.concurrent.Executors;
> import java.util.concurrent.TimeUnit;
> import java.util.concurrent.atomic.AtomicBoolean;
> import java.util.concurrent.atomic.AtomicInteger;
> import javax.jcr.Repository;
> import javax.jcr.RepositoryException;
> import javax.jcr.Session;
> import javax.jcr.SimpleCredentials;
> import org.apache.jackrabbit.core.TransientRepository;
> public class JackrabbitTest {
>  public static void main(final String[] args) throws Exception {
>    File dir = File.createTempFile("jackrabbit-test", "");
>    dir.delete();
>    dir.mkdir();
>    System.out.println("created temporary directory: " +
>        dir.getAbsolutePath());
>    dir.deleteOnExit();
>    final Repository jcrRepo = new TransientRepository(dir);
>    final AtomicBoolean passed = new AtomicBoolean(true);
>    final AtomicInteger counter = new AtomicInteger(0);
>    ExecutorService executor = Executors.newFixedThreadPool(50);
>    Runnable runnable = new Runnable() {
>      @Override
>      public void run() {
>        try {
>          Session session = jcrRepo.login(
>              new SimpleCredentials("admin",
>                  "admin".toCharArray()));
>          session.getRootNode().addNode("n" +
>                  counter.getAndIncrement()); //unique name
>          session.save();
>          session.logout();
>        } catch (RepositoryException e) {
>          e.printStackTrace();
>          passed.set(false);
>        }
>      }
>    };
>    System.out.println("Running threads");
>    for (int i = 0; i<  500; i++) {
>      executor.execute(runnable);
>    }
>    executor.shutdown(); //Disable new tasks from being submitted
>    if (!executor.awaitTermination(120, TimeUnit.SECONDS)) {
>      System.err.println("timeout");
>      System.exit(1);
>    }
>    if (!passed.get()) {
>      System.err.println("one or more threads got an exception");
>      System.exit(1);
>    } else {
>      System.out.println("all threads ran with no exceptions");
>      System.exit(0);
>    }
>  }
> }

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33706-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 14:01:31 2012
Return-Path: <dev-return-33706-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 61E8FBE2E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 14:01:31 +0000 (UTC)
Received: (qmail 6120 invoked by uid 500); 4 Jan 2012 14:01:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 5656 invoked by uid 500); 4 Jan 2012 14:01:28 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 5648 invoked by uid 99); 4 Jan 2012 14:01:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:01:28 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:01:26 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1A35E138293
	for <dev@jackrabbit.apache.org>; Wed,  4 Jan 2012 14:00:41 +0000 (UTC)
Date: Wed, 4 Jan 2012 14:00:41 +0000 (UTC)
From: "Julian Reschke (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1577678328.4549.1325685641108.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3199) workspace-wide default for lock timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

workspace-wide default for lock timeout
---------------------------------------

                 Key: JCR-3199
                 URL: https://issues.apache.org/jira/browse/JCR-3199
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: jackrabbit-core, locks
            Reporter: Julian Reschke
            Assignee: Julian Reschke


There should be a way to define a workspace-wide default for JCR lock timeouts (in case the code creating the lock did not specify one).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33707-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 14:46:28 2012
Return-Path: <dev-return-33707-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 512DBB3CF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 14:46:28 +0000 (UTC)
Received: (qmail 73536 invoked by uid 500); 4 Jan 2012 14:46:27 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 73456 invoked by uid 500); 4 Jan 2012 14:46:27 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 73436 invoked by uid 99); 4 Jan 2012 14:46:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:46:27 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:46:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 90033137D2A
	for <dev@jackrabbit.apache.org>; Wed,  4 Jan 2012 14:45:39 +0000 (UTC)
Date: Wed, 4 Jan 2012 14:45:39 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1507328603.4692.1325688339591.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Updated] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-2859:
--------------------------------

    Affects Version/s:     (was: 2.2)
               Status: In Progress  (was: Patch Available)
    
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33708-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 14:46:28 2012
Return-Path: <dev-return-33708-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6FEA2B3DA
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 14:46:28 +0000 (UTC)
Received: (qmail 73547 invoked by uid 500); 4 Jan 2012 14:46:27 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 73458 invoked by uid 500); 4 Jan 2012 14:46:27 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 73449 invoked by uid 99); 4 Jan 2012 14:46:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:46:27 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:46:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C2A09137D2E
	for <dev@jackrabbit.apache.org>; Wed,  4 Jan 2012 14:45:39 +0000 (UTC)
Date: Wed, 4 Jan 2012 14:45:39 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1475426671.4696.1325688339798.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Resolved] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-2859.
---------------------------------

       Resolution: Fixed
    Fix Version/s: 2.5
    
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>             Fix For: 2.5
>
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33709-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 14:48:25 2012
Return-Path: <dev-return-33709-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9891FB4B3
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 14:48:25 +0000 (UTC)
Received: (qmail 76754 invoked by uid 500); 4 Jan 2012 14:48:25 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 76719 invoked by uid 500); 4 Jan 2012 14:48:25 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 76612 invoked by uid 99); 4 Jan 2012 14:48:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:48:25 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 14:48:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E869C137F1F
	for <dev@jackrabbit.apache.org>; Wed,  4 Jan 2012 14:47:39 +0000 (UTC)
Date: Wed, 4 Jan 2012 14:47:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <696221745.4714.1325688459953.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Commented] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13179527#comment-13179527 ] 

Julian Reschke commented on JCR-2859:
-------------------------------------

So I have left the patch as proposed, allowing admin users to get the lock token, enabling them to unlock the node.

Added JCR-3199 as a change request (make the default lock time out configurable).
                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>             Fix For: 2.5
>
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33710-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 18:10:25 2012
Return-Path: <dev-return-33710-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD0A0B4C5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 18:10:25 +0000 (UTC)
Received: (qmail 84580 invoked by uid 500); 4 Jan 2012 18:10:25 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 84489 invoked by uid 500); 4 Jan 2012 18:10:25 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 84309 invoked by uid 99); 4 Jan 2012 18:10:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 18:10:25 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 18:10:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 041F7138E9C
	for <dev@jackrabbit.apache.org>; Wed,  4 Jan 2012 18:09:40 +0000 (UTC)
Date: Wed, 4 Jan 2012 18:09:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <298120671.5653.1325700580018.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <455253259.813.1325609319240.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3198) Broken handling of outer join results
 over davex
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3198?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3198:
-------------------------------

    Component/s: jackrabbit-spi
                 jackrabbit-jcr2spi
    
> Broken handling of outer join results over davex
> ------------------------------------------------
>
>                 Key: JCR-3198
>                 URL: https://issues.apache.org/jira/browse/JCR-3198
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, jackrabbit-jcr2spi, jackrabbit-spi, jackrabbit-spi2dav
>    Affects Versions: 2.3.6
>            Reporter: Jukka Zitting
>            Assignee: Jukka Zitting
>              Labels: davex, join, outer, sql2
>             Fix For: 2.4
>
>
> The davex join support added in JCR-3089 only works correctly when the join returns at least one row and none of the returned rows contain null values for any of the selectors. This should be reasonably straightforward to fix.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33711-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 18:10:27 2012
Return-Path: <dev-return-33711-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C05D4B4D8
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 18:10:27 +0000 (UTC)
Received: (qmail 85083 invoked by uid 500); 4 Jan 2012 18:10:27 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 85035 invoked by uid 500); 4 Jan 2012 18:10:27 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 85021 invoked by uid 99); 4 Jan 2012 18:10:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 18:10:27 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 18:10:24 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7A6A4138E8F
	for <dev@jackrabbit.apache.org>; Wed,  4 Jan 2012 18:09:39 +0000 (UTC)
Date: Wed, 4 Jan 2012 18:09:39 +0000 (UTC)
From: "Jukka Zitting (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <221023747.5640.1325700579502.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <455253259.813.1325609319240.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3198) Broken handling of outer join results
 over davex
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3198?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting resolved JCR-3198.
--------------------------------

       Resolution: Fixed
    Fix Version/s: 2.4

Fixed in revision 1227240 and merged to the 2.4 branch in revision 1227247.
                
> Broken handling of outer join results over davex
> ------------------------------------------------
>
>                 Key: JCR-3198
>                 URL: https://issues.apache.org/jira/browse/JCR-3198
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, jackrabbit-jcr2spi, jackrabbit-spi, jackrabbit-spi2dav
>    Affects Versions: 2.3.6
>            Reporter: Jukka Zitting
>            Assignee: Jukka Zitting
>              Labels: davex, join, outer, sql2
>             Fix For: 2.4
>
>
> The davex join support added in JCR-3089 only works correctly when the join returns at least one row and none of the returned rows contain null values for any of the selectors. This should be reasonably straightforward to fix.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33712-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 18:10:30 2012
Return-Path: <dev-return-33712-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3DFA9B532
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 18:10:30 +0000 (UTC)
Received: (qmail 86160 invoked by uid 500); 4 Jan 2012 18:10:29 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 86100 invoked by uid 500); 4 Jan 2012 18:10:28 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 86088 invoked by uid 99); 4 Jan 2012 18:10:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 18:10:28 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 18:10:25 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7A887138EAA
	for <dev@jackrabbit.apache.org>; Wed,  4 Jan 2012 18:09:40 +0000 (UTC)
Date: Wed, 4 Jan 2012 18:09:40 +0000 (UTC)
From: "Jukka Zitting (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <480551721.5666.1325700580503.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-2535) jcr-server: Search fails with
 RepositoryException as Row.getPath() is used with multiple selector names
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-2535?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting resolved JCR-2535.
--------------------------------

    Resolution: Duplicate

This got fixed in JCR-3198.
                
> jcr-server: Search fails with RepositoryException as Row.getPath() is used with multiple selector names
> -------------------------------------------------------------------------------------------------------
>
>                 Key: JCR-2535
>                 URL: https://issues.apache.org/jira/browse/JCR-2535
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, JCR 2.0
>    Affects Versions: 2.0
>            Reporter: angela
>
> SearchResourceImpl line 246 call Row.getPath() without testing for multiple selector names.
> this causes the query to fail with the following RepositoryException:
> javax.jcr.RepositoryException: More than one selector. Use getPath(String) instead.
> i have the impression this should be easy to fix for somebody familiar with the query. the comment
> says:  // get the path for the first selector and build [...]
> but apparently Row.getPath() isn't the right choice.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33713-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan  4 21:14:48 2012
Return-Path: <dev-return-33713-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 55F46BF63
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed,  4 Jan 2012 21:14:48 +0000 (UTC)
Received: (qmail 69067 invoked by uid 500); 4 Jan 2012 21:14:48 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 69038 invoked by uid 500); 4 Jan 2012 21:14:47 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 69031 invoked by uid 99); 4 Jan 2012 21:14:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 21:14:47 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 04 Jan 2012 21:14:45 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 42FD9C00A0;
	Wed,  4 Jan 2012 21:14:24 +0000 (UTC)
Date: Wed, 4 Jan 2012 21:14:24 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org, jukka.zitting@gmail.com
Message-ID: <1669283762.2391325711664273.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1807 - Failure
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Apache Jenkins build system has built Jackrabbit-trunk (build #1807)

Status: Failure

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1807/ to view the results.

From dev-return-33714-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan  5 13:02:09 2012
Return-Path: <dev-return-33714-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8F1EE9290
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu,  5 Jan 2012 13:02:09 +0000 (UTC)
Received: (qmail 98339 invoked by uid 500); 5 Jan 2012 13:02:09 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 97938 invoked by uid 500); 5 Jan 2012 13:02:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 97931 invoked by uid 99); 5 Jan 2012 13:02:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:02:02 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:02:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 5DDCA139DA8
	for <dev@jackrabbit.apache.org>; Thu,  5 Jan 2012 13:01:39 +0000 (UTC)
Date: Thu, 5 Jan 2012 13:01:39 +0000 (UTC)
From: "Thomas Mueller (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1636246546.8955.1325768499385.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1680393693.26131.1324301250664.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3185) refactor consistency checks in
 BundleDBPersistenceManager into a standalone class that could be re-used
 for other PMs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3185?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13180351#comment-13180351 ] 

Thomas Mueller commented on JCR-3185:
-------------------------------------

Loading the whole list in memory will run out of memory in many cases.

The call isn't supposed to block other operations (specially for DataStore garbage collection).

Many persistence manager implementations can't return the exact size() (specially, but not only because the call is non-blocking).

Therefore the easiest solution is to revert the change, and don't log the size. Or add a method getNumberOfBundlesEstimate() or so.
                
> refactor consistency checks in BundleDBPersistenceManager into a standalone class that could be re-used for other PMs
> ---------------------------------------------------------------------------------------------------------------------
>
>                 Key: JCR-3185
>                 URL: https://issues.apache.org/jira/browse/JCR-3185
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3185.diff
>
>
> see subject

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33715-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan  5 13:18:10 2012
Return-Path: <dev-return-33715-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0AFE0972A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu,  5 Jan 2012 13:18:10 +0000 (UTC)
Received: (qmail 28984 invoked by uid 500); 5 Jan 2012 13:18:09 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 27899 invoked by uid 500); 5 Jan 2012 13:18:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 27285 invoked by uid 99); 5 Jan 2012 13:18:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:18:06 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:18:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 018BB13977A
	for <dev@jackrabbit.apache.org>; Thu,  5 Jan 2012 13:17:42 +0000 (UTC)
Date: Thu, 5 Jan 2012 13:17:42 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1030733328.9037.1325769462007.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1680393693.26131.1324301250664.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3185) refactor consistency checks in
 BundleDBPersistenceManager into a standalone class that could be re-used
 for other PMs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3185?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13180372#comment-13180372 ] 

Jukka Zitting commented on JCR-3185:
------------------------------------

> Loading the whole list in memory will run out of memory in many cases. 

That's best handled on the client side, e.g. by making the consistency checker process things in chunks of say 1m nodes at a time. I'd track that as a separate issue.

> don't log the size

That's what I'd do.
                
> refactor consistency checks in BundleDBPersistenceManager into a standalone class that could be re-used for other PMs
> ---------------------------------------------------------------------------------------------------------------------
>
>                 Key: JCR-3185
>                 URL: https://issues.apache.org/jira/browse/JCR-3185
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3185.diff
>
>
> see subject

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33716-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan  5 13:30:11 2012
Return-Path: <dev-return-33716-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7C5CF9613
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu,  5 Jan 2012 13:30:11 +0000 (UTC)
Received: (qmail 50213 invoked by uid 500); 5 Jan 2012 13:30:10 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 49597 invoked by uid 500); 5 Jan 2012 13:30:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 49590 invoked by uid 99); 5 Jan 2012 13:30:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:30:00 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:29:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4CAA5139F14
	for <dev@jackrabbit.apache.org>; Thu,  5 Jan 2012 13:29:39 +0000 (UTC)
Date: Thu, 5 Jan 2012 13:29:39 +0000 (UTC)
From: "Julian Reschke (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <481776123.9110.1325770179315.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3200) consistency check should get node ids
 in chunks, not rely on total count
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

consistency check should get node ids in chunks, not rely on total count
------------------------------------------------------------------------

                 Key: JCR-3200
                 URL: https://issues.apache.org/jira/browse/JCR-3200
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: jackrabbit-core
            Reporter: Julian Reschke
            Assignee: Julian Reschke
            Priority: Minor


The PM consistency checker should use the paging feature to fetch nodeis in chunks, and also not rely on the total number of ids for logging purposes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33717-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan  5 13:38:13 2012
Return-Path: <dev-return-33717-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 68D1E98DC
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu,  5 Jan 2012 13:38:13 +0000 (UTC)
Received: (qmail 71431 invoked by uid 500); 5 Jan 2012 13:38:12 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 70889 invoked by uid 500); 5 Jan 2012 13:38:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 70865 invoked by uid 99); 5 Jan 2012 13:38:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:38:03 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 13:38:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 113461392ED
	for <dev@jackrabbit.apache.org>; Thu,  5 Jan 2012 13:37:40 +0000 (UTC)
Date: Thu, 5 Jan 2012 13:37:40 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <344505769.9135.1325770660071.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <481776123.9110.1325770179315.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3200) consistency check should get node ids
 in chunks, not rely on total count
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3200?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3200:
--------------------------------

    Description: The PM consistency checker should use the paging feature to fetch nodeIds in chunks, and also not rely on the total number of ids for logging purposes.  (was: The PM consistency checker should use the paging feature to fetch nodeis in chunks, and also not rely on the total number of ids for logging purposes.)
    
> consistency check should get node ids in chunks, not rely on total count
> ------------------------------------------------------------------------
>
>                 Key: JCR-3200
>                 URL: https://issues.apache.org/jira/browse/JCR-3200
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>
> The PM consistency checker should use the paging feature to fetch nodeIds in chunks, and also not rely on the total number of ids for logging purposes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33718-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan  5 15:21:08 2012
Return-Path: <dev-return-33718-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 10D839F01
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu,  5 Jan 2012 15:21:08 +0000 (UTC)
Received: (qmail 48777 invoked by uid 500); 5 Jan 2012 15:21:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 48698 invoked by uid 500); 5 Jan 2012 15:21:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 48691 invoked by uid 99); 5 Jan 2012 15:21:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 15:21:06 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 15:20:59 +0000
Received: by wicr5 with SMTP id r5so1113550wic.1
        for <dev@jackrabbit.apache.org>; Thu, 05 Jan 2012 07:20:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=5Xa0Np2o1SWrMW/GG8Lqw3taphPXYOUqLSlQY6vJh4c=;
        b=AgCtcYjpUYB4ch1KAZkQ9n0EJrVfbjxAJcRYXAackA2akbA/VQzTUN0V/qlGM60Xl8
         z18kwnapkvEkVrRj5C1l+6ixS4obiFbqNqqqquolZfWAFWUkfrx9C5WskGCdt4CPOkfa
         BBD2bdfA6IGsIVR7JV6xISaTCsFZNy9Go9uME=
Received: by 10.180.19.138 with SMTP id f10mr4823709wie.3.1325776839112; Thu,
 05 Jan 2012 07:20:39 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Thu, 5 Jan 2012 07:20:18 -0800 (PST)
In-Reply-To: <1669283762.2391325711664273.JavaMail.hudson@aegis>
References: <1669283762.2391325711664273.JavaMail.hudson@aegis>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Thu, 5 Jan 2012 16:20:18 +0100
Message-ID: <CAOFYJNZYMoa3m1D7dOxt302ZyVZBgbOSe822DOvu-igUU6=QyQ@mail.gmail.com>
Subject: Re: Jackrabbit-trunk - Build # 1807 - Failure
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Wed, Jan 4, 2012 at 10:14 PM, Apache Jenkins Server
<jenkins@builds.apache.org> wrote:
> The Apache Jenkins build system has built Jackrabbit-trunk (build #1807)
>
> Status: Failure

Jenkins problem again.

BR,

Jukka Zitting

From dev-return-33719-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan  5 16:27:08 2012
Return-Path: <dev-return-33719-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E1B769742
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu,  5 Jan 2012 16:27:07 +0000 (UTC)
Received: (qmail 94785 invoked by uid 500); 5 Jan 2012 16:27:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 94707 invoked by uid 500); 5 Jan 2012 16:27:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 94700 invoked by uid 99); 5 Jan 2012 16:27:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 16:27:06 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 16:27:04 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 73EFBC004A;
	Thu,  5 Jan 2012 16:26:42 +0000 (UTC)
Date: Thu, 5 Jan 2012 16:26:06 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org, julian.reschke@greenbytes.de
Message-ID: <796523891.351325780801999.JavaMail.hudson@aegis>
In-Reply-To: <1669283762.2391325711664273.JavaMail.hudson@aegis>
References: <1669283762.2391325711664273.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1808 - Unstable
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Apache Jenkins build system has built Jackrabbit-trunk (build #1808)

Status: Unstable

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1808/ to view the results.

From dev-return-33720-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan  5 17:25:47 2012
Return-Path: <dev-return-33720-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 189949408
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu,  5 Jan 2012 17:25:47 +0000 (UTC)
Received: (qmail 3943 invoked by uid 500); 5 Jan 2012 17:25:46 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 3862 invoked by uid 500); 5 Jan 2012 17:25:46 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 3855 invoked by uid 99); 5 Jan 2012 17:25:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 05 Jan 2012 17:25:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of julian.reschke@gmx.de designates 213.165.64.23 as permitted sender)
Received: from [213.165.64.23] (HELO mailout-de.gmx.net) (213.165.64.23)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 05 Jan 2012 17:25:36 +0000
Received: (qmail invoked by alias); 05 Jan 2012 17:25:15 -0000
Received: from mail.greenbytes.de (EHLO [192.168.1.140]) [217.91.35.233]
  by mail.gmx.net (mp061) with SMTP; 05 Jan 2012 18:25:15 +0100
X-Authenticated: #1915285
X-Provags-ID: V01U2FsdGVkX18AI1Q/VrkAO1IxpUtKcSPV/FLFOqJLmqjP5/8dju
	+/Yd/oSyQ4iC/j
Message-ID: <4F05DCF9.7090203@gmx.de>
Date: Thu, 05 Jan 2012 18:25:13 +0100
From: Julian Reschke <julian.reschke@gmx.de>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
CC: Apache Jenkins Server <jenkins@builds.apache.org>, 
 julian.reschke@greenbytes.de
Subject: Re: Jackrabbit-trunk - Build # 1808 - Unstable
References: <1669283762.2391325711664273.JavaMail.hudson@aegis> <796523891.351325780801999.JavaMail.hudson@aegis>
In-Reply-To: <796523891.351325780801999.JavaMail.hudson@aegis>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0
X-Virus-Checked: Checked by ClamAV on apache.org

On 2012-01-05 17:26, Apache Jenkins Server wrote:
> The Apache Jenkins build system has built Jackrabbit-trunk (build #1808)
>
> Status: Unstable
>
> Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1808/ to view the results.

My fault. Looking...



From dev-return-33721-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 10:10:38 2012
Return-Path: <dev-return-33721-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 196EFBFF7
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 10:10:38 +0000 (UTC)
Received: (qmail 55044 invoked by uid 500); 6 Jan 2012 10:10:36 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 54550 invoked by uid 500); 6 Jan 2012 10:10:10 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 54513 invoked by uid 99); 6 Jan 2012 10:10:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 10:10:04 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 10:10:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9B04713BB60
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 10:09:40 +0000 (UTC)
Date: Fri, 6 Jan 2012 10:09:40 +0000 (UTC)
From: "Julian Reschke (Reopened) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1753721246.14058.1325844580636.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Reopened] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke reopened JCR-2859:
---------------------------------


causes breakage in jcr2dav tests
                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>             Fix For: 2.5
>
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33722-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:35:12 2012
Return-Path: <dev-return-33722-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0E7CAB396
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:35:12 +0000 (UTC)
Received: (qmail 34184 invoked by uid 500); 6 Jan 2012 12:35:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 33038 invoked by uid 500); 6 Jan 2012 12:34:11 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 32524 invoked by uid 99); 6 Jan 2012 12:34:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:34:03 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:34:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 33DAB13BA6F
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 12:33:39 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:33:39 +0000 (UTC)
From: "angela (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1721925875.14239.1325853219213.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3202) AuthorizableImpl#memberOf and
 #declaredMemberOf should return RangeIterator
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

AuthorizableImpl#memberOf and #declaredMemberOf should return RangeIterator
---------------------------------------------------------------------------

                 Key: JCR-3202
                 URL: https://issues.apache.org/jira/browse/JCR-3202
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: jackrabbit-core, security
            Reporter: angela
            Assignee: angela
            Priority: Minor


it would be favorable if the iterator returned by Authorizable#memberOf and #declaredMemberOf
would return a RangeIterator in order to all the caller to determine the size without having to
iterate.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33723-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:35:36 2012
Return-Path: <dev-return-33723-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BA1CCB483
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:35:36 +0000 (UTC)
Received: (qmail 34844 invoked by uid 500); 6 Jan 2012 12:35:10 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 33309 invoked by uid 500); 6 Jan 2012 12:34:30 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 32525 invoked by uid 99); 6 Jan 2012 12:34:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:34:03 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:34:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 2CB0413BA6D
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 12:33:39 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:33:39 +0000 (UTC)
From: "angela (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <581725917.14238.1325853219184.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3201) AuthorizableImpl#memberOf and
 #declaredMemberOf should return RangeIterator
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

AuthorizableImpl#memberOf and #declaredMemberOf should return RangeIterator
---------------------------------------------------------------------------

                 Key: JCR-3201
                 URL: https://issues.apache.org/jira/browse/JCR-3201
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: jackrabbit-core, security
            Reporter: angela
            Assignee: angela
            Priority: Minor


it would be favorable if the iterator returned by Authorizable#memberOf and #declaredMemberOf
would return a RangeIterator in order to all the caller to determine the size without having to
iterate.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33724-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:36:16 2012
Return-Path: <dev-return-33724-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B5A8AB4E1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:36:16 +0000 (UTC)
Received: (qmail 37504 invoked by uid 500); 6 Jan 2012 12:36:12 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 37129 invoked by uid 500); 6 Jan 2012 12:36:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 37087 invoked by uid 99); 6 Jan 2012 12:36:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:36:02 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:36:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 3A7E313BAF0
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 12:35:39 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:35:39 +0000 (UTC)
From: "angela (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1420088880.14244.1325853339241.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1721925875.14239.1325853219213.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3202) AuthorizableImpl#memberOf and
 #declaredMemberOf should return RangeIterator
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3202?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela resolved JCR-3202.
-------------------------

       Resolution: Fixed
    Fix Version/s: 2.4
    
> AuthorizableImpl#memberOf and #declaredMemberOf should return RangeIterator
> ---------------------------------------------------------------------------
>
>                 Key: JCR-3202
>                 URL: https://issues.apache.org/jira/browse/JCR-3202
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, security
>            Reporter: angela
>            Assignee: angela
>            Priority: Minor
>             Fix For: 2.4
>
>
> it would be favorable if the iterator returned by Authorizable#memberOf and #declaredMemberOf
> would return a RangeIterator in order to all the caller to determine the size without having to
> iterate.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33725-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:40:25 2012
Return-Path: <dev-return-33725-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 42BE7B604
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:40:25 +0000 (UTC)
Received: (qmail 43421 invoked by uid 500); 6 Jan 2012 12:40:23 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 42944 invoked by uid 500); 6 Jan 2012 12:40:13 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 42749 invoked by uid 99); 6 Jan 2012 12:40:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:40:01 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:39:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 41BD913BCB6
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 12:39:39 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:39:39 +0000 (UTC)
From: "angela (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2078728471.14249.1325853579270.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3203) GroupImp#members and #declaredMembers
 should return RangeIterator
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

GroupImp#members and #declaredMembers should return RangeIterator
-----------------------------------------------------------------

                 Key: JCR-3203
                 URL: https://issues.apache.org/jira/browse/JCR-3203
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: jackrabbit-core, security
            Reporter: angela
            Priority: Minor
             Fix For: 2.4


for those cases where the total amount of members can easily be detected/calculated the
implementations of Group#getMembers() and #getDeclaredMembersOf() should return a RangeIterator.

so far i found that Group#declaredMembers() can be easily adjusted for those cases where
the group members are stored in a multivalued property.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33726-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:40:36 2012
Return-Path: <dev-return-33726-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0AD3DB623
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:40:36 +0000 (UTC)
Received: (qmail 44294 invoked by uid 500); 6 Jan 2012 12:40:34 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 43071 invoked by uid 500); 6 Jan 2012 12:40:23 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 42779 invoked by uid 99); 6 Jan 2012 12:40:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:40:03 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:40:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C3ECD13BCBE
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 12:39:39 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:39:39 +0000 (UTC)
From: "angela (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <419140538.14257.1325853579804.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <2078728471.14249.1325853579270.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3203) GroupImp#getMembers and
 #getDeclaredMembers should return RangeIterator
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3203?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela updated JCR-3203:
------------------------

    Summary: GroupImp#getMembers and #getDeclaredMembers should return RangeIterator  (was: GroupImp#members and #declaredMembers should return RangeIterator)
    
> GroupImp#getMembers and #getDeclaredMembers should return RangeIterator
> -----------------------------------------------------------------------
>
>                 Key: JCR-3203
>                 URL: https://issues.apache.org/jira/browse/JCR-3203
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, security
>            Reporter: angela
>            Priority: Minor
>             Fix For: 2.4
>
>
> for those cases where the total amount of members can easily be detected/calculated the
> implementations of Group#getMembers() and #getDeclaredMembersOf() should return a RangeIterator.
> so far i found that Group#declaredMembers() can be easily adjusted for those cases where
> the group members are stored in a multivalued property.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33727-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:40:49 2012
Return-Path: <dev-return-33727-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7BE83B646
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:40:49 +0000 (UTC)
Received: (qmail 44852 invoked by uid 500); 6 Jan 2012 12:40:47 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 44659 invoked by uid 500); 6 Jan 2012 12:40:38 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 44226 invoked by uid 99); 6 Jan 2012 12:40:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:40:34 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:40:32 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 434DAC00A0;
	Fri,  6 Jan 2012 12:40:12 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:39:35 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org, julian.reschke@greenbytes.de
Message-ID: <58806903.1671325853612274.JavaMail.hudson@aegis>
In-Reply-To: <796523891.351325780801999.JavaMail.hudson@aegis>
References: <796523891.351325780801999.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1809 - Fixed
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

The Apache Jenkins build system has built Jackrabbit-trunk (build #1809)

Status: Fixed

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1809/ to view the results.

From dev-return-33728-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:50:31 2012
Return-Path: <dev-return-33728-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5A3C0B829
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:50:31 +0000 (UTC)
Received: (qmail 60705 invoked by uid 500); 6 Jan 2012 12:50:29 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 60364 invoked by uid 500); 6 Jan 2012 12:50:08 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 60319 invoked by uid 99); 6 Jan 2012 12:50:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:50:02 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:49:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 947DC13B348
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 12:49:39 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:49:39 +0000 (UTC)
From: "Matthias Reischenbacher (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <767673161.14354.1325854179609.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <23632580.55004.1323376900017.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3173) InvalidItemStateException if
 accessing VersionHistory before checkin()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3173?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13181279#comment-13181279 ] 

Matthias Reischenbacher commented on JCR-3173:
----------------------------------------------

Is there a known workaround until this issues gets fixed?
                
> InvalidItemStateException if accessing VersionHistory before checkin()
> ----------------------------------------------------------------------
>
>                 Key: JCR-3173
>                 URL: https://issues.apache.org/jira/browse/JCR-3173
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>    Affects Versions: 2.2.10
>            Reporter: Matthias Reischenbacher
>         Attachments: UserTransactionCheckinTest.java
>
>
> A checkin operation fails during a transaction if the VersionHistory of a node is accessed previously. See the attached test case for further details.
> -------------------------------------------------------------------------------
> Test set: org.apache.jackrabbit.core.version.UserTransactionCheckinTest
> -------------------------------------------------------------------------------
> Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 4.072 sec <<< FAILURE!
> testRestoreWithXA(org.apache.jackrabbit.core.version.UserTransactionCheckinTest)  Time elapsed: 3.858 sec  <<< ERROR!
> javax.jcr.InvalidItemStateException: Could not find child e77834ee-244c-441f-ab94-19847c769fa4 of node 03629609-8049-46ee-9e80-279c70b3a34d
> 	at org.apache.jackrabbit.core.ItemManager.getDefinition(ItemManager.java:207)
> 	at org.apache.jackrabbit.core.ItemData.getDefinition(ItemData.java:99)
> 	at org.apache.jackrabbit.core.ItemManager.canRead(ItemManager.java:421)
> 	at org.apache.jackrabbit.core.ItemManager.createItemData(ItemManager.java:843)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:391)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.SessionImpl.getNodeById(SessionImpl.java:493)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:123)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:1)
> 	at org.apache.jackrabbit.core.session.SessionState.perform(SessionState.java:200)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.perform(VersionManagerImpl.java:96)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:115)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:101)
> 	at org.apache.jackrabbit.core.NodeImpl.checkin(NodeImpl.java:2830)
> 	at org.apache.jackrabbit.core.version.UserTransactionCheckinTest.testRestoreWithXA(UserTransactionCheckinTest.java:35)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33729-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan  6 12:52:22 2012
Return-Path: <dev-return-33729-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7A5E0B880
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri,  6 Jan 2012 12:52:22 +0000 (UTC)
Received: (qmail 61635 invoked by uid 500); 6 Jan 2012 12:52:18 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 61549 invoked by uid 500); 6 Jan 2012 12:52:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 61542 invoked by uid 99); 6 Jan 2012 12:52:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:52:03 +0000
X-ASF-Spam-Status: No, hits=-2001.6 required=5.0
	tests=ALL_TRUSTED,RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 06 Jan 2012 12:52:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 3CFA813B3CE
	for <dev@jackrabbit.apache.org>; Fri,  6 Jan 2012 12:51:39 +0000 (UTC)
Date: Fri, 6 Jan 2012 12:51:39 +0000 (UTC)
From: "Matthias Reischenbacher (Issue Comment Edited) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <938785768.14358.1325854299256.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <23632580.55004.1323376900017.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Issue Comment Edited] (JCR-3173) InvalidItemStateException
 if accessing VersionHistory before checkin()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3173?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13181279#comment-13181279 ] 

Matthias Reischenbacher edited comment on JCR-3173 at 1/6/12 12:49 PM:
-----------------------------------------------------------------------

Is there a known workaround until this issue gets fixed?
                
      was (Author: matthias8283):
    Is there a known workaround until this issues gets fixed?
                  
> InvalidItemStateException if accessing VersionHistory before checkin()
> ----------------------------------------------------------------------
>
>                 Key: JCR-3173
>                 URL: https://issues.apache.org/jira/browse/JCR-3173
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>    Affects Versions: 2.2.10
>            Reporter: Matthias Reischenbacher
>         Attachments: UserTransactionCheckinTest.java
>
>
> A checkin operation fails during a transaction if the VersionHistory of a node is accessed previously. See the attached test case for further details.
> -------------------------------------------------------------------------------
> Test set: org.apache.jackrabbit.core.version.UserTransactionCheckinTest
> -------------------------------------------------------------------------------
> Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 4.072 sec <<< FAILURE!
> testRestoreWithXA(org.apache.jackrabbit.core.version.UserTransactionCheckinTest)  Time elapsed: 3.858 sec  <<< ERROR!
> javax.jcr.InvalidItemStateException: Could not find child e77834ee-244c-441f-ab94-19847c769fa4 of node 03629609-8049-46ee-9e80-279c70b3a34d
> 	at org.apache.jackrabbit.core.ItemManager.getDefinition(ItemManager.java:207)
> 	at org.apache.jackrabbit.core.ItemData.getDefinition(ItemData.java:99)
> 	at org.apache.jackrabbit.core.ItemManager.canRead(ItemManager.java:421)
> 	at org.apache.jackrabbit.core.ItemManager.createItemData(ItemManager.java:843)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:391)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.SessionImpl.getNodeById(SessionImpl.java:493)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:123)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:1)
> 	at org.apache.jackrabbit.core.session.SessionState.perform(SessionState.java:200)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.perform(VersionManagerImpl.java:96)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:115)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:101)
> 	at org.apache.jackrabbit.core.NodeImpl.checkin(NodeImpl.java:2830)
> 	at org.apache.jackrabbit.core.version.UserTransactionCheckinTest.testRestoreWithXA(UserTransactionCheckinTest.java:35)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33730-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan  9 10:03:44 2012
Return-Path: <dev-return-33730-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4D0F39D0E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon,  9 Jan 2012 10:03:44 +0000 (UTC)
Received: (qmail 1180 invoked by uid 500); 9 Jan 2012 10:03:38 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 1031 invoked by uid 500); 9 Jan 2012 10:03:08 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 99122 invoked by uid 99); 9 Jan 2012 10:03:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 09 Jan 2012 10:03:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 09 Jan 2012 10:02:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 605BB13F462
	for <dev@jackrabbit.apache.org>; Mon,  9 Jan 2012 10:02:39 +0000 (UTC)
Date: Mon, 9 Jan 2012 10:02:39 +0000 (UTC)
From: "Lukas Kahwe Smith (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1654757044.21073.1326103359396.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3204) query time field boosting
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

query time field boosting
-------------------------

                 Key: JCR-3204
                 URL: https://issues.apache.org/jira/browse/JCR-3204
             Project: Jackrabbit Content Repository
          Issue Type: New Feature
            Reporter: Lukas Kahwe Smith
            Priority: Minor


Right now its only possible to boot fields at index time. But for a use case where more recent documents should be preferred this isn't feasible, as this would require reindexing all documents every day.

see also http://lucene.apache.org/java/3_0_2/api/all/org/apache/lucene/search/Similarity.html

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33731-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 10 12:58:58 2012
Return-Path: <dev-return-33731-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A539BBEDE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 10 Jan 2012 12:58:58 +0000 (UTC)
Received: (qmail 58921 invoked by uid 500); 10 Jan 2012 12:37:40 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 58706 invoked by uid 500); 10 Jan 2012 12:37:16 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 58595 invoked by uid 99); 10 Jan 2012 12:37:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 10 Jan 2012 12:37:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 10 Jan 2012 12:36:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C3BE9141054
	for <dev@jackrabbit.apache.org>; Tue, 10 Jan 2012 12:36:39 +0000 (UTC)
Date: Tue, 10 Jan 2012 12:36:39 +0000 (UTC)
From: "Marcel Reutegger (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1399090740.25208.1326198999803.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1446988912.15716.1323959430807.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3182) SQL2 Parser fails for some version
 paths
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3182?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Marcel Reutegger resolved JCR-3182.
-----------------------------------

    Resolution: Invalid

> [...] not a legal name

I agree. Resolving as invalid.
                
> SQL2 Parser fails for some version paths
> ----------------------------------------
>
>                 Key: JCR-3182
>                 URL: https://issues.apache.org/jira/browse/JCR-3182
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-commons, query
>            Reporter: Alex Parvulescu
>            Priority: Minor
>         Attachments: JCR-3182-test.patch
>
>
> This is the SQL2 query that is failing at the moment:
>   SELECT NODE.* FROM [nt:base] AS NODE WHERE ISCHILDNODE(NODE, [/jcr:system/jcr:versionStorage/17/66/ea/1766eaef-f0f5-4cf6-95ef-a1d7290257f9])
> I've seen that while running some queries on the versioning store.
> Stacktrace:
> SELECT * FROM [nt:base] as NODE WHERE ischildnode(NODE, [/jcr:system/jcr:versionStorage/17/66/ea/(*)1766eaef-f0f5-4cf6-95ef-a1d7290257f9])
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.getSyntaxError(Parser.java:978)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.getSyntaxError(Parser.java:959)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.readDecimal(Parser.java:937)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.read(Parser.java:846)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.readAny(Parser.java:667)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.readName(Parser.java:158)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.readPath(Parser.java:384)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.parseConditionFuntionIf(Parser.java:365)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.parseCondition(Parser.java:258)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.parseAnd(Parser.java:241)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.parseConstraint(Parser.java:233)
> 	at org.apache.jackrabbit.commons.query.sql2.Parser.createQueryObjectModel(Parser.java:117)
> 	at org.apache.jackrabbit.commons.query.sql2.SQL2QOMBuilder.createQueryObjectModel(SQL2QOMBuilder.java:55)
> 	at org.apache.jackrabbit.core.query.QOMQueryFactory.createQuery(QOMQueryFactory.java:70)
> 	at org.apache.jackrabbit.core.query.CompoundQueryFactory.createQuery(CompoundQueryFactory.java:67)
> 	at org.apache.jackrabbit.core.query.QueryManagerImpl$2.perform(QueryManagerImpl.java:95)
> 	at org.apache.jackrabbit.core.query.QueryManagerImpl$2.perform(QueryManagerImpl.java:1)
> 	at org.apache.jackrabbit.core.session.SessionState.perform(SessionState.java:216)
> 	at org.apache.jackrabbit.core.query.QueryManagerImpl.perform(QueryManagerImpl.java:197)
> 	at org.apache.jackrabbit.core.query.QueryManagerImpl.createQuery(QueryManagerImpl.java:91)
> 	at org.apache.jackrabbit.core.cluster.DbClusterTestJCR3162.checkConsistency(DbClusterTestJCR3162.java:177)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33732-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 10 19:01:06 2012
Return-Path: <dev-return-33732-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DF99DB13D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 10 Jan 2012 19:01:05 +0000 (UTC)
Received: (qmail 94324 invoked by uid 500); 10 Jan 2012 19:01:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 93904 invoked by uid 500); 10 Jan 2012 19:01:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 93887 invoked by uid 99); 10 Jan 2012 19:01:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 10 Jan 2012 19:01:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 10 Jan 2012 19:01:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D59B1142D02
	for <dev@jackrabbit.apache.org>; Tue, 10 Jan 2012 19:00:39 +0000 (UTC)
Date: Tue, 10 Jan 2012 19:00:39 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <975630474.26473.1326222039876.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1218356144.49931.1323278079902.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCRSITE-37) Migrate web site from Confluence to
 Apache CMS
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCRSITE-37?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13183476#comment-13183476 ] 

Jukka Zitting commented on JCRSITE-37:
--------------------------------------

I've now set up the basic CMS site sources and done an initial migration of Confluence pages.

I filed INFRA-4311 to set up a staging build so we can start checking how the migrated site looks in practice.
                
> Migrate web site from Confluence to Apache CMS
> ----------------------------------------------
>
>                 Key: JCRSITE-37
>                 URL: https://issues.apache.org/jira/browse/JCRSITE-37
>             Project: Jackrabbit Site
>          Issue Type: Task
>          Components: site
>            Reporter: Jukka Zitting
>            Assignee: Jukka Zitting
>              Labels: cms
>
> As discussed earlier (http://markmail.org/message/h5zp3f67g5zftltf) we should migrate our web site away from the Confluence wiki to the Apache CMS system (http://www.apache.org/dev/cms.html).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33733-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 11 06:46:41 2012
Return-Path: <dev-return-33733-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2914191FE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 11 Jan 2012 06:46:41 +0000 (UTC)
Received: (qmail 12591 invoked by uid 500); 11 Jan 2012 06:46:40 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 12209 invoked by uid 500); 11 Jan 2012 06:46:23 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 12198 invoked by uid 99); 11 Jan 2012 06:46:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 06:46:18 +0000
X-ASF-Spam-Status: No, hits=2.0 required=5.0
	tests=SPF_NEUTRAL,URI_HEX
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 216.139.236.26 is neither permitted nor denied by domain of jain.sm@gmail.com)
Received: from [216.139.236.26] (HELO sam.nabble.com) (216.139.236.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 06:46:12 +0000
Received: from joe.nabble.com ([192.168.236.139])
	by sam.nabble.com with esmtp (Exim 4.72)
	(envelope-from <jain.sm@gmail.com>)
	id 1RkrwV-0006E7-6C
	for dev@jackrabbit.apache.org; Tue, 10 Jan 2012 22:45:51 -0800
Date: Tue, 10 Jan 2012 22:45:51 -0800 (PST)
From: smjain <jain.sm@gmail.com>
To: dev@jackrabbit.apache.org
Message-ID: <1326264351165-4284582.post@n4.nabble.com>
Subject: deleting the last version of a node doesnt work
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

I am trying to delete the last version of a node. It gives an error. All
other versions can be deleted.

Has someone seen this issue in the past?

Thanks

Shashank

--
View this message in context: http://jackrabbit.510166.n4.nabble.com/deleting-the-last-version-of-a-node-doesnt-work-tp4284582p4284582.html
Sent from the Jackrabbit - Dev mailing list archive at Nabble.com.

From dev-return-33734-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 11 08:17:30 2012
Return-Path: <dev-return-33734-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AA40E901E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 11 Jan 2012 08:17:30 +0000 (UTC)
Received: (qmail 15932 invoked by uid 500); 11 Jan 2012 08:17:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 15117 invoked by uid 500); 11 Jan 2012 08:17:20 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 15100 invoked by uid 99); 11 Jan 2012 08:17:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 08:17:13 +0000
X-ASF-Spam-Status: No, hits=1.3 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL,URI_HEX
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 129.79.1.188 is neither permitted nor denied by domain of peri.subrahmanya@gmail.com)
Received: from [129.79.1.188] (HELO irpt-internal-relay.indiana.edu) (129.79.1.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 08:17:04 +0000
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: AscJALNEDU+BTwE+/2dsb2JhbABCnEuDHox3A4EFgXIBAQQBOiISEAsLCzsjNBGIAgimA4dKP4h4iQGCOWMEiDiMVIVRjHM
Received: from internal-relay.indiana.edu ([129.79.1.62])
  by irpt-internal-relay.indiana.edu with ESMTP; 11 Jan 2012 03:16:44 -0500
Received: from mail-relay.iu.edu (burns.uits.indiana.edu [129.79.1.202])
	by internal-relay.indiana.edu (8.14.5/8.14.4/IU Messaging Team) with ESMTP id q0B8GhEG001061
	for <dev@jackrabbit.apache.org>; Wed, 11 Jan 2012 03:16:43 -0500
Received: from [223.177.2.87] ([223.177.2.87])
	(authenticated bits=0)
	by mail-relay.iu.edu (8.14.5/8.14.4/IU Messaging Team Submission) with ESMTP id q0B8Gb74029730
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=NO)
	for <dev@jackrabbit.apache.org>; Wed, 11 Jan 2012 03:16:42 -0500
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1251.1)
Subject: Re: deleting the last version of a node doesnt work
From: Peri Subrahmanya <peri.subrahmanya@gmail.com>
In-Reply-To: <1326264351165-4284582.post@n4.nabble.com>
Date: Wed, 11 Jan 2012 13:46:36 +0530
Content-Transfer-Encoding: quoted-printable
Message-Id: <2473_1326269804_q0B8GhEG001061_0FB7335D-41DE-42AF-BBF2-A9217CC50F66@gmail.com>
References: <1326264351165-4284582.post@n4.nabble.com>
To: dev@jackrabbit.apache.org
X-Mailer: Apple Mail (2.1251.1)

Shashank,

Could you provide details on what version of JCR are you using and also =
how you are trying to delete?=20

Thanks
-PeriS

On Jan 11, 2012, at 12:15 PM, smjain wrote:

> I am trying to delete the last version of a node. It gives an error. =
All
> other versions can be deleted.
>=20
> Has someone seen this issue in the past?
>=20
> Thanks
>=20
> Shashank
>=20
> --
> View this message in context: =
http://jackrabbit.510166.n4.nabble.com/deleting-the-last-version-of-a-node=
-doesnt-work-tp4284582p4284582.html
> Sent from the Jackrabbit - Dev mailing list archive at Nabble.com.


From dev-return-33735-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 11 13:56:25 2012
Return-Path: <dev-return-33735-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C350D975F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 11 Jan 2012 13:56:25 +0000 (UTC)
Received: (qmail 60542 invoked by uid 500); 11 Jan 2012 13:56:23 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 60131 invoked by uid 500); 11 Jan 2012 13:56:08 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 60123 invoked by uid 99); 11 Jan 2012 13:56:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 13:56:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 13:55:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 733D01442C4
	for <dev@jackrabbit.apache.org>; Wed, 11 Jan 2012 13:55:39 +0000 (UTC)
Date: Wed, 11 Jan 2012 13:55:39 +0000 (UTC)
From: "Julian Reschke (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1257788499.29889.1326290139473.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1047400331.28339.1324332572529.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3186) Export size of Observation eventQueue
 to JMX
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3186?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke reassigned JCR-3186:
-----------------------------------

    Assignee: Julian Reschke
   =20
> Export size of Observation eventQueue to JMX
> --------------------------------------------
>
>                 Key: JCR-3186
>                 URL: https://issues.apache.org/jira/browse/JCR-3186
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: jackrabbit-core
>            Reporter: J=C3=B6rg Hoh
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JR-observationQueueJMX-trunk.patch
>
>
> export the size of the event queue of JCR Observation to JMX.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33736-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 11 15:47:07 2012
Return-Path: <dev-return-33736-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5EA639146
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 11 Jan 2012 15:47:07 +0000 (UTC)
Received: (qmail 58107 invoked by uid 500); 11 Jan 2012 15:47:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 57264 invoked by uid 500); 11 Jan 2012 15:47:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 56902 invoked by uid 99); 11 Jan 2012 15:47:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 15:47:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 11 Jan 2012 15:47:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id DA814144D05
	for <dev@jackrabbit.apache.org>; Wed, 11 Jan 2012 15:46:39 +0000 (UTC)
Date: Wed, 11 Jan 2012 15:46:39 +0000 (UTC)
From: "Vitali Liubchanka (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1294087750.30185.1326296799896.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <23632580.55004.1323376900017.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3173) InvalidItemStateException if
 accessing VersionHistory before checkin()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3173?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13184140#comment-13184140 ] 

Vitali Liubchanka commented on JCR-3173:
----------------------------------------

Experience the same issue with checkout - change - checkin in one transaction.

There is a code in ItemManager.getDefinition(NodeState state):
ItemData parentData = getItemData(parentId, null, false);

It was discovered that this data is retrieved from cache where it's not up-to-date. Invoke several times in debug finally retrieves correct data and operation is finished successfully. 
I've not founfd workaround at the moment.
                
> InvalidItemStateException if accessing VersionHistory before checkin()
> ----------------------------------------------------------------------
>
>                 Key: JCR-3173
>                 URL: https://issues.apache.org/jira/browse/JCR-3173
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>    Affects Versions: 2.2.10
>            Reporter: Matthias Reischenbacher
>         Attachments: UserTransactionCheckinTest.java
>
>
> A checkin operation fails during a transaction if the VersionHistory of a node is accessed previously. See the attached test case for further details.
> -------------------------------------------------------------------------------
> Test set: org.apache.jackrabbit.core.version.UserTransactionCheckinTest
> -------------------------------------------------------------------------------
> Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 4.072 sec <<< FAILURE!
> testRestoreWithXA(org.apache.jackrabbit.core.version.UserTransactionCheckinTest)  Time elapsed: 3.858 sec  <<< ERROR!
> javax.jcr.InvalidItemStateException: Could not find child e77834ee-244c-441f-ab94-19847c769fa4 of node 03629609-8049-46ee-9e80-279c70b3a34d
> 	at org.apache.jackrabbit.core.ItemManager.getDefinition(ItemManager.java:207)
> 	at org.apache.jackrabbit.core.ItemData.getDefinition(ItemData.java:99)
> 	at org.apache.jackrabbit.core.ItemManager.canRead(ItemManager.java:421)
> 	at org.apache.jackrabbit.core.ItemManager.createItemData(ItemManager.java:843)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:391)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.SessionImpl.getNodeById(SessionImpl.java:493)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:123)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:1)
> 	at org.apache.jackrabbit.core.session.SessionState.perform(SessionState.java:200)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.perform(VersionManagerImpl.java:96)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:115)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:101)
> 	at org.apache.jackrabbit.core.NodeImpl.checkin(NodeImpl.java:2830)
> 	at org.apache.jackrabbit.core.version.UserTransactionCheckinTest.testRestoreWithXA(UserTransactionCheckinTest.java:35)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33737-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 02:10:51 2012
Return-Path: <dev-return-33737-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A8F52987F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 02:10:51 +0000 (UTC)
Received: (qmail 96099 invoked by uid 500); 12 Jan 2012 02:10:51 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 96016 invoked by uid 500); 12 Jan 2012 02:10:50 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 96009 invoked by uid 99); 12 Jan 2012 02:10:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 02:10:50 +0000
X-ASF-Spam-Status: No, hits=2.0 required=5.0
	tests=SPF_NEUTRAL,URI_HEX
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 216.139.236.26 is neither permitted nor denied by domain of jain.sm@gmail.com)
Received: from [216.139.236.26] (HELO sam.nabble.com) (216.139.236.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 02:10:44 +0000
Received: from joe.nabble.com ([192.168.236.139])
	by sam.nabble.com with esmtp (Exim 4.72)
	(envelope-from <jain.sm@gmail.com>)
	id 1RlA7T-0001zm-Ru
	for dev@jackrabbit.apache.org; Wed, 11 Jan 2012 18:10:23 -0800
Date: Wed, 11 Jan 2012 18:10:23 -0800 (PST)
From: smjain <jain.sm@gmail.com>
To: dev@jackrabbit.apache.org
Message-ID: <1326334223856-4287608.post@n4.nabble.com>
In-Reply-To: <2473_1326269804_q0B8GhEG001061_0FB7335D-41DE-42AF-BBF2-A9217CC50F66@gmail.com>
References: <1326264351165-4284582.post@n4.nabble.com> <2473_1326269804_q0B8GhEG001061_0FB7335D-41DE-42AF-BBF2-A9217CC50F66@gmail.com>
Subject: Re: deleting the last version of a node doesnt work
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

The jackrabbit version is 2.2.4
Thanks

Shashank

--
View this message in context: http://jackrabbit.510166.n4.nabble.com/deleting-the-last-version-of-a-node-doesnt-work-tp4284582p4287608.html
Sent from the Jackrabbit - Dev mailing list archive at Nabble.com.

From dev-return-33738-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 02:11:43 2012
Return-Path: <dev-return-33738-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EE29B98D6
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 02:11:42 +0000 (UTC)
Received: (qmail 97629 invoked by uid 500); 12 Jan 2012 02:11:42 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 97452 invoked by uid 500); 12 Jan 2012 02:11:42 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 97445 invoked by uid 99); 12 Jan 2012 02:11:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 02:11:41 +0000
X-ASF-Spam-Status: No, hits=2.0 required=5.0
	tests=SPF_NEUTRAL,URI_HEX
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 216.139.236.26 is neither permitted nor denied by domain of jain.sm@gmail.com)
Received: from [216.139.236.26] (HELO sam.nabble.com) (216.139.236.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 02:11:36 +0000
Received: from joe.nabble.com ([192.168.236.139])
	by sam.nabble.com with esmtp (Exim 4.72)
	(envelope-from <jain.sm@gmail.com>)
	id 1RlA8K-000235-6L
	for dev@jackrabbit.apache.org; Wed, 11 Jan 2012 18:11:16 -0800
Date: Wed, 11 Jan 2012 18:11:16 -0800 (PST)
From: smjain <jain.sm@gmail.com>
To: dev@jackrabbit.apache.org
Message-ID: <1326334276188-4287611.post@n4.nabble.com>
In-Reply-To: <1326334223856-4287608.post@n4.nabble.com>
References: <1326264351165-4284582.post@n4.nabble.com> <2473_1326269804_q0B8GhEG001061_0FB7335D-41DE-42AF-BBF2-A9217CC50F66@gmail.com> <1326334223856-4287608.post@n4.nabble.com>
Subject: Re: deleting the last version of a node doesnt work
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

We get the version from the version manager and do a remove on it. Able to
delete other versions except the last one..

--
View this message in context: http://jackrabbit.510166.n4.nabble.com/deleting-the-last-version-of-a-node-doesnt-work-tp4284582p4287611.html
Sent from the Jackrabbit - Dev mailing list archive at Nabble.com.

From dev-return-33739-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 08:08:42 2012
Return-Path: <dev-return-33739-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DF059B5EE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 08:08:42 +0000 (UTC)
Received: (qmail 43156 invoked by uid 500); 12 Jan 2012 08:08:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 42750 invoked by uid 500); 12 Jan 2012 08:08:09 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 42724 invoked by uid 99); 12 Jan 2012 08:08:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:08:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:08:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 53BF3146103
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 08:07:39 +0000 (UTC)
Date: Thu, 12 Jan 2012 08:07:39 +0000 (UTC)
From: "Vitali Liubchanka (Issue Comment Edited) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <250074634.33702.1326355659344.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <23632580.55004.1323376900017.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Issue Comment Edited] (JCR-3173) InvalidItemStateException
 if accessing VersionHistory before checkin()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3173?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13184140#comment-13184140 ] 

Vitali Liubchanka edited comment on JCR-3173 at 1/12/12 8:06 AM:
-----------------------------------------------------------------

Experience the same issue with checkout - change - checkin in one transaction.

There is a code in ItemManager.getDefinition(NodeState state):
ItemData parentData = getItemData(parentId, null, false);

It was discovered that this data is retrieved from cache where it's not up-to-date. Invoke several times in debug finally retrieves correct data and operation is finished successfully. 
                
      was (Author: vitalyl):
    Experience the same issue with checkout - change - checkin in one transaction.

There is a code in ItemManager.getDefinition(NodeState state):
ItemData parentData = getItemData(parentId, null, false);

It was discovered that this data is retrieved from cache where it's not up-to-date. Invoke several times in debug finally retrieves correct data and operation is finished successfully. 
I've not founfd workaround at the moment.
                  
> InvalidItemStateException if accessing VersionHistory before checkin()
> ----------------------------------------------------------------------
>
>                 Key: JCR-3173
>                 URL: https://issues.apache.org/jira/browse/JCR-3173
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>    Affects Versions: 2.2.10
>            Reporter: Matthias Reischenbacher
>         Attachments: UserTransactionCheckinTest.java
>
>
> A checkin operation fails during a transaction if the VersionHistory of a node is accessed previously. See the attached test case for further details.
> -------------------------------------------------------------------------------
> Test set: org.apache.jackrabbit.core.version.UserTransactionCheckinTest
> -------------------------------------------------------------------------------
> Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 4.072 sec <<< FAILURE!
> testRestoreWithXA(org.apache.jackrabbit.core.version.UserTransactionCheckinTest)  Time elapsed: 3.858 sec  <<< ERROR!
> javax.jcr.InvalidItemStateException: Could not find child e77834ee-244c-441f-ab94-19847c769fa4 of node 03629609-8049-46ee-9e80-279c70b3a34d
> 	at org.apache.jackrabbit.core.ItemManager.getDefinition(ItemManager.java:207)
> 	at org.apache.jackrabbit.core.ItemData.getDefinition(ItemData.java:99)
> 	at org.apache.jackrabbit.core.ItemManager.canRead(ItemManager.java:421)
> 	at org.apache.jackrabbit.core.ItemManager.createItemData(ItemManager.java:843)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:391)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.SessionImpl.getNodeById(SessionImpl.java:493)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:123)
> 	at org.apache.jackrabbit.core.VersionManagerImpl$1.perform(VersionManagerImpl.java:1)
> 	at org.apache.jackrabbit.core.session.SessionState.perform(SessionState.java:200)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.perform(VersionManagerImpl.java:96)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:115)
> 	at org.apache.jackrabbit.core.VersionManagerImpl.checkin(VersionManagerImpl.java:101)
> 	at org.apache.jackrabbit.core.NodeImpl.checkin(NodeImpl.java:2830)
> 	at org.apache.jackrabbit.core.version.UserTransactionCheckinTest.testRestoreWithXA(UserTransactionCheckinTest.java:35)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33740-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 08:24:51 2012
Return-Path: <dev-return-33740-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 174C3BF3A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 08:24:51 +0000 (UTC)
Received: (qmail 66545 invoked by uid 500); 12 Jan 2012 08:24:45 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 64400 invoked by uid 500); 12 Jan 2012 08:24:17 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 62466 invoked by uid 99); 12 Jan 2012 08:24:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:24:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:23:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CF87A1467D0
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 08:23:38 +0000 (UTC)
Date: Thu, 12 Jan 2012 08:23:38 +0000 (UTC)
From: "David Buchmann (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3205) Lock timeout not working with jcr2spi
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

Lock timeout not working with jcr2spi
-------------------------------------

                 Key: JCR-3205
                 URL: https://issues.apache.org/jira/browse/JCR-3205
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-jcr2spi, jackrabbit-spi2jcr
    Affects Versions: 2.3.6
            Reporter: David Buchmann


trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.

this was my test code:

import javax.jcr.*;
import javax.jcr.lock.*;

import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;


String url = "http://localhost:8080/server/";
String workspace = "tests";

RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
Repository repo = RepositoryImpl.create(config);

Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
Session s = repo.login(sc,workspace);

Node t;
if (s.getRootNode().hasNode("test")) {
    t = s.getRootNode().getNode("test");
} else {
    t = s.getRootNode().addNode("test", "nt:unstructured");
}
t.addMixin("mix:lockable");
s.save();
LockManager m = s.getWorkspace().getLockManager();
Lock l = m.lock(t.getPath(), false, true, 10, "me");
System.out.println(l.getSecondsRemaining());

and the output is 2147483


the relevant communication fragment is below, i attach the full trace in case i miss something.

LOCK /server/tests/jcr%3aroot/test HTTP/1.1
Timeout: Second-10
Depth: 0
Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
Authorization: Basic YWRtaW46YWRtaW4=
User-Agent: Jakarta Commons-HttpClient/3.0
Host: localhost:8080
Content-Length: 254
Content-Type: text/xml; charset=UTF-8

<?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>

HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 450
Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
Server: Jetty(6.1.x)

<?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>



by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33741-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 08:26:41 2012
Return-Path: <dev-return-33741-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 00E14B742
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 08:26:41 +0000 (UTC)
Received: (qmail 72134 invoked by uid 500); 12 Jan 2012 08:26:19 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 70290 invoked by uid 500); 12 Jan 2012 08:26:09 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 69299 invoked by uid 99); 12 Jan 2012 08:26:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:26:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:25:58 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7277C1468FF
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 08:25:38 +0000 (UTC)
Date: Thu, 12 Jan 2012 08:25:38 +0000 (UTC)
From: "David Buchmann (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <490575149.33738.1326356738470.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3205) Lock timeout not working with jcr2spi
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

David Buchmann updated JCR-3205:
--------------------------------

    Attachment: tcpdump.log

full dump of the tcp communication between client and server for the sample code, done with wireshark and formatted a little bit for readability.
                
> Lock timeout not working with jcr2spi
> -------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr2spi, jackrabbit-spi2jcr
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33742-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 08:30:30 2012
Return-Path: <dev-return-33742-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 03AAFB35E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 08:30:30 +0000 (UTC)
Received: (qmail 82695 invoked by uid 500); 12 Jan 2012 08:30:22 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 82267 invoked by uid 500); 12 Jan 2012 08:29:57 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 82253 invoked by uid 99); 12 Jan 2012 08:29:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:29:52 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,URI_HEX
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of david.buchmann@liip.ch designates 207.126.144.121 as permitted sender)
Received: from [207.126.144.121] (HELO eu1sys200aog106.obsmtp.com) (207.126.144.121)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:29:44 +0000
Received: from mail-ww0-f43.google.com ([74.125.82.43]) (using TLSv1) by eu1sys200aob106.postini.com ([207.126.147.11]) with SMTP
	ID DSNKTw6Z5OR4yGhtcfzdkcxggPBRMzAne/8z@postini.com; Thu, 12 Jan 2012 08:29:24 UTC
Received: by mail-ww0-f43.google.com with SMTP id dt11so1517352wgb.12
        for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 00:29:24 -0800 (PST)
Received: by 10.180.100.234 with SMTP id fb10mr16796138wib.5.1326356964270;
        Thu, 12 Jan 2012 00:29:24 -0800 (PST)
Received: from [192.168.2.2] (84-73-137-226.dclient.hispeed.ch. [84.73.137.226])
        by mx.google.com with ESMTPS id 28sm4857262wby.3.2012.01.12.00.29.23
        (version=SSLv3 cipher=OTHER);
        Thu, 12 Jan 2012 00:29:23 -0800 (PST)
Message-ID: <4F0E99E2.4030508@liip.ch>
Date: Thu, 12 Jan 2012 09:29:22 +0100
From: David Buchmann <david.buchmann@liip.ch>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.24) Gecko/20111108 Thunderbird/3.1.16
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
CC: smjain <jain.sm@gmail.com>
Subject: Re: deleting the last version of a node doesnt work
References: <1326264351165-4284582.post@n4.nabble.com> <2473_1326269804_q0B8GhEG001061_0FB7335D-41DE-42AF-BBF2-A9217CC50F66@gmail.com> <1326334223856-4287608.post@n4.nabble.com> <1326334276188-4287611.post@n4.nabble.com>
In-Reply-To: <1326334276188-4287611.post@n4.nabble.com>
X-Enigmail-Version: 1.1.1
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

i can not find the reference right now, but i thought it is not possible
to remove the current version of a node. after all, what would the node
be then?

you could restore the previous version with removeExisting set to true.
or if you completely want to remove the node, just remove it instead of
removing all versions separatly.

cheers,david

Am 12.01.2012 03:11, schrieb smjain:
> We get the version from the version manager and do a remove on it. Able to
> delete other versions except the last one..
> 
> --
> View this message in context: http://jackrabbit.510166.n4.nabble.com/deleting-the-last-version-of-a-node-doesnt-work-tp4284582p4287611.html
> Sent from the Jackrabbit - Dev mailing list archive at Nabble.com.

- -- 
Liip AG // Agile Web Development // T +41 26 422 25 11
CH-1700 Fribourg // PGP 0xA581808B // www.liip.ch
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk8OmeIACgkQqBnXnqWBgIvV6QCgp0ld4I5B+il2TQJcld8omB5B
UtcAoJEFZfqnyIoSmvPIEe7RoMKMZQRb
=8GB5
-----END PGP SIGNATURE-----

From dev-return-33743-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 08:32:31 2012
Return-Path: <dev-return-33743-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0011CB4BF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 08:32:30 +0000 (UTC)
Received: (qmail 85023 invoked by uid 500); 12 Jan 2012 08:32:29 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 84736 invoked by uid 500); 12 Jan 2012 08:32:20 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 84480 invoked by uid 99); 12 Jan 2012 08:32:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:32:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:31:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A19B9146BD2
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 08:31:38 +0000 (UTC)
Date: Thu, 12 Jan 2012 08:31:38 +0000 (UTC)
From: =?utf-8?Q?Claus_K=C3=B6ll_=28Updated=29_=28JIRA=29?= <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <529734170.33749.1326357098663.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1694948235.34137.1324440810712.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3189)
 JCARepositoryManager.createNonTransientRepository throws NPE with no
 JCAManagedConnectionFactory.CONFIGFILE_KEY
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3189?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Claus K=C3=B6ll updated JCR-3189:
----------------------------

    Affects Version/s: 2.3.5
   =20
> JCARepositoryManager.createNonTransientRepository throws NPE with no JCAM=
anagedConnectionFactory.CONFIGFILE_KEY
> -------------------------------------------------------------------------=
--------------------------------------
>
>                 Key: JCR-3189
>                 URL: https://issues.apache.org/jira/browse/JCR-3189
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jca
>    Affects Versions: 2.3.5
>            Reporter: Dave Brosius
>            Assignee: Claus K=C3=B6ll
>            Priority: Minor
>
> JCARepositoryManager.createNonTransientRepository fails if
> String configFile =3D parameters.get(JCAManagedConnectionFactory.CONFIGFI=
LE_KEY);
> is null, because
> config =3D RepositoryConfig.create(configFile, homeDir);
> will always throw an NPE, perhaps the call should just be
> config =3D RepositoryConfig.create(homeDir);

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33744-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 08:44:29 2012
Return-Path: <dev-return-33744-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A4269B742
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 08:44:29 +0000 (UTC)
Received: (qmail 96358 invoked by uid 500); 12 Jan 2012 08:44:28 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 95968 invoked by uid 500); 12 Jan 2012 08:44:12 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 95908 invoked by uid 99); 12 Jan 2012 08:44:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:44:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 08:43:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1F0C514722E
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 08:43:39 +0000 (UTC)
Date: Thu, 12 Jan 2012 08:43:39 +0000 (UTC)
From: =?utf-8?Q?Claus_K=C3=B6ll_=28Created=29_=28JIRA=29?= <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2121910821.33772.1326357819140.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3206) JSR-283 support for RMI
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

JSR-283 support for RMI
-----------------------

                 Key: JCR-3206
                 URL: https://issues.apache.org/jira/browse/JCR-3206
             Project: Jackrabbit Content Repository
          Issue Type: New Feature
          Components: jackrabbit-jcr-rmi
    Affects Versions: 2.3
            Reporter: Claus K=C3=B6ll


We have the JCRRMI-26 Issue for the missing JSR-283 support.
As we do no more use the Jira Project JCRRMI i would like to create a new I=
ssue for that feature request.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33745-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 09:39:46 2012
Return-Path: <dev-return-33745-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7C8D9B5D5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 09:39:46 +0000 (UTC)
Received: (qmail 48291 invoked by uid 500); 12 Jan 2012 09:39:37 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 47579 invoked by uid 500); 12 Jan 2012 09:39:10 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 47528 invoked by uid 99); 12 Jan 2012 09:39:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 09:39:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 09:38:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 6B12E1467BE
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 09:38:39 +0000 (UTC)
Date: Thu, 12 Jan 2012 09:38:39 +0000 (UTC)
From: "Julian Reschke (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <368597575.33865.1326361119439.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3205) Lock timeout not working with jcr2spi
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke reassigned JCR-3205:
-----------------------------------

    Assignee: Julian Reschke
    
> Lock timeout not working with jcr2spi
> -------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr2spi, jackrabbit-spi2jcr
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33746-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 09:40:04 2012
Return-Path: <dev-return-33746-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 826EEB635
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 09:40:04 +0000 (UTC)
Received: (qmail 49535 invoked by uid 500); 12 Jan 2012 09:39:50 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 47895 invoked by uid 500); 12 Jan 2012 09:39:30 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 47541 invoked by uid 99); 12 Jan 2012 09:39:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 09:39:05 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 09:39:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7F7CA1467D7
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 09:38:40 +0000 (UTC)
Date: Thu, 12 Jan 2012 09:38:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <742309115.33885.1326361120523.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3205) Lock timeout not working with jcr2spi
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13184842#comment-13184842 ] 

Julian Reschke commented on JCR-3205:
-------------------------------------

The LOCK response indicates that the timeout value wasn't used; will investigate...
                
> Lock timeout not working with jcr2spi
> -------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr2spi, jackrabbit-spi2jcr
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33747-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 14:46:31 2012
Return-Path: <dev-return-33747-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CC184B37D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 14:46:31 +0000 (UTC)
Received: (qmail 45172 invoked by uid 500); 12 Jan 2012 14:46:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 44795 invoked by uid 500); 12 Jan 2012 14:46:17 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 44754 invoked by uid 99); 12 Jan 2012 14:46:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 14:46:05 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 14:46:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id B2F28147FDB
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 14:45:39 +0000 (UTC)
Date: Thu, 12 Jan 2012 14:45:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1070403026.34601.1326379539734.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Commented] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13184995#comment-13184995 ] 

Julian Reschke commented on JCR-2859:
-------------------------------------

The problem is caused by LockInfoImpl in SPI assuming that seeing the lock token implies owning the Lock.
                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>             Fix For: 2.5
>
>         Attachments: JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33748-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 17:22:03 2012
Return-Path: <dev-return-33748-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C0C57B2BE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 17:22:03 +0000 (UTC)
Received: (qmail 86332 invoked by uid 500); 12 Jan 2012 17:22:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 86117 invoked by uid 500); 12 Jan 2012 17:22:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 85927 invoked by uid 99); 12 Jan 2012 17:22:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 17:22:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 17:21:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 98BB014760B
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 17:21:39 +0000 (UTC)
Date: Thu, 12 Jan 2012 17:21:39 +0000 (UTC)
From: "angela (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2060463728.35098.1326388899627.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3205) Lock timeout not working with jcr2spi
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela updated JCR-3205:
------------------------

    Component/s:     (was: jackrabbit-spi2jcr)
                     (was: jackrabbit-jcr2spi)
                 jackrabbit-jcr-server
       Assignee: angela  (was: Julian Reschke)

adjusted the component to jackrabbit-jcr-server. as far as i know the jsr 283 lock features
are implemented in jcr2spi and the various spi-implementations. however, they are missing
in the jcr-server (JcrActiveLock and DefaultItemCollection).

will take a look at it.
                
> Lock timeout not working with jcr2spi
> -------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33749-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 17:46:03 2012
Return-Path: <dev-return-33749-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B9750B5BF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 17:46:03 +0000 (UTC)
Received: (qmail 28262 invoked by uid 500); 12 Jan 2012 17:46:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 27258 invoked by uid 500); 12 Jan 2012 17:46:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 27182 invoked by uid 99); 12 Jan 2012 17:46:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 17:46:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 17:46:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1D88F1481DC
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 17:45:40 +0000 (UTC)
Date: Thu, 12 Jan 2012 17:45:40 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1566752315.35157.1326390340122.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Updated] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-2859:
--------------------------------

    Attachment: JCR-2859.diff

proposed patch
                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>             Fix For: 2.5
>
>         Attachments: JCR-2859.diff, JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33750-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 18:18:03 2012
Return-Path: <dev-return-33750-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C2046B587
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 18:18:03 +0000 (UTC)
Received: (qmail 94132 invoked by uid 500); 12 Jan 2012 18:18:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 93462 invoked by uid 500); 12 Jan 2012 18:18:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 93282 invoked by uid 99); 12 Jan 2012 18:18:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 18:18:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 18:18:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 70AA3148F19
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 18:17:40 +0000 (UTC)
Date: Thu, 12 Jan 2012 18:17:40 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1296029907.35272.1326392260463.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Resolved] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-2859.
---------------------------------

    Resolution: Fixed
    
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>             Fix For: 2.5
>
>         Attachments: JCR-2859.diff, JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33751-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 18:32:06 2012
Return-Path: <dev-return-33751-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1D44BB1A5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 18:32:06 +0000 (UTC)
Received: (qmail 23313 invoked by uid 500); 12 Jan 2012 18:32:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 22701 invoked by uid 500); 12 Jan 2012 18:32:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 22694 invoked by uid 99); 12 Jan 2012 18:32:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 18:32:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 18:32:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id BB3CF1476CD
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 18:31:40 +0000 (UTC)
Date: Thu, 12 Jan 2012 18:31:40 +0000 (UTC)
From: "angela (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1523082695.35331.1326393100768.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3205) Missing support for lock timeout and
 ownerHint in jcr-server
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela updated JCR-3205:
------------------------

    Summary: Missing support for lock timeout and ownerHint in jcr-server  (was: Lock timeout not working with jcr2spi)
    
> Missing support for lock timeout and ownerHint in jcr-server
> ------------------------------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33752-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 12 18:40:05 2012
Return-Path: <dev-return-33752-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 67F74B3D4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 12 Jan 2012 18:40:05 +0000 (UTC)
Received: (qmail 33834 invoked by uid 500); 12 Jan 2012 18:40:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 33759 invoked by uid 500); 12 Jan 2012 18:40:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 33540 invoked by uid 99); 12 Jan 2012 18:40:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 18:40:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 12 Jan 2012 18:40:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A17D9147A6D
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 18:39:39 +0000 (UTC)
Date: Thu, 12 Jan 2012 18:39:39 +0000 (UTC)
From: "angela (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <64951482.35343.1326393579662.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3205) Missing support for lock timeout and
 ownerHint in jcr-server
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela resolved JCR-3205.
-------------------------

       Resolution: Fixed
    Fix Version/s: 2.4

modified the DefaultItemCollection to use LockManager#lock instead of 
Node#lock and adjusted the webdav active-lock object accordingly.

since both features are defined to be optional by the jcr specification automated
testing would require quite some changes in the tck and the jcr2spi tests.
i did some quick verifications stepping into the OpenScopedLockTest and the
server was responding as expected with the fixes in place.

david, thanks for reporting this issue.
                
> Missing support for lock timeout and ownerHint in jcr-server
> ------------------------------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>             Fix For: 2.4
>
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33753-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 06:25:01 2012
Return-Path: <dev-return-33753-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 229209979
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 06:25:01 +0000 (UTC)
Received: (qmail 9272 invoked by uid 500); 13 Jan 2012 06:24:57 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 8846 invoked by uid 500); 13 Jan 2012 06:24:35 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 8815 invoked by uid 99); 13 Jan 2012 06:24:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 06:24:27 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,URI_HEX
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tripod@adobe.com designates 64.18.1.39 as permitted sender)
Received: from [64.18.1.39] (HELO exprod6og117.obsmtp.com) (64.18.1.39)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 06:24:20 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob117.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTw/N/4VIKFnyk3aaPffDr9iYCrzzZ6UE@postini.com; Thu, 12 Jan 2012 22:23:59 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.corp.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0D6NvPu025887
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 22:23:58 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0D6NvL7028382
	for <dev@jackrabbit.apache.org>; Thu, 12 Jan 2012 22:23:57 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 12 Jan 2012
 22:23:57 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Fri, 13 Jan 2012 06:23:54
 +0000
From: Tobias Bocanegra <tripod@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 13 Jan 2012 06:23:49 +0000
Subject: Re: deleting the last version of a node doesnt work
Thread-Topic: deleting the last version of a node doesnt work
Thread-Index: AczRu+wDeRg6uIjLSsewdNBfTT+1TQ==
Message-ID: <CAB+dfinvHbTwUjuB8cUiShEujhcp0+w=LtYM834C_KHPQTnKgQ@mail.gmail.com>
References: <1326264351165-4284582.post@n4.nabble.com>
	<2473_1326269804_q0B8GhEG001061_0FB7335D-41DE-42AF-BBF2-A9217CC50F66@gmail.com>
	<1326334223856-4287608.post@n4.nabble.com>
	<1326334276188-4287611.post@n4.nabble.com>
In-Reply-To: <1326334276188-4287611.post@n4.nabble.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

SGkgU2hhc2hhbmssDQp5b3UgY2Fubm90IHJlbW92ZSBhIHZlcnNpb24gdGhhdCBpcyBzdGlsbCBy
ZWZlcmVuY2VkIGFzIGEgYmFzZSB2ZXJzaW9uDQpvZiBhIG5vZGUuIElmIHlvdSB3YW50IHRvIHJl
bW92ZSBhbGwgdmVyc2lvbnMsIHlvdSBmaXJzdA0KbmVlZCB0byByZW1vdmUgdGhlIG1peDp2ZXJz
aW9uYWJsZSBmcm9tIHRoYXQgbm9kZS4NCg0KLS0NCnRvYnkNCg0KT24gV2VkLCBKYW4gMTEsIDIw
MTIgYXQgNjoxMSBQTSwgc21qYWluIDxqYWluLnNtQGdtYWlsLmNvbT4gd3JvdGU6DQo+IFdlIGdl
dCB0aGUgdmVyc2lvbiBmcm9tIHRoZSB2ZXJzaW9uIG1hbmFnZXIgYW5kIGRvIGEgcmVtb3ZlIG9u
IGl0LiBBYmxlIHRvDQo+IGRlbGV0ZSBvdGhlciB2ZXJzaW9ucyBleGNlcHQgdGhlIGxhc3Qgb25l
Li4NCj4NCj4gLS0NCj4gVmlldyB0aGlzIG1lc3NhZ2UgaW4gY29udGV4dDogaHR0cDovL2phY2ty
YWJiaXQuNTEwMTY2Lm40Lm5hYmJsZS5jb20vZGVsZXRpbmctdGhlLWxhc3QtdmVyc2lvbi1vZi1h
LW5vZGUtZG9lc250LXdvcmstdHA0Mjg0NTgycDQyODc2MTEuaHRtbA0KPiBTZW50IGZyb20gdGhl
IEphY2tyYWJiaXQgLSBEZXYgbWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4=

From dev-return-33754-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 08:14:27 2012
Return-Path: <dev-return-33754-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1E09890F2
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 08:14:27 +0000 (UTC)
Received: (qmail 80274 invoked by uid 500); 13 Jan 2012 08:06:46 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 80060 invoked by uid 500); 13 Jan 2012 08:06:16 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 79913 invoked by uid 99); 13 Jan 2012 08:05:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 08:05:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 129.79.1.188 is neither permitted nor denied by domain of peri.subrahmanya@gmail.com)
Received: from [129.79.1.188] (HELO irpt-internal-relay.indiana.edu) (129.79.1.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 08:05:48 +0000
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: AtQFABnlD0+BTwE+/2dsb2JhbABCnHmBaoE0ikiCM4EFgjMiQ15Fn1aOUocwP4h4iQGCOWMEiDmMVYVRjHM
Received: from internal-relay.indiana.edu ([129.79.1.62])
  by irpt-internal-relay.indiana.edu with ESMTP; 13 Jan 2012 03:05:27 -0500
Received: from mail-relay.iu.edu (candy.uits.indiana.edu [129.79.1.201])
	by internal-relay.indiana.edu (8.14.5/8.14.4/IU Messaging Team) with ESMTP id q0D85QA6026696
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 03:05:27 -0500
Received: from [27.61.55.156] ([27.61.55.156])
	(authenticated bits=0)
	by mail-relay.iu.edu (8.14.5/8.14.4/IU Messaging Team Submission) with ESMTP id q0D85Lo5013965
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=NO)
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 03:05:25 -0500
From: Peri Subrahmanya <peri.subrahmanya@gmail.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: Saving large number of nodes
Date: Fri, 13 Jan 2012 13:35:19 +0530
Message-Id: <11367_1326441927_q0D85QA6026696_091E4A80-A18C-4F68-8447-E6342F76BCF0@gmail.com>
To: dev@jackrabbit.apache.org
Mime-Version: 1.0 (Apple Message framework v1251.1)
X-Mailer: Apple Mail (2.1251.1)

I am currently a 100K records file and saving to the JCR in 10K batches =
per node using multiple threads. I see lot of the following messages and =
wanted to know what these are; I am using local file system for =
datastore and SQLBundlePersistenceManager for the rest.

2012-01-13 13:06:30,223 [pool-3-thread-2] INFO  =
org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceMan=
ager.logCacheStats():Line 808: =
cachename=3DdefaultBundleCache[ConcurrentCache@563ab8f2], =
elements=3D13711, usedmemorykb=3D214, maxmemorykb=3D8192, access=3D80264, =
miss=3D80243

Thanks
-PeriS=

From dev-return-33755-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 10:23:12 2012
Return-Path: <dev-return-33755-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E41D593C4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 10:23:11 +0000 (UTC)
Received: (qmail 8710 invoked by uid 500); 13 Jan 2012 10:01:33 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 6953 invoked by uid 500); 13 Jan 2012 10:01:23 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 6910 invoked by uid 99); 13 Jan 2012 10:01:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 10:01:20 +0000
X-ASF-Spam-Status: No, hits=2.2 required=5.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Kevin.Mueller@cib.de designates 88.130.230.180 as permitted sender)
Received: from [88.130.230.180] (HELO mail.cib.de) (88.130.230.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 10:01:13 +0000
Received: from mailix2.cib.de (172.21.1.2) by mail.cib.de (192.168.199.2) with
 Microsoft SMTP Server (TLS) id 8.1.436.0; Fri, 13 Jan 2012 11:00:51 +0100
Received: from mailix2.cib.de ([172.21.1.2]) by mailix2.cib.de ([172.21.1.2])
 with mapi; Fri, 13 Jan 2012 11:00:51 +0100
From: =?iso-8859-1?Q?Kevin_M=FCller?= <Kevin.Mueller@cib.de>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 13 Jan 2012 11:00:50 +0100
Subject: Bulk load of several nodes
Thread-Topic: Bulk load of several nodes
Thread-Index: AczR2jrmGpFbret4Q+yVEBPk0cx9kQ==
Message-ID: <63796837D123564BB8015F7117E79434012B7183673C@mailix2.cib.de>
Accept-Language: de-DE
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: de-DE
Content-Type: multipart/alternative;
	boundary="_000_63796837D123564BB8015F7117E79434012B7183673Cmailix2cibd_"
MIME-Version: 1.0
X-GFI-SMTP-Submission: 1

--_000_63796837D123564BB8015F7117E79434012B7183673Cmailix2cibd_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Hi,

I think in some cases it would be useful to get all or some properties of a=
 set of nodes in one database query.
Can somebody tell me if something like this is planned for future releases =
?

One example for this usecase would be:
for (RowIterator it =3D qm.createQuery("//*[@prop=3D'some_value']/(@prop2|@=
prop3)", Query.XPATH).execute().getRows(); it.hasNext(); ) {
        Row row =3D it.nextRow();
        Map map =3D new HashMap();
        for (String key : Arrays.asList("prop2", "prop3")) {
                Value val =3D row.getValue(key);
                map.put(key, val !=3D null ? val.getString() : null);
        }
        res.put(row.getPath(), map);
}

Wouldn't be nice if this could be done with one database roundtrip - right =
now (2.2.10) there are at least n roundtrips (n =3D=3D number of results in=
 query) it seems to me.

Regards,
Kevin M=FCller


--_000_63796837D123564BB8015F7117E79434012B7183673Cmailix2cibd_
Content-Type: text/html; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Diso-8859-=
1">
<meta name=3D"Generator" content=3D"Microsoft Exchange Server">
<!-- converted from rtf -->
<style><!-- .EmailQuote { margin-left: 1pt; padding-left: 4pt; border-left:=
 #800000 2px solid; } --></style>
</head>
<body>
<font face=3D"Calibri, sans-serif" size=3D"2">
<div>Hi,</div>
<div>&nbsp;</div>
<div>I think in some cases it would be useful to get all or some properties=
 of a set of nodes in one database query.</div>
<div>Can somebody tell me if something like this is planned for future rele=
ases ?</div>
<div>&nbsp;</div>
<div>One example for this usecase would be:</div>
<div>for (RowIterator it =3D qm.createQuery(&quot;//*[@prop=3D'some_value']=
/(@prop2|@prop3)&quot;, Query.XPATH).execute().getRows(); it.hasNext(); ) {=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp; </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Row row =3D it.nextRow();</=
div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map map =3D new HashMap();<=
/div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (String key : Arrays.as=
List(&quot;prop2&quot;, &quot;prop3&quot;)) {</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; Value val =3D row.getValue(key);</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; map.put(key, val !=3D null ? val.getString() : null);&=
nbsp;&nbsp;&nbsp;&nbsp; </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp; </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res.put(row.getPath(), map)=
;</div>
<div>}</div>
<div>&nbsp;</div>
<div>Wouldn't be nice if this could be done with one database roundtrip - r=
ight now (2.2.10) there are at least n roundtrips (n =3D=3D number of resul=
ts in query) it seems to me.</div>
<div>&nbsp;</div>
<div>Regards, </div>
<div>Kevin M=FCller</div>
<div>&nbsp;</div>
</font>
</body>
</html>

--_000_63796837D123564BB8015F7117E79434012B7183673Cmailix2cibd_--

From dev-return-33756-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 10:32:56 2012
Return-Path: <dev-return-33756-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 924159FC7
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 10:32:56 +0000 (UTC)
Received: (qmail 72844 invoked by uid 500); 13 Jan 2012 10:30:26 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 72635 invoked by uid 500); 13 Jan 2012 10:30:16 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 72480 invoked by uid 99); 13 Jan 2012 10:30:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 10:30:12 +0000
X-ASF-Spam-Status: No, hits=-0.3 required=5.0
	tests=RCVD_IN_BL_SPAMCOP_NET,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.171 as permitted sender)
Received: from [64.18.2.171] (HELO exprod7og109.obsmtp.com) (64.18.2.171)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 13 Jan 2012 10:30:04 +0000
Received: from mail-tul01m020-f180.google.com ([209.85.214.180]) (using TLSv1) by exprod7ob109.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTxAHlxQ+jvVCquKhFC2SMn1x+q1qikm7@postini.com; Fri, 13 Jan 2012 02:29:43 PST
Received: by mail-tul01m020-f180.google.com with SMTP id wc20so2000512obb.25
        for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 02:29:43 -0800 (PST)
Received: by 10.182.122.70 with SMTP id lq6mr203149obb.8.1326450582971; Fri,
 13 Jan 2012 02:29:42 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Fri, 13 Jan 2012 02:29:11 -0800 (PST)
In-Reply-To: <11367_1326441927_q0D85QA6026696_091E4A80-A18C-4F68-8447-E6342F76BCF0@gmail.com>
References: <11367_1326441927_q0D85QA6026696_091E4A80-A18C-4F68-8447-E6342F76BCF0@gmail.com>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Fri, 13 Jan 2012 11:29:11 +0100
Message-ID: <CAAOnkMvCWSLEu-0GxLVN8UjvohzwMXdsTDKc3oHxU8FwZKsutA@mail.gmail.com>
Subject: Re: Saving large number of nodes
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

On Fri, Jan 13, 2012 at 9:05 AM, Peri Subrahmanya
<peri.subrahmanya@gmail.com> wrote:
> I am currently a 100K records file and saving to the JCR in 10K batches p=
er node using multiple threads. I see lot of the following messages and wan=
ted to know what these are; I am using local file system for datastore and =
SQLBundlePersistenceManager for the rest.
>
> 2012-01-13 13:06:30,223 [pool-3-thread-2] INFO =A0org.apache.jackrabbit.c=
ore.persistence.bundle.AbstractBundlePersistenceManager.logCacheStats():Lin=
e 808: cachename=3DdefaultBundleCache[ConcurrentCache@563ab8f2], elements=
=3D13711, usedmemorykb=3D214, maxmemorykb=3D8192, access=3D80264, miss=3D80=
243

It's just printing some statistics about from the bundle persistence
manager which you can use to tune your caches correctly. If you don't
want to get those messages you can put the logging of the
AbstractBundlePersistenceManager on WARN level.

Regards,
Bart

From dev-return-33757-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 11:15:41 2012
Return-Path: <dev-return-33757-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A63EA9BDC
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 11:15:41 +0000 (UTC)
Received: (qmail 59678 invoked by uid 500); 13 Jan 2012 11:15:40 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 59223 invoked by uid 500); 13 Jan 2012 11:15:26 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 59135 invoked by uid 99); 13 Jan 2012 11:15:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 11:15:20 +0000
X-ASF-Spam-Status: No, hits=3.3 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_NEUTRAL,TRACKER_ID
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 129.79.1.188 is neither permitted nor denied by domain of peri.subrahmanya@gmail.com)
Received: from [129.79.1.188] (HELO irpt-internal-relay.indiana.edu) (129.79.1.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 11:15:08 +0000
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: Ah4FADoREE+BTwE+/2dsb2JhbABCnH2DH4x8gQWBaQkBAQQBXCILCwMBBzsjNBGIAqZFhz8/iHiJAYI5YwSIOoxYhVGMdg
Received: from internal-relay.indiana.edu ([129.79.1.62])
  by irpt-internal-relay.indiana.edu with ESMTP; 13 Jan 2012 06:14:47 -0500
Received: from mail-relay.iu.edu (burns.uits.indiana.edu [129.79.1.202])
	by internal-relay.indiana.edu (8.14.5/8.14.4/IU Messaging Team) with ESMTP id q0DBEkbt012619
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 06:14:46 -0500
Received: from [117.97.92.135] ([117.97.92.135])
	(authenticated bits=0)
	by mail-relay.iu.edu (8.14.5/8.14.4/IU Messaging Team Submission) with ESMTP id q0DBEdhR002586
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=NO)
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 06:14:45 -0500
From: Peri Subrahmanya <peri.subrahmanya@gmail.com>
Mime-Version: 1.0 (Apple Message framework v1251.1)
Content-Type: multipart/alternative; boundary="Apple-Mail=_D1B97A8D-93F0-4A9F-A89D-2565B9401431"
Subject: Re: Saving large number of nodes
Date: Fri, 13 Jan 2012 16:44:36 +0530
In-Reply-To: <CAAOnkMvCWSLEu-0GxLVN8UjvohzwMXdsTDKc3oHxU8FwZKsutA@mail.gmail.com>
To: dev@jackrabbit.apache.org
References: <11367_1326441927_q0D85QA6026696_091E4A80-A18C-4F68-8447-E6342F76BCF0@gmail.com> <CAAOnkMvCWSLEu-0GxLVN8UjvohzwMXdsTDKc3oHxU8FwZKsutA@mail.gmail.com>
Message-Id: <11371_1326453287_q0DBEkbt012619_5C9077C7-1B26-413C-A342-EFB8D6DDC249@gmail.com>
X-Mailer: Apple Mail (2.1251.1)
X-Virus-Checked: Checked by ClamAV on apache.org


--Apple-Mail=_D1B97A8D-93F0-4A9F-A89D-2565B9401431
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=iso-8859-1

What I was more interested was to interpret the messages i.e seems to be =
lots of hits and lots of misses; Should I be worried about something =
here?

On Jan 13, 2012, at 3:59 PM, Bart van der Schans wrote:

> AbstractBundlePersistenceManager


--Apple-Mail=_D1B97A8D-93F0-4A9F-A89D-2565B9401431
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=iso-8859-1

<html><head></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">What =
I was more interested was to interpret the messages i.e seems to be lots =
of hits and lots of misses; Should I be worried about something =
here?<div><br><div><div>On Jan 13, 2012, at 3:59 PM, Bart van der Schans =
wrote:</div><br class=3D"Apple-interchange-newline"><blockquote =
type=3D"cite"><span class=3D"Apple-style-span" style=3D"border-collapse: =
separate; font-family: Helvetica; font-style: normal; font-variant: =
normal; font-weight: normal; letter-spacing: normal; line-height: =
normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; =
-webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: =
0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: =
auto; -webkit-text-stroke-width: 0px; font-size: medium; =
">AbstractBundlePersistenceManager</span></blockquote></div><br></div></bo=
dy></html>=

--Apple-Mail=_D1B97A8D-93F0-4A9F-A89D-2565B9401431--

From dev-return-33758-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 13:05:10 2012
Return-Path: <dev-return-33758-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8E1D992A3
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 13:05:10 +0000 (UTC)
Received: (qmail 43741 invoked by uid 500); 13 Jan 2012 13:05:10 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 43414 invoked by uid 500); 13 Jan 2012 13:05:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 43384 invoked by uid 99); 13 Jan 2012 13:05:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 13:05:06 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 13:05:04 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 824BF1497CB
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 13:04:44 +0000 (UTC)
Date: Fri, 13 Jan 2012 13:04:44 +0000 (UTC)
From: "Unico Hommes (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1765242056.37735.1326459884535.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3207) Info map of NODE_MOVED event on node
 reordering is not according to spec
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Info map of NODE_MOVED event on node reordering is not according to spec
------------------------------------------------------------------------

                 Key: JCR-3207
                 URL: https://issues.apache.org/jira/browse/JCR-3207
             Project: Jackrabbit Content Repository
          Issue Type: Bug
    Affects Versions: 2.3.5, 2.2.10
            Reporter: Unico Hommes


According to JSR-283 "If the method that caused the NODE_MOVE event was a Node.orderBefore then the returned Map has keys srcChildRelPath and destChildRelPath with values corresponding to the parameters passed to the orderBefore method, as specified in the Javadoc." As the attached patch for the ReorderTest test case shows this is not the way jackrabbit behaves. Instead it looks like the value of the srcChildRelPath entry in the info map is really the destChildRelPath and destChildRelPath info entry seems to always be null.


--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33759-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 13:07:20 2012
Return-Path: <dev-return-33759-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 10565934F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 13:07:20 +0000 (UTC)
Received: (qmail 48927 invoked by uid 500); 13 Jan 2012 13:07:19 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 48583 invoked by uid 500); 13 Jan 2012 13:07:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 48570 invoked by uid 99); 13 Jan 2012 13:07:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 13:07:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 13:07:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1EF5F149923
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 13:06:41 +0000 (UTC)
Date: Fri, 13 Jan 2012 13:06:41 +0000 (UTC)
From: "Unico Hommes (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <83103462.37737.1326460001136.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1765242056.37735.1326459884535.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3207) Info map of NODE_MOVED event on node
 reordering is not according to spec
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3207?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Unico Hommes updated JCR-3207:
------------------------------

    Attachment: reordertest.patch

Patch for ReorderTest.java in jackrabbit-core. Apply by cd'ing to jackrabbit-core and executing the command $patch -u -p0 < reordertest.patch
                
> Info map of NODE_MOVED event on node reordering is not according to spec
> ------------------------------------------------------------------------
>
>                 Key: JCR-3207
>                 URL: https://issues.apache.org/jira/browse/JCR-3207
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.2.10, 2.3.5
>            Reporter: Unico Hommes
>         Attachments: reordertest.patch
>
>
> According to JSR-283 "If the method that caused the NODE_MOVE event was a Node.orderBefore then the returned Map has keys srcChildRelPath and destChildRelPath with values corresponding to the parameters passed to the orderBefore method, as specified in the Javadoc." As the attached patch for the ReorderTest test case shows this is not the way jackrabbit behaves. Instead it looks like the value of the srcChildRelPath entry in the info map is really the destChildRelPath and destChildRelPath info entry seems to always be null.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33760-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 13:23:07 2012
Return-Path: <dev-return-33760-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E916E9A42
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 13:23:06 +0000 (UTC)
Received: (qmail 66134 invoked by uid 500); 13 Jan 2012 13:23:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 65742 invoked by uid 500); 13 Jan 2012 13:23:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 65735 invoked by uid 99); 13 Jan 2012 13:23:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 13:23:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 13:23:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 32BAE14A00A
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 13:22:40 +0000 (UTC)
Date: Fri, 13 Jan 2012 13:22:40 +0000 (UTC)
From: "Julian Reschke (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1993534079.37754.1326460960209.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1765242056.37735.1326459884535.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3207) Info map of NODE_MOVED event on node
 reordering is not according to spec
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3207?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke reassigned JCR-3207:
-----------------------------------

    Assignee: Julian Reschke
    
> Info map of NODE_MOVED event on node reordering is not according to spec
> ------------------------------------------------------------------------
>
>                 Key: JCR-3207
>                 URL: https://issues.apache.org/jira/browse/JCR-3207
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.2.10, 2.3.5
>            Reporter: Unico Hommes
>            Assignee: Julian Reschke
>         Attachments: reordertest.patch
>
>
> According to JSR-283 "If the method that caused the NODE_MOVE event was a Node.orderBefore then the returned Map has keys srcChildRelPath and destChildRelPath with values corresponding to the parameters passed to the orderBefore method, as specified in the Javadoc." As the attached patch for the ReorderTest test case shows this is not the way jackrabbit behaves. Instead it looks like the value of the srcChildRelPath entry in the info map is really the destChildRelPath and destChildRelPath info entry seems to always be null.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33761-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 14:40:08 2012
Return-Path: <dev-return-33761-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F14E9DA5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 14:40:08 +0000 (UTC)
Received: (qmail 74315 invoked by uid 500); 13 Jan 2012 14:40:08 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 73919 invoked by uid 500); 13 Jan 2012 14:40:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 73896 invoked by uid 99); 13 Jan 2012 14:40:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 14:40:06 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 14:40:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7517014A010
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 14:39:39 +0000 (UTC)
Date: Fri, 13 Jan 2012 14:39:39 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <160030828.37944.1326465579480.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1577678328.4549.1325685641108.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3199) workspace-wide default for lock timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3199?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3199:
--------------------------------

    Attachment: JCR-3199.diff

Proposed patch.

- adds a defaultLockTimeout attribute to the Workspace element
- parses it into WorkspaceConfig
- uses it in NodeImpl.lock()

Q: 
- dunno about how we version the DTD
- do we need to maintain the previous 2 variants of the WorkspaceConfig constructor
                
> workspace-wide default for lock timeout
> ---------------------------------------
>
>                 Key: JCR-3199
>                 URL: https://issues.apache.org/jira/browse/JCR-3199
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>         Attachments: JCR-3199.diff
>
>
> There should be a way to define a workspace-wide default for JCR lock timeouts (in case the code creating the lock did not specify one).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33762-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 16:24:02 2012
Return-Path: <dev-return-33762-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F1C5691DB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 16:24:01 +0000 (UTC)
Received: (qmail 23930 invoked by uid 500); 13 Jan 2012 16:24:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 23882 invoked by uid 500); 13 Jan 2012 16:24:00 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 23875 invoked by uid 99); 13 Jan 2012 16:24:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 16:24:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 16:23:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 69A2914AEB8
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 16:23:39 +0000 (UTC)
Date: Fri, 13 Jan 2012 16:23:39 +0000 (UTC)
From: "angela (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1961975139.38171.1326471819434.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1577678328.4549.1325685641108.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3199) workspace-wide default for lock
 timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3199?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13185653#comment-13185653 ] 

angela commented on JCR-3199:
-----------------------------

> dunno about how we version the DTD

they are listed in /jackrabbit-core/src/main/resources/org/apache/jackrabbit/core/config.
if i remember correctly it should be sufficient to add the additional elements there. since 
the latest version is 2.4 i don't think you have to create a new version. 

> do we need to maintain the previous 2 variants of the WorkspaceConfig constructor

not sure... i tend to be overly careful with such removals. but in any case we need to adjust the CRX specific overlay.

                
> workspace-wide default for lock timeout
> ---------------------------------------
>
>                 Key: JCR-3199
>                 URL: https://issues.apache.org/jira/browse/JCR-3199
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>         Attachments: JCR-3199.diff
>
>
> There should be a way to define a workspace-wide default for JCR lock timeouts (in case the code creating the lock did not specify one).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33763-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 16:32:03 2012
Return-Path: <dev-return-33763-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EB2B59B27
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 16:32:03 +0000 (UTC)
Received: (qmail 36505 invoked by uid 500); 13 Jan 2012 16:32:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 36451 invoked by uid 500); 13 Jan 2012 16:32:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 36439 invoked by uid 99); 13 Jan 2012 16:32:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 16:32:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 16:32:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7035014A1EF
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 16:31:39 +0000 (UTC)
Date: Fri, 13 Jan 2012 16:31:39 +0000 (UTC)
From: "angela (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1992581790.38179.1326472299461.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1577678328.4549.1325685641108.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3199) workspace-wide default for lock
 timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3199?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13185655#comment-13185655 ] 

angela commented on JCR-3199:
-----------------------------

... and the patch looks good
                
> workspace-wide default for lock timeout
> ---------------------------------------
>
>                 Key: JCR-3199
>                 URL: https://issues.apache.org/jira/browse/JCR-3199
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>         Attachments: JCR-3199.diff
>
>
> There should be a way to define a workspace-wide default for JCR lock timeouts (in case the code creating the lock did not specify one).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33764-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 17:07:02 2012
Return-Path: <dev-return-33764-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2715096B6
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 17:07:02 +0000 (UTC)
Received: (qmail 9802 invoked by uid 500); 13 Jan 2012 17:07:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 9723 invoked by uid 500); 13 Jan 2012 17:07:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 9716 invoked by uid 99); 13 Jan 2012 17:07:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 17:07:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 17:06:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id BAB2114A03C
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 17:06:39 +0000 (UTC)
Date: Fri, 13 Jan 2012 17:06:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2023177566.38251.1326474399766.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1765242056.37735.1326459884535.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3207) Info map of NODE_MOVED event on node
 reordering is not according to spec
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3207?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13185673#comment-13185673 ] 

Julian Reschke commented on JCR-3207:
-------------------------------------

I can confirm that there's a compliance issue here. Unfortunately it's non-trivial to fix.

Events are generated based on the change information on NodeState. NodeState has the new ordering of the child elements, but doesn't how the new ordering was obtained; therefore, given a node with children a and b the event info would be the same for:

 orderBefore("b", "a")

and

 orderBefore("a", null)

Furthemore, in order to compute the event EventStateCollection compares with the previous ordering. This is likely to fail for any save() operation that contains more than a single operation causing the ordering to change.

Feedback appreciated.  
 
                
> Info map of NODE_MOVED event on node reordering is not according to spec
> ------------------------------------------------------------------------
>
>                 Key: JCR-3207
>                 URL: https://issues.apache.org/jira/browse/JCR-3207
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.2.10, 2.3.5
>            Reporter: Unico Hommes
>            Assignee: Julian Reschke
>         Attachments: reordertest.patch
>
>
> According to JSR-283 "If the method that caused the NODE_MOVE event was a Node.orderBefore then the returned Map has keys srcChildRelPath and destChildRelPath with values corresponding to the parameters passed to the orderBefore method, as specified in the Javadoc." As the attached patch for the ReorderTest test case shows this is not the way jackrabbit behaves. Instead it looks like the value of the srcChildRelPath entry in the info map is really the destChildRelPath and destChildRelPath info entry seems to always be null.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33765-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 13 17:43:03 2012
Return-Path: <dev-return-33765-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 398FC969C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 13 Jan 2012 17:43:03 +0000 (UTC)
Received: (qmail 63219 invoked by uid 500); 13 Jan 2012 17:43:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 62730 invoked by uid 500); 13 Jan 2012 17:43:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 62715 invoked by uid 99); 13 Jan 2012 17:43:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 17:43:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 13 Jan 2012 17:43:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id BBA6F14ADDA
	for <dev@jackrabbit.apache.org>; Fri, 13 Jan 2012 17:42:40 +0000 (UTC)
Date: Fri, 13 Jan 2012 17:42:40 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1285867715.38323.1326476560775.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1577678328.4549.1325685641108.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3199) workspace-wide default for lock
 timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3199?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-3199.
---------------------------------

       Resolution: Fixed
    Fix Version/s: 2.5
    
> workspace-wide default for lock timeout
> ---------------------------------------
>
>                 Key: JCR-3199
>                 URL: https://issues.apache.org/jira/browse/JCR-3199
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>             Fix For: 2.5
>
>         Attachments: JCR-3199.diff
>
>
> There should be a way to define a workspace-wide default for JCR lock timeouts (in case the code creating the lock did not specify one).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33766-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 13:47:06 2012
Return-Path: <dev-return-33766-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 645F3B117
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 13:47:06 +0000 (UTC)
Received: (qmail 52855 invoked by uid 500); 16 Jan 2012 13:47:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52201 invoked by uid 500); 16 Jan 2012 13:47:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 51610 invoked by uid 99); 16 Jan 2012 13:47:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 13:47:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 13:47:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C82A614FAF8
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 13:46:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 13:46:39 +0000 (UTC)
From: "Julian Reschke (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

locking a node twice yields the same lock token
-----------------------------------------------

                 Key: JCR-3208
                 URL: https://issues.apache.org/jira/browse/JCR-3208
             Project: Jackrabbit Content Repository
          Issue Type: Task
          Components: jackrabbit-core, locks
            Reporter: Julian Reschke
            Priority: Minor


Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.

This seems to contradict a JCR requirement:

"A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>

...in that two subsequent locks on the same node get the same token.

(This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33767-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 13:57:06 2012
Return-Path: <dev-return-33767-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7F140B572
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 13:57:06 +0000 (UTC)
Received: (qmail 69073 invoked by uid 500); 16 Jan 2012 13:57:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 68579 invoked by uid 500); 16 Jan 2012 13:57:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 68572 invoked by uid 99); 16 Jan 2012 13:57:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 13:57:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 13:57:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C083514F06C
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 13:56:40 +0000 (UTC)
Date: Mon, 16 Jan 2012 13:56:40 +0000 (UTC)
From: "Julian Reschke (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

lock token validity
-------------------

                 Key: JCR-3209
                 URL: https://issues.apache.org/jira/browse/JCR-3209
             Project: Jackrabbit Content Repository
          Issue Type: Task
          Components: jackrabbit-jcr-server, jackrabbit-spi2dav
            Reporter: Julian Reschke
            Priority: Minor


There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:

1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)

2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)

Proposal:

a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33768-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 13:59:02 2012
Return-Path: <dev-return-33768-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7A8A9B591
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 13:59:02 +0000 (UTC)
Received: (qmail 70474 invoked by uid 500); 16 Jan 2012 13:59:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 70431 invoked by uid 500); 16 Jan 2012 13:59:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 70424 invoked by uid 99); 16 Jan 2012 13:59:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 13:59:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 13:59:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4758C14F1CE
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 13:58:40 +0000 (UTC)
Date: Mon, 16 Jan 2012 13:58:40 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <320761998.44735.1326722320293.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3209:
--------------------------------

    Component/s: locks
    
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33769-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 14:09:04 2012
Return-Path: <dev-return-33769-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 262BFB9E9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 14:09:04 +0000 (UTC)
Received: (qmail 90608 invoked by uid 500); 16 Jan 2012 14:09:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 90549 invoked by uid 500); 16 Jan 2012 14:09:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 90542 invoked by uid 99); 16 Jan 2012 14:09:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 14:09:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 14:09:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D53E514F5AF
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 14:08:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 14:08:39 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1004847833.44750.1326722919875.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13186929#comment-13186929 ] 

Jukka Zitting commented on JCR-3208:
------------------------------------

Is this a problem (either in practice or in theory)? The token uniquely identifies a lock at any given time in a given workspace. AFAICT that's the scope of uniqueness that the spec really requires.
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33770-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 14:19:04 2012
Return-Path: <dev-return-33770-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EB304BBD7
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 14:19:03 +0000 (UTC)
Received: (qmail 5489 invoked by uid 500); 16 Jan 2012 14:19:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 5427 invoked by uid 500); 16 Jan 2012 14:19:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 5420 invoked by uid 99); 16 Jan 2012 14:19:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 14:19:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 14:19:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A11C214F988
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 14:18:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 14:18:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1545138384.44773.1326723519661.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13186934#comment-13186934 ] 

Julian Reschke commented on JCR-3208:
-------------------------------------

Consider two users A and B trying to edit a document.

1) A open-scope locks the document, starts editing, and goes on vacation

2) B asks the admin to unlock the document

3) B open-scope locks the document, starts editing

4) A comes back, starts editing, and can (because the lock token did not change)
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33771-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 15:06:03 2012
Return-Path: <dev-return-33771-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 74FB3BE05
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 15:06:03 +0000 (UTC)
Received: (qmail 74988 invoked by uid 500); 16 Jan 2012 15:06:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 74865 invoked by uid 500); 16 Jan 2012 15:06:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 74858 invoked by uid 99); 16 Jan 2012 15:06:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 15:06:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 15:06:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7D02E14F260
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 15:05:40 +0000 (UTC)
Date: Mon, 16 Jan 2012 15:05:40 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <815961901.44889.1326726340513.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1765242056.37735.1326459884535.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3207) Info map of NODE_MOVED event on node
 reordering is not according to spec
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3207?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3207:
--------------------------------

    Component/s: observation
                 jackrabbit-core
    
> Info map of NODE_MOVED event on node reordering is not according to spec
> ------------------------------------------------------------------------
>
>                 Key: JCR-3207
>                 URL: https://issues.apache.org/jira/browse/JCR-3207
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core, observation
>    Affects Versions: 2.2.10, 2.3.5
>            Reporter: Unico Hommes
>            Assignee: Julian Reschke
>         Attachments: reordertest.patch
>
>
> According to JSR-283 "If the method that caused the NODE_MOVE event was a Node.orderBefore then the returned Map has keys srcChildRelPath and destChildRelPath with values corresponding to the parameters passed to the orderBefore method, as specified in the Javadoc." As the attached patch for the ReorderTest test case shows this is not the way jackrabbit behaves. Instead it looks like the value of the srcChildRelPath entry in the info map is really the destChildRelPath and destChildRelPath info entry seems to always be null.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33772-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 15:25:04 2012
Return-Path: <dev-return-33772-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 288F6BA08
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 15:25:04 +0000 (UTC)
Received: (qmail 10216 invoked by uid 500); 16 Jan 2012 15:25:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 10099 invoked by uid 500); 16 Jan 2012 15:25:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 10091 invoked by uid 99); 16 Jan 2012 15:25:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 15:25:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 15:25:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E5BBB14FDA0
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 15:24:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 15:24:39 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1176136482.44932.1326727479963.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1047400331.28339.1324332572529.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3186) Export size of Observation eventQueue
 to JMX
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3186?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3186:
--------------------------------

    Issue Type: Sub-task  (was: New Feature)
        Parent: JCR-2936
   =20
> Export size of Observation eventQueue to JMX
> --------------------------------------------
>
>                 Key: JCR-3186
>                 URL: https://issues.apache.org/jira/browse/JCR-3186
>             Project: Jackrabbit Content Repository
>          Issue Type: Sub-task
>          Components: jackrabbit-core
>            Reporter: J=C3=B6rg Hoh
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JR-observationQueueJMX-trunk.patch
>
>
> export the size of the event queue of JCR Observation to JMX.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33773-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 15:49:04 2012
Return-Path: <dev-return-33773-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9CEDCB448
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 15:49:04 +0000 (UTC)
Received: (qmail 62169 invoked by uid 500); 16 Jan 2012 15:49:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 61824 invoked by uid 500); 16 Jan 2012 15:49:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 61817 invoked by uid 99); 16 Jan 2012 15:49:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 15:49:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 15:49:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id DC02914FB41
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 15:48:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 15:48:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2085240346.45009.1326728919921.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13186981#comment-13186981 ] 

Julian Reschke commented on JCR-3208:
-------------------------------------

Looking at LockManagerImpl this doesn't seem too hard to fix; the main drawback is that we'd need to change the file format to persist s a triple (node id, lock id, timeout) instead of a pair; could be done in a backwards-compatible way...
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33774-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 16:27:04 2012
Return-Path: <dev-return-33774-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4AA40BB95
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 16:27:04 +0000 (UTC)
Received: (qmail 47590 invoked by uid 500); 16 Jan 2012 16:27:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 47185 invoked by uid 500); 16 Jan 2012 16:27:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 47178 invoked by uid 99); 16 Jan 2012 16:27:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 16:27:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 16:27:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 392D614FD39
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 16:26:41 +0000 (UTC)
Date: Mon, 16 Jan 2012 16:26:41 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <90192045.45088.1326731201235.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13186999#comment-13186999 ] 

Jukka Zitting commented on JCR-3208:
------------------------------------

> admin to unlock

Explicit admin intervention is already taking the repository outside the scope of normal JCR semantics, so I wouldn't be too worried about this case.

A similar case could arise if in step 2 user A explicitly hands over the lock token to user B, but in that case I'd assume the users to be aware of each others actions and synchronize accordingly.

So while it might be useful to do this (and it looks like this could be achieved in a backwards-compatible manner), I'm not sure how pressing the issue is. If there's an itch to fix this, +1 to proceed.

PS. The one thing that could be a pretty reason to do this is that with the lock token based directly on the UUID of the node, anyone with sufficient read access to a node can calculate the token of an open-scoped lock and thus unlock the node without interaction with an administrator or the original lock holder. That could be a security and/or consistency issue in some circumstances.

                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33775-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 16:37:10 2012
Return-Path: <dev-return-33775-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9EA68B956
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 16:37:10 +0000 (UTC)
Received: (qmail 62434 invoked by uid 500); 16 Jan 2012 16:37:10 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 62354 invoked by uid 500); 16 Jan 2012 16:37:09 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 62347 invoked by uid 99); 16 Jan 2012 16:37:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 16:37:09 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 16:37:08 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 52C80150233
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 16:36:48 +0000 (UTC)
Date: Mon, 16 Jan 2012 16:36:48 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1751378265.45135.1326731808340.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187009#comment-13187009 ] 

Julian Reschke commented on JCR-3208:
-------------------------------------

Indeed, the predictability of the lock token is also unfortunate. I wonder whether people have abused this in the past to recover locks they lost :-)
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33776-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 17:38:08 2012
Return-Path: <dev-return-33776-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B1E42BB67
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 17:38:08 +0000 (UTC)
Received: (qmail 63767 invoked by uid 500); 16 Jan 2012 17:38:08 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 63662 invoked by uid 500); 16 Jan 2012 17:38:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 63655 invoked by uid 99); 16 Jan 2012 17:38:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:38:07 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:38:05 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 6162614FAFC
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 17:37:44 +0000 (UTC)
Date: Mon, 16 Jan 2012 17:37:44 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <25948907.45318.1326735464400.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <481776123.9110.1325770179315.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3200) consistency check should get node ids
 in chunks, not rely on total count
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3200?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3200:
--------------------------------

    Attachment: JCR-3200.diff

proposed change
                
> consistency check should get node ids in chunks, not rely on total count
> ------------------------------------------------------------------------
>
>                 Key: JCR-3200
>                 URL: https://issues.apache.org/jira/browse/JCR-3200
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3200.diff
>
>
> The PM consistency checker should use the paging feature to fetch nodeIds in chunks, and also not rely on the total number of ids for logging purposes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33777-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 17:40:02 2012
Return-Path: <dev-return-33777-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1857FBDEB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 17:40:02 +0000 (UTC)
Received: (qmail 68131 invoked by uid 500); 16 Jan 2012 17:40:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 67838 invoked by uid 500); 16 Jan 2012 17:40:00 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 67826 invoked by uid 99); 16 Jan 2012 17:40:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:40:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:39:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C282A14FC2E
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 17:39:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 17:39:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <608814131.45321.1326735579798.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <481776123.9110.1325770179315.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3200) consistency check should get node ids
 in chunks, not rely on total count
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3200?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187041#comment-13187041 ] 

Julian Reschke commented on JCR-3200:
-------------------------------------

The proposed change fetches 64K nodes at once. The test cases pass, but it would be good if somebody else did a sanity check before I commit the change.
                
> consistency check should get node ids in chunks, not rely on total count
> ------------------------------------------------------------------------
>
>                 Key: JCR-3200
>                 URL: https://issues.apache.org/jira/browse/JCR-3200
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3200.diff
>
>
> The PM consistency checker should use the paging feature to fetch nodeIds in chunks, and also not rely on the total number of ids for logging purposes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33778-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 17:46:54 2012
Return-Path: <dev-return-33778-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0DA8AB0FE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 17:46:54 +0000 (UTC)
Received: (qmail 85628 invoked by uid 500); 16 Jan 2012 17:46:53 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 85523 invoked by uid 500); 16 Jan 2012 17:46:53 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 85516 invoked by uid 99); 16 Jan 2012 17:46:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:46:52 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:46:45 +0000
Received: by werp12 with SMTP id p12so908337wer.1
        for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 09:46:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=50hEMUvJOIbKZ8Oi9HSmJrPsEFynQDWKEZY3tg/izj8=;
        b=dZN77/PWHsd5z9B72i7OsnUduUej0yvZgRzuWmD4yAgQlsEo8yFmGDlxDYye+FsRt5
         s1qsPkRnn17d/gewqWzy9ZIR/3KoOcYjIcEAeQhzMoIyY0HVsgFAOrk8oCPThln4PunY
         1vRYwQy0QlWkgORulXYkEWE76tFAUsCFyav28=
Received: by 10.216.134.196 with SMTP id s46mr5497621wei.44.1326735985120;
 Mon, 16 Jan 2012 09:46:25 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Mon, 16 Jan 2012 09:46:04 -0800 (PST)
In-Reply-To: <CAOFYJNYSVrZ6YgEPH+GbZ_qibhT9jBLZKbHLBoNnhxgKL5cUxQ@mail.gmail.com>
References: <CAOFYJNZQSm6UEuY0SPW9bVR92Dd4M-vix73PNVZN24RTPt6WeA@mail.gmail.com>
 <CAOFYJNYSVrZ6YgEPH+GbZ_qibhT9jBLZKbHLBoNnhxgKL5cUxQ@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Mon, 16 Jan 2012 18:46:04 +0100
Message-ID: <CAOFYJNam6nsaQmexzNQ5xpJarNnP+19KyU4AvaFsmjuxAfRjxg@mail.gmail.com>
Subject: Re: Jackrabbit 2.4 release plan
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Mon, Jan 2, 2012 at 5:17 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> And there hasn't been much work in trunk or the 2.4 branch since the
> 2.3.6, so also from that perspective we should let things rest a bit
> longer before cutting the first stable 2.4 release.
>
> Thus I suggest that we postpone the 2.4.0 cut date two weeks ahead to
> Tuesday, Jan 17th.

We actually did get some active work done on areas like locking
(including a new configuration option) and I'd like to complete
exposing the query stats by Alex through JMX interfaces before 2.4, so
I think we should postpone cutting the 2.4.0 release two weeks ahead
to the end of January. Instead I'll tomorrow cut a 2.3.7 release
candidate from the latest 2.4 branch after merging any relevant
changes from trunk.

BR,

Jukka Zitting

From dev-return-33779-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 17:56:04 2012
Return-Path: <dev-return-33779-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 268B6B302
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 17:56:04 +0000 (UTC)
Received: (qmail 1966 invoked by uid 500); 16 Jan 2012 17:56:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 1896 invoked by uid 500); 16 Jan 2012 17:56:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 1888 invoked by uid 99); 16 Jan 2012 17:56:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:56:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:56:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 8611C150319
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 17:55:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 17:55:39 +0000 (UTC)
From: "Tobias Bocanegra (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1883485972.45339.1326736539556.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3210) NPE in spi2dav when server does not
 send all headers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

NPE in spi2dav when server does not send all headers
----------------------------------------------------

                 Key: JCR-3210
                 URL: https://issues.apache.org/jira/browse/JCR-3210
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-spi2dav
    Affects Versions: 2.3.5
            Reporter: Tobias Bocanegra
            Priority: Minor


The ValueLoader may throw a NPE if the desired headers are not present in the response:

org.apache.jackrabbit.spi2davex.ValueLoader:

    public Map<String, String> loadHeaders(String uri, String[] headerNames) throws IOException, RepositoryException {
    ....
                for (String name : headerNames) {
--->                headers.put(name, method.getResponseHeader(name).getValue());
                }
    .....
    }

In my case, the server does not return the ETag response header, but the 'loadHeaders' is indirectly called by the QValueFactoryImpl:

                        this.preInitialize(new String[] {HEADER_ETAG, HEADER_LAST_MODIFIED});


--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33780-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 17:58:03 2012
Return-Path: <dev-return-33780-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C6E2EB371
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 17:58:03 +0000 (UTC)
Received: (qmail 3461 invoked by uid 500); 16 Jan 2012 17:58:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 3407 invoked by uid 500); 16 Jan 2012 17:58:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 3400 invoked by uid 99); 16 Jan 2012 17:58:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:58:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 17:58:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9FF6715039A
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 17:57:39 +0000 (UTC)
Date: Mon, 16 Jan 2012 17:57:39 +0000 (UTC)
From: "Tobias Bocanegra (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1071628493.45344.1326736659656.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1883485972.45339.1326736539556.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3210) NPE in spi2dav when server does not
 send all headers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3210?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Tobias Bocanegra reassigned JCR-3210:
-------------------------------------

    Assignee: Tobias Bocanegra
    
> NPE in spi2dav when server does not send all headers
> ----------------------------------------------------
>
>                 Key: JCR-3210
>                 URL: https://issues.apache.org/jira/browse/JCR-3210
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-spi2dav
>    Affects Versions: 2.3.5
>            Reporter: Tobias Bocanegra
>            Assignee: Tobias Bocanegra
>            Priority: Minor
>
> The ValueLoader may throw a NPE if the desired headers are not present in the response:
> org.apache.jackrabbit.spi2davex.ValueLoader:
>     public Map<String, String> loadHeaders(String uri, String[] headerNames) throws IOException, RepositoryException {
>     ....
>                 for (String name : headerNames) {
> --->                headers.put(name, method.getResponseHeader(name).getValue());
>                 }
>     .....
>     }
> In my case, the server does not return the ETag response header, but the 'loadHeaders' is indirectly called by the QValueFactoryImpl:
>                         this.preInitialize(new String[] {HEADER_ETAG, HEADER_LAST_MODIFIED});

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33781-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 18:30:03 2012
Return-Path: <dev-return-33781-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1F152B917
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 18:30:03 +0000 (UTC)
Received: (qmail 48813 invoked by uid 500); 16 Jan 2012 18:30:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 48353 invoked by uid 500); 16 Jan 2012 18:30:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 48338 invoked by uid 99); 16 Jan 2012 18:30:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 18:30:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 18:30:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 81B4E150FF4
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 18:29:40 +0000 (UTC)
Date: Mon, 16 Jan 2012 18:29:40 +0000 (UTC)
From: "Tobias Bocanegra (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <880030044.45421.1326738580549.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1883485972.45339.1326736539556.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3210) NPE in spi2dav when server does not
 send all headers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3210?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Tobias Bocanegra resolved JCR-3210.
-----------------------------------

    Resolution: Fixed

fixed by checking for NULL
                
> NPE in spi2dav when server does not send all headers
> ----------------------------------------------------
>
>                 Key: JCR-3210
>                 URL: https://issues.apache.org/jira/browse/JCR-3210
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-spi2dav
>    Affects Versions: 2.3.5
>            Reporter: Tobias Bocanegra
>            Assignee: Tobias Bocanegra
>            Priority: Minor
>
> The ValueLoader may throw a NPE if the desired headers are not present in the response:
> org.apache.jackrabbit.spi2davex.ValueLoader:
>     public Map<String, String> loadHeaders(String uri, String[] headerNames) throws IOException, RepositoryException {
>     ....
>                 for (String name : headerNames) {
> --->                headers.put(name, method.getResponseHeader(name).getValue());
>                 }
>     .....
>     }
> In my case, the server does not return the ETag response header, but the 'loadHeaders' is indirectly called by the QValueFactoryImpl:
>                         this.preInitialize(new String[] {HEADER_ETAG, HEADER_LAST_MODIFIED});

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33782-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 16 18:44:06 2012
Return-Path: <dev-return-33782-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4CBDBBD8D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 16 Jan 2012 18:44:06 +0000 (UTC)
Received: (qmail 66252 invoked by uid 500); 16 Jan 2012 18:44:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 66087 invoked by uid 500); 16 Jan 2012 18:44:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 66072 invoked by uid 99); 16 Jan 2012 18:44:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 18:44:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 16 Jan 2012 18:44:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 05DEE14F7EE
	for <dev@jackrabbit.apache.org>; Mon, 16 Jan 2012 18:43:41 +0000 (UTC)
Date: Mon, 16 Jan 2012 18:43:41 +0000 (UTC)
From: "Tobias Bocanegra (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1809669892.45456.1326739422039.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1883485972.45339.1326736539556.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3210) NPE in spi2dav when server does not
 send all headers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3210?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Tobias Bocanegra updated JCR-3210:
----------------------------------

    Fix Version/s: 2.6
    
> NPE in spi2dav when server does not send all headers
> ----------------------------------------------------
>
>                 Key: JCR-3210
>                 URL: https://issues.apache.org/jira/browse/JCR-3210
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-spi2dav
>    Affects Versions: 2.3.5
>            Reporter: Tobias Bocanegra
>            Assignee: Tobias Bocanegra
>            Priority: Minor
>             Fix For: 2.6
>
>
> The ValueLoader may throw a NPE if the desired headers are not present in the response:
> org.apache.jackrabbit.spi2davex.ValueLoader:
>     public Map<String, String> loadHeaders(String uri, String[] headerNames) throws IOException, RepositoryException {
>     ....
>                 for (String name : headerNames) {
> --->                headers.put(name, method.getResponseHeader(name).getValue());
>                 }
>     .....
>     }
> In my case, the server does not return the ETag response header, but the 'loadHeaders' is indirectly called by the QValueFactoryImpl:
>                         this.preInitialize(new String[] {HEADER_ETAG, HEADER_LAST_MODIFIED});

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33783-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 02:01:02 2012
Return-Path: <dev-return-33783-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5C992BF16
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 02:01:02 +0000 (UTC)
Received: (qmail 47105 invoked by uid 500); 17 Jan 2012 02:01:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 46881 invoked by uid 500); 17 Jan 2012 02:01:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 46872 invoked by uid 99); 17 Jan 2012 02:01:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 02:01:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 02:01:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 03B59150DDF
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 02:00:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 02:00:40 +0000 (UTC)
From: "Warren Janssens (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1162174724.46886.1326765640016.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3211) Support HTTP proxy in SPI2DAV
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Support HTTP proxy in SPI2DAV
-----------------------------

                 Key: JCR-3211
                 URL: https://issues.apache.org/jira/browse/JCR-3211
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: jackrabbit-spi2dav
    Affects Versions: 2.2.10
            Reporter: Warren Janssens
            Priority: Minor


There needs to be a way to set configure a proxy and proxy and proxy credentials on the HttpClient Host Configuration and State objects in RepositoryServiceImpl to enable requests over HTTP proxies.

Ideally the configuration could be done without resorting to static or thread local values.

The workaround is to use a proxy servlet that has the real endpoint of the repository hardcoded so it's not that critical of a bug but this workaround may not always be an available option.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33784-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 03:51:17 2012
Return-Path: <dev-return-33784-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4671D92DB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 03:51:17 +0000 (UTC)
Received: (qmail 39138 invoked by uid 500); 17 Jan 2012 03:51:14 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 38334 invoked by uid 500); 17 Jan 2012 03:51:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 38281 invoked by uid 99); 17 Jan 2012 03:51:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 03:51:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 03:51:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 12680151917
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 03:50:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 03:50:40 +0000 (UTC)
From: "Warren Janssens (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1951857269.47098.1326772240086.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1162174724.46886.1326765640016.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3211) Support HTTP proxy in SPI2DAV
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3211?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Warren Janssens updated JCR-3211:
---------------------------------

    Description: 
There needs to be a way to configure a proxy and proxy credentials on the HttpClient HostConfiguration and State objects in RepositoryServiceImpl to enable requests over HTTP proxies.

Ideally the configuration could be done without resorting to static or thread local values.

The workaround is to use a proxy servlet that has the real endpoint of the repository hardcoded so it's not that critical of a bug but this workaround may not always be an available option.

  was:
There needs to be a way to set configure a proxy and proxy and proxy credentials on the HttpClient Host Configuration and State objects in RepositoryServiceImpl to enable requests over HTTP proxies.

Ideally the configuration could be done without resorting to static or thread local values.

The workaround is to use a proxy servlet that has the real endpoint of the repository hardcoded so it's not that critical of a bug but this workaround may not always be an available option.

    
> Support HTTP proxy in SPI2DAV
> -----------------------------
>
>                 Key: JCR-3211
>                 URL: https://issues.apache.org/jira/browse/JCR-3211
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-spi2dav
>    Affects Versions: 2.2.10
>            Reporter: Warren Janssens
>            Priority: Minor
>
> There needs to be a way to configure a proxy and proxy credentials on the HttpClient HostConfiguration and State objects in RepositoryServiceImpl to enable requests over HTTP proxies.
> Ideally the configuration could be done without resorting to static or thread local values.
> The workaround is to use a proxy servlet that has the real endpoint of the repository hardcoded so it's not that critical of a bug but this workaround may not always be an available option.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33785-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 12:47:06 2012
Return-Path: <dev-return-33785-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5D4579974
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 12:47:06 +0000 (UTC)
Received: (qmail 88340 invoked by uid 500); 17 Jan 2012 12:47:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 88223 invoked by uid 500); 17 Jan 2012 12:47:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 88215 invoked by uid 99); 17 Jan 2012 12:47:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 12:47:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 12:47:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1A6EC151813
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 12:46:41 +0000 (UTC)
Date: Tue, 17 Jan 2012 12:46:41 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <682452415.48172.1326804401109.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1047400331.28339.1324332572529.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3186) Export size of Observation eventQueue
 to JMX
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3186?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3186:
--------------------------------

    Issue Type: Wish  (was: Sub-task)
        Parent:     (was: JCR-2936)
   =20
> Export size of Observation eventQueue to JMX
> --------------------------------------------
>
>                 Key: JCR-3186
>                 URL: https://issues.apache.org/jira/browse/JCR-3186
>             Project: Jackrabbit Content Repository
>          Issue Type: Wish
>          Components: jackrabbit-core
>            Reporter: J=C3=B6rg Hoh
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JR-observationQueueJMX-trunk.patch
>
>
> export the size of the event queue of JCR Observation to JMX.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33786-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 13:22:04 2012
Return-Path: <dev-return-33786-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 54B9D9871
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 13:22:04 +0000 (UTC)
Received: (qmail 52899 invoked by uid 500); 17 Jan 2012 13:22:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52762 invoked by uid 500); 17 Jan 2012 13:22:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 52754 invoked by uid 99); 17 Jan 2012 13:22:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:22:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:22:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7ED80151F82
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 13:21:41 +0000 (UTC)
Date: Tue, 17 Jan 2012 13:21:41 +0000 (UTC)
From: "Julian Reschke (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1126329003.48420.1326806501521.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke reassigned JCR-3208:
-----------------------------------

    Assignee: Julian Reschke
    
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33787-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 13:36:02 2012
Return-Path: <dev-return-33787-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4E9F69410
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 13:36:02 +0000 (UTC)
Received: (qmail 71314 invoked by uid 500); 17 Jan 2012 13:36:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 71245 invoked by uid 500); 17 Jan 2012 13:36:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 71229 invoked by uid 99); 17 Jan 2012 13:36:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:36:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:35:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D65151519C8
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 13:35:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 13:35:39 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1061256326.48514.1326807339896.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3208:
--------------------------------

    Attachment: JCR-3208.diff

test case
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33788-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 13:36:03 2012
Return-Path: <dev-return-33788-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4D3F0942D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 13:36:03 +0000 (UTC)
Received: (qmail 71754 invoked by uid 500); 17 Jan 2012 13:36:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 71250 invoked by uid 500); 17 Jan 2012 13:36:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 71236 invoked by uid 99); 17 Jan 2012 13:36:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:36:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:36:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E65201519C9
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 13:35:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 13:35:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1683382747.48515.1326807339965.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187675#comment-13187675 ] 

Julian Reschke commented on JCR-3208:
-------------------------------------

attached a new TCK test; from my reading of the spec it really is a conformance issue
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33789-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 13:48:04 2012
Return-Path: <dev-return-33789-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5002E96C0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 13:48:04 +0000 (UTC)
Received: (qmail 94043 invoked by uid 500); 17 Jan 2012 13:48:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 93974 invoked by uid 500); 17 Jan 2012 13:48:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 93967 invoked by uid 99); 17 Jan 2012 13:48:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:48:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:48:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D43B9151F73
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 13:47:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 13:47:39 +0000 (UTC)
From: "angela (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1172786780.48543.1326808059870.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187682#comment-13187682 ] 

angela commented on JCR-3208:
-----------------------------

> thus unlock the node without interaction with an administrator or the original lock holder.

as far as i know that was not possible in the original implementation as a different session
was not able to become lock holder unless the original holder dropped the token from the
session... i don't remember that we changed that. 

in other words: to my knowledge sharing a token should not possible in jackrabbit-core.
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33790-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 13:56:04 2012
Return-Path: <dev-return-33790-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C888B98FB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 13:56:04 +0000 (UTC)
Received: (qmail 6055 invoked by uid 500); 17 Jan 2012 13:56:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 5979 invoked by uid 500); 17 Jan 2012 13:56:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 5970 invoked by uid 99); 17 Jan 2012 13:56:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:56:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 13:56:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id B1C88151308
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 13:55:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 13:55:40 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1145060785.48558.1326808540729.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187687#comment-13187687 ] 

Jukka Zitting commented on JCR-3208:
------------------------------------

It's probably best to raise an issue in JSR 333 for a clarification on the uniqueness requirements on lock tokens.
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33791-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:00:05 2012
Return-Path: <dev-return-33791-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C0E3999D0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:00:05 +0000 (UTC)
Received: (qmail 16052 invoked by uid 500); 17 Jan 2012 14:00:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 15990 invoked by uid 500); 17 Jan 2012 14:00:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 15977 invoked by uid 99); 17 Jan 2012 14:00:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:00:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:00:03 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7B451151506
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 13:59:43 +0000 (UTC)
Date: Tue, 17 Jan 2012 13:59:43 +0000 (UTC)
From: "angela (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <443715885.48564.1326808783523.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187690#comment-13187690 ] 

angela commented on JCR-3209:
-----------------------------

isn't 1) already covered by JCR-1352?

regarding 2) 

> The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though 

this change was introduce since as of jcr 2.0 session scoped locks don't expose the token any more.
if you have a proposal for another type of token that's fine.

> and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. 

as far as i know this just causes a ugly warning in the log file (written by jackrabbit-core), since adding the token to 
session fails, which in this case was useless any way as they are session scoped. but if i remember correctly it otherwise 
used to work (see also JCR-2990... which i resolved wontfix due to lack of priority)

> This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway) 

can't follow you here.

but anyway: it was definitely favorable if we can distinguish the two types of locks based on the token and
could therefore omit adding it to the session/lockmanager. 
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33792-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:08:02 2012
Return-Path: <dev-return-33792-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 93A959BBA
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:08:02 +0000 (UTC)
Received: (qmail 35349 invoked by uid 500); 17 Jan 2012 14:08:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 35195 invoked by uid 500); 17 Jan 2012 14:08:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 35157 invoked by uid 99); 17 Jan 2012 14:08:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:08:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:08:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 3D09C151948
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 14:07:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 14:07:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <336398448.48587.1326809260251.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187696#comment-13187696 ] 

Julian Reschke commented on JCR-3208:
-------------------------------------

JSR 333 ticket:  <http://java.net/jira/browse/JSR_333-45>.
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33793-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:08:04 2012
Return-Path: <dev-return-33793-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 032389BC4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:08:04 +0000 (UTC)
Received: (qmail 35677 invoked by uid 500); 17 Jan 2012 14:08:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 35627 invoked by uid 500); 17 Jan 2012 14:08:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 35620 invoked by uid 99); 17 Jan 2012 14:08:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:08:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:08:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id F2449151943
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 14:07:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 14:07:39 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <934966832.48582.1326809259993.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <36102778.19491.1324044391021.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3184) extend ConsistencyChecker API to allow
 adoption of orphaned nodes to a to-be-specified parent node
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3184?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3184:
-------------------------------

    Fix Version/s:     (was: 2.5)
                   2.4

Merged to the 2.4 branch in revision 1232414. It'll be useful to have this already in 2.4.0.
                
> extend ConsistencyChecker API to allow adoption of orphaned nodes to a to-be-specified parent node
> --------------------------------------------------------------------------------------------------
>
>                 Key: JCR-3184
>                 URL: https://issues.apache.org/jira/browse/JCR-3184
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.4
>
>         Attachments: JCR-3184.diff
>
>
> The optional ConsistencyChecker API on persistence managers allows analyzing and fixing storage inconsistencies. The current fixup code though does not attempt to "adopt" orphaned nodes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33794-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:14:05 2012
Return-Path: <dev-return-33794-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 998DD9CA9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:14:05 +0000 (UTC)
Received: (qmail 39424 invoked by uid 500); 17 Jan 2012 14:14:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 39378 invoked by uid 500); 17 Jan 2012 14:14:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 39371 invoked by uid 99); 17 Jan 2012 14:14:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:14:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:14:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A3BBA151C57
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 14:13:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 14:13:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <43900249.48597.1326809619672.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187700#comment-13187700 ] 

Julian Reschke commented on JCR-3208:
-------------------------------------

Angela,

"as far as i know that was not possible in the original implementation as a different session
was not able to become lock holder unless the original holder dropped the token from the
session... i don't remember that we changed that.

in other words: to my knowledge sharing a token should not possible in jackrabbit-core."

Indeed. But keep in mind we're discussing open-scoped locks, and their reason why we have them is that the lock is kept around when the session is closed.

Jukka,

"Explicit admin intervention is already taking the repository outside the scope of normal JCR semantics, so I wouldn't be too worried about this case."

Not really. The JCR spec allows repositories to expose the lock tokens to different parties (not just admins), and also allows lock transfer between sessions.
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33795-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:18:07 2012
Return-Path: <dev-return-33795-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1B3E09F42
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:18:07 +0000 (UTC)
Received: (qmail 44983 invoked by uid 500); 17 Jan 2012 14:18:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 44693 invoked by uid 500); 17 Jan 2012 14:18:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 43826 invoked by uid 99); 17 Jan 2012 14:18:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:18:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:18:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4E51A151FE2
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 14:17:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 14:17:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <992426661.48604.1326809860322.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187704#comment-13187704 ] 

Julian Reschke commented on JCR-3209:
-------------------------------------

Angela, sorry for missing the two older JIRA issues :-) Will clean this up.

Regarding:

"> This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)

can't follow you here. "

My reading of the code is that a RuntimeException is thrown and thus the request will not continue to run as it should (but I'll check that).
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33796-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:18:07 2012
Return-Path: <dev-return-33796-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B0BC49F87
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:18:07 +0000 (UTC)
Received: (qmail 45281 invoked by uid 500); 17 Jan 2012 14:18:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 44946 invoked by uid 500); 17 Jan 2012 14:18:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 44189 invoked by uid 99); 17 Jan 2012 14:18:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:18:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:18:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9D830151FE7
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 14:17:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 14:17:40 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1106283460.48609.1326809860646.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-1352) illegal format for WebDAV lock tokens
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-1352?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-1352:
--------------------------------

    Component/s: locks
    
> illegal format for WebDAV lock tokens
> -------------------------------------
>
>                 Key: JCR-1352
>                 URL: https://issues.apache.org/jira/browse/JCR-1352
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> WebDAV lock tokens are URIs, while JCR lock tokens aren't. Therefore, the WebDAV servlet needs to transform outgoing JCR lock tokens (response headers and WebDAV properties) into URI format, and needs to parse the original lock token out of incoming WebDAV lock tokens (in request headers).
> Proposed mapping:
> - when the JCR lock token uses UUID format, use "urn:uuid",
> - otherwise encode with a constant prefix, such as "tag:jackrabbit.apache.org,2008:LockTokens."

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33797-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:28:03 2012
Return-Path: <dev-return-33797-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3B0199799
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:28:03 +0000 (UTC)
Received: (qmail 74534 invoked by uid 500); 17 Jan 2012 14:28:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 74420 invoked by uid 500); 17 Jan 2012 14:28:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 74410 invoked by uid 99); 17 Jan 2012 14:28:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:28:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:28:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E2C8815155C
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 14:27:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 14:27:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1439768706.48648.1326810460930.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187713#comment-13187713 ] 

Julian Reschke commented on JCR-3209:
-------------------------------------

Angela: indeed, the IllegalArgumentException is transformed into a LockException and then catched, logged, and ignored by o.a.j.c.SessionImpl,addLockToken(). Sorry for the confusion.
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33798-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 14:34:06 2012
Return-Path: <dev-return-33798-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2AB069E12
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 14:34:06 +0000 (UTC)
Received: (qmail 85689 invoked by uid 500); 17 Jan 2012 14:34:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 84814 invoked by uid 500); 17 Jan 2012 14:34:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 84805 invoked by uid 99); 17 Jan 2012 14:34:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:34:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 14:34:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4E1B0151900
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 14:33:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 14:33:40 +0000 (UTC)
From: "angela (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1165519816.48668.1326810820321.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187719#comment-13187719 ] 

angela commented on JCR-3209:
-----------------------------

no problem... i just happened to take a look at that the session-scoped locks some time ago
and found myself struggling with the log-output, that turned out to be irrelevant for the
problem i was trying to solve.
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Priority: Minor
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33799-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 15:10:02 2012
Return-Path: <dev-return-33799-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BA7919457
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 15:10:02 +0000 (UTC)
Received: (qmail 37339 invoked by uid 500); 17 Jan 2012 15:10:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 37156 invoked by uid 500); 17 Jan 2012 15:10:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 37142 invoked by uid 99); 17 Jan 2012 15:10:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 15:10:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 15:09:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C28B5151A07
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 15:09:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 15:09:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <561833883.48719.1326812979806.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187735#comment-13187735 ] 

Julian Reschke commented on JCR-3208:
-------------------------------------

OK, I underestimated the impact of this.

I tried to change the lock token to contain both the node id and the lock token id. This is straightforward, but I'm running into two issues:

- LockEventListener events only send nodeIds, not the lock tokens (can this interface be changed without breakage somewhere else?)

and

- Both LockManagerImpl and XALockManager are used for locking, and at least one test case fails when the same lock's token is inspected both inside and outside a transaction (XATest.testAddRemoveLockToken)
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33800-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 15:12:03 2012
Return-Path: <dev-return-33800-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 11B73956F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 15:12:03 +0000 (UTC)
Received: (qmail 39739 invoked by uid 500); 17 Jan 2012 15:12:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 39663 invoked by uid 500); 17 Jan 2012 15:12:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 39656 invoked by uid 99); 17 Jan 2012 15:12:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 15:12:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 15:12:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 103F7151BA1
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 15:11:41 +0000 (UTC)
Date: Tue, 17 Jan 2012 15:11:41 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1948249702.48723.1326813101068.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <610143909.44702.1326721599821.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3208) locking a node twice yields the same
 lock token
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3208?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3208:
--------------------------------

    Attachment: JCR-3208.diff

(work in progress, see previous comment)
                
> locking a node twice yields the same lock token
> -----------------------------------------------
>
>                 Key: JCR-3208
>                 URL: https://issues.apache.org/jira/browse/JCR-3208
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3208.diff, JCR-3208.diff
>
>
> Due to the way jackrabbit assigns lock tokens, the same lock token is generated every time a node is locked.
> This seems to contradict a JCR requirement:
> "A lock token is a string that uniquely identifies a particular lock and acts as a key granting lock ownership to any session that hold the token." <http://www.day.com/specs/jcr/2.0/17_Locking.html#17.5%20Lock%20Token>
> ...in that two subsequent locks on the same node get the same token.
> (This may be harmless but we should consider fixing this for compliance reasons)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33801-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 15:38:02 2012
Return-Path: <dev-return-33801-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AFEA39831
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 15:38:02 +0000 (UTC)
Received: (qmail 93844 invoked by uid 500); 17 Jan 2012 15:38:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 93684 invoked by uid 500); 17 Jan 2012 15:38:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 93667 invoked by uid 99); 17 Jan 2012 15:38:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 15:38:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 15:37:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C3700151BE4
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 15:37:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 15:37:39 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <580698816.48828.1326814659801.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3205) Missing support for lock timeout and
 ownerHint in jcr-server
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3205:
--------------------------------

    Component/s: locks
    
> Missing support for lock timeout and ownerHint in jcr-server
> ------------------------------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>             Fix For: 2.4
>
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33802-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 16:42:04 2012
Return-Path: <dev-return-33802-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3D48298ED
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 16:42:04 +0000 (UTC)
Received: (qmail 21977 invoked by uid 500); 17 Jan 2012 16:42:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 21914 invoked by uid 500); 17 Jan 2012 16:42:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 21907 invoked by uid 99); 17 Jan 2012 16:42:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 16:42:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 16:42:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D18D0152247
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 16:41:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 16:41:39 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1328411206.49063.1326818499859.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1883485972.45339.1326736539556.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3210) NPE in spi2dav when server does not
 send all headers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3210?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3210:
-------------------------------

    Fix Version/s:     (was: 2.6)
                   2.4

Merged to the 2.4 branch in revision 1232469.
                
> NPE in spi2dav when server does not send all headers
> ----------------------------------------------------
>
>                 Key: JCR-3210
>                 URL: https://issues.apache.org/jira/browse/JCR-3210
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-spi2dav
>    Affects Versions: 2.3.5
>            Reporter: Tobias Bocanegra
>            Assignee: Tobias Bocanegra
>            Priority: Minor
>             Fix For: 2.4
>
>
> The ValueLoader may throw a NPE if the desired headers are not present in the response:
> org.apache.jackrabbit.spi2davex.ValueLoader:
>     public Map<String, String> loadHeaders(String uri, String[] headerNames) throws IOException, RepositoryException {
>     ....
>                 for (String name : headerNames) {
> --->                headers.put(name, method.getResponseHeader(name).getValue());
>                 }
>     .....
>     }
> In my case, the server does not return the ETag response header, but the 'loadHeaders' is indirectly called by the QValueFactoryImpl:
>                         this.preInitialize(new String[] {HEADER_ETAG, HEADER_LAST_MODIFIED});

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33803-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 16:54:03 2012
Return-Path: <dev-return-33803-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F364B9BA1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 16:54:02 +0000 (UTC)
Received: (qmail 47611 invoked by uid 500); 17 Jan 2012 16:54:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 47169 invoked by uid 500); 17 Jan 2012 16:54:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 47026 invoked by uid 99); 17 Jan 2012 16:54:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 16:54:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 16:53:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CD36715280F
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 16:53:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 16:53:39 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <723491421.49097.1326819219854.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <20830832.43268.1324675590659.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3194) ConcurrentModificationException in
 CacheManager.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3194?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3194:
-------------------------------

    Fix Version/s: 2.4

Merged to the 2.4 branch in revision 1232474.
                
> ConcurrentModificationException in CacheManager.
> ------------------------------------------------
>
>                 Key: JCR-3194
>                 URL: https://issues.apache.org/jira/browse/JCR-3194
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.3.4
>            Reporter: Mat Lowery
>             Fix For: 2.4
>
>
> Using the test code below, I was able to produce this stack:
> java.util.ConcurrentModificationException
> 	at java.util.WeakHashMap$HashIterator.nextEntry(WeakHashMap.java:762)
> 	at java.util.WeakHashMap$KeyIterator.next(WeakHashMap.java:795)
> 	at org.apache.jackrabbit.core.cache.CacheManager.logCacheStats(CacheManager.java:164)
> 	at org.apache.jackrabbit.core.cache.CacheManager.cacheAccessed(CacheManager.java:137)
> 	at org.apache.jackrabbit.core.cache.AbstractCache.recordCacheAccess(AbstractCache.java:122)
> 	at org.apache.jackrabbit.core.cache.ConcurrentCache.get(ConcurrentCache.java:122)
> 	at org.apache.jackrabbit.core.state.MLRUItemStateCache.retrieve(MLRUItemStateCache.java:71)
> 	at org.apache.jackrabbit.core.state.ItemStateReferenceCache.retrieve(ItemStateReferenceCache.java:139)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getNonVirtualItemState(SharedItemStateManager.java:1716)
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.getItemState(SharedItemStateManager.java:268)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getNodeState(LocalItemStateManager.java:110)
> 	at org.apache.jackrabbit.core.state.LocalItemStateManager.getItemState(LocalItemStateManager.java:175)
> 	at org.apache.jackrabbit.core.state.XAItemStateManager.getItemState(XAItemStateManager.java:260)
> 	at org.apache.jackrabbit.core.state.SessionItemStateManager.getItemState(SessionItemStateManager.java:161)
> 	at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:382)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:328)
> 	at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:622)
> 	at org.apache.jackrabbit.core.ItemManager.getRootNode(ItemManager.java:531)
> 	at org.apache.jackrabbit.core.SessionImpl.getRootNode(SessionImpl.java:760)
> 	at test.JackrabbitTest$1.run(JackrabbitTest.java:37)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
> 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
> 	at java.lang.Thread.run(Thread.java:662)
> -------------------------
> package test;
> import java.io.File;
> import java.util.concurrent.ExecutorService;
> import java.util.concurrent.Executors;
> import java.util.concurrent.TimeUnit;
> import java.util.concurrent.atomic.AtomicBoolean;
> import java.util.concurrent.atomic.AtomicInteger;
> import javax.jcr.Repository;
> import javax.jcr.RepositoryException;
> import javax.jcr.Session;
> import javax.jcr.SimpleCredentials;
> import org.apache.jackrabbit.core.TransientRepository;
> public class JackrabbitTest {
>  public static void main(final String[] args) throws Exception {
>    File dir = File.createTempFile("jackrabbit-test", "");
>    dir.delete();
>    dir.mkdir();
>    System.out.println("created temporary directory: " +
>        dir.getAbsolutePath());
>    dir.deleteOnExit();
>    final Repository jcrRepo = new TransientRepository(dir);
>    final AtomicBoolean passed = new AtomicBoolean(true);
>    final AtomicInteger counter = new AtomicInteger(0);
>    ExecutorService executor = Executors.newFixedThreadPool(50);
>    Runnable runnable = new Runnable() {
>      @Override
>      public void run() {
>        try {
>          Session session = jcrRepo.login(
>              new SimpleCredentials("admin",
>                  "admin".toCharArray()));
>          session.getRootNode().addNode("n" +
>                  counter.getAndIncrement()); //unique name
>          session.save();
>          session.logout();
>        } catch (RepositoryException e) {
>          e.printStackTrace();
>          passed.set(false);
>        }
>      }
>    };
>    System.out.println("Running threads");
>    for (int i = 0; i<  500; i++) {
>      executor.execute(runnable);
>    }
>    executor.shutdown(); //Disable new tasks from being submitted
>    if (!executor.awaitTermination(120, TimeUnit.SECONDS)) {
>      System.err.println("timeout");
>      System.exit(1);
>    }
>    if (!passed.get()) {
>      System.err.println("one or more threads got an exception");
>      System.exit(1);
>    } else {
>      System.out.println("all threads ran with no exceptions");
>      System.exit(0);
>    }
>  }
> }

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33804-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 18:03:04 2012
Return-Path: <dev-return-33804-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B3D3D9E56
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 18:03:04 +0000 (UTC)
Received: (qmail 68076 invoked by uid 500); 17 Jan 2012 18:03:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 67614 invoked by uid 500); 17 Jan 2012 18:03:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 67450 invoked by uid 99); 17 Jan 2012 18:03:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:03:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:03:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id F411015291A
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 18:02:39 +0000 (UTC)
Date: Tue, 17 Jan 2012 18:02:39 +0000 (UTC)
From: "Julien Nicoulaud (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1727232892.49351.1326823360001.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-1442) FSImport.java link on wiki is dead
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-1442?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187836#comment-13187836 ] 

Julien Nicoulaud commented on JCR-1442:
---------------------------------------

The link is dead again.
                
> FSImport.java link on wiki is dead
> ----------------------------------
>
>                 Key: JCR-1442
>                 URL: https://issues.apache.org/jira/browse/JCR-1442
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>            Reporter: Dave Brosius
>
> The link for FSImport.java 
> http://svn.apache.org/repos/asf/jackrabbit/trunk/contrib/examples/src/java/org/apache/jackrabbit/examples/FSImport.java
> from wiki page
> http://wiki.apache.org/jackrabbit/ExamplesPage
> is dead, could it be updated please?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33805-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 18:05:03 2012
Return-Path: <dev-return-33805-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0537F9F74
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 18:05:03 +0000 (UTC)
Received: (qmail 71627 invoked by uid 500); 17 Jan 2012 18:05:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 71188 invoked by uid 500); 17 Jan 2012 18:05:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 71176 invoked by uid 99); 17 Jan 2012 18:05:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:05:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:05:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 97823152A05
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 18:04:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 18:04:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1389557955.49364.1326823480622.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <5100067.156451294219425338.JavaMail.jira@thor>
Subject: [jira] [Updated] (JCR-2859) Make open scoped locks recoverable
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-2859?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-2859:
-------------------------------

    Fix Version/s:     (was: 2.5)
                   2.4

Merged to the 2.4 branch in revision 1232513.
                
> Make open scoped locks recoverable
> ----------------------------------
>
>                 Key: JCR-2859
>                 URL: https://issues.apache.org/jira/browse/JCR-2859
>             Project: Jackrabbit Content Repository
>          Issue Type: New Feature
>          Components: locks
>            Reporter: Carsten Ziegeler
>            Assignee: Julian Reschke
>             Fix For: 2.4
>
>         Attachments: JCR-2859.diff, JCR-2859.diff, JCR-2859.patch, OpenScopeLockTest.java
>
>
> The lock tokens for open scoped locks are currently tied to the session which created the lock. If the session dies (for whatever reason) there is no way to recover the lock and unlock the node.
> There is a theoretical way of adding the lock token to another session, but in most cases the lock token is not available.
> Fortunately, the spec allows to relax this behaviour and I think it would make sense to allow all sessions from the same user to unlock the node - this is still in compliance with the spec but would make unlocked locked nodes possible in a programmatic way.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33806-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 18:05:04 2012
Return-Path: <dev-return-33806-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4BAAA9F99
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 18:05:04 +0000 (UTC)
Received: (qmail 72126 invoked by uid 500); 17 Jan 2012 18:05:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 72058 invoked by uid 500); 17 Jan 2012 18:05:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 72049 invoked by uid 99); 17 Jan 2012 18:05:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:05:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:05:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 61280152A02
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 18:04:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 18:04:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <854773460.49361.1326823480399.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <198669010.48388.1325071890770.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3195) wrong assumptions in test cases about
 lock tokens
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3195?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3195:
-------------------------------

    Affects Version/s: 2.3.6
        Fix Version/s:     (was: 2.5)
                       2.4

Merged to the 2.4 branch in revision 1232513 as a dependency of JCR-2859.
                
> wrong assumptions in test cases about lock tokens
> -------------------------------------------------
>
>                 Key: JCR-3195
>                 URL: https://issues.apache.org/jira/browse/JCR-3195
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-tests, test
>    Affects Versions: 2.3.6
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>             Fix For: 2.4
>
>
> Several test cases assume that Lock.getLockToken has to return null for locks not attached to the current session. However, this is optional. Citing the Javadoc for getLockToken:
>      * May return the lock token for this lock. If this lock is open-scoped and
>      * the current session either holds the lock token for this lock, or the
>      * repository chooses to expose the lock token to the current session, then
>      * this method will return that lock token. Otherwise this method will
>      * return <code>null</code>.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33807-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 18:35:02 2012
Return-Path: <dev-return-33807-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A167B9675
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 18:35:02 +0000 (UTC)
Received: (qmail 28385 invoked by uid 500); 17 Jan 2012 18:35:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 28191 invoked by uid 500); 17 Jan 2012 18:35:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 28169 invoked by uid 99); 17 Jan 2012 18:35:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:35:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:35:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 3325515182E
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 18:34:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 18:34:40 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1907018296.49506.1326825280211.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <2078728471.14249.1325853579270.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3203) GroupImp#getMembers and
 #getDeclaredMembers should return RangeIterator
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3203?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187866#comment-13187866 ] 

Jukka Zitting commented on JCR-3203:
------------------------------------

Merged to the 2.4 branch in revision 1232526.
                
> GroupImp#getMembers and #getDeclaredMembers should return RangeIterator
> -----------------------------------------------------------------------
>
>                 Key: JCR-3203
>                 URL: https://issues.apache.org/jira/browse/JCR-3203
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, security
>            Reporter: angela
>            Priority: Minor
>             Fix For: 2.4
>
>
> for those cases where the total amount of members can easily be detected/calculated the
> implementations of Group#getMembers() and #getDeclaredMembersOf() should return a RangeIterator.
> so far i found that Group#declaredMembers() can be easily adjusted for those cases where
> the group members are stored in a multivalued property.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33808-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 18:35:03 2012
Return-Path: <dev-return-33808-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3949B968F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 18:35:03 +0000 (UTC)
Received: (qmail 28845 invoked by uid 500); 17 Jan 2012 18:35:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 28281 invoked by uid 500); 17 Jan 2012 18:35:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 28172 invoked by uid 99); 17 Jan 2012 18:35:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:35:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:35:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1B6CB15182C
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 18:34:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 18:34:40 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <809583926.49504.1326825280114.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1721925875.14239.1325853219213.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3202) AuthorizableImpl#memberOf and
 #declaredMemberOf should return RangeIterator
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3202?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187865#comment-13187865 ] 

Jukka Zitting commented on JCR-3202:
------------------------------------

Merged to the 2.4 branch in revision 1232526.
                
> AuthorizableImpl#memberOf and #declaredMemberOf should return RangeIterator
> ---------------------------------------------------------------------------
>
>                 Key: JCR-3202
>                 URL: https://issues.apache.org/jira/browse/JCR-3202
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, security
>            Reporter: angela
>            Assignee: angela
>            Priority: Minor
>             Fix For: 2.4
>
>
> it would be favorable if the iterator returned by Authorizable#memberOf and #declaredMemberOf
> would return a RangeIterator in order to all the caller to determine the size without having to
> iterate.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33809-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 18:41:03 2012
Return-Path: <dev-return-33809-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D844E98E1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 18:41:02 +0000 (UTC)
Received: (qmail 40002 invoked by uid 500); 17 Jan 2012 18:41:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 39910 invoked by uid 500); 17 Jan 2012 18:41:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 39903 invoked by uid 99); 17 Jan 2012 18:41:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:41:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 18:41:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 12C0B151B4E
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 18:40:40 +0000 (UTC)
Date: Tue, 17 Jan 2012 18:40:40 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1475021160.49532.1326825640078.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3205) Missing support for lock timeout and
 ownerHint in jcr-server
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13187869#comment-13187869 ] 

Jukka Zitting commented on JCR-3205:
------------------------------------

Merged to the 2.4 branch in revision 1232530.
                
> Missing support for lock timeout and ownerHint in jcr-server
> ------------------------------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>             Fix For: 2.4
>
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33810-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 17 19:28:06 2012
Return-Path: <dev-return-33810-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 87D319274
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 17 Jan 2012 19:28:06 +0000 (UTC)
Received: (qmail 29659 invoked by uid 500); 17 Jan 2012 19:28:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 29314 invoked by uid 500); 17 Jan 2012 19:28:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 29286 invoked by uid 99); 17 Jan 2012 19:28:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 19:28:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 17 Jan 2012 19:28:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9B24D15187A
	for <dev@jackrabbit.apache.org>; Tue, 17 Jan 2012 19:27:41 +0000 (UTC)
Date: Tue, 17 Jan 2012 19:27:41 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1629760644.49837.1326828461636.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1577678328.4549.1325685641108.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3199) workspace-wide default for lock timeout
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3199?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3199:
-------------------------------

    Fix Version/s:     (was: 2.5)
                   2.4

Merged to the 2.4 branch in revision 1232546.
                
> workspace-wide default for lock timeout
> ---------------------------------------
>
>                 Key: JCR-3199
>                 URL: https://issues.apache.org/jira/browse/JCR-3199
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>             Fix For: 2.4
>
>         Attachments: JCR-3199.diff
>
>
> There should be a way to define a workspace-wide default for JCR lock timeouts (in case the code creating the lock did not specify one).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33811-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 11:04:05 2012
Return-Path: <dev-return-33811-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D1F6FB5AB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 11:04:05 +0000 (UTC)
Received: (qmail 28341 invoked by uid 500); 18 Jan 2012 11:04:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 28197 invoked by uid 500); 18 Jan 2012 11:04:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 28190 invoked by uid 99); 18 Jan 2012 11:04:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 11:04:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 11:04:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CC94715305D
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 11:03:39 +0000 (UTC)
Date: Wed, 18 Jan 2012 11:03:39 +0000 (UTC)
From: =?utf-8?Q?Claus_K=C3=B6ll_=28Resolved=29_=28JIRA=29?= <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1655454936.52390.1326884619839.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1694948235.34137.1324440810712.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3189)
 JCARepositoryManager.createNonTransientRepository throws NPE with no
 JCAManagedConnectionFactory.CONFIGFILE_KEY
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3189?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Claus K=C3=B6ll resolved JCR-3189.
-----------------------------

       Resolution: Fixed
    Fix Version/s: 2.4

Committed in revision 1232831.
               =20
> JCARepositoryManager.createNonTransientRepository throws NPE with no JCAM=
anagedConnectionFactory.CONFIGFILE_KEY
> -------------------------------------------------------------------------=
--------------------------------------
>
>                 Key: JCR-3189
>                 URL: https://issues.apache.org/jira/browse/JCR-3189
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jca
>    Affects Versions: 2.3.5
>            Reporter: Dave Brosius
>            Assignee: Claus K=C3=B6ll
>            Priority: Minor
>             Fix For: 2.4
>
>
> JCARepositoryManager.createNonTransientRepository fails if
> String configFile =3D parameters.get(JCAManagedConnectionFactory.CONFIGFI=
LE_KEY);
> is null, because
> config =3D RepositoryConfig.create(configFile, homeDir);
> will always throw an NPE, perhaps the call should just be
> config =3D RepositoryConfig.create(homeDir);

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33812-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 11:59:40 2012
Return-Path: <dev-return-33812-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B8931B578
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 11:59:40 +0000 (UTC)
Received: (qmail 88617 invoked by uid 500); 18 Jan 2012 11:59:40 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 88394 invoked by uid 500); 18 Jan 2012 11:59:39 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 88387 invoked by uid 99); 18 Jan 2012 11:59:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 11:59:39 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 11:59:37 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 3D44DC004A
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 11:59:16 +0000 (UTC)
Date: Wed, 18 Jan 2012 11:59:09 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1075580208.8761326887956236.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1817 - Failure
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Apache Jenkins build system has built Jackrabbit-trunk (build #1817)

Status: Failure

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1817/ to view the results.

From dev-return-33813-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 13:39:04 2012
Return-Path: <dev-return-33813-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7E440BB55
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 13:39:04 +0000 (UTC)
Received: (qmail 36445 invoked by uid 500); 18 Jan 2012 13:39:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 36333 invoked by uid 500); 18 Jan 2012 13:39:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 36314 invoked by uid 99); 18 Jan 2012 13:39:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 13:39:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 13:39:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E77BA1538BD
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 13:38:39 +0000 (UTC)
Date: Wed, 18 Jan 2012 13:38:39 +0000 (UTC)
From: "Julian Reschke (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <617371429.52553.1326893919949.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke reassigned JCR-3209:
-----------------------------------

    Assignee: Julian Reschke
    
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33814-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 13:41:04 2012
Return-Path: <dev-return-33814-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 98891BB6E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 13:41:04 +0000 (UTC)
Received: (qmail 37295 invoked by uid 500); 18 Jan 2012 13:41:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 37238 invoked by uid 500); 18 Jan 2012 13:41:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 37230 invoked by uid 99); 18 Jan 2012 13:41:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 13:41:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 13:41:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id EB243153990
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 13:40:39 +0000 (UTC)
Date: Wed, 18 Jan 2012 13:40:39 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1970153261.52555.1326894039964.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3209:
--------------------------------

    Attachment: JCR-3209.diff

Proposed patch; implements mapping of JCR lock tokens to valid DAV lock token URIs, isolates mapping in a single place.
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3209.diff
>
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33815-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 13:41:04 2012
Return-Path: <dev-return-33815-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CDA06BB84
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 13:41:04 +0000 (UTC)
Received: (qmail 37488 invoked by uid 500); 18 Jan 2012 13:41:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 37246 invoked by uid 500); 18 Jan 2012 13:41:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 37236 invoked by uid 99); 18 Jan 2012 13:41:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 13:41:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 13:41:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 06884153991
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 13:40:40 +0000 (UTC)
Date: Wed, 18 Jan 2012 13:40:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <315504534.52556.1326894040028.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13188442#comment-13188442 ] 

Julian Reschke commented on JCR-3209:
-------------------------------------

Observation: it appears that we never need the actual JCR lock token of a *session* scoped lock. That makes sense as we are keeping the JCR session around, right? 
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>         Attachments: JCR-3209.diff
>
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33816-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 15:01:06 2012
Return-Path: <dev-return-33816-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 02F65B3F5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 15:01:06 +0000 (UTC)
Received: (qmail 3572 invoked by uid 500); 18 Jan 2012 15:01:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 3504 invoked by uid 500); 18 Jan 2012 15:01:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 3497 invoked by uid 99); 18 Jan 2012 15:01:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:01:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:01:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 2DD8215353D
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 15:00:41 +0000 (UTC)
Date: Wed, 18 Jan 2012 15:00:41 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1862699054.52733.1326898841200.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <481776123.9110.1325770179315.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3200) consistency check should get node ids
 in chunks, not rely on total count
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3200?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-3200.
---------------------------------

       Resolution: Fixed
    Fix Version/s: 2.6
    
> consistency check should get node ids in chunks, not rely on total count
> ------------------------------------------------------------------------
>
>                 Key: JCR-3200
>                 URL: https://issues.apache.org/jira/browse/JCR-3200
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>         Attachments: JCR-3200.diff
>
>
> The PM consistency checker should use the paging feature to fetch nodeIds in chunks, and also not rely on the total number of ids for logging purposes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33817-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 15:15:40 2012
Return-Path: <dev-return-33817-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 81D87BC60
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 15:15:40 +0000 (UTC)
Received: (qmail 38727 invoked by uid 500); 18 Jan 2012 15:15:40 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 38651 invoked by uid 500); 18 Jan 2012 15:15:39 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 38644 invoked by uid 99); 18 Jan 2012 15:15:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:15:39 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:15:37 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 08FA6C004A
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 15:15:16 +0000 (UTC)
Date: Wed, 18 Jan 2012 15:15:15 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2141317871.8871326899715969.JavaMail.hudson@aegis>
In-Reply-To: <1075580208.8761326887956236.JavaMail.hudson@aegis>
References: <1075580208.8761326887956236.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1818 - Still Failing
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Apache Jenkins build system has built Jackrabbit-trunk (build #1818)

Status: Still Failing

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1818/ to view the results.

From dev-return-33818-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 15:17:37 2012
Return-Path: <dev-return-33818-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3E0ECBCBF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 15:17:37 +0000 (UTC)
Received: (qmail 42128 invoked by uid 500); 18 Jan 2012 15:17:36 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 42088 invoked by uid 500); 18 Jan 2012 15:17:36 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 42076 invoked by uid 99); 18 Jan 2012 15:17:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:17:36 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.42 as permitted sender)
Received: from [74.125.82.42] (HELO mail-ww0-f42.google.com) (74.125.82.42)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:17:28 +0000
Received: by wgbgn7 with SMTP id gn7so3698586wgb.1
        for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 07:17:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=IKTplyjZOHnMc/9dgcdXUWqv9ZTJ9g98wsnY6fG5JJc=;
        b=dp4zUkhpjv2zpYtSkq+oCu5G6bf95YaSaJ/N41iCtzkLhryJpT5OOCcZ9Bvypr0iNl
         Z1m+W6qvBWVCrFck7W9cwN51TtXjDb+ttp0pzzuOPXnjfWV+8TXu5o5NrEClBwRDJw7k
         e6ME8QJNHLDEZpCW3v+CL24QRm34DHIA5E1aA=
Received: by 10.180.106.202 with SMTP id gw10mr39596986wib.3.1326899828132;
 Wed, 18 Jan 2012 07:17:08 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Wed, 18 Jan 2012 07:16:47 -0800 (PST)
In-Reply-To: <2141317871.8871326899715969.JavaMail.hudson@aegis>
References: <1075580208.8761326887956236.JavaMail.hudson@aegis> <2141317871.8871326899715969.JavaMail.hudson@aegis>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Wed, 18 Jan 2012 16:16:47 +0100
Message-ID: <CAOFYJNaT9gyWbXLYT+XUdrR-ZBbjSBTbcsNjtdJ=U3AOmqC1Xw@mail.gmail.com>
Subject: Re: Jackrabbit-trunk - Build # 1818 - Still Failing
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Wed, Jan 18, 2012 at 4:15 PM, Apache Jenkins Server
<jenkins@builds.apache.org> wrote:
> Status: Still Failing

Something wrong with Jenkins. The trunk build itself is fine.

BR,

Jukka Zitting

From dev-return-33819-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 15:31:05 2012
Return-Path: <dev-return-33819-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 579B1BA81
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 15:31:05 +0000 (UTC)
Received: (qmail 75638 invoked by uid 500); 18 Jan 2012 15:31:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 75552 invoked by uid 500); 18 Jan 2012 15:31:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 75529 invoked by uid 99); 18 Jan 2012 15:31:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:31:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 15:31:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 36353153671
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 15:30:40 +0000 (UTC)
Date: Wed, 18 Jan 2012 15:30:40 +0000 (UTC)
From: "Julian Reschke (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1824991771.52841.1326900640223.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3212) add TCK test for Info map of NODE_MOVED
 event on node reordering
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

add TCK test for Info map of NODE_MOVED event on node reordering
----------------------------------------------------------------

                 Key: JCR-3212
                 URL: https://issues.apache.org/jira/browse/JCR-3212
             Project: Jackrabbit Content Repository
          Issue Type: Sub-task
          Components: jackrabbit-jcr-tests, observation
            Reporter: Julian Reschke
            Assignee: Julian Reschke
            Priority: Minor
             Fix For: 2.6


add the TCK test for this problem, and mark this as known test failure for now

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33820-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 16:09:05 2012
Return-Path: <dev-return-33820-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 76647B55A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 16:09:05 +0000 (UTC)
Received: (qmail 38709 invoked by uid 500); 18 Jan 2012 16:09:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 38242 invoked by uid 500); 18 Jan 2012 16:09:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 38228 invoked by uid 99); 18 Jan 2012 16:09:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 16:09:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 16:09:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C300C153DBC
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 16:08:39 +0000 (UTC)
Date: Wed, 18 Jan 2012 16:08:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1356587635.52959.1326902919800.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1824991771.52841.1326900640223.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3212) add TCK test for Info map of
 NODE_MOVED event on node reordering
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3212?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13188523#comment-13188523 ] 

Julian Reschke commented on JCR-3212:
-------------------------------------

Turns out that we have test cases for these operations in the TCK, see org.apache.jackrabbit.test.api.observation.NodeReorderTest. However, these tests have been written in a way that also causes the incorrect reporting of reorder data in the info map.

I wouldn't want to remove this completely, because then other aspects (ADDED/REMOVED events) wouldn't be tested anymore (once we mark the tests as failing in Jackrabbit). Instead, we could refactor the tests to check REMOVED and ADDED independently from MOVED.
 
                
> add TCK test for Info map of NODE_MOVED event on node reordering
> ----------------------------------------------------------------
>
>                 Key: JCR-3212
>                 URL: https://issues.apache.org/jira/browse/JCR-3212
>             Project: Jackrabbit Content Repository
>          Issue Type: Sub-task
>          Components: jackrabbit-jcr-tests, observation
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>
> add the TCK test for this problem, and mark this as known test failure for now

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33821-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 18:25:44 2012
Return-Path: <dev-return-33821-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 21FEBB301
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 18:25:44 +0000 (UTC)
Received: (qmail 75314 invoked by uid 500); 18 Jan 2012 18:25:43 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 75237 invoked by uid 500); 18 Jan 2012 18:25:43 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 75230 invoked by uid 99); 18 Jan 2012 18:25:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 18:25:42 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 18:25:40 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id C49EEC004A
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 18:25:19 +0000 (UTC)
Date: Wed, 18 Jan 2012 18:25:13 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <130671646.8991326911119778.JavaMail.hudson@aegis>
In-Reply-To: <2141317871.8871326899715969.JavaMail.hudson@aegis>
References: <2141317871.8871326899715969.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1819 - Still Failing
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Apache Jenkins build system has built Jackrabbit-trunk (build #1819)

Status: Still Failing

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1819/ to view the results.

From dev-return-33822-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 21:07:04 2012
Return-Path: <dev-return-33822-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 476B9B94B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 21:07:04 +0000 (UTC)
Received: (qmail 59917 invoked by uid 500); 18 Jan 2012 21:07:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 59884 invoked by uid 500); 18 Jan 2012 21:07:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 59869 invoked by uid 99); 18 Jan 2012 21:07:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 21:07:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 21:07:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E1C7F1547B6
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 21:06:39 +0000 (UTC)
Date: Wed, 18 Jan 2012 21:06:39 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1903892754.53853.1326920799926.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1824991771.52841.1326900640223.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3212) add TCK test for Info map of
 NODE_MOVED event on node reordering
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3212?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-3212.
---------------------------------

    Resolution: Fixed
    
> add TCK test for Info map of NODE_MOVED event on node reordering
> ----------------------------------------------------------------
>
>                 Key: JCR-3212
>                 URL: https://issues.apache.org/jira/browse/JCR-3212
>             Project: Jackrabbit Content Repository
>          Issue Type: Sub-task
>          Components: jackrabbit-jcr-tests, observation
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>
> add the TCK test for this problem, and mark this as known test failure for now

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33823-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 18 22:44:39 2012
Return-Path: <dev-return-33823-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 06AB9BDDD
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 18 Jan 2012 22:44:39 +0000 (UTC)
Received: (qmail 27292 invoked by uid 500); 18 Jan 2012 22:44:38 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 27183 invoked by uid 500); 18 Jan 2012 22:44:38 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 27146 invoked by uid 99); 18 Jan 2012 22:44:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 22:44:37 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 18 Jan 2012 22:44:37 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id E6849C004A
	for <dev@jackrabbit.apache.org>; Wed, 18 Jan 2012 22:44:16 +0000 (UTC)
Date: Wed, 18 Jan 2012 22:44:16 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <667790501.9151326926656925.JavaMail.hudson@aegis>
In-Reply-To: <130671646.8991326911119778.JavaMail.hudson@aegis>
References: <130671646.8991326911119778.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1820 - Still Failing
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

The Apache Jenkins build system has built Jackrabbit-trunk (build #1820)

Status: Still Failing

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1820/ to view the results.

From dev-return-33824-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 09:39:29 2012
Return-Path: <dev-return-33824-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 717829BAC
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 09:39:29 +0000 (UTC)
Received: (qmail 90425 invoked by uid 500); 19 Jan 2012 09:39:28 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 90004 invoked by uid 500); 19 Jan 2012 09:39:09 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 89992 invoked by uid 99); 19 Jan 2012 09:39:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 09:39:06 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 09:39:04 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 95CE6C004A
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 09:38:44 +0000 (UTC)
Date: Thu, 19 Jan 2012 09:38:44 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <815824954.231326965924596.JavaMail.hudson@aegis>
In-Reply-To: <667790501.9151326926656925.JavaMail.hudson@aegis>
References: <667790501.9151326926656925.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1821 - Unstable
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

The Apache Jenkins build system has built Jackrabbit-trunk (build #1821)

Status: Unstable

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1821/ to view the results.

From dev-return-33825-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 10:22:55 2012
Return-Path: <dev-return-33825-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5E205988C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 10:22:55 +0000 (UTC)
Received: (qmail 61762 invoked by uid 500); 19 Jan 2012 10:22:55 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 61668 invoked by uid 500); 19 Jan 2012 10:22:53 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 61655 invoked by uid 99); 19 Jan 2012 10:22:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 10:22:53 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 10:22:46 +0000
Received: by wibhi18 with SMTP id hi18so8682934wib.1
        for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 02:22:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=N3UO34Vc8hcoPqizcXhAT9Xo8PCFLR1s9MnhSD8kvJ4=;
        b=cmwzwkFmMYxC49TVY2xp49iaX2iyk8iVeVkRZUOtjpim+YdH2CvyiLTkiTQAcN3pmD
         F38PDIC1i11ChHVcwUj8ZuGTaEK9F8RP3pEyTTR3xRj3YO5iIBWVBT06UhlWFtJQPE7r
         DGJPNjKxinkrx07xKixkNGFtu2gLa83tHIbKk=
Received: by 10.180.106.202 with SMTP id gw10mr46713949wib.3.1326968545120;
 Thu, 19 Jan 2012 02:22:25 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Thu, 19 Jan 2012 02:22:04 -0800 (PST)
In-Reply-To: <815824954.231326965924596.JavaMail.hudson@aegis>
References: <667790501.9151326926656925.JavaMail.hudson@aegis> <815824954.231326965924596.JavaMail.hudson@aegis>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Thu, 19 Jan 2012 11:22:04 +0100
Message-ID: <CAOFYJNZHgyO=yg5god8hgOji2b9=OK2y=Hj8OwXNimbXDZtdzA@mail.gmail.com>
Subject: Re: Jackrabbit-trunk - Build # 1821 - Unstable
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi,

Not sure whether this ("Can not rename ... media read only?") is a
problem with the Jenkins slave or something we should look at:

org.apache.jackrabbit.core.data.DataStoreException: Could not add record
	at org.apache.jackrabbit.core.data.FileDataStore.addRecord(FileDataStore.java:252)
	at org.apache.jackrabbit.core.data.ConcurrentGcTest.doTest(ConcurrentGcTest.java:133)
	at org.apache.jackrabbit.core.data.ConcurrentGcTest.testFile(ConcurrentGcTest.java:114)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:592)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:243)
	at junit.framework.TestSuite.run(TestSuite.java:238)
	at junit.framework.TestSuite.runTest(TestSuite.java:243)
	at org.apache.jackrabbit.test.ConcurrentTestSuite.access$001(ConcurrentTestSuite.java:29)
	at org.apache.jackrabbit.test.ConcurrentTestSuite$2.run(ConcurrentTestSuite.java:67)
	at EDU.oswego.cs.dl.util.concurrent.PooledExecutor$Worker.run(Unknown Source)
	at java.lang.Thread.run(Thread.java:595)
Caused by: java.io.IOException: Can not rename
/export/home/hudson/hudson-slave/workspace/Jackrabbit-trunk/trunk/jackrabbit-core/target/ConcurrentGcTest/fs/tmp8592574245007180213.tmp
to /export/home/hudson/hudson-slave/workspace/Jackrabbit-trunk/trunk/jackrabbit-core/target/ConcurrentGcTest/fs/2a/1c/dc/2a1cdc6966424a8a5014588bb5a647234a3e38ba
(media read only?)
	at org.apache.jackrabbit.core.data.FileDataStore.addRecord(FileDataStore.java:225)
	... 19 more

BR,

Jukka Zitting



On Thu, Jan 19, 2012 at 10:38 AM, Apache Jenkins Server
<jenkins@builds.apache.org> wrote:
> The Apache Jenkins build system has built Jackrabbit-trunk (build #1821)
>
> Status: Unstable
>
> Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1821/ to view the results.

From dev-return-33826-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 10:27:07 2012
Return-Path: <dev-return-33826-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 866099767
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 10:27:07 +0000 (UTC)
Received: (qmail 66428 invoked by uid 500); 19 Jan 2012 10:27:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 66364 invoked by uid 500); 19 Jan 2012 10:27:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 66354 invoked by uid 99); 19 Jan 2012 10:27:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 10:27:05 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 10:27:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id F2086155878
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 10:26:41 +0000 (UTC)
Date: Thu, 19 Jan 2012 10:26:41 +0000 (UTC)
From: "Alex Parvulescu (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1262887743.55737.1326968801992.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3213) Speed up NodeIndexer.isIndexed() check
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

Speed up NodeIndexer.isIndexed() check
--------------------------------------

                 Key: JCR-3213
                 URL: https://issues.apache.org/jira/browse/JCR-3213
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: indexing
            Reporter: Alex Parvulescu
            Priority: Minor


The isIndexed() method is called for every value in a multi-valued property. This may be quite expensive when there are a lot of values.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33827-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 10:39:05 2012
Return-Path: <dev-return-33827-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 26BE29305
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 10:39:05 +0000 (UTC)
Received: (qmail 84071 invoked by uid 500); 19 Jan 2012 10:39:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 84021 invoked by uid 500); 19 Jan 2012 10:39:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 84011 invoked by uid 99); 19 Jan 2012 10:39:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 10:39:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 10:39:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A9E1A155E8E
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 10:38:40 +0000 (UTC)
Date: Thu, 19 Jan 2012 10:38:40 +0000 (UTC)
From: "Alex Parvulescu (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <674004006.55793.1326969520705.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1262887743.55737.1326968801992.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3213) Speed up NodeIndexer.isIndexed() check
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3213?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Alex Parvulescu updated JCR-3213:
---------------------------------

    Attachment: JCR-3213.patch

The proposed patch moves up the isIndexed call from the #addValue method to #createDoc.

Before, it was being called for each value of a property, so for a MVP multiple times, which is suboptimal because the method only relates to the property's name, not its value to determine if it should be indexed or not.
                
> Speed up NodeIndexer.isIndexed() check
> --------------------------------------
>
>                 Key: JCR-3213
>                 URL: https://issues.apache.org/jira/browse/JCR-3213
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: indexing
>            Reporter: Alex Parvulescu
>            Priority: Minor
>         Attachments: JCR-3213.patch
>
>
> The isIndexed() method is called for every value in a multi-valued property. This may be quite expensive when there are a lot of values.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33828-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 13:10:03 2012
Return-Path: <dev-return-33828-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0089E9904
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 13:10:02 +0000 (UTC)
Received: (qmail 42264 invoked by uid 500); 19 Jan 2012 13:10:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 42189 invoked by uid 500); 19 Jan 2012 13:10:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 42180 invoked by uid 99); 19 Jan 2012 13:10:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:10:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:10:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id EE4B815591B
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 13:09:39 +0000 (UTC)
Date: Thu, 19 Jan 2012 13:09:39 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <371969513.56013.1326978579988.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <481776123.9110.1325770179315.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3200) consistency check should get node ids
 in chunks, not rely on total count
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3200?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3200:
-------------------------------

    Fix Version/s:     (was: 2.6)
                   2.4

Looks good to me and works for simple tests, so I merged also this one to the 2.4 branch. Revision 1233349.
                
> consistency check should get node ids in chunks, not rely on total count
> ------------------------------------------------------------------------
>
>                 Key: JCR-3200
>                 URL: https://issues.apache.org/jira/browse/JCR-3200
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.4
>
>         Attachments: JCR-3200.diff
>
>
> The PM consistency checker should use the paging feature to fetch nodeIds in chunks, and also not rely on the total number of ids for logging purposes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33829-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 13:16:02 2012
Return-Path: <dev-return-33829-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C8E9A9A0A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 13:16:01 +0000 (UTC)
Received: (qmail 49077 invoked by uid 500); 19 Jan 2012 13:16:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 48996 invoked by uid 500); 19 Jan 2012 13:16:00 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 48988 invoked by uid 99); 19 Jan 2012 13:16:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:16:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:15:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id B2AEC155BC0
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 13:15:39 +0000 (UTC)
Date: Thu, 19 Jan 2012 13:15:39 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1923192908.56021.1326978939733.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1824991771.52841.1326900640223.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3212) add TCK test for Info map of
 NODE_MOVED event on node reordering
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3212?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13189093#comment-13189093 ] 

Jukka Zitting commented on JCR-3212:
------------------------------------

FTR, the relevant commit was in revision 1233069. Jira doesn't see it because the issue referenced in the commit was JCR-3207. I fixed the commit message afterwards with "svn propset --revprop svn:log".
                
> add TCK test for Info map of NODE_MOVED event on node reordering
> ----------------------------------------------------------------
>
>                 Key: JCR-3212
>                 URL: https://issues.apache.org/jira/browse/JCR-3212
>             Project: Jackrabbit Content Repository
>          Issue Type: Sub-task
>          Components: jackrabbit-jcr-tests, observation
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>
> add the TCK test for this problem, and mark this as known test failure for now

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33830-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 13:32:00 2012
Return-Path: <dev-return-33830-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 910429741
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 13:32:00 +0000 (UTC)
Received: (qmail 74532 invoked by uid 500); 19 Jan 2012 13:32:00 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 74457 invoked by uid 500); 19 Jan 2012 13:31:59 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 74445 invoked by uid 99); 19 Jan 2012 13:31:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:31:59 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:31:58 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 58CA51553C6
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 13:31:38 +0000 (UTC)
Date: Thu, 19 Jan 2012 13:31:38 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1157330625.56069.1326979898365.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1694948235.34137.1324440810712.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3189)
 JCARepositoryManager.createNonTransientRepository throws NPE with no
 JCAManagedConnectionFactory.CONFIGFILE_KEY
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3189?page=3Dcom.atlassian.j=
ira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=3D131891=
01#comment-13189101 ]=20

Jukka Zitting commented on JCR-3189:
------------------------------------

Merged to the 2.4 branch revision 1233365.
               =20
> JCARepositoryManager.createNonTransientRepository throws NPE with no JCAM=
anagedConnectionFactory.CONFIGFILE_KEY
> -------------------------------------------------------------------------=
--------------------------------------
>
>                 Key: JCR-3189
>                 URL: https://issues.apache.org/jira/browse/JCR-3189
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jca
>    Affects Versions: 2.3.5
>            Reporter: Dave Brosius
>            Assignee: Claus K=C3=B6ll
>            Priority: Minor
>             Fix For: 2.4
>
>
> JCARepositoryManager.createNonTransientRepository fails if
> String configFile =3D parameters.get(JCAManagedConnectionFactory.CONFIGFI=
LE_KEY);
> is null, because
> config =3D RepositoryConfig.create(configFile, homeDir);
> will always throw an NPE, perhaps the call should just be
> config =3D RepositoryConfig.create(homeDir);

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33831-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 13:39:03 2012
Return-Path: <dev-return-33831-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 42692994C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 13:39:03 +0000 (UTC)
Received: (qmail 95726 invoked by uid 500); 19 Jan 2012 13:39:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 95658 invoked by uid 500); 19 Jan 2012 13:39:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 95651 invoked by uid 99); 19 Jan 2012 13:39:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:39:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:39:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4244F15596E
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 13:38:41 +0000 (UTC)
Date: Thu, 19 Jan 2012 13:38:41 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1653169366.56087.1326980321272.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <322325411.15335.1323955710669.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3181) add test case for recovering from
 broken version history hierarchy
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3181?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3181:
-------------------------------

    Fix Version/s: 2.6
       Issue Type: Improvement  (was: Task)
    
> add test case for recovering from broken version history hierarchy
> ------------------------------------------------------------------
>
>                 Key: JCR-3181
>                 URL: https://issues.apache.org/jira/browse/JCR-3181
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, versioning
>    Affects Versions: 2.4
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>
> The test should exercise recovery from a missing parent node of a VHR.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33832-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 13:47:06 2012
Return-Path: <dev-return-33832-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 22CAA9B2E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 13:47:06 +0000 (UTC)
Received: (qmail 10709 invoked by uid 500); 19 Jan 2012 13:47:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 10240 invoked by uid 500); 19 Jan 2012 13:47:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 10233 invoked by uid 99); 19 Jan 2012 13:47:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:47:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 13:47:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CF5EF155E48
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 13:46:40 +0000 (UTC)
Date: Thu, 19 Jan 2012 13:46:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1085798433.56106.1326980800850.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1680393693.26131.1324301250664.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3185) refactor consistency checks in
 BundleDBPersistenceManager into a standalone class that could be re-used
 for other PMs
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3185?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3185:
-------------------------------

    Fix Version/s: 2.3.7
       Issue Type: Improvement  (was: Task)
    
> refactor consistency checks in BundleDBPersistenceManager into a standalone class that could be re-used for other PMs
> ---------------------------------------------------------------------------------------------------------------------
>
>                 Key: JCR-3185
>                 URL: https://issues.apache.org/jira/browse/JCR-3185
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.3.7
>
>         Attachments: JCR-3185.diff
>
>
> see subject

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33833-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 14:33:02 2012
Return-Path: <dev-return-33833-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3101391AF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 14:33:02 +0000 (UTC)
Received: (qmail 8468 invoked by uid 500); 19 Jan 2012 14:33:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 8421 invoked by uid 500); 19 Jan 2012 14:33:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 8412 invoked by uid 99); 19 Jan 2012 14:33:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 14:33:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 14:33:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id DE0FF1556F2
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 14:32:39 +0000 (UTC)
Date: Thu, 19 Jan 2012 14:32:39 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <779148975.56196.1326983559911.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1218050112.18303.1318321709720.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3107) Speed up hierarchy cache initialization
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3107?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3107:
--------------------------------

    Fix Version/s: 2.2.11
   =20
> Speed up hierarchy cache initialization
> ---------------------------------------
>
>                 Key: JCR-3107
>                 URL: https://issues.apache.org/jira/browse/JCR-3107
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, query
>            Reporter: Martin B=C3=B6ttcher
>             Fix For: 2.2.11, 2.3.2
>
>         Attachments: JCR-3107.patch
>
>
> Initializing a workspace can take quite a long time if there is a big num=
ber of nodes and some search indexes involved. The reason is that the setup=
 of the CachingIndexReader is processed using chunks of a certain size (act=
ually 400K) in order to reduce the memory footprint. As soon as the number =
of documents exceeds this limit some operations (actually traversing comple=
te indexes) are performed again and again.
> It seems that the current algorithm "initializeParents" in the CachingInd=
exReader class can't be optimized without increasing the memory consumption=
. Therefore it should be a promising approach to persist the "state" of thi=
s class (actually it's main member array and map) and reload it on startup.
> The "load" of the state can be done implicitly in the initializing phase =
of the cache. This is obvious. The correct point of time to call the "save"=
 operation isn't obvious at all. I tried the "doClose" method of the class =
and it seems sufficient.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33834-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 14:55:02 2012
Return-Path: <dev-return-33834-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C47C79818
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 14:55:02 +0000 (UTC)
Received: (qmail 49146 invoked by uid 500); 19 Jan 2012 14:55:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 49044 invoked by uid 500); 19 Jan 2012 14:55:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 49036 invoked by uid 99); 19 Jan 2012 14:55:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 14:55:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 14:55:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 41715155216
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 14:54:40 +0000 (UTC)
Date: Thu, 19 Jan 2012 14:54:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1768481840.56235.1326984880269.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <36102778.19491.1324044391021.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3184) extend ConsistencyChecker API to allow
 adoption of orphaned nodes to a to-be-specified parent node
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3184?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3184:
-------------------------------

    Issue Type: Improvement  (was: Task)
    
> extend ConsistencyChecker API to allow adoption of orphaned nodes to a to-be-specified parent node
> --------------------------------------------------------------------------------------------------
>
>                 Key: JCR-3184
>                 URL: https://issues.apache.org/jira/browse/JCR-3184
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.3.7
>
>         Attachments: JCR-3184.diff
>
>
> The optional ConsistencyChecker API on persistence managers allows analyzing and fixing storage inconsistencies. The current fixup code though does not attempt to "adopt" orphaned nodes.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33835-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 15:17:47 2012
Return-Path: <dev-return-33835-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6DA159054
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 15:17:47 +0000 (UTC)
Received: (qmail 84725 invoked by uid 500); 19 Jan 2012 15:17:47 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 84436 invoked by uid 500); 19 Jan 2012 15:17:46 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 84425 invoked by uid 99); 19 Jan 2012 15:17:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 15:17:46 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 15:17:44 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id F27A8C00A0;
	Thu, 19 Jan 2012 15:17:22 +0000 (UTC)
Date: Thu, 19 Jan 2012 15:17:22 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org, jukka.zitting@gmail.com
Message-ID: <241726763.741326986242991.JavaMail.hudson@aegis>
In-Reply-To: <815824954.231326965924596.JavaMail.hudson@aegis>
References: <815824954.231326965924596.JavaMail.hudson@aegis>
Subject: Jackrabbit-trunk - Build # 1822 - Fixed
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Apache Jenkins build system has built Jackrabbit-trunk (build #1822)

Status: Fixed

Check console output at https://builds.apache.org/job/Jackrabbit-trunk/1822/ to view the results.

From dev-return-33836-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 18:24:31 2012
Return-Path: <dev-return-33836-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 295E29124
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 18:24:31 +0000 (UTC)
Received: (qmail 26039 invoked by uid 500); 19 Jan 2012 18:24:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 25981 invoked by uid 500); 19 Jan 2012 18:24:30 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 25973 invoked by uid 99); 19 Jan 2012 18:24:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 18:24:29 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 18:24:24 +0000
Received: by wibhi18 with SMTP id hi18so402117wib.1
        for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 10:24:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        bh=yYK5FEuUnRpJTQstPua2bOr3azLrsfegET/hqowKifI=;
        b=xor6eEvGP47O5j/nQ5TvshAaUhgWIVPVit+ta9RfY+pwjOCvR0voOBP3rlbJ2NLxJx
         wsRCJcj0CjKSATFZNx/K/cJgEWCOkIVrRf27yJw0kSeB9R/SUpQZHfexAOBpQHJlEodw
         b7fdc7/ai3REtIY5KplGwmXlC5eDxWviY01Eo=
Received: by 10.180.106.202 with SMTP id gw10mr50760854wib.3.1326997442123;
 Thu, 19 Jan 2012 10:24:02 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Thu, 19 Jan 2012 10:23:41 -0800 (PST)
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Thu, 19 Jan 2012 19:23:41 +0100
Message-ID: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
Subject: [VOTE] Release Apache Jackrabbit 2.3.7
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1

Hi,

A candidate for the Jackrabbit 2.3.7 release is available at:

    http://people.apache.org/~jukka/jackrabbit/2.3.7/

The release candidate is a zip archive of the sources in:

    http://svn.apache.org/repos/asf/jackrabbit/tags/2.3.7/

The SHA1 checksum of the archive is f772f95a79edf2b45ed3fa18d86acd75a0cf0b06.

A staged Maven repository is available for review at:

    https://repository.apache.org/content/repositories/orgapachejackrabbit-098/

The command for running automated checks against this release candidate is:

    $ sh check-release.sh jukka 2.3.7 f772f95a79edf2b45ed3fa18d86acd75a0cf0b06

Please vote on releasing this package as Apache Jackrabbit 2.3.7.
The vote is open for the next 72 hours and passes if a majority of at
least three +1 Jackrabbit PMC votes are cast.

    [ ] +1 Release this package as Apache Jackrabbit 2.3.7
    [ ] -1 Do not release this package because...

My vote is +1.

BR,

Jukka Zitting

From dev-return-33837-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 19:15:04 2012
Return-Path: <dev-return-33837-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 51683995F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 19:15:04 +0000 (UTC)
Received: (qmail 40386 invoked by uid 500); 19 Jan 2012 19:15:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 40331 invoked by uid 500); 19 Jan 2012 19:15:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 40324 invoked by uid 99); 19 Jan 2012 19:15:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 19:15:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 19:15:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D74731568EE
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 19:14:39 +0000 (UTC)
Date: Thu, 19 Jan 2012 19:14:39 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1057620613.57167.1327000479883.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-3209.
---------------------------------

       Resolution: Fixed
    Fix Version/s: 2.6
    
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Task
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>         Attachments: JCR-3209.diff
>
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33838-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 19 19:17:04 2012
Return-Path: <dev-return-33838-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 21AE399FB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 19 Jan 2012 19:17:04 +0000 (UTC)
Received: (qmail 44550 invoked by uid 500); 19 Jan 2012 19:17:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 44489 invoked by uid 500); 19 Jan 2012 19:17:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 44482 invoked by uid 99); 19 Jan 2012 19:17:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 19:17:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 19 Jan 2012 19:17:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 13DE11569B5
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 19:16:40 +0000 (UTC)
Date: Thu, 19 Jan 2012 19:16:40 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1888272549.57175.1327000600082.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-1352) illegal format for WebDAV lock tokens
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-1352?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-1352.
---------------------------------

    Resolution: Duplicate
      Assignee: Julian Reschke
    
> illegal format for WebDAV lock tokens
> -------------------------------------
>
>                 Key: JCR-1352
>                 URL: https://issues.apache.org/jira/browse/JCR-1352
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>
> WebDAV lock tokens are URIs, while JCR lock tokens aren't. Therefore, the WebDAV servlet needs to transform outgoing JCR lock tokens (response headers and WebDAV properties) into URI format, and needs to parse the original lock token out of incoming WebDAV lock tokens (in request headers).
> Proposed mapping:
> - when the JCR lock token uses UUID format, use "urn:uuid",
> - otherwise encode with a constant prefix, such as "tag:jackrabbit.apache.org,2008:LockTokens."

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33839-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 00:09:54 2012
Return-Path: <dev-return-33839-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C4DBD99DF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 00:09:54 +0000 (UTC)
Received: (qmail 65632 invoked by uid 500); 20 Jan 2012 00:09:54 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 65553 invoked by uid 500); 20 Jan 2012 00:09:53 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 65546 invoked by uid 99); 20 Jan 2012 00:09:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 00:09:53 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of tripod@adobe.com designates 64.18.1.25 as permitted sender)
Received: from [64.18.1.25] (HELO exprod6og110.obsmtp.com) (64.18.1.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 00:09:44 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob110.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxiwsRMQKDVrdGkKZ1I7+85oZr4OihcV@postini.com; Thu, 19 Jan 2012 16:09:23 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0K07S0Y016225
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 16:07:28 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0K09IMM020794
	for <dev@jackrabbit.apache.org>; Thu, 19 Jan 2012 16:09:20 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 19 Jan 2012
 16:09:18 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Fri, 20 Jan 2012 00:09:16
 +0000
From: Tobias Bocanegra <tripod@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 20 Jan 2012 00:09:11 +0000
Subject: Re: [VOTE] Release Apache Jackrabbit 2.3.7
Thread-Topic: [VOTE] Release Apache Jackrabbit 2.3.7
Thread-Index: AczXB78M50JGkTjcQlqwZDgwzmthrA==
Message-ID: <CAB+dfimPv7a4NjC48kEzCS=DdNCQKUF=nFZHGVMBrxUVmCjP=Q@mail.gmail.com>
References: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
In-Reply-To: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

KiBkb3dubG9hZGVkIHRoZSB6aXAgYXJjaGl2ZSAob2spDQoqIHZlcmlmaWVkIGNoZWNrc3VtIChv
aykNCiogYnVpbHQgYW5kIHJ1biB0ZXN0cyAob2spDQoNCisxIFJlbGVhc2UgdGhpcyBwYWNrYWdl
IGFzIEFwYWNoZSBKYWNrcmFiYml0IDIuMy43DQoNCi0tDQp0b2J5DQoNCk9uIFRodSwgSmFuIDE5
LCAyMDEyIGF0IDEwOjIzIEFNLCBKdWtrYSBaaXR0aW5nIDxqdWtrYS56aXR0aW5nQGdtYWlsLmNv
bT4gd3JvdGU6DQo+IEhpLA0KPg0KPiBBIGNhbmRpZGF0ZSBmb3IgdGhlIEphY2tyYWJiaXQgMi4z
LjcgcmVsZWFzZSBpcyBhdmFpbGFibGUgYXQ6DQo+DQo+IMKgIMKgaHR0cDovL3Blb3BsZS5hcGFj
aGUub3JnL35qdWtrYS9qYWNrcmFiYml0LzIuMy43Lw0KPg0KPiBUaGUgcmVsZWFzZSBjYW5kaWRh
dGUgaXMgYSB6aXAgYXJjaGl2ZSBvZiB0aGUgc291cmNlcyBpbjoNCj4NCj4gwqAgwqBodHRwOi8v
c3ZuLmFwYWNoZS5vcmcvcmVwb3MvYXNmL2phY2tyYWJiaXQvdGFncy8yLjMuNy8NCj4NCj4gVGhl
IFNIQTEgY2hlY2tzdW0gb2YgdGhlIGFyY2hpdmUgaXMgZjc3MmY5NWE3OWVkZjJiNDVlZDNmYTE4
ZDg2YWNkNzVhMGNmMGIwNi4NCj4NCj4gQSBzdGFnZWQgTWF2ZW4gcmVwb3NpdG9yeSBpcyBhdmFp
bGFibGUgZm9yIHJldmlldyBhdDoNCj4NCj4gwqAgwqBodHRwczovL3JlcG9zaXRvcnkuYXBhY2hl
Lm9yZy9jb250ZW50L3JlcG9zaXRvcmllcy9vcmdhcGFjaGVqYWNrcmFiYml0LTA5OC8NCj4NCj4g
VGhlIGNvbW1hbmQgZm9yIHJ1bm5pbmcgYXV0b21hdGVkIGNoZWNrcyBhZ2FpbnN0IHRoaXMgcmVs
ZWFzZSBjYW5kaWRhdGUgaXM6DQo+DQo+IMKgIMKgJCBzaCBjaGVjay1yZWxlYXNlLnNoIGp1a2th
IDIuMy43IGY3NzJmOTVhNzllZGYyYjQ1ZWQzZmExOGQ4NmFjZDc1YTBjZjBiMDYNCj4NCj4gUGxl
YXNlIHZvdGUgb24gcmVsZWFzaW5nIHRoaXMgcGFja2FnZSBhcyBBcGFjaGUgSmFja3JhYmJpdCAy
LjMuNy4NCj4gVGhlIHZvdGUgaXMgb3BlbiBmb3IgdGhlIG5leHQgNzIgaG91cnMgYW5kIHBhc3Nl
cyBpZiBhIG1ham9yaXR5IG9mIGF0DQo+IGxlYXN0IHRocmVlICsxIEphY2tyYWJiaXQgUE1DIHZv
dGVzIGFyZSBjYXN0Lg0KPg0KPiDCoCDCoFsgXSArMSBSZWxlYXNlIHRoaXMgcGFja2FnZSBhcyBB
cGFjaGUgSmFja3JhYmJpdCAyLjMuNw0KPiDCoCDCoFsgXSAtMSBEbyBub3QgcmVsZWFzZSB0aGlz
IHBhY2thZ2UgYmVjYXVzZS4uLg0KPg0KPiBNeSB2b3RlIGlzICsxLg0KPg0KPiBCUiwNCj4NCj4g
SnVra2EgWml0dGluZw==

From dev-return-33840-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 06:32:02 2012
Return-Path: <dev-return-33840-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 407D1B5C5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 06:32:02 +0000 (UTC)
Received: (qmail 45958 invoked by uid 500); 20 Jan 2012 06:32:00 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 45570 invoked by uid 500); 20 Jan 2012 06:31:55 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 45563 invoked by uid 99); 20 Jan 2012 06:31:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 06:31:53 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.8.61.7] (HELO spamslammer1.tirol.gv.at) (194.8.61.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 06:31:47 +0000
From: =?iso-8859-1?Q?K=D6LL_Claus?= <C.KOELL@TIROL.GV.AT>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 20 Jan 2012 07:31:20 +0100
Subject: AW: [VOTE] Release Apache Jackrabbit 2.3.7
Thread-Topic: [VOTE] Release Apache Jackrabbit 2.3.7
Thread-Index: AczW15vE0ryewdEpSR+r2RoDotCwfgAZXzhA
Message-ID: <89934884426A01458CBE55947B042D7220AF1046D1@EXCHMCA.tirol.local>
References: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
In-Reply-To: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
Accept-Language: de-DE, en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

+1

greets
claus

From dev-return-33841-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 09:33:14 2012
Return-Path: <dev-return-33841-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7521BBB3A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 09:33:14 +0000 (UTC)
Received: (qmail 14983 invoked by uid 500); 20 Jan 2012 09:33:13 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 14418 invoked by uid 500); 20 Jan 2012 09:32:59 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 14350 invoked by uid 99); 20 Jan 2012 09:32:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 09:32:53 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.18 as permitted sender)
Received: from [64.18.2.18] (HELO exprod7og120.obsmtp.com) (64.18.2.18)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 20 Jan 2012 09:32:44 +0000
Received: from mail-tul01m020-f178.google.com ([209.85.214.178]) (using TLSv1) by exprod7ob120.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTxk0phMba6/wQdvDjuScnCjknqqvDfHT@postini.com; Fri, 20 Jan 2012 01:32:23 PST
Received: by mail-tul01m020-f178.google.com with SMTP id wc7so597058obb.23
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 01:32:22 -0800 (PST)
Received: by 10.182.51.67 with SMTP id i3mr24113664obo.78.1327051942346; Fri,
 20 Jan 2012 01:32:22 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Fri, 20 Jan 2012 01:32:01 -0800 (PST)
In-Reply-To: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
References: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Fri, 20 Jan 2012 10:32:01 +0100
Message-ID: <CAAOnkMsQkjQD4YAb4zdnh18=g9a78AW0tvr2at1ZttL=uQ5fUg@mail.gmail.com>
Subject: Re: [VOTE] Release Apache Jackrabbit 2.3.7
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Looking good!

+1

Regards,
Bart

On Thu, Jan 19, 2012 at 7:23 PM, Jukka Zitting <jukka.zitting@gmail.com> wr=
ote:
> Hi,
>
> A candidate for the Jackrabbit 2.3.7 release is available at:
>
> =A0 =A0http://people.apache.org/~jukka/jackrabbit/2.3.7/
>
> The release candidate is a zip archive of the sources in:
>
> =A0 =A0http://svn.apache.org/repos/asf/jackrabbit/tags/2.3.7/
>
> The SHA1 checksum of the archive is f772f95a79edf2b45ed3fa18d86acd75a0cf0=
b06.
>
> A staged Maven repository is available for review at:
>
> =A0 =A0https://repository.apache.org/content/repositories/orgapachejackra=
bbit-098/
>
> The command for running automated checks against this release candidate i=
s:
>
> =A0 =A0$ sh check-release.sh jukka 2.3.7 f772f95a79edf2b45ed3fa18d86acd75=
a0cf0b06
>
> Please vote on releasing this package as Apache Jackrabbit 2.3.7.
> The vote is open for the next 72 hours and passes if a majority of at
> least three +1 Jackrabbit PMC votes are cast.
>
> =A0 =A0[ ] +1 Release this package as Apache Jackrabbit 2.3.7
> =A0 =A0[ ] -1 Do not release this package because...
>
> My vote is +1.
>
> BR,
>
> Jukka Zitting



--=20
Amsterdam - Oosteinde 11, 1017 WT Amsterdam
Boston - 1 Broadway, Cambridge, MA 02142

US +1 877 414 4776 (toll free)
Europe +31(0)20 522 4466
www.onehippo.com

From dev-return-33842-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 13:55:03 2012
Return-Path: <dev-return-33842-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6E6C3BC15
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 13:55:03 +0000 (UTC)
Received: (qmail 84463 invoked by uid 500); 20 Jan 2012 13:55:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 84412 invoked by uid 500); 20 Jan 2012 13:55:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 84405 invoked by uid 99); 20 Jan 2012 13:55:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 13:55:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 13:55:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E2B82157226
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 13:54:39 +0000 (UTC)
Date: Fri, 20 Jan 2012 13:54:39 +0000 (UTC)
From: "David Buchmann (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2133173075.59940.1327067679930.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3205) Missing support for lock timeout and
 ownerHint in jcr-server
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13189812#comment-13189812 ] 

David Buchmann commented on JCR-3205:
-------------------------------------

thanks, the timeout is now taken into account by the server and works fine!


what still confuses me is the reply by the server for infinite timeout (before and after this fix):

<D:timeout>Second-2147483</D:timeout>

this number is
2^21+50331

which seems pretty random to me. coincidally, this number is exactly 2^31 - 1  (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?
                
> Missing support for lock timeout and ownerHint in jcr-server
> ------------------------------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>             Fix For: 2.3.7
>
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33843-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:00:14 2012
Return-Path: <dev-return-33843-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C978CBD6E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:00:14 +0000 (UTC)
Received: (qmail 90518 invoked by uid 500); 20 Jan 2012 14:00:14 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 90484 invoked by uid 500); 20 Jan 2012 14:00:13 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 90477 invoked by uid 99); 20 Jan 2012 14:00:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:00:13 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of david.buchmann@liip.ch designates 207.126.144.135 as permitted sender)
Received: from [207.126.144.135] (HELO eu1sys200aog113.obsmtp.com) (207.126.144.135)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:00:07 +0000
Received: from mail-ww0-f53.google.com ([74.125.82.53]) (using TLSv1) by eu1sys200aob113.postini.com ([207.126.147.11]) with SMTP
	ID DSNKTxlzUK7X1MSVbC2XQaocsQ3DsqSFroZy@postini.com; Fri, 20 Jan 2012 13:59:46 UTC
Received: by wgbdr1 with SMTP id dr1so598618wgb.10
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 05:59:44 -0800 (PST)
Received: by 10.180.19.168 with SMTP id g8mr52258621wie.4.1327067984617;
        Fri, 20 Jan 2012 05:59:44 -0800 (PST)
Received: from [10.0.0.105] (cust.static.109-164-240-33.swisscomdata.ch. [109.164.240.33])
        by mx.google.com with ESMTPS id n3sm9307629wiz.9.2012.01.20.05.59.41
        (version=SSLv3 cipher=OTHER);
        Fri, 20 Jan 2012 05:59:41 -0800 (PST)
Message-ID: <4F19734C.7060404@liip.ch>
Date: Fri, 20 Jan 2012 14:59:40 +0100
From: David Buchmann <david.buchmann@liip.ch>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.24) Gecko/20111108 Thunderbird/3.1.16
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
Subject: Re: [VOTE] Release Apache Jackrabbit 2.3.7
References: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
In-Reply-To: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
X-Enigmail-Version: 1.1.1
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

i ran the phpcr tests with jackalope and it looks good.

+1


the only surprise i had: we had one test with a (very weird) join query

SELECT data.zeronumber
FROM [nt:unstructured] AS data
    INNER JOIN [nt:unstructured] AS second
        ON data.[jcr:mimeType] = second.[jcr:mimeType]

WHERE data.zeronumber = 0

there is only one node that should match. up until 2.3.6 this gave 1 row
of results. 2.3.7 gives me 3 rows. i am not sure if the old behaviour
was a bug or if its simply not defined what should happen in this case.

i now test with a more sane join of two different types and that works
correctly.

cheers,david


Am 19.01.2012 19:23, schrieb Jukka Zitting:
> Hi,
> 
> A candidate for the Jackrabbit 2.3.7 release is available at:
> 
>     http://people.apache.org/~jukka/jackrabbit/2.3.7/
> 
> The release candidate is a zip archive of the sources in:
> 
>     http://svn.apache.org/repos/asf/jackrabbit/tags/2.3.7/
> 
> The SHA1 checksum of the archive is f772f95a79edf2b45ed3fa18d86acd75a0cf0b06.
> 
> A staged Maven repository is available for review at:
> 
>     https://repository.apache.org/content/repositories/orgapachejackrabbit-098/
> 
> The command for running automated checks against this release candidate is:
> 
>     $ sh check-release.sh jukka 2.3.7 f772f95a79edf2b45ed3fa18d86acd75a0cf0b06
> 
> Please vote on releasing this package as Apache Jackrabbit 2.3.7.
> The vote is open for the next 72 hours and passes if a majority of at
> least three +1 Jackrabbit PMC votes are cast.
> 
>     [ ] +1 Release this package as Apache Jackrabbit 2.3.7
>     [ ] -1 Do not release this package because...
> 
> My vote is +1.
> 
> BR,
> 
> Jukka Zitting

- -- 
Liip AG // Agile Web Development // T +41 26 422 25 11
CH-1700 Fribourg // PGP 0xA581808B // www.liip.ch
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk8Zc0gACgkQqBnXnqWBgItR9gCfTaAObe4Sw7puStFbXA76UzMB
maIAn0VoFEEAoyUUXAYPlD6sbGFnZFiG
=xPih
-----END PGP SIGNATURE-----

From dev-return-33844-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:23:03 2012
Return-Path: <dev-return-33844-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0A3F0B406
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:23:03 +0000 (UTC)
Received: (qmail 26807 invoked by uid 500); 20 Jan 2012 14:23:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 26719 invoked by uid 500); 20 Jan 2012 14:23:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 26711 invoked by uid 99); 20 Jan 2012 14:23:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:23:01 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.28 as permitted sender)
Received: from [64.18.2.28] (HELO exprod7og125.obsmtp.com) (64.18.2.28)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 20 Jan 2012 14:22:52 +0000
Received: from mail-tul01m020-f181.google.com ([209.85.214.181]) (using TLSv1) by exprod7ob125.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTxl4poDUXUqx4l1qzXyALfGydIzuonmz@postini.com; Fri, 20 Jan 2012 06:22:32 PST
Received: by obbup10 with SMTP id up10so906246obb.12
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 06:22:30 -0800 (PST)
Received: by 10.182.150.66 with SMTP id ug2mr27007915obb.68.1327069350452;
 Fri, 20 Jan 2012 06:22:30 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Fri, 20 Jan 2012 06:22:09 -0800 (PST)
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Fri, 20 Jan 2012 15:22:09 +0100
Message-ID: <CAAOnkMu--dU0iGNom9_q9mcwGWwfjVwP3-a0GRqMgfDoE-E1eg@mail.gmail.com>
Subject: Question about consistency checker and node ordering in queries
To: Jackrabbit Dev <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I was wondering about how the ConsistencyCheckerImpl fetches all the
node ids. The first set of node ids is fetched with
"pm.getAllNodeIds(null, NODESATONCE)" in the internalCheckConsistency
method. All subsequent sets are fetched with "pm.getAllNodeIds(lastId,
NODESATONCE)".

In the BundleDbPersistenceManager the method
getAllNodeIds(NodeId,maxCount) uses the "bundleSelectAllIdsSQL" if the
first parameter is null otherwise the "bundleSelectAllIdsFromSQL"
query. The  "bundleSelectAllIdsSQL" query doesn't use ordering and the
"bundleSelectAllIdsFromSQL" does.

Now my question is the following: souldn't the "bundleSelectAllIdsSQL"
also use an order clause to make sure the correct batch of node ids is
fetched the first time? Or is that somehow implicitly guaranteed?

Regards,
Bart

From dev-return-33845-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:23:05 2012
Return-Path: <dev-return-33845-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E6ABDB415
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:23:04 +0000 (UTC)
Received: (qmail 27291 invoked by uid 500); 20 Jan 2012 14:23:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 27242 invoked by uid 500); 20 Jan 2012 14:23:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 27235 invoked by uid 99); 20 Jan 2012 14:23:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:23:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:23:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D14A615730B
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 14:22:39 +0000 (UTC)
Date: Fri, 20 Jan 2012 14:22:39 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1773712790.60027.1327069359858.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3205) Missing support for lock timeout and
 ownerHint in jcr-server
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13189822#comment-13189822 ] 

Julian Reschke commented on JCR-3205:
-------------------------------------

Looks like a problem mapping Long.MAX_LONG to Infinite. Could you please open a separate ticket?
                
> Missing support for lock timeout and ownerHint in jcr-server
> ------------------------------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>             Fix For: 2.3.7
>
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33846-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:31:06 2012
Return-Path: <dev-return-33846-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2561CBE00
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:31:06 +0000 (UTC)
Received: (qmail 39047 invoked by uid 500); 20 Jan 2012 14:31:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 38998 invoked by uid 500); 20 Jan 2012 14:31:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 38991 invoked by uid 99); 20 Jan 2012 14:31:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:31:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:31:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1CC2E15775D
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 14:30:41 +0000 (UTC)
Date: Fri, 20 Jan 2012 14:30:41 +0000 (UTC)
From: "David Buchmann (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

[Lock] weird number for "infinite"
----------------------------------

                 Key: JCR-3214
                 URL: https://issues.apache.org/jira/browse/JCR-3214
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-jcr-server, locks
            Reporter: David Buchmann


(this is a follow-up of JCR-3205)

i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):


<D:timeout>Second-2147483</D:timeout>

this number is
2^21+50331

which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?


--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33847-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:35:02 2012
Return-Path: <dev-return-33847-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4070BBE6B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:35:02 +0000 (UTC)
Received: (qmail 43238 invoked by uid 500); 20 Jan 2012 14:35:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 43175 invoked by uid 500); 20 Jan 2012 14:35:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 43165 invoked by uid 99); 20 Jan 2012 14:35:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:35:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:34:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CD6291578D3
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 14:34:39 +0000 (UTC)
Date: Fri, 20 Jan 2012 14:34:39 +0000 (UTC)
From: "David Buchmann (Closed) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1690781124.60052.1327070079842.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1731217071.33734.1326356618851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Closed] (JCR-3205) Missing support for lock timeout and
 ownerHint in jcr-server
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3205?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

David Buchmann closed JCR-3205.
-------------------------------

    
> Missing support for lock timeout and ownerHint in jcr-server
> ------------------------------------------------------------
>
>                 Key: JCR-3205
>                 URL: https://issues.apache.org/jira/browse/JCR-3205
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>            Assignee: angela
>             Fix For: 2.3.7
>
>         Attachments: tcpdump.log
>
>
> trying to set the lock timeout when creating a lock seems not to work over the davex transport. the timeout is always 2147483.
> this was my test code:
> import javax.jcr.*;
> import javax.jcr.lock.*;
> import org.apache.jackrabbit.jcr2spi.RepositoryImpl;
> import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
> String url = "http://localhost:8080/server/";
> String workspace = "tests";
> RepositoryConfig config = new RepositoryConfigImplTest(repoUrl);
> Repository repo = RepositoryImpl.create(config);
> Credentials sc = new SimpleCredentials("admin","admin".toCharArray());
> Session s = repo.login(sc,workspace);
> Node t;
> if (s.getRootNode().hasNode("test")) {
>     t = s.getRootNode().getNode("test");
> } else {
>     t = s.getRootNode().addNode("test", "nt:unstructured");
> }
> t.addMixin("mix:lockable");
> s.save();
> LockManager m = s.getWorkspace().getLockManager();
> Lock l = m.lock(t.getPath(), false, true, 10, "me");
> System.out.println(l.getSecondsRemaining());
> and the output is 2147483
> the relevant communication fragment is below, i attach the full trace in case i miss something.
> LOCK /server/tests/jcr%3aroot/test HTTP/1.1
> Timeout: Second-10
> Depth: 0
> Link: <urn:uuid0c740bb9-042a-4ef2-b019-1a6c52784c29>; rel="http://www.day.com/jcr/webdav/1.0/session-id"
> Authorization: Basic YWRtaW46YWRtaW4=
> User-Agent: Jakarta Commons-HttpClient/3.0
> Host: localhost:8080
> Content-Length: 254
> Content-Type: text/xml; charset=UTF-8
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:lockinfo xmlns:D="DAV:"><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:owner>me</D:owner></D:lockinfo>
> HTTP/1.1 200 OK
> Content-Type: text/xml; charset=utf-8
> Content-Length: 450
> Lock-Token: <aa724c28-3c24-41e8-a3b4-9fc129adf732>
> Server: Jetty(6.1.x)
> <?xml version="1.0" encoding="UTF-8" standalone="no"?><D:prop xmlns:D="DAV:"><D:lockdiscovery><D:activelock><D:lockscope><dcr:exclusive-session-scoped xmlns:dcr="http://www.day.com/jcr/webdav/1.0"/></D:lockscope><D:locktype><D:write/></D:locktype><D:depth>0</D:depth><D:timeout>Second-2147483</D:timeout><D:owner>admin</D:owner><D:locktoken><D:href>aa724c28-3c24-41e8-a3b4-9fc129adf732</D:href></D:locktoken></D:activelock></D:lockdiscovery></D:prop>
> by the way: if i do not explicitly logout before the program exits, the lock is also not released even though it is session based. should the session not trigger a logout on destruction?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33848-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:39:56 2012
Return-Path: <dev-return-33848-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 23939BFB0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:39:56 +0000 (UTC)
Received: (qmail 50544 invoked by uid 500); 20 Jan 2012 14:39:55 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 50499 invoked by uid 500); 20 Jan 2012 14:39:54 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 50492 invoked by uid 99); 20 Jan 2012 14:39:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:39:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of julian.reschke@gmx.de designates 213.165.64.23 as permitted sender)
Received: from [213.165.64.23] (HELO mailout-de.gmx.net) (213.165.64.23)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 20 Jan 2012 14:39:45 +0000
Received: (qmail invoked by alias); 20 Jan 2012 14:39:24 -0000
Received: from mail.greenbytes.de (EHLO [192.168.1.140]) [217.91.35.233]
  by mail.gmx.net (mp059) with SMTP; 20 Jan 2012 15:39:24 +0100
X-Authenticated: #1915285
X-Provags-ID: V01U2FsdGVkX1+3+5NnK9K3I4VpCk8T9yXJS5sUY0mM4luWG6ORFP
	UKwMEyilqrB3J/
Message-ID: <4F197C96.7040603@gmx.de>
Date: Fri, 20 Jan 2012 15:39:18 +0100
From: Julian Reschke <julian.reschke@gmx.de>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
CC: Bart van der Schans <b.vanderschans@onehippo.com>
Subject: Re: Question about consistency checker and node ordering in queries
References: <CAAOnkMu--dU0iGNom9_q9mcwGWwfjVwP3-a0GRqMgfDoE-E1eg@mail.gmail.com>
In-Reply-To: <CAAOnkMu--dU0iGNom9_q9mcwGWwfjVwP3-a0GRqMgfDoE-E1eg@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0
X-Virus-Checked: Checked by ClamAV on apache.org

On 2012-01-20 15:22, Bart van der Schans wrote:
> Hi all,
>
> I was wondering about how the ConsistencyCheckerImpl fetches all the
> node ids. The first set of node ids is fetched with
> "pm.getAllNodeIds(null, NODESATONCE)" in the internalCheckConsistency
> method. All subsequent sets are fetched with "pm.getAllNodeIds(lastId,
> NODESATONCE)".
>
> In the BundleDbPersistenceManager the method
> getAllNodeIds(NodeId,maxCount) uses the "bundleSelectAllIdsSQL" if the
> first parameter is null otherwise the "bundleSelectAllIdsFromSQL"
> query. The  "bundleSelectAllIdsSQL" query doesn't use ordering and the
> "bundleSelectAllIdsFromSQL" does.
>
> Now my question is the following: souldn't the "bundleSelectAllIdsSQL"
> also use an order clause to make sure the correct batch of node ids is
> fetched the first time? Or is that somehow implicitly guaranteed?

Good question. I was confused about that as well. I tried and stepped 
through he code and everything seem to worked as advertised, so I 
stopped worrying about it :-)


From dev-return-33849-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:45:17 2012
Return-Path: <dev-return-33849-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A5B34B0E1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:45:17 +0000 (UTC)
Received: (qmail 58774 invoked by uid 500); 20 Jan 2012 14:45:17 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 58727 invoked by uid 500); 20 Jan 2012 14:45:16 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 58720 invoked by uid 99); 20 Jan 2012 14:45:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:45:16 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.22 as permitted sender)
Received: from [64.18.2.22] (HELO exprod7og122.obsmtp.com) (64.18.2.22)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 20 Jan 2012 14:45:08 +0000
Received: from mail-tul01m020-f176.google.com ([209.85.214.176]) (using TLSv1) by exprod7ob122.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTxl93xtYVj4Ib+BHUjRHZrRn8dx4b/YE@postini.com; Fri, 20 Jan 2012 06:44:48 PST
Received: by mail-tul01m020-f176.google.com with SMTP id wp18so1067380obc.35
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 06:44:47 -0800 (PST)
Received: by 10.182.15.105 with SMTP id w9mr27022506obc.18.1327070687371; Fri,
 20 Jan 2012 06:44:47 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Fri, 20 Jan 2012 06:44:25 -0800 (PST)
In-Reply-To: <4F197C96.7040603@gmx.de>
References: <CAAOnkMu--dU0iGNom9_q9mcwGWwfjVwP3-a0GRqMgfDoE-E1eg@mail.gmail.com>
 <4F197C96.7040603@gmx.de>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Fri, 20 Jan 2012 15:44:25 +0100
Message-ID: <CAAOnkMtvXfqV=ORhPz6kN1sd+8W3__MpXW4-ZVQ6oy49y_MphA@mail.gmail.com>
Subject: Re: Question about consistency checker and node ordering in queries
To: Julian Reschke <julian.reschke@gmx.de>
Cc: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Jan 20, 2012 at 3:39 PM, Julian Reschke <julian.reschke@gmx.de> wro=
te:
> On 2012-01-20 15:22, Bart van der Schans wrote:
>>
>> Hi all,
>>
>> I was wondering about how the ConsistencyCheckerImpl fetches all the
>> node ids. The first set of node ids is fetched with
>> "pm.getAllNodeIds(null, NODESATONCE)" in the internalCheckConsistency
>> method. All subsequent sets are fetched with "pm.getAllNodeIds(lastId,
>> NODESATONCE)".
>>
>> In the BundleDbPersistenceManager the method
>> getAllNodeIds(NodeId,maxCount) uses the "bundleSelectAllIdsSQL" if the
>> first parameter is null otherwise the "bundleSelectAllIdsFromSQL"
>> query. The =A0"bundleSelectAllIdsSQL" query doesn't use ordering and the
>> "bundleSelectAllIdsFromSQL" does.
>>
>> Now my question is the following: souldn't the "bundleSelectAllIdsSQL"
>> also use an order clause to make sure the correct batch of node ids is
>> fetched the first time? Or is that somehow implicitly guaranteed?
>
>
> Good question. I was confused about that as well. I tried and stepped
> through he code and everything seem to worked as advertised, so I stopped
> worrying about it :-)

I think (at least on mysql) we're just lucky that the natural ordering
is by NODE_ID:

mysql> SELECT hex(NODE_ID) FROM VERSION_BUNDLE ORDER BY NODE_ID LIMIT 0,10;
+----------------------------------+
| hex(NODE_ID)                     |
+----------------------------------+
| 000005E87E6D402BA27CDF41E7999D8A |
| 000007DC02CF48BA8FFEDA5F566A3A98 |
| 00000C4A81744934B4F0CB55C9967378 |
| 000016C9E4464C4FA7B6F4B9CF2F9903 |
| 00001D5A1C6F4339B317BB436AA54431 |
| 0000257D67AB4F1EA4DDEDB84BB13039 |
| 00002C51F22145B89F59E882BB505036 |
| 00002F2AFC2E4842863C360B68A36BDA |
| 0000354F151945CEA953D62C922A4FAC |
| 00003C0254C8471E8349C0B6F0DEFDC2 |
+----------------------------------+
10 rows in set (0.00 sec)

mysql> SELECT hex(NODE_ID) FROM VERSION_BUNDLE LIMIT 0,10;
+----------------------------------+
| hex(NODE_ID)                     |
+----------------------------------+
| 000005E87E6D402BA27CDF41E7999D8A |
| 000007DC02CF48BA8FFEDA5F566A3A98 |
| 00000C4A81744934B4F0CB55C9967378 |
| 000016C9E4464C4FA7B6F4B9CF2F9903 |
| 00001D5A1C6F4339B317BB436AA54431 |
| 0000257D67AB4F1EA4DDEDB84BB13039 |
| 00002C51F22145B89F59E882BB505036 |
| 00002F2AFC2E4842863C360B68A36BDA |
| 0000354F151945CEA953D62C922A4FAC |
| 00003C0254C8471E8349C0B6F0DEFDC2 |
+----------------------------------+
10 rows in set (0.00 sec)

But that doesn't have to be the case with other databases. Maybe
somebody can try similar queries on another database?

Regards,
bart

From dev-return-33850-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 14:56:03 2012
Return-Path: <dev-return-33850-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E98A4B1A6
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 14:56:02 +0000 (UTC)
Received: (qmail 64661 invoked by uid 500); 20 Jan 2012 14:56:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 64547 invoked by uid 500); 20 Jan 2012 14:56:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 64529 invoked by uid 99); 20 Jan 2012 14:56:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:56:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 14:56:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 0FB06158233
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 14:55:40 +0000 (UTC)
Date: Fri, 20 Jan 2012 14:55:40 +0000 (UTC)
From: "Julian Reschke (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <391238749.60096.1327071340065.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3214?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke reassigned JCR-3214:
-----------------------------------

    Assignee: Julian Reschke
    
> [Lock] weird number for "infinite"
> ----------------------------------
>
>                 Key: JCR-3214
>                 URL: https://issues.apache.org/jira/browse/JCR-3214
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>
> (this is a follow-up of JCR-3205)
> i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):
> <D:timeout>Second-2147483</D:timeout>
> this number is
> 2^21+50331
> which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33851-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:08:07 2012
Return-Path: <dev-return-33851-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 69446B4B3
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:08:07 +0000 (UTC)
Received: (qmail 80911 invoked by uid 500); 20 Jan 2012 15:08:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 80854 invoked by uid 500); 20 Jan 2012 15:08:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 80847 invoked by uid 99); 20 Jan 2012 15:08:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:08:06 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:08:04 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id F2E821587FF
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 15:07:42 +0000 (UTC)
Date: Fri, 20 Jan 2012 15:07:42 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <617797750.60141.1327072062996.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3214?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13189843#comment-13189843 ] 

Julian Reschke commented on JCR-3214:
-------------------------------------

DomUtil.timeoutToXml:

     * Note, that {@link DavConstants#INFINITE_TIMEOUT} is not represented by the String
     * {@link DavConstants#TIMEOUT_INFINITE 'Infinite'} defined by RFC 2518, due to a known
     * issue with Microsoft Office that opens the document "read only" and
     * never unlocks the resource if the timeout is missing or 'Infinite'.

So what happens is that the servlet internall uses MAX_INT as infinite, but then doesn't treat is as a special value, and also divides by 1000 (ms -> s).

Not sure what's the best fix here; do we know whether Office still has this problem?
                
> [Lock] weird number for "infinite"
> ----------------------------------
>
>                 Key: JCR-3214
>                 URL: https://issues.apache.org/jira/browse/JCR-3214
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>
> (this is a follow-up of JCR-3205)
> i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):
> <D:timeout>Second-2147483</D:timeout>
> this number is
> 2^21+50331
> which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33852-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:09:59 2012
Return-Path: <dev-return-33852-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 40550B504
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:09:59 +0000 (UTC)
Received: (qmail 82242 invoked by uid 500); 20 Jan 2012 15:09:58 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 82188 invoked by uid 500); 20 Jan 2012 15:09:58 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 82181 invoked by uid 99); 20 Jan 2012 15:09:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:09:58 +0000
X-ASF-Spam-Status: No, hits=-0.1 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mueller@adobe.com designates 64.18.1.185 as permitted sender)
Received: from [64.18.1.185] (HELO exprod6og103.obsmtp.com) (64.18.1.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:09:47 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob103.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxmDpbEP6LNH7tvg5RXhdx85YK2YVJ8y@postini.com; Fri, 20 Jan 2012 07:09:27 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KF7W0Y023626
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:07:32 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KF9PMM024096
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:09:25 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Fri, 20 Jan
 2012 07:09:25 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Fri, 20 Jan 2012 15:09:23
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 20 Jan 2012 15:09:17 +0000
Subject: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczXhX4dSXy7XRtuRXaqMaRZStbZUQ==
Message-ID: <CB3F422D.22F20%mueller@adobe.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_CB3F422D22F20muelleradobecom_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_CB3F422D22F20muelleradobecom_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,

The current Jackrabbit implementation uses orderable child nodes by default=
, meaning nodes are returned in the same order as they are created. As an e=
xample, if I create the nodes /test/c, then /test/b, and then /test/a, and =
then read the node list, I will get them back in that same order. I'm wonde=
ring if this is really required (at all, and to be the default behavior). S=
pecially if there are a lot of child nodes.

Instead of using the insertion order, I propose to sort the child node list=
 alphabetically: /test/a, /test/b, /test/c - no matter in what order the no=
des where created. This will allow an efficient lookup (using binary search=
), and for large child node lists (more than one thousand child nodes per n=
ode) modifications would be about twice as fast as using insertion order (p=
lus it would need less disk space).

Would it be a problem if Jackrabbit 3 sorts child nodes by name (always, or=
 at least by default)?

Another option would be to use (insertion) order until the child node list =
gets too large (for example 1000 elements), and from then on sort the child=
 nodes by name (the previous ordering would then be lost).

Regards,
Thomas


--_000_CB3F422D22F20muelleradobecom_
Content-Type: text/html; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<html><head></head><body style=3D"word-wrap: break-word; -webkit-nbsp-mode:=
 space; -webkit-line-break: after-white-space; color: rgb(0, 0, 0); font-si=
ze: 14px; font-family: Calibri, sans-serif; "><div>Hi,</div><div><br></div>=
<div>The current Jackrabbit implementation uses orderable child nodes by de=
fault, meaning nodes are returned in the same order as they are created. As=
 an example, if I create the nodes&nbsp;/test/c, then&nbsp;/test/b, and the=
n&nbsp;/test/a, and then read the node list, I will get them back in that s=
ame order.&nbsp;I'm wondering if this is really required (at all, and to be=
 the default behavior). Specially if there are a lot of child nodes.</div><=
div><br></div><div>Instead of using the insertion order, I propose to sort =
the child node list alphabetically: /test/a, /test/b, /test/c - no matter i=
n what order the nodes where created. This will allow an efficient lookup (=
using binary search), and for large child node lists (more than one thousan=
d child nodes per node) modifications would be about twice as fast as using=
 insertion order (plus it would need less disk space).</div><div><br></div>=
<div>Would it be a problem if Jackrabbit 3 sorts child nodes by name (alway=
s, or at least by default)?&nbsp;</div><div><br></div><div>Another option w=
ould be to use (insertion) order until the child node list gets too large (=
for example 1000 elements), and from then on sort the child nodes by name (=
the previous ordering would then be lost).</div><div><br></div><div>Regards=
,</div><div>Thomas</div><div><br></div></body></html>

--_000_CB3F422D22F20muelleradobecom_--

From dev-return-33853-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:10:07 2012
Return-Path: <dev-return-33853-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F2B66B54A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:10:06 +0000 (UTC)
Received: (qmail 83250 invoked by uid 500); 20 Jan 2012 15:10:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 83191 invoked by uid 500); 20 Jan 2012 15:10:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 83182 invoked by uid 99); 20 Jan 2012 15:10:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:10:06 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:10:03 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id AA8991588B2
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 15:09:42 +0000 (UTC)
Date: Fri, 20 Jan 2012 15:09:42 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <944562326.60146.1327072182699.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3214?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13189844#comment-13189844 ] 

Julian Reschke commented on JCR-3214:
-------------------------------------

Speaking of which, as far as I recall Office uses a lock time out of 300s, and just was confused when the server did not respect the timeout.

Now that the server *does* respect timeouts, the workaround may not be needed anymore.
                
> [Lock] weird number for "infinite"
> ----------------------------------
>
>                 Key: JCR-3214
>                 URL: https://issues.apache.org/jira/browse/JCR-3214
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>
> (this is a follow-up of JCR-3205)
> i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):
> <D:timeout>Second-2147483</D:timeout>
> this number is
> 2^21+50331
> which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33854-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:26:58 2012
Return-Path: <dev-return-33854-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5FCB8B62E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:26:58 +0000 (UTC)
Received: (qmail 25673 invoked by uid 500); 20 Jan 2012 15:26:58 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 25600 invoked by uid 500); 20 Jan 2012 15:26:57 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 25592 invoked by uid 99); 20 Jan 2012 15:26:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:26:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of julian.reschke@gmx.de designates 213.165.64.22 as permitted sender)
Received: from [213.165.64.22] (HELO mailout-de.gmx.net) (213.165.64.22)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 20 Jan 2012 15:26:48 +0000
Received: (qmail invoked by alias); 20 Jan 2012 15:26:27 -0000
Received: from mail.greenbytes.de (EHLO [192.168.1.140]) [217.91.35.233]
  by mail.gmx.net (mp070) with SMTP; 20 Jan 2012 16:26:27 +0100
X-Authenticated: #1915285
X-Provags-ID: V01U2FsdGVkX19DSkAEHsJDDtKaPiYNmTv2UYY+mp2Jdq2oJLOjR8
	MokMhz2dX5rgiX
Message-ID: <4F1987A0.3080000@gmx.de>
Date: Fri, 20 Jan 2012 16:26:24 +0100
From: Julian Reschke <julian.reschke@gmx.de>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
CC: Thomas Mueller <mueller@adobe.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
References: <CB3F422D.22F20%mueller@adobe.com>
In-Reply-To: <CB3F422D.22F20%mueller@adobe.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0
X-Virus-Checked: Checked by ClamAV on apache.org

On 2012-01-20 16:09, Thomas Mueller wrote:
> Hi,
>
> The current Jackrabbit implementation uses orderable child nodes by
> default, meaning nodes are returned in the same order as they are
> created. As an example, if I create the nodes /test/c, then /test/b, and
> then /test/a, and then read the node list, I will get them back in that
> same order. I'm wondering if this is really required (at all, and to be
> the default behavior). Specially if there are a lot of child nodes.
>
> Instead of using the insertion order, I propose to sort the child node
> list alphabetically: /test/a, /test/b, /test/c - no matter in what order
> the nodes where created. This will allow an efficient lookup (using
> binary search), and for large child node lists (more than one thousand
> child nodes per node) modifications would be about twice as fast as
> using insertion order (plus it would need less disk space).
>
> Would it be a problem if Jackrabbit 3 sorts child nodes by name (always,
> or at least by default)?
> ...

Spec-wise the returned ordering shouldn't matter unless the node type 
indicates that the child nodes are indeed ordered.

If we suspect that there's code out there making other assumptions, we 
may want to change that in an earlier jackrabbit release to find out for 
sure :-)

From dev-return-33855-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:36:11 2012
Return-Path: <dev-return-33855-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8D246B38D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:36:11 +0000 (UTC)
Received: (qmail 47848 invoked by uid 500); 20 Jan 2012 15:36:11 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 47788 invoked by uid 500); 20 Jan 2012 15:36:10 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 47780 invoked by uid 99); 20 Jan 2012 15:36:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:36:10 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mueller@adobe.com designates 64.18.1.39 as permitted sender)
Received: from [64.18.1.39] (HELO exprod6og117.obsmtp.com) (64.18.1.39)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:36:02 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob117.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxmJy3E6sInG2ZhNI2FX77sET9jDniJ8@postini.com; Fri, 20 Jan 2012 07:35:42 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KFXk0Y026121;
	Fri, 20 Jan 2012 07:33:46 -0800 (PST)
Received: from nacas02.corp.adobe.com (nacas02.corp.adobe.com [10.8.189.100])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0KFYvPx019771;
	Fri, 20 Jan 2012 07:35:37 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas02.corp.adobe.com
 (10.8.189.100) with Microsoft SMTP Server (TLS) id 8.3.192.1; Fri, 20 Jan
 2012 07:35:29 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Fri, 20 Jan 2012 15:35:27
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "julian.reschke@gmx.de" <julian.reschke@gmx.de>,
        "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 20 Jan 2012 15:35:24 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczXiSJ1qvbLvZXATkG40nrQ+Pzo2Q==
Message-ID: <CB3F470C.22F2F%mueller@adobe.com>
In-Reply-To: <4F1987A0.3080000@gmx.de>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I guess one problem is that the default node type, nt:unstructured,
supports orderable child nodes:
http://www.day.com/specs/jcr/2.0/3_Repository_Model.html#3.7.13.1%20nt:unst
ructured "This node type also supports client-orderable child nodes." I
guess "client-orderable" also means "insertion order".

If we use alphabetical child node lists by default for Jackrabbit 3, then
we would need to use a different default node type? Is it even possible to
use a different node type than nt:unstructured in Jackrabbit 3?

Regards,
Thomas



On 1/20/12 4:26 PM, "julian.reschke@gmx.de" <julian.reschke@gmx.de> wrote:

>On 2012-01-20 16:09, Thomas Mueller wrote:
>> Hi,
>>
>> The current Jackrabbit implementation uses orderable child nodes by
>> default, meaning nodes are returned in the same order as they are
>> created. As an example, if I create the nodes /test/c, then /test/b, and
>> then /test/a, and then read the node list, I will get them back in that
>> same order. I'm wondering if this is really required (at all, and to be
>> the default behavior). Specially if there are a lot of child nodes.
>>
>> Instead of using the insertion order, I propose to sort the child node
>> list alphabetically: /test/a, /test/b, /test/c - no matter in what order
>> the nodes where created. This will allow an efficient lookup (using
>> binary search), and for large child node lists (more than one thousand
>> child nodes per node) modifications would be about twice as fast as
>> using insertion order (plus it would need less disk space).
>>
>> Would it be a problem if Jackrabbit 3 sorts child nodes by name (always,
>> or at least by default)?
>> ...
>
>Spec-wise the returned ordering shouldn't matter unless the node type
>indicates that the child nodes are indeed ordered.
>
>If we suspect that there's code out there making other assumptions, we
>may want to change that in an earlier jackrabbit release to find out for
>sure :-)


From dev-return-33856-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:43:48 2012
Return-Path: <dev-return-33856-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 930EDB562
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:43:48 +0000 (UTC)
Received: (qmail 55868 invoked by uid 500); 20 Jan 2012 15:43:48 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 55836 invoked by uid 500); 20 Jan 2012 15:43:47 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 55829 invoked by uid 99); 20 Jan 2012 15:43:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:43:47 +0000
X-ASF-Spam-Status: No, hits=0.9 required=5.0
	tests=FRT_ADOBE2,HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aklimets@adobe.com designates 64.18.1.187 as permitted sender)
Received: from [64.18.1.187] (HELO exprod6og104.obsmtp.com) (64.18.1.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:43:38 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob104.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxmLlZ5WMb831B6ma9piyXA+GbypAvY+@postini.com; Fri, 20 Jan 2012 07:43:18 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KFfN0Y026837
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:41:24 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0KFhFPl022012
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:43:15 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Fri, 20 Jan 2012
 07:43:14 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Fri, 20 Jan 2012 15:43:12
 +0000
From: Alexander Klimetschek <aklimets@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 20 Jan 2012 15:43:11 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczXije6OAH8ujl2QHmWi15MXOkzkA==
Message-ID: <CB3F4492.A021D%aklimets@adobe.com>
In-Reply-To: <CB3F422D.22F20%mueller@adobe.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: de-DE, en-US
Content-Type: multipart/alternative;
	boundary="_000_CB3F4492A021Daklimetsadobecom_"
MIME-Version: 1.0

--_000_CB3F4492A021Daklimetsadobecom_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

On 20.01.12 16:09, "Thomas Mueller" <mueller@adobe.com<mailto:mueller@adobe=
.com>> wrote:

The current Jackrabbit implementation uses orderable child nodes by default=
, meaning nodes are returned in the same order as they are created.

I think "same order as they are created" is not really "orderable child nod=
es" - if a node does not have the orderable flag, you cannot re-order them =
(through the API). I'd call this default behavior simply "appending". And I=
 think for nodes with the orderable flag, this is a good default behaviour =
and shouldn't be changed....

Instead of using the insertion order, I propose to sort the child node list=
 alphabetically: /test/a, /test/b, /test/c - no matter in what order the no=
des where created.

...but for non-orderable nodes (i.e. a big "bunch") I agree that alphabetic=
al order by default is good.

Based on experience, all the UIs for non-orderable nodes (e.g nt:hierarchyN=
odes) end up doing alphabetical ordering anyway (for the default view and i=
f they don't allow for custom display ordering), as that's what makes it ea=
sy for humans to find the way around.

This will allow an efficient lookup (using binary search), and for large ch=
ild node lists (more than one thousand child nodes per node) modifications =
would be about twice as fast as using insertion order (plus it would need l=
ess disk space).

Isn't the current appending the simplest and fastest?

Would it be a problem if Jackrabbit 3 sorts child nodes by name (always, or=
 at least by default)?

Yes, but for non-orderable nodes only, of course.

For orderable nodes I think a goal should be to keep the list ordered the w=
hole stack down (API, in-memory, in-between formats (like json) and persist=
ence layer), to handle it efficiently. I.e. without any "ordering number" c=
olumn and thus requiring re-orderings at some level.

Another option would be to use (insertion) order until the child node list =
gets too large (for example 1000 elements), and from then on sort the child=
 nodes by name (the previous ordering would then be lost).

Hmm, that would take away the benefit of the alphabetical default order, as=
 applications would still need to order it alphabetically in UIs (for the l=
ists shorter than 1000 elements).

Cheers,
Alex

--
Alexander Klimetschek
Developer // Adobe (Day) // Berlin - Basel

--_000_CB3F4492A021Daklimetsadobecom_
Content-Type: text/html; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<html><head></head><body style=3D"word-wrap: break-word; -webkit-nbsp-mode:=
 space; -webkit-line-break: after-white-space; color: rgb(0, 0, 0); font-si=
ze: 14px; font-family: 'Adobe Clean', sans-serif; "><span id=3D"OLK_SRC_BOD=
Y_SECTION"><div><div>On 20.01.12 16:09, "Thomas Mueller" &lt;<a href=3D"mai=
lto:mueller@adobe.com">mueller@adobe.com</a>&gt; wrote:</div></div><div><br=
></div><blockquote id=3D"MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE" style=3D"BORDE=
R-LEFT: #b5c4df 5 solid; PADDING:0 0 0 5; MARGIN:0 0 0 5;"><div><div style=
=3D"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: af=
ter-white-space; color: rgb(0, 0, 0); font-size: 14px; font-family: Calibri=
, sans-serif; "><div>The current Jackrabbit implementation uses orderable c=
hild nodes by default, meaning nodes are returned in the same order as they=
 are created.</div></div></div></blockquote></span><div><br></div><div>I th=
ink "same order as they are created" is not really "orderable child nodes" =
- if a node does not have the orderable flag, you cannot re-order them (thr=
ough the API). I'd call this default behavior simply "appending". And I thi=
nk for nodes with the orderable flag, this is a good default behaviour and =
shouldn't be changed....</div><div><br></div><span id=3D"OLK_SRC_BODY_SECTI=
ON"><blockquote id=3D"MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE" style=3D"BORDER-L=
EFT: #b5c4df 5 solid; PADDING:0 0 0 5; MARGIN:0 0 0 5;"><div><div style=3D"=
word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-=
white-space; color: rgb(0, 0, 0); font-size: 14px; font-family: Calibri, sa=
ns-serif; "><div>Instead of using the insertion order, I propose to sort th=
e child node list alphabetically: /test/a, /test/b, /test/c - no matter in =
what order the nodes where created.</div></div></div></blockquote></span><d=
iv><br></div><div><div>...but for non-orderable nodes (i.e. a big "bunch") =
I agree that alphabetical order by default is good.</div><div><br></div><di=
v>Based on experience, all the UIs for non-orderable nodes (e.g nt:hierarch=
yNodes) end up doing alphabetical ordering anyway (for the default view and=
 if they don't allow for custom display ordering), as that's what makes it =
easy for humans to find the way around.</div></div><div><br></div><span id=
=3D"OLK_SRC_BODY_SECTION"><blockquote id=3D"MAC_OUTLOOK_ATTRIBUTION_BLOCKQU=
OTE" style=3D"BORDER-LEFT: #b5c4df 5 solid; PADDING:0 0 0 5; MARGIN:0 0 0 5=
;"><div><div style=3D"word-wrap: break-word; -webkit-nbsp-mode: space; -web=
kit-line-break: after-white-space; color: rgb(0, 0, 0); font-size: 14px; fo=
nt-family: Calibri, sans-serif; "><div> This will allow an efficient lookup=
 (using binary search), and for large child node lists (more than one thous=
and child nodes per node) modifications would be about twice as fast as usi=
ng insertion order (plus it would need less disk space).</div></div></div><=
/blockquote></span><div><br></div><div>Isn't the current appending the simp=
lest and fastest?</div><div><div><br></div><span id=3D"OLK_SRC_BODY_SECTION=
"><blockquote id=3D"MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE" style=3D"border-lef=
t-color: rgb(181, 196, 223); border-left-width: 5px; border-left-style: sol=
id; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left=
: 5px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left:=
 5px; "><div><div style=3D"word-wrap: break-word; -webkit-nbsp-mode: space;=
 -webkit-line-break: after-white-space; color: rgb(0, 0, 0); font-size: 14p=
x; font-family: Calibri, sans-serif; "></div></div></blockquote></span></di=
v><span id=3D"OLK_SRC_BODY_SECTION"><blockquote id=3D"MAC_OUTLOOK_ATTRIBUTI=
ON_BLOCKQUOTE" style=3D"BORDER-LEFT: #b5c4df 5 solid; PADDING:0 0 0 5; MARG=
IN:0 0 0 5;"><div><div style=3D"word-wrap: break-word; -webkit-nbsp-mode: s=
pace; -webkit-line-break: after-white-space; color: rgb(0, 0, 0); font-size=
: 14px; font-family: Calibri, sans-serif; "><div>Would it be a problem if J=
ackrabbit 3 sorts child nodes by name (always, or at least by default)?&nbs=
p;</div></div></div></blockquote></span><div><br></div><div>Yes, but for no=
n-orderable nodes only, of course.</div><div><br></div><div>For orderable n=
odes I think a goal should be to keep the list ordered the whole stack down=
 (API, in-memory, in-between formats (like json) and persistence layer), to=
 handle it efficiently. I.e. without any "ordering number" column and thus =
requiring re-orderings at some level.</div><div><br></div><span id=3D"OLK_S=
RC_BODY_SECTION"><blockquote id=3D"MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE" styl=
e=3D"BORDER-LEFT: #b5c4df 5 solid; PADDING:0 0 0 5; MARGIN:0 0 0 5;"><div><=
div style=3D"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-=
break: after-white-space; color: rgb(0, 0, 0); font-size: 14px; font-family=
: Calibri, sans-serif; "><div>Another option would be to use (insertion) or=
der until the child node list gets too large (for example 1000 elements), a=
nd from then on sort the child nodes by name (the previous ordering would t=
hen be lost).</div></div></div></blockquote></span><div><br></div><div>Hmm,=
 that would take away the benefit of the alphabetical default order, as app=
lications would still need to order it alphabetically in UIs (for the lists=
 shorter than 1000 elements).</div><div><br></div><div>Cheers,</div><div>Al=
ex</div><div><div><div><br></div><div>--&nbsp;</div><div><div><div><div>Ale=
xander Klimetschek</div><div>Developer // Adobe (Day) // Berlin - Basel</di=
v></div></div></div></div></div></body></html>

--_000_CB3F4492A021Daklimetsadobecom_--

From dev-return-33857-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:50:41 2012
Return-Path: <dev-return-33857-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 74B15B691
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:50:41 +0000 (UTC)
Received: (qmail 60249 invoked by uid 500); 20 Jan 2012 15:50:41 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 60162 invoked by uid 500); 20 Jan 2012 15:50:40 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 60155 invoked by uid 99); 20 Jan 2012 15:50:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:50:40 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mueller@adobe.com designates 64.18.1.27 as permitted sender)
Received: from [64.18.1.27] (HELO exprod6og111.obsmtp.com) (64.18.1.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:50:30 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob111.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxmNMPkivw5tTfWrI9Jkhv4ujV5ukD2j@postini.com; Fri, 20 Jan 2012 07:50:09 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.sea.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KFo62U022708
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:50:06 -0800 (PST)
Received: from nahub02.corp.adobe.com (nahub02.corp.adobe.com [10.8.189.98])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KFo5MM009683
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:50:05 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nahub02.corp.adobe.com
 (10.8.189.98) with Microsoft SMTP Server (TLS) id 8.3.192.1; Fri, 20 Jan 2012
 07:50:05 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Fri, 20 Jan 2012 15:50:03
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 20 Jan 2012 15:50:00 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczXiyxbdzc+eHC5RMaA3nCyX5ovrA==
Message-ID: <CB3F4B58.22F3E%mueller@adobe.com>
In-Reply-To: <CB3F4492.A021D%aklimets@adobe.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

> Isn't the current appending the simplest and fastest?

No. It requires to keep two indexes: one by number, and one by name.
Having only one index (by name) is about twice as fast, and needs about
half the disk space / memory.

Regards,
Thomas


From dev-return-33858-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:53:30 2012
Return-Path: <dev-return-33858-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ADC9AB766
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:53:30 +0000 (UTC)
Received: (qmail 64841 invoked by uid 500); 20 Jan 2012 15:53:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 64791 invoked by uid 500); 20 Jan 2012 15:53:29 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 64784 invoked by uid 99); 20 Jan 2012 15:53:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:53:29 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aklimets@adobe.com designates 64.18.1.23 as permitted sender)
Received: from [64.18.1.23] (HELO exprod6og109.obsmtp.com) (64.18.1.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:53:20 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob109.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxmN3CgZEUR6wErYdCir1vbMeTuk3Tu3@postini.com; Fri, 20 Jan 2012 07:53:00 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KFp70Y027909
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:51:07 -0800 (PST)
Received: from nacas02.corp.adobe.com (nacas02.corp.adobe.com [10.8.189.100])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0KFqxMM011000
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:52:59 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas02.corp.adobe.com
 (10.8.189.100) with Microsoft SMTP Server (TLS) id 8.3.192.1; Fri, 20 Jan
 2012 07:52:59 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Fri, 20 Jan 2012 15:52:58
 +0000
From: Alexander Klimetschek <aklimets@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Fri, 20 Jan 2012 15:52:56 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczXi5RS6Nu8pkYNSSm8jVsCuJw1qg==
Message-ID: <CB3F4C32.A0280%aklimets@adobe.com>
In-Reply-To: <CB3F4B58.22F3E%mueller@adobe.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

On 20.01.12 16:50, "Thomas Mueller" <mueller@adobe.com> wrote:
>>Isn't the current appending the simplest and fastest?
>
>No. It requires to keep two indexes: one by number, and one by name.
>Having only one index (by name) is about twice as fast, and needs about
>half the disk space / memory.

Ah, I guess this is because both cases (orderable & non-orderable) share
the same data structure underneath. Wouldn't it make sense for J3 to
support both cases naturally in the persistence layer?

Cheers,
Alex

--=20
Alexander Klimetschek
Developer // Adobe (Day) // Berlin - Basel





From dev-return-33859-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 15:56:57 2012
Return-Path: <dev-return-33859-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D8C1AB814
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 15:56:56 +0000 (UTC)
Received: (qmail 74512 invoked by uid 500); 20 Jan 2012 15:56:56 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 74451 invoked by uid 500); 20 Jan 2012 15:56:55 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 74444 invoked by uid 99); 20 Jan 2012 15:56:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:56:55 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.50 as permitted sender)
Received: from [74.125.82.50] (HELO mail-ww0-f50.google.com) (74.125.82.50)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 15:56:49 +0000
Received: by wgbdr11 with SMTP id dr11so805031wgb.19
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 07:56:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=jVMhhCBKne5IRk3LD8FzrdbaOareL4Ma5VIdbkrp58E=;
        b=K4T71e/cHqhF1XMvWDRO/5fX73vnRFC9XZHKmjHgBt+NaRSFEMXIwE3l6xo3Lzk0Ka
         0QgYRvFnVO07/gxpVlkTa3c1VECnq98paoNLXwTOSY1JvJ/Par5SI+/XzG/WHrck3n/6
         55XZo3H/8m6pnd1yFIndIVk6XV0MU9lPbKvBY=
Received: by 10.180.99.225 with SMTP id et1mr53049669wib.2.1327074988119; Fri,
 20 Jan 2012 07:56:28 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Fri, 20 Jan 2012 07:56:07 -0800 (PST)
In-Reply-To: <CB3F470C.22F2F%mueller@adobe.com>
References: <4F1987A0.3080000@gmx.de> <CB3F470C.22F2F%mueller@adobe.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Fri, 20 Jan 2012 16:56:07 +0100
Message-ID: <CAOFYJNbWZMS1bofPh3rk+3uqz=ETt7qj_k33BfsEZ-x-48zEiw@mail.gmail.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi,

On Fri, Jan 20, 2012 at 4:35 PM, Thomas Mueller <mueller@adobe.com> wrote:
> If we use alphabetical child node lists by default for Jackrabbit 3, then
> we would need to use a different default node type?

Right, though I suppose there are quite a few applications that use
nt:unstructured either as-is or as a base type for many purposes.

> Is it even possible to use a different node type than nt:unstructured
> in Jackrabbit 3?

It is. The default use of nt:unstructured in Jackrabbit 1.x and 2.x
boils down to the use of nt:unstructured as the base type of rep:root.
It should be fairly straightforward to change the root type to specify
an unorderable type as the default for any child nodes.

Doing so may cause some breakage in existing clients that don't
explicitly specify the types they want, but that breakage should be
manageable with proper release notes and workaround instructions.

BR,

Jukka Zitting

From dev-return-33860-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 16:17:07 2012
Return-Path: <dev-return-33860-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C4298BDBB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 16:17:07 +0000 (UTC)
Received: (qmail 14054 invoked by uid 500); 20 Jan 2012 16:17:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 13788 invoked by uid 500); 20 Jan 2012 16:17:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 13780 invoked by uid 99); 20 Jan 2012 16:17:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:17:06 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.206 as permitted sender)
Received: from [64.18.2.206] (HELO exprod7og126.obsmtp.com) (64.18.2.206)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 20 Jan 2012 16:16:59 +0000
Received: from mail-tul01m020-f181.google.com ([209.85.214.181]) (using TLSv1) by exprod7ob126.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTxmTZWHw1dS2QKe6FZCzEzfel/4ZiGUC@postini.com; Fri, 20 Jan 2012 08:16:38 PST
Received: by obbup10 with SMTP id up10so1061245obb.12
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 08:16:37 -0800 (PST)
Received: by 10.182.51.67 with SMTP id i3mr25344972obo.78.1327076197364; Fri,
 20 Jan 2012 08:16:37 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Fri, 20 Jan 2012 08:16:16 -0800 (PST)
In-Reply-To: <CAAOnkMtvXfqV=ORhPz6kN1sd+8W3__MpXW4-ZVQ6oy49y_MphA@mail.gmail.com>
References: <CAAOnkMu--dU0iGNom9_q9mcwGWwfjVwP3-a0GRqMgfDoE-E1eg@mail.gmail.com>
 <4F197C96.7040603@gmx.de> <CAAOnkMtvXfqV=ORhPz6kN1sd+8W3__MpXW4-ZVQ6oy49y_MphA@mail.gmail.com>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Fri, 20 Jan 2012 17:16:16 +0100
Message-ID: <CAAOnkMuudZXj_b=QCAWWfu07AvDLdFjk=nAy7ACsjzRX_A2cuA@mail.gmail.com>
Subject: Re: Question about consistency checker and node ordering in queries
To: Julian Reschke <julian.reschke@gmx.de>
Cc: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Jan 20, 2012 at 3:44 PM, Bart van der Schans
<b.vanderschans@onehippo.com> wrote:
> On Fri, Jan 20, 2012 at 3:39 PM, Julian Reschke <julian.reschke@gmx.de> w=
rote:
>> On 2012-01-20 15:22, Bart van der Schans wrote:
>>>
>>> Hi all,
>>>
>>> I was wondering about how the ConsistencyCheckerImpl fetches all the
>>> node ids. The first set of node ids is fetched with
>>> "pm.getAllNodeIds(null, NODESATONCE)" in the internalCheckConsistency
>>> method. All subsequent sets are fetched with "pm.getAllNodeIds(lastId,
>>> NODESATONCE)".
>>>
>>> In the BundleDbPersistenceManager the method
>>> getAllNodeIds(NodeId,maxCount) uses the "bundleSelectAllIdsSQL" if the
>>> first parameter is null otherwise the "bundleSelectAllIdsFromSQL"
>>> query. The =A0"bundleSelectAllIdsSQL" query doesn't use ordering and th=
e
>>> "bundleSelectAllIdsFromSQL" does.
>>>
>>> Now my question is the following: souldn't the "bundleSelectAllIdsSQL"
>>> also use an order clause to make sure the correct batch of node ids is
>>> fetched the first time? Or is that somehow implicitly guaranteed?
>>
>>
>> Good question. I was confused about that as well. I tried and stepped
>> through he code and everything seem to worked as advertised, so I stoppe=
d
>> worrying about it :-)
>
> I think (at least on mysql) we're just lucky that the natural ordering
> is by NODE_ID:
>
> mysql> SELECT hex(NODE_ID) FROM VERSION_BUNDLE ORDER BY NODE_ID LIMIT 0,1=
0;
> +----------------------------------+
> | hex(NODE_ID) =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 |
> +----------------------------------+
> | 000005E87E6D402BA27CDF41E7999D8A |
> | 000007DC02CF48BA8FFEDA5F566A3A98 |
> | 00000C4A81744934B4F0CB55C9967378 |
> | 000016C9E4464C4FA7B6F4B9CF2F9903 |
> | 00001D5A1C6F4339B317BB436AA54431 |
> | 0000257D67AB4F1EA4DDEDB84BB13039 |
> | 00002C51F22145B89F59E882BB505036 |
> | 00002F2AFC2E4842863C360B68A36BDA |
> | 0000354F151945CEA953D62C922A4FAC |
> | 00003C0254C8471E8349C0B6F0DEFDC2 |
> +----------------------------------+
> 10 rows in set (0.00 sec)
>
> mysql> SELECT hex(NODE_ID) FROM VERSION_BUNDLE LIMIT 0,10;
> +----------------------------------+
> | hex(NODE_ID) =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 |
> +----------------------------------+
> | 000005E87E6D402BA27CDF41E7999D8A |
> | 000007DC02CF48BA8FFEDA5F566A3A98 |
> | 00000C4A81744934B4F0CB55C9967378 |
> | 000016C9E4464C4FA7B6F4B9CF2F9903 |
> | 00001D5A1C6F4339B317BB436AA54431 |
> | 0000257D67AB4F1EA4DDEDB84BB13039 |
> | 00002C51F22145B89F59E882BB505036 |
> | 00002F2AFC2E4842863C360B68A36BDA |
> | 0000354F151945CEA953D62C922A4FAC |
> | 00003C0254C8471E8349C0B6F0DEFDC2 |
> +----------------------------------+
> 10 rows in set (0.00 sec)
>
> But that doesn't have to be the case with other databases. Maybe
> somebody can try similar queries on another database?

Does anybody have an objection to adding an order clause to the
"bundleSelectAllIdsSQL" statement? If not, I'll create an issue and
add it.

Regards,
Bart

From dev-return-33861-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 16:18:36 2012
Return-Path: <dev-return-33861-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9EC02BE08
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 16:18:36 +0000 (UTC)
Received: (qmail 19120 invoked by uid 500); 20 Jan 2012 16:18:36 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 18994 invoked by uid 500); 20 Jan 2012 16:18:35 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 18986 invoked by uid 99); 20 Jan 2012 16:18:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:18:35 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:18:30 +0000
Received: by werp12 with SMTP id p12so1344864wer.1
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 08:18:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=wK7p+/AS1O6wo2zUbAHF+MycpTMxHDfvG9K+Vn9DmfA=;
        b=AkeA2jcKxGYbbGzyTZfQylvYfQEMmbwVvFZNrdLD8iNgCL91V+zcDpBDw0F4L7NTIh
         xB7Irspj4Tp/5cy/bu0YSfHJMvuNFx1lE7ybbeicUiEtqje9emCIlKl6TwytfUIhn+Vk
         iOGquU2RX98ddHKiVFseE0sCIs8d4ynz8OEOw=
Received: by 10.216.132.139 with SMTP id o11mr13454336wei.33.1327076289125;
 Fri, 20 Jan 2012 08:18:09 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Fri, 20 Jan 2012 08:17:48 -0800 (PST)
In-Reply-To: <CAAOnkMuudZXj_b=QCAWWfu07AvDLdFjk=nAy7ACsjzRX_A2cuA@mail.gmail.com>
References: <CAAOnkMu--dU0iGNom9_q9mcwGWwfjVwP3-a0GRqMgfDoE-E1eg@mail.gmail.com>
 <4F197C96.7040603@gmx.de> <CAAOnkMtvXfqV=ORhPz6kN1sd+8W3__MpXW4-ZVQ6oy49y_MphA@mail.gmail.com>
 <CAAOnkMuudZXj_b=QCAWWfu07AvDLdFjk=nAy7ACsjzRX_A2cuA@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Fri, 20 Jan 2012 17:17:48 +0100
Message-ID: <CAOFYJNZt7J24AKdgwf+8RnBmEkHW_W4BKGdSqTXk4TpZLaqTvA@mail.gmail.com>
Subject: Re: Question about consistency checker and node ordering in queries
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi,

On Fri, Jan 20, 2012 at 5:16 PM, Bart van der Schans
<b.vanderschans@onehippo.com> wrote:
> Does anybody have an objection to adding an order clause to the
> "bundleSelectAllIdsSQL" statement? If not, I'll create an issue and
> add it.

Sounds like the right thing to do.

BR,

Jukka Zitting

From dev-return-33862-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 16:41:05 2012
Return-Path: <dev-return-33862-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E6452BDA7
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 16:41:04 +0000 (UTC)
Received: (qmail 87398 invoked by uid 500); 20 Jan 2012 16:41:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 87257 invoked by uid 500); 20 Jan 2012 16:41:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 87250 invoked by uid 99); 20 Jan 2012 16:41:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:41:03 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:40:57 +0000
Received: by iaoo28 with SMTP id o28so2362104iao.1
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 08:40:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=ihizyYIsuqE8ApPVm4SI7yPf2dS8Bhzh3UR+Kp9H37Q=;
        b=oJJsZ1UHTXh8rOuuM3J8314wmZvn2dH5oUHZEVyz65XSjG/zAE0k8dhTejyb1QAzEC
         WHoh9O+uZAELgE+YIDWTBXTvB21Aouq9Kqepev1q4Or9GhkkB1F1MMtjX2OzYgbrVVND
         GiPz1Ht+gc5lstn0wnZRPEBGVor5CPJJOAMDg=
MIME-Version: 1.0
Received: by 10.50.168.2 with SMTP id zs2mr3227771igb.9.1327077637082; Fri, 20
 Jan 2012 08:40:37 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Fri, 20 Jan 2012 08:40:37 -0800 (PST)
In-Reply-To: <CB3F422D.22F20%mueller@adobe.com>
References: <CB3F422D.22F20%mueller@adobe.com>
Date: Fri, 20 Jan 2012 17:40:37 +0100
Message-ID: <CAFYk8N=oiikWgDxyi=X1eHnnbhU+TPxQ1ZiQWMTEh=Sa_nhkjg@mail.gmail.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Fri, Jan 20, 2012 at 4:09 PM, Thomas Mueller <mueller@adobe.com> wrote:
> Hi,
>
> The current Jackrabbit implementation uses orderable child nodes by defau=
lt,
> meaning nodes are returned in the same order as they are created. As an
> example, if I create the nodes=A0/test/c, then=A0/test/b, and then=A0/tes=
t/a, and
> then read the node list, I will get them back in that same order.=A0I'm
> wondering if this is really required (at all, and to be the default
> behavior). Specially if there are a lot of child nodes.
>
> Instead of using the insertion order, I propose to sort the child node li=
st
> alphabetically: /test/a, /test/b, /test/c - no matter in what order the
> nodes where created. This will allow an efficient lookup (using binary
> search), and for large child node lists (more than one thousand child nod=
es
> per node) modifications would be about twice as fast as using insertion
> order (plus it would need less disk space).
>
> Would it be a problem if Jackrabbit 3 sorts child nodes by name (always, =
or
> at least by default)?

i guess no. unless that this behavior is expected/mandated.

>
> Another option would be to use (insertion) order until the child node lis=
t
> gets too large (for example 1000 elements), and from then on sort the chi=
ld
> nodes by name (the previous ordering would then be lost).

i am currently working on a similar approach in the microkernel prototype
(sandbox). i am thinking about switching from 'insertion ordered' to
'unordered' (the order depends on the implementation, in my case it's
based on the hashcode of the child node name) once a certain threshold
is reached.

cheers
stefan
>
> Regards,
> Thomas
>

From dev-return-33863-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 16:44:12 2012
Return-Path: <dev-return-33863-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A0106BE96
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 16:44:12 +0000 (UTC)
Received: (qmail 93665 invoked by uid 500); 20 Jan 2012 16:44:12 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 93596 invoked by uid 500); 20 Jan 2012 16:44:11 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 93581 invoked by uid 99); 20 Jan 2012 16:44:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:44:11 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:44:05 +0000
Received: by werp12 with SMTP id p12so1388842wer.1
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 08:43:44 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=9K3nxUeEwYOF2S/IwkyHjg7vvC3nqOgl+0gVGUC0Hq8=;
        b=T0w2EU+j3lMY+PdlrvKElbymiCXyKpZTOPD3E17wPfPdSkmCh3/gWQB1i24EQ/5dve
         Hmhuik/pwAxqictiTXp2My54jod6W8vsq6J9vSYN3igSNompnm57uy5OT5XXyD3Q055a
         3T0u1eIyhylxoCaqNgtHRq8tllZybGbG4Bvfc=
Received: by 10.216.134.155 with SMTP id s27mr1307845wei.41.1327077824081;
 Fri, 20 Jan 2012 08:43:44 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Fri, 20 Jan 2012 08:43:23 -0800 (PST)
In-Reply-To: <CB3F422D.22F20%mueller@adobe.com>
References: <CB3F422D.22F20%mueller@adobe.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Fri, 20 Jan 2012 17:43:23 +0100
Message-ID: <CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi,

Thinking about this more generally, it would definitely be useful to
be able to use a more efficient underlying storage for unorderable
nodes. However, there still are hard use cases that require us to
support orderable nodes as indicated by the type of the parent node.
Thus the implementation basically has two options:

1) Use a single data structure for all nodes, like Jackrabbit
currently does. This simplifies the implementation but prevents us
from enjoying the performance and scalability benefits of unorderable
nodes.

2) Use two data structures, one for orderable and another for
unorderable nodes. This is more complex (not least because it links
node types to the underlying storage model), but is probably required
if we want to efficiently support up to millions of child nodes per a
single parent.

It might also be possible to have the underlying storage model
unorderable, and just include extra ordering metadata at a higher
layer where also node types are handled. Option 2b, if you like, with
probably fairly significant overhead when iterating over nodes (the
implementation would probably need to pre-fetch all child nodes in
advance to access their ordering metadata).

If we do have native support for unorderable nodes, then I wouldn't
promise any particular ordering (alphabetic, insertion order, etc.)
but rather leave it undefined like in Java's Map interface. The
underlying implementation is then free to use whatever ordering it
thinks is best.

PS. Note that ordering affects not just node traversal, but also the
document ordering used in search results. Though in practice we
already now disable document ordering of search results by default.

BR,

Jukka Zitting

From dev-return-33864-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 16:52:07 2012
Return-Path: <dev-return-33864-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 872A1B119
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 16:52:07 +0000 (UTC)
Received: (qmail 13975 invoked by uid 500); 20 Jan 2012 16:52:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 13941 invoked by uid 500); 20 Jan 2012 16:52:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 13934 invoked by uid 99); 20 Jan 2012 16:52:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:52:06 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.160.170 as permitted sender)
Received: from [209.85.160.170] (HELO mail-gy0-f170.google.com) (209.85.160.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 16:52:00 +0000
Received: by ghrr13 with SMTP id r13so609908ghr.1
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 08:51:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=rYj2yRjrdk0qFPEJ1TBZVP6NIPnLifTdwIaS7rLgDb4=;
        b=qNilY98PP4PhfPC6PyoWmex++oREKDOV7FizgIVWdDvDWkPHE9RzYvnWVxuNQTLma9
         P3BREQ0FtiB28eKdSoOyz3z3+hSu5WgxMS177cddmjzHOky9I1xx58UQRuMdrUPp9I+E
         Od4LzSgDMCzpJPu9r1xeZqQMc8f6KV8zw/VVM=
MIME-Version: 1.0
Received: by 10.50.10.225 with SMTP id l1mr33543550igb.9.1327078298994; Fri,
 20 Jan 2012 08:51:38 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Fri, 20 Jan 2012 08:51:38 -0800 (PST)
In-Reply-To: <CAOFYJNbWZMS1bofPh3rk+3uqz=ETt7qj_k33BfsEZ-x-48zEiw@mail.gmail.com>
References: <4F1987A0.3080000@gmx.de>
	<CB3F470C.22F2F%mueller@adobe.com>
	<CAOFYJNbWZMS1bofPh3rk+3uqz=ETt7qj_k33BfsEZ-x-48zEiw@mail.gmail.com>
Date: Fri, 20 Jan 2012 17:51:38 +0100
Message-ID: <CAFYk8Nkkaj1ZZnYX_UtM4hiB1cCC=JE9cVBXP3-r+cjx=_zNgA@mail.gmail.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Fri, Jan 20, 2012 at 4:56 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> Hi,
>
> On Fri, Jan 20, 2012 at 4:35 PM, Thomas Mueller <mueller@adobe.com> wrote:
>> If we use alphabetical child node lists by default for Jackrabbit 3, then
>> we would need to use a different default node type?
>
> Right, though I suppose there are quite a few applications that use
> nt:unstructured either as-is or as a base type for many purposes.
>
>> Is it even possible to use a different node type than nt:unstructured
>> in Jackrabbit 3?
>
> It is. The default use of nt:unstructured in Jackrabbit 1.x and 2.x
> boils down to the use of nt:unstructured as the base type of rep:root.
> It should be fairly straightforward to change the root type to specify
> an unorderable type as the default for any child nodes.

yes, i agree.

cheers
stefan

>
> Doing so may cause some breakage in existing clients that don't
> explicitly specify the types they want, but that breakage should be
> manageable with proper release notes and workaround instructions.
>
> BR,
>
> Jukka Zitting

From dev-return-33865-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 17:14:14 2012
Return-Path: <dev-return-33865-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 29BA1B756
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 17:14:14 +0000 (UTC)
Received: (qmail 62000 invoked by uid 500); 20 Jan 2012 17:14:13 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 61939 invoked by uid 500); 20 Jan 2012 17:14:13 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 61932 invoked by uid 99); 20 Jan 2012 17:14:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 17:14:13 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 17:14:06 +0000
Received: by iaoo28 with SMTP id o28so2431823iao.1
        for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 09:13:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ywcf8Li2Kh6Buzioy6lutM1qSf/rFG3R2naiWwsKVKA=;
        b=BBWgnL0ZqlKfF6JHl30SVbSgGJh5OQ3jyVPx95c/o9aZNwI2prOBZN8f45S7E5mYtx
         399ZJ70MqNeT5GzEUE54EQK5VgI15p7tn4iY3pkLsiGOwFhcVGDSfKZkcp+HtocvC6vB
         ly66Lcb+GfxjdWzPQn8TTlp4yGUTt3i+kcZKQ=
MIME-Version: 1.0
Received: by 10.50.10.225 with SMTP id l1mr33638876igb.9.1327079626022; Fri,
 20 Jan 2012 09:13:46 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Fri, 20 Jan 2012 09:13:45 -0800 (PST)
In-Reply-To: <CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
References: <CB3F422D.22F20%mueller@adobe.com>
	<CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
Date: Fri, 20 Jan 2012 18:13:45 +0100
Message-ID: <CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Fri, Jan 20, 2012 at 5:43 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> Hi,
>
> Thinking about this more generally, it would definitely be useful to
> be able to use a more efficient underlying storage for unorderable
> nodes. However, there still are hard use cases that require us to
> support orderable nodes as indicated by the type of the parent node.
> Thus the implementation basically has two options:
>
> 1) Use a single data structure for all nodes, like Jackrabbit
> currently does. This simplifies the implementation but prevents us
> from enjoying the performance and scalability benefits of unorderable
> nodes.
>
> 2) Use two data structures, one for orderable and another for
> unorderable nodes. This is more complex (not least because it links
> node types to the underlying storage model), but is probably required
> if we want to efficiently support up to millions of child nodes per a
> single parent.

i agree that it's probably required for efficiently handling both large
and small child node lists.

i am not sure that it necessarily means linking node types to the
underlying storage modal. the microkernel prototype currently has
no notion of node types and that's IMO a good thing.

node types have a way to dominant role in the current jackrabbit
core implementation. jackrabbit started out as the official reference
implementation for jsr-170, the focus was on supporting every
feature of the spec.

in jr3 i guess we can and should trade some 'note type correctness'
for improved efficiency.

>
> It might also be possible to have the underlying storage model
> unorderable, and just include extra ordering metadata at a higher
> layer where also node types are handled. Option 2b, if you like, with
> probably fairly significant overhead when iterating over nodes (the
> implementation would probably need to pre-fetch all child nodes in
> advance to access their ordering metadata).
>
> If we do have native support for unorderable nodes, then I wouldn't
> promise any particular ordering (alphabetic, insertion order, etc.)
> but rather leave it undefined like in Java's Map interface. The
> underlying implementation is then free to use whatever ordering it
> thinks is best.

i agree.

cheers
stefan

>
> PS. Note that ordering affects not just node traversal, but also the
> document ordering used in search results. Though in practice we
> already now disable document ordering of search results by default.
>
> BR,
>
> Jukka Zitting

From dev-return-33866-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 20 23:41:53 2012
Return-Path: <dev-return-33866-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C9B8BB2D3
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 20 Jan 2012 23:41:53 +0000 (UTC)
Received: (qmail 80706 invoked by uid 500); 20 Jan 2012 23:41:53 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 80626 invoked by uid 500); 20 Jan 2012 23:41:52 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 80619 invoked by uid 99); 20 Jan 2012 23:41:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 20 Jan 2012 23:41:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of julian.reschke@gmx.de designates 213.165.64.23 as permitted sender)
Received: from [213.165.64.23] (HELO mailout-de.gmx.net) (213.165.64.23)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 20 Jan 2012 23:41:47 +0000
Received: (qmail invoked by alias); 20 Jan 2012 23:41:25 -0000
Received: from p3EE27868.dip.t-dialin.net (EHLO [192.168.178.36]) [62.226.120.104]
  by mail.gmx.net (mp031) with SMTP; 21 Jan 2012 00:41:25 +0100
X-Authenticated: #1915285
X-Provags-ID: V01U2FsdGVkX1/BPK11iD/BCHkuT70zPo8U4aQPHXK+4tiTjhjW5w
	6XrrkMjYC/nWlK
Message-ID: <4F19FBA2.3040201@gmx.de>
Date: Sat, 21 Jan 2012 00:41:22 +0100
From: Julian Reschke <julian.reschke@gmx.de>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: Bart van der Schans <b.vanderschans@onehippo.com>
CC: dev@jackrabbit.apache.org
Subject: Re: Question about consistency checker and node ordering in queries
References: <CAAOnkMu--dU0iGNom9_q9mcwGWwfjVwP3-a0GRqMgfDoE-E1eg@mail.gmail.com> <4F197C96.7040603@gmx.de> <CAAOnkMtvXfqV=ORhPz6kN1sd+8W3__MpXW4-ZVQ6oy49y_MphA@mail.gmail.com> <CAAOnkMuudZXj_b=QCAWWfu07AvDLdFjk=nAy7ACsjzRX_A2cuA@mail.gmail.com>
In-Reply-To: <CAAOnkMuudZXj_b=QCAWWfu07AvDLdFjk=nAy7ACsjzRX_A2cuA@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0

On 2012-01-20 17:16, Bart van der Schans wrote:
> On Fri, Jan 20, 2012 at 3:44 PM, Bart van der Schans
> <b.vanderschans@onehippo.com>  wrote:
>> On Fri, Jan 20, 2012 at 3:39 PM, Julian Reschke<julian.reschke@gmx.de>  wrote:
>>> On 2012-01-20 15:22, Bart van der Schans wrote:
>>>>
>>>> Hi all,
>>>>
>>>> I was wondering about how the ConsistencyCheckerImpl fetches all the
>>>> node ids. The first set of node ids is fetched with
>>>> "pm.getAllNodeIds(null, NODESATONCE)" in the internalCheckConsistency
>>>> method. All subsequent sets are fetched with "pm.getAllNodeIds(lastId,
>>>> NODESATONCE)".
>>>>
>>>> In the BundleDbPersistenceManager the method
>>>> getAllNodeIds(NodeId,maxCount) uses the "bundleSelectAllIdsSQL" if the
>>>> first parameter is null otherwise the "bundleSelectAllIdsFromSQL"
>>>> query. The  "bundleSelectAllIdsSQL" query doesn't use ordering and the
>>>> "bundleSelectAllIdsFromSQL" does.
>>>>
>>>> Now my question is the following: souldn't the "bundleSelectAllIdsSQL"
>>>> also use an order clause to make sure the correct batch of node ids is
>>>> fetched the first time? Or is that somehow implicitly guaranteed?
>>>
>>>
>>> Good question. I was confused about that as well. I tried and stepped
>>> through he code and everything seem to worked as advertised, so I stopped
>>> worrying about it :-)
>>
>> I think (at least on mysql) we're just lucky that the natural ordering
>> is by NODE_ID:
>>
>> mysql>  SELECT hex(NODE_ID) FROM VERSION_BUNDLE ORDER BY NODE_ID LIMIT 0,10;
>> +----------------------------------+
>> | hex(NODE_ID)                     |
>> +----------------------------------+
>> | 000005E87E6D402BA27CDF41E7999D8A |
>> | 000007DC02CF48BA8FFEDA5F566A3A98 |
>> | 00000C4A81744934B4F0CB55C9967378 |
>> | 000016C9E4464C4FA7B6F4B9CF2F9903 |
>> | 00001D5A1C6F4339B317BB436AA54431 |
>> | 0000257D67AB4F1EA4DDEDB84BB13039 |
>> | 00002C51F22145B89F59E882BB505036 |
>> | 00002F2AFC2E4842863C360B68A36BDA |
>> | 0000354F151945CEA953D62C922A4FAC |
>> | 00003C0254C8471E8349C0B6F0DEFDC2 |
>> +----------------------------------+
>> 10 rows in set (0.00 sec)
>>
>> mysql>  SELECT hex(NODE_ID) FROM VERSION_BUNDLE LIMIT 0,10;
>> +----------------------------------+
>> | hex(NODE_ID)                     |
>> +----------------------------------+
>> | 000005E87E6D402BA27CDF41E7999D8A |
>> | 000007DC02CF48BA8FFEDA5F566A3A98 |
>> | 00000C4A81744934B4F0CB55C9967378 |
>> | 000016C9E4464C4FA7B6F4B9CF2F9903 |
>> | 00001D5A1C6F4339B317BB436AA54431 |
>> | 0000257D67AB4F1EA4DDEDB84BB13039 |
>> | 00002C51F22145B89F59E882BB505036 |
>> | 00002F2AFC2E4842863C360B68A36BDA |
>> | 0000354F151945CEA953D62C922A4FAC |
>> | 00003C0254C8471E8349C0B6F0DEFDC2 |
>> +----------------------------------+
>> 10 rows in set (0.00 sec)
>>
>> But that doesn't have to be the case with other databases. Maybe
>> somebody can try similar queries on another database?
>
> Does anybody have an objection to adding an order clause to the
> "bundleSelectAllIdsSQL" statement? If not, I'll create an issue and
> add it.
>
> Regards,
> Bart

Sounds good to me.

Best regards, Julian


From dev-return-33867-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Sat Jan 21 02:01:39 2012
Return-Path: <dev-return-33867-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 86150BCFE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Sat, 21 Jan 2012 02:01:39 +0000 (UTC)
Received: (qmail 77660 invoked by uid 500); 21 Jan 2012 02:01:39 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 77588 invoked by uid 500); 21 Jan 2012 02:01:38 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 77581 invoked by uid 99); 21 Jan 2012 02:01:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 21 Jan 2012 02:01:38 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tripod@adobe.com designates 64.18.1.185 as permitted sender)
Received: from [64.18.1.185] (HELO exprod6og103.obsmtp.com) (64.18.1.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 21 Jan 2012 02:01:29 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob103.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxocZN8GQWiF+/hjdMv9kfF+WxiW0mZI@postini.com; Fri, 20 Jan 2012 18:01:09 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0L1xE0Y029468
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 17:59:15 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0L212Po022424
	for <dev@jackrabbit.apache.org>; Fri, 20 Jan 2012 18:01:06 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Fri, 20 Jan 2012
 18:01:05 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Sat, 21 Jan 2012 02:01:03
 +0000
From: Tobias Bocanegra <tripod@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Sat, 21 Jan 2012 02:00:58 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczX4Ic2M5GtVRKJR3awHP9OkxCwAg==
Message-ID: <CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com>
References: <CB3F422D.22F20%mueller@adobe.com>
	<CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
	<CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com>
In-Reply-To: <CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

bnQ6dW5zdHJ1Y3R1cmVkIGhhcyBvcmRlcmFibGUgY2hpbGRub2RlcywgYW5kIHdlIGFsc28gcHJl
YWNoIHRvIHVzZQ0KbnQ6dW5zdHJ1Y3R1cmVkIHdoZXJlZXZlciB5b3UgY2FuLiBBbHNvLCBpIGFz
c3VtZSB0aGF0IGEgbG90IG9mDQphcHBsaWNhdGlvbnMgYmVuZWZpdCBmcm9tIG5vZGUgb3JkZXJp
bmcgKGxpa2UgYSBDTVMpLiBTbyBJIHRoaW5rIHRoYXQNCnRoZSBtYWpvcml0eSBvZiB0aGUgcmVw
b3NpdG9yaWVzIGhhdmUgYSBsb3Qgb2Ygbm9kZXMgd2l0aCBvcmRlcmVkDQpjaGlsZG5vZGVzLiB0
aHVzIGkgd291bGQgbm90IHB1dCB0b28gbXVjaCBlZmZvcnQgaW4gaGF2aW5nIGFuDQplZmZpY2ll
bnQgbm9uLW9yZGVyZWQgZm9ybWF0LCBidXQgbWFraW5nIHRoZSBvcmRlcmVkIHN0b3JhZ2UgYXMg
ZmFzdA0KYXMgcG9zc2libGUuIHVzaW5nIGxleGljb2dyYXBoaWNhbCBvcmRlcmluZyBmb3IgdW5v
cmRlcmVkIGNoaWxkIG5vZGVzDQp3b3VsZCBjZXJ0YWlubHkgYmUgYSBnb29kIG9wdGlvbiwgYXMg
aSBjYW4gcmVkdWNlIHRoZSBsb29rdXAgKGJ1dCBub3QNCmluc2VydCkuIGFsc28sIGkgdGhpbmsg
dGhhdCByZS1vcmRlcmluZ3MgaGFwcGVuIHJlbGF0aXZlbHkgcmFyZWx5Lg0KDQpyZWdhcmRzLCB0
b2J5DQoNCk9uIEZyaSwgSmFuIDIwLCAyMDEyIGF0IDk6MTMgQU0sIFN0ZWZhbiBHdWdnaXNiZXJn
DQo8c3RlZmFuLmd1Z2dpc2JlcmdAZ21haWwuY29tPiB3cm90ZToNCj4gT24gRnJpLCBKYW4gMjAs
IDIwMTIgYXQgNTo0MyBQTSwgSnVra2EgWml0dGluZyA8anVra2Eueml0dGluZ0BnbWFpbC5jb20+
IHdyb3RlOg0KPj4gSGksDQo+Pg0KPj4gVGhpbmtpbmcgYWJvdXQgdGhpcyBtb3JlIGdlbmVyYWxs
eSwgaXQgd291bGQgZGVmaW5pdGVseSBiZSB1c2VmdWwgdG8NCj4+IGJlIGFibGUgdG8gdXNlIGEg
bW9yZSBlZmZpY2llbnQgdW5kZXJseWluZyBzdG9yYWdlIGZvciB1bm9yZGVyYWJsZQ0KPj4gbm9k
ZXMuIEhvd2V2ZXIsIHRoZXJlIHN0aWxsIGFyZSBoYXJkIHVzZSBjYXNlcyB0aGF0IHJlcXVpcmUg
dXMgdG8NCj4+IHN1cHBvcnQgb3JkZXJhYmxlIG5vZGVzIGFzIGluZGljYXRlZCBieSB0aGUgdHlw
ZSBvZiB0aGUgcGFyZW50IG5vZGUuDQo+PiBUaHVzIHRoZSBpbXBsZW1lbnRhdGlvbiBiYXNpY2Fs
bHkgaGFzIHR3byBvcHRpb25zOg0KPj4NCj4+IDEpIFVzZSBhIHNpbmdsZSBkYXRhIHN0cnVjdHVy
ZSBmb3IgYWxsIG5vZGVzLCBsaWtlIEphY2tyYWJiaXQNCj4+IGN1cnJlbnRseSBkb2VzLiBUaGlz
IHNpbXBsaWZpZXMgdGhlIGltcGxlbWVudGF0aW9uIGJ1dCBwcmV2ZW50cyB1cw0KPj4gZnJvbSBl
bmpveWluZyB0aGUgcGVyZm9ybWFuY2UgYW5kIHNjYWxhYmlsaXR5IGJlbmVmaXRzIG9mIHVub3Jk
ZXJhYmxlDQo+PiBub2Rlcy4NCj4+DQo+PiAyKSBVc2UgdHdvIGRhdGEgc3RydWN0dXJlcywgb25l
IGZvciBvcmRlcmFibGUgYW5kIGFub3RoZXIgZm9yDQo+PiB1bm9yZGVyYWJsZSBub2Rlcy4gVGhp
cyBpcyBtb3JlIGNvbXBsZXggKG5vdCBsZWFzdCBiZWNhdXNlIGl0IGxpbmtzDQo+PiBub2RlIHR5
cGVzIHRvIHRoZSB1bmRlcmx5aW5nIHN0b3JhZ2UgbW9kZWwpLCBidXQgaXMgcHJvYmFibHkgcmVx
dWlyZWQNCj4+IGlmIHdlIHdhbnQgdG8gZWZmaWNpZW50bHkgc3VwcG9ydCB1cCB0byBtaWxsaW9u
cyBvZiBjaGlsZCBub2RlcyBwZXIgYQ0KPj4gc2luZ2xlIHBhcmVudC4NCj4NCj4gaSBhZ3JlZSB0
aGF0IGl0J3MgcHJvYmFibHkgcmVxdWlyZWQgZm9yIGVmZmljaWVudGx5IGhhbmRsaW5nIGJvdGgg
bGFyZ2UNCj4gYW5kIHNtYWxsIGNoaWxkIG5vZGUgbGlzdHMuDQo+DQo+IGkgYW0gbm90IHN1cmUg
dGhhdCBpdCBuZWNlc3NhcmlseSBtZWFucyBsaW5raW5nIG5vZGUgdHlwZXMgdG8gdGhlDQo+IHVu
ZGVybHlpbmcgc3RvcmFnZSBtb2RhbC4gdGhlIG1pY3Jva2VybmVsIHByb3RvdHlwZSBjdXJyZW50
bHkgaGFzDQo+IG5vIG5vdGlvbiBvZiBub2RlIHR5cGVzIGFuZCB0aGF0J3MgSU1PIGEgZ29vZCB0
aGluZy4NCj4NCj4gbm9kZSB0eXBlcyBoYXZlIGEgd2F5IHRvIGRvbWluYW50IHJvbGUgaW4gdGhl
IGN1cnJlbnQgamFja3JhYmJpdA0KPiBjb3JlIGltcGxlbWVudGF0aW9uLiBqYWNrcmFiYml0IHN0
YXJ0ZWQgb3V0IGFzIHRoZSBvZmZpY2lhbCByZWZlcmVuY2UNCj4gaW1wbGVtZW50YXRpb24gZm9y
IGpzci0xNzAsIHRoZSBmb2N1cyB3YXMgb24gc3VwcG9ydGluZyBldmVyeQ0KPiBmZWF0dXJlIG9m
IHRoZSBzcGVjLg0KPg0KPiBpbiBqcjMgaSBndWVzcyB3ZSBjYW4gYW5kIHNob3VsZCB0cmFkZSBz
b21lICdub3RlIHR5cGUgY29ycmVjdG5lc3MnDQo+IGZvciBpbXByb3ZlZCBlZmZpY2llbmN5Lg0K
Pg0KPj4NCj4+IEl0IG1pZ2h0IGFsc28gYmUgcG9zc2libGUgdG8gaGF2ZSB0aGUgdW5kZXJseWlu
ZyBzdG9yYWdlIG1vZGVsDQo+PiB1bm9yZGVyYWJsZSwgYW5kIGp1c3QgaW5jbHVkZSBleHRyYSBv
cmRlcmluZyBtZXRhZGF0YSBhdCBhIGhpZ2hlcg0KPj4gbGF5ZXIgd2hlcmUgYWxzbyBub2RlIHR5
cGVzIGFyZSBoYW5kbGVkLiBPcHRpb24gMmIsIGlmIHlvdSBsaWtlLCB3aXRoDQo+PiBwcm9iYWJs
eSBmYWlybHkgc2lnbmlmaWNhbnQgb3ZlcmhlYWQgd2hlbiBpdGVyYXRpbmcgb3ZlciBub2RlcyAo
dGhlDQo+PiBpbXBsZW1lbnRhdGlvbiB3b3VsZCBwcm9iYWJseSBuZWVkIHRvIHByZS1mZXRjaCBh
bGwgY2hpbGQgbm9kZXMgaW4NCj4+IGFkdmFuY2UgdG8gYWNjZXNzIHRoZWlyIG9yZGVyaW5nIG1l
dGFkYXRhKS4NCj4+DQo+PiBJZiB3ZSBkbyBoYXZlIG5hdGl2ZSBzdXBwb3J0IGZvciB1bm9yZGVy
YWJsZSBub2RlcywgdGhlbiBJIHdvdWxkbid0DQo+PiBwcm9taXNlIGFueSBwYXJ0aWN1bGFyIG9y
ZGVyaW5nIChhbHBoYWJldGljLCBpbnNlcnRpb24gb3JkZXIsIGV0Yy4pDQo+PiBidXQgcmF0aGVy
IGxlYXZlIGl0IHVuZGVmaW5lZCBsaWtlIGluIEphdmEncyBNYXAgaW50ZXJmYWNlLiBUaGUNCj4+
IHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gaXMgdGhlbiBmcmVlIHRvIHVzZSB3aGF0ZXZlciBv
cmRlcmluZyBpdA0KPj4gdGhpbmtzIGlzIGJlc3QuDQo+DQo+IGkgYWdyZWUuDQo+DQo+IGNoZWVy
cw0KPiBzdGVmYW4NCj4NCj4+DQo+PiBQUy4gTm90ZSB0aGF0IG9yZGVyaW5nIGFmZmVjdHMgbm90
IGp1c3Qgbm9kZSB0cmF2ZXJzYWwsIGJ1dCBhbHNvIHRoZQ0KPj4gZG9jdW1lbnQgb3JkZXJpbmcg
dXNlZCBpbiBzZWFyY2ggcmVzdWx0cy4gVGhvdWdoIGluIHByYWN0aWNlIHdlDQo+PiBhbHJlYWR5
IG5vdyBkaXNhYmxlIGRvY3VtZW50IG9yZGVyaW5nIG9mIHNlYXJjaCByZXN1bHRzIGJ5IGRlZmF1
bHQuDQo+Pg0KPj4gQlIsDQo+Pg0KPj4gSnVra2EgWml0dGluZw==

From dev-return-33868-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Sat Jan 21 13:05:13 2012
Return-Path: <dev-return-33868-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D8AAA95E7
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Sat, 21 Jan 2012 13:05:13 +0000 (UTC)
Received: (qmail 18791 invoked by uid 500); 21 Jan 2012 13:05:13 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 18594 invoked by uid 500); 21 Jan 2012 13:05:12 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 18587 invoked by uid 99); 21 Jan 2012 13:05:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 21 Jan 2012 13:05:12 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 21 Jan 2012 13:05:05 +0000
Received: by iaoo28 with SMTP id o28so4669727iao.1
        for <dev@jackrabbit.apache.org>; Sat, 21 Jan 2012 05:04:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ANvlVm9CcC7d1ybU5tirvDZNPRXr80b25a1V62HSHgE=;
        b=fxL0vCSHuVQudbSJuwXGLbD4DjRh1/zwg52zaCDbPfUXuxEuk82iTWWIzYenUudZDd
         vAsSSrBTXGwjQ22C1ZncAKo5SN52kGbkTuwgyedS/GjG65H84vIp756gW15E4W+n9uZD
         64w6wTwayvIdXg1YnFtTl/e+V2Xu4Rvq8kir0=
MIME-Version: 1.0
Received: by 10.50.168.2 with SMTP id zs2mr2792815igb.9.1327151085344; Sat, 21
 Jan 2012 05:04:45 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Sat, 21 Jan 2012 05:04:45 -0800 (PST)
In-Reply-To: <CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com>
References: <CB3F422D.22F20%mueller@adobe.com>
	<CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
	<CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com>
	<CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com>
Date: Sat, 21 Jan 2012 14:04:45 +0100
Message-ID: <CAFYk8N=eiVhwqN2imhE6oJ9o4JaMDRoOt=kVdoj89685s5=8SQ@mail.gmail.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Sat, Jan 21, 2012 at 3:00 AM, Tobias Bocanegra <tripod@adobe.com> wrote:
> nt:unstructured has orderable childnodes, and we also preach to use
> nt:unstructured whereever you can. Also, i assume that a lot of
> applications benefit from node ordering (like a CMS). So I think that
> the majority of the repositories have a lot of nodes with ordered
> childnodes.


agreed, at least for small child node lists (e.g. < 1k child nodes).
but i doubt there's a need for large (e.g. 1M entries)  orderable
child node lists.

> thus i would not put too much effort in having an
> efficient non-ordered format, but making the ordered storage as fast
> as possible.

i am thinking of large child node collections with stable order.
however, they wouldn't be insertion-ordered nor client-orderable.
that's the compromise.

> using lexicographical ordering for unordered child nodes
> would certainly be a good option,

that would be an implementation detail. as long as the order
is stable (repeated reads of the same node revision should
provide the same order of the child nodes) we shouldn't make
any promises about how the order is defined.

cheers
stefan

> [...] as i can reduce the lookup (but not
> insert). also, i think that re-orderings happen relatively rarely.
>
> regards, toby
>
> On Fri, Jan 20, 2012 at 9:13 AM, Stefan Guggisberg
> <stefan.guggisberg@gmail.com> wrote:
>> On Fri, Jan 20, 2012 at 5:43 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
>>> Hi,
>>>
>>> Thinking about this more generally, it would definitely be useful to
>>> be able to use a more efficient underlying storage for unorderable
>>> nodes. However, there still are hard use cases that require us to
>>> support orderable nodes as indicated by the type of the parent node.
>>> Thus the implementation basically has two options:
>>>
>>> 1) Use a single data structure for all nodes, like Jackrabbit
>>> currently does. This simplifies the implementation but prevents us
>>> from enjoying the performance and scalability benefits of unorderable
>>> nodes.
>>>
>>> 2) Use two data structures, one for orderable and another for
>>> unorderable nodes. This is more complex (not least because it links
>>> node types to the underlying storage model), but is probably required
>>> if we want to efficiently support up to millions of child nodes per a
>>> single parent.
>>
>> i agree that it's probably required for efficiently handling both large
>> and small child node lists.
>>
>> i am not sure that it necessarily means linking node types to the
>> underlying storage modal. the microkernel prototype currently has
>> no notion of node types and that's IMO a good thing.
>>
>> node types have a way to dominant role in the current jackrabbit
>> core implementation. jackrabbit started out as the official reference
>> implementation for jsr-170, the focus was on supporting every
>> feature of the spec.
>>
>> in jr3 i guess we can and should trade some 'note type correctness'
>> for improved efficiency.
>>
>>>
>>> It might also be possible to have the underlying storage model
>>> unorderable, and just include extra ordering metadata at a higher
>>> layer where also node types are handled. Option 2b, if you like, with
>>> probably fairly significant overhead when iterating over nodes (the
>>> implementation would probably need to pre-fetch all child nodes in
>>> advance to access their ordering metadata).
>>>
>>> If we do have native support for unorderable nodes, then I wouldn't
>>> promise any particular ordering (alphabetic, insertion order, etc.)
>>> but rather leave it undefined like in Java's Map interface. The
>>> underlying implementation is then free to use whatever ordering it
>>> thinks is best.
>>
>> i agree.
>>
>> cheers
>> stefan
>>
>>>
>>> PS. Note that ordering affects not just node traversal, but also the
>>> document ordering used in search results. Though in practice we
>>> already now disable document ordering of search results by default.
>>>
>>> BR,
>>>
>>> Jukka Zitting

From dev-return-33869-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Sat Jan 21 22:38:05 2012
Return-Path: <dev-return-33869-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0D0029099
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Sat, 21 Jan 2012 22:38:05 +0000 (UTC)
Received: (qmail 21960 invoked by uid 500); 21 Jan 2012 22:38:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 21850 invoked by uid 500); 21 Jan 2012 22:38:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 21843 invoked by uid 99); 21 Jan 2012 22:38:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 21 Jan 2012 22:38:03 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tripod@adobe.com designates 64.18.1.191 as permitted sender)
Received: from [64.18.1.191] (HELO exprod6og106.obsmtp.com) (64.18.1.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 21 Jan 2012 22:37:55 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob106.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTxs+Ld9k8go4DXx0+YGEVqtaDSxtjMXS@postini.com; Sat, 21 Jan 2012 14:37:34 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0LMbW2U025085
	for <dev@jackrabbit.apache.org>; Sat, 21 Jan 2012 14:37:32 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0LMbVMM001995
	for <dev@jackrabbit.apache.org>; Sat, 21 Jan 2012 14:37:31 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Sat, 21 Jan 2012
 14:37:31 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Sat, 21 Jan 2012 22:37:29
 +0000
From: Tobias Bocanegra <tripod@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Sat, 21 Jan 2012 22:37:23 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczYjUFCULwiFTf1TFaF4TZM45rFqA==
Message-ID: <CAB+dfik8cCL3r5UfmAN5r=JuCS45iPs8bi3Zx8d9yAc9DVFVFg@mail.gmail.com>
References: <CB3F422D.22F20%mueller@adobe.com>
	<CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
	<CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com>
	<CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com>
	<CAFYk8N=eiVhwqN2imhE6oJ9o4JaMDRoOt=kVdoj89685s5=8SQ@mail.gmail.com>
In-Reply-To: <CAFYk8N=eiVhwqN2imhE6oJ9o4JaMDRoOt=kVdoj89685s5=8SQ@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

SSBhZ3JlZSwNCnNvIGZvciBsYXJnZSBjaGlsZG5vZGUgbGlzdHMsIGEgc3RhYmxlIGJ1dCB1bmNv
bnRyb2xsYWJsZSBvcmRlciB3b3VsZA0KYmUgb2ssIGFsdGhvdWdoIHZpb2xhdGluZyB0aGUgc3Bl
Yz8NCg0KLS0NCg0KdG9ieQ0KT24gU2F0LCBKYW4gMjEsIDIwMTIgYXQgNTowNCBBTSwgU3RlZmFu
IEd1Z2dpc2JlcmcNCjxzdGVmYW4uZ3VnZ2lzYmVyZ0BnbWFpbC5jb20+IHdyb3RlOg0KPiBPbiBT
YXQsIEphbiAyMSwgMjAxMiBhdCAzOjAwIEFNLCBUb2JpYXMgQm9jYW5lZ3JhIDx0cmlwb2RAYWRv
YmUuY29tPiB3cm90ZToNCj4+IG50OnVuc3RydWN0dXJlZCBoYXMgb3JkZXJhYmxlIGNoaWxkbm9k
ZXMsIGFuZCB3ZSBhbHNvIHByZWFjaCB0byB1c2UNCj4+IG50OnVuc3RydWN0dXJlZCB3aGVyZWV2
ZXIgeW91IGNhbi4gQWxzbywgaSBhc3N1bWUgdGhhdCBhIGxvdCBvZg0KPj4gYXBwbGljYXRpb25z
IGJlbmVmaXQgZnJvbSBub2RlIG9yZGVyaW5nIChsaWtlIGEgQ01TKS4gU28gSSB0aGluayB0aGF0
DQo+PiB0aGUgbWFqb3JpdHkgb2YgdGhlIHJlcG9zaXRvcmllcyBoYXZlIGEgbG90IG9mIG5vZGVz
IHdpdGggb3JkZXJlZA0KPj4gY2hpbGRub2Rlcy4NCj4NCj4NCj4gYWdyZWVkLCBhdCBsZWFzdCBm
b3Igc21hbGwgY2hpbGQgbm9kZSBsaXN0cyAoZS5nLiA8IDFrIGNoaWxkIG5vZGVzKS4NCj4gYnV0
IGkgZG91YnQgdGhlcmUncyBhIG5lZWQgZm9yIGxhcmdlIChlLmcuIDFNIGVudHJpZXMpIMKgb3Jk
ZXJhYmxlDQo+IGNoaWxkIG5vZGUgbGlzdHMuDQo+DQo+PiB0aHVzIGkgd291bGQgbm90IHB1dCB0
b28gbXVjaCBlZmZvcnQgaW4gaGF2aW5nIGFuDQo+PiBlZmZpY2llbnQgbm9uLW9yZGVyZWQgZm9y
bWF0LCBidXQgbWFraW5nIHRoZSBvcmRlcmVkIHN0b3JhZ2UgYXMgZmFzdA0KPj4gYXMgcG9zc2li
bGUuDQo+DQo+IGkgYW0gdGhpbmtpbmcgb2YgbGFyZ2UgY2hpbGQgbm9kZSBjb2xsZWN0aW9ucyB3
aXRoIHN0YWJsZSBvcmRlci4NCj4gaG93ZXZlciwgdGhleSB3b3VsZG4ndCBiZSBpbnNlcnRpb24t
b3JkZXJlZCBub3IgY2xpZW50LW9yZGVyYWJsZS4NCj4gdGhhdCdzIHRoZSBjb21wcm9taXNlLg0K
Pg0KPj4gdXNpbmcgbGV4aWNvZ3JhcGhpY2FsIG9yZGVyaW5nIGZvciB1bm9yZGVyZWQgY2hpbGQg
bm9kZXMNCj4+IHdvdWxkIGNlcnRhaW5seSBiZSBhIGdvb2Qgb3B0aW9uLA0KPg0KPiB0aGF0IHdv
dWxkIGJlIGFuIGltcGxlbWVudGF0aW9uIGRldGFpbC4gYXMgbG9uZyBhcyB0aGUgb3JkZXINCj4g
aXMgc3RhYmxlIChyZXBlYXRlZCByZWFkcyBvZiB0aGUgc2FtZSBub2RlIHJldmlzaW9uIHNob3Vs
ZA0KPiBwcm92aWRlIHRoZSBzYW1lIG9yZGVyIG9mIHRoZSBjaGlsZCBub2Rlcykgd2Ugc2hvdWxk
bid0IG1ha2UNCj4gYW55IHByb21pc2VzIGFib3V0IGhvdyB0aGUgb3JkZXIgaXMgZGVmaW5lZC4N
Cj4NCj4gY2hlZXJzDQo+IHN0ZWZhbg0KPg0KPj4gWy4uLl0gYXMgaSBjYW4gcmVkdWNlIHRoZSBs
b29rdXAgKGJ1dCBub3QNCj4+IGluc2VydCkuIGFsc28sIGkgdGhpbmsgdGhhdCByZS1vcmRlcmlu
Z3MgaGFwcGVuIHJlbGF0aXZlbHkgcmFyZWx5Lg0KPj4NCj4+IHJlZ2FyZHMsIHRvYnkNCj4+DQo+
PiBPbiBGcmksIEphbiAyMCwgMjAxMiBhdCA5OjEzIEFNLCBTdGVmYW4gR3VnZ2lzYmVyZw0KPj4g
PHN0ZWZhbi5ndWdnaXNiZXJnQGdtYWlsLmNvbT4gd3JvdGU6DQo+Pj4gT24gRnJpLCBKYW4gMjAs
IDIwMTIgYXQgNTo0MyBQTSwgSnVra2EgWml0dGluZyA8anVra2Eueml0dGluZ0BnbWFpbC5jb20+
IHdyb3RlOg0KPj4+PiBIaSwNCj4+Pj4NCj4+Pj4gVGhpbmtpbmcgYWJvdXQgdGhpcyBtb3JlIGdl
bmVyYWxseSwgaXQgd291bGQgZGVmaW5pdGVseSBiZSB1c2VmdWwgdG8NCj4+Pj4gYmUgYWJsZSB0
byB1c2UgYSBtb3JlIGVmZmljaWVudCB1bmRlcmx5aW5nIHN0b3JhZ2UgZm9yIHVub3JkZXJhYmxl
DQo+Pj4+IG5vZGVzLiBIb3dldmVyLCB0aGVyZSBzdGlsbCBhcmUgaGFyZCB1c2UgY2FzZXMgdGhh
dCByZXF1aXJlIHVzIHRvDQo+Pj4+IHN1cHBvcnQgb3JkZXJhYmxlIG5vZGVzIGFzIGluZGljYXRl
ZCBieSB0aGUgdHlwZSBvZiB0aGUgcGFyZW50IG5vZGUuDQo+Pj4+IFRodXMgdGhlIGltcGxlbWVu
dGF0aW9uIGJhc2ljYWxseSBoYXMgdHdvIG9wdGlvbnM6DQo+Pj4+DQo+Pj4+IDEpIFVzZSBhIHNp
bmdsZSBkYXRhIHN0cnVjdHVyZSBmb3IgYWxsIG5vZGVzLCBsaWtlIEphY2tyYWJiaXQNCj4+Pj4g
Y3VycmVudGx5IGRvZXMuIFRoaXMgc2ltcGxpZmllcyB0aGUgaW1wbGVtZW50YXRpb24gYnV0IHBy
ZXZlbnRzIHVzDQo+Pj4+IGZyb20gZW5qb3lpbmcgdGhlIHBlcmZvcm1hbmNlIGFuZCBzY2FsYWJp
bGl0eSBiZW5lZml0cyBvZiB1bm9yZGVyYWJsZQ0KPj4+PiBub2Rlcy4NCj4+Pj4NCj4+Pj4gMikg
VXNlIHR3byBkYXRhIHN0cnVjdHVyZXMsIG9uZSBmb3Igb3JkZXJhYmxlIGFuZCBhbm90aGVyIGZv
cg0KPj4+PiB1bm9yZGVyYWJsZSBub2Rlcy4gVGhpcyBpcyBtb3JlIGNvbXBsZXggKG5vdCBsZWFz
dCBiZWNhdXNlIGl0IGxpbmtzDQo+Pj4+IG5vZGUgdHlwZXMgdG8gdGhlIHVuZGVybHlpbmcgc3Rv
cmFnZSBtb2RlbCksIGJ1dCBpcyBwcm9iYWJseSByZXF1aXJlZA0KPj4+PiBpZiB3ZSB3YW50IHRv
IGVmZmljaWVudGx5IHN1cHBvcnQgdXAgdG8gbWlsbGlvbnMgb2YgY2hpbGQgbm9kZXMgcGVyIGEN
Cj4+Pj4gc2luZ2xlIHBhcmVudC4NCj4+Pg0KPj4+IGkgYWdyZWUgdGhhdCBpdCdzIHByb2JhYmx5
IHJlcXVpcmVkIGZvciBlZmZpY2llbnRseSBoYW5kbGluZyBib3RoIGxhcmdlDQo+Pj4gYW5kIHNt
YWxsIGNoaWxkIG5vZGUgbGlzdHMuDQo+Pj4NCj4+PiBpIGFtIG5vdCBzdXJlIHRoYXQgaXQgbmVj
ZXNzYXJpbHkgbWVhbnMgbGlua2luZyBub2RlIHR5cGVzIHRvIHRoZQ0KPj4+IHVuZGVybHlpbmcg
c3RvcmFnZSBtb2RhbC4gdGhlIG1pY3Jva2VybmVsIHByb3RvdHlwZSBjdXJyZW50bHkgaGFzDQo+
Pj4gbm8gbm90aW9uIG9mIG5vZGUgdHlwZXMgYW5kIHRoYXQncyBJTU8gYSBnb29kIHRoaW5nLg0K
Pj4+DQo+Pj4gbm9kZSB0eXBlcyBoYXZlIGEgd2F5IHRvIGRvbWluYW50IHJvbGUgaW4gdGhlIGN1
cnJlbnQgamFja3JhYmJpdA0KPj4+IGNvcmUgaW1wbGVtZW50YXRpb24uIGphY2tyYWJiaXQgc3Rh
cnRlZCBvdXQgYXMgdGhlIG9mZmljaWFsIHJlZmVyZW5jZQ0KPj4+IGltcGxlbWVudGF0aW9uIGZv
ciBqc3ItMTcwLCB0aGUgZm9jdXMgd2FzIG9uIHN1cHBvcnRpbmcgZXZlcnkNCj4+PiBmZWF0dXJl
IG9mIHRoZSBzcGVjLg0KPj4+DQo+Pj4gaW4ganIzIGkgZ3Vlc3Mgd2UgY2FuIGFuZCBzaG91bGQg
dHJhZGUgc29tZSAnbm90ZSB0eXBlIGNvcnJlY3RuZXNzJw0KPj4+IGZvciBpbXByb3ZlZCBlZmZp
Y2llbmN5Lg0KPj4+DQo+Pj4+DQo+Pj4+IEl0IG1pZ2h0IGFsc28gYmUgcG9zc2libGUgdG8gaGF2
ZSB0aGUgdW5kZXJseWluZyBzdG9yYWdlIG1vZGVsDQo+Pj4+IHVub3JkZXJhYmxlLCBhbmQganVz
dCBpbmNsdWRlIGV4dHJhIG9yZGVyaW5nIG1ldGFkYXRhIGF0IGEgaGlnaGVyDQo+Pj4+IGxheWVy
IHdoZXJlIGFsc28gbm9kZSB0eXBlcyBhcmUgaGFuZGxlZC4gT3B0aW9uIDJiLCBpZiB5b3UgbGlr
ZSwgd2l0aA0KPj4+PiBwcm9iYWJseSBmYWlybHkgc2lnbmlmaWNhbnQgb3ZlcmhlYWQgd2hlbiBp
dGVyYXRpbmcgb3ZlciBub2RlcyAodGhlDQo+Pj4+IGltcGxlbWVudGF0aW9uIHdvdWxkIHByb2Jh
Ymx5IG5lZWQgdG8gcHJlLWZldGNoIGFsbCBjaGlsZCBub2RlcyBpbg0KPj4+PiBhZHZhbmNlIHRv
IGFjY2VzcyB0aGVpciBvcmRlcmluZyBtZXRhZGF0YSkuDQo+Pj4+DQo+Pj4+IElmIHdlIGRvIGhh
dmUgbmF0aXZlIHN1cHBvcnQgZm9yIHVub3JkZXJhYmxlIG5vZGVzLCB0aGVuIEkgd291bGRuJ3QN
Cj4+Pj4gcHJvbWlzZSBhbnkgcGFydGljdWxhciBvcmRlcmluZyAoYWxwaGFiZXRpYywgaW5zZXJ0
aW9uIG9yZGVyLCBldGMuKQ0KPj4+PiBidXQgcmF0aGVyIGxlYXZlIGl0IHVuZGVmaW5lZCBsaWtl
IGluIEphdmEncyBNYXAgaW50ZXJmYWNlLiBUaGUNCj4+Pj4gdW5kZXJseWluZyBpbXBsZW1lbnRh
dGlvbiBpcyB0aGVuIGZyZWUgdG8gdXNlIHdoYXRldmVyIG9yZGVyaW5nIGl0DQo+Pj4+IHRoaW5r
cyBpcyBiZXN0Lg0KPj4+DQo+Pj4gaSBhZ3JlZS4NCj4+Pg0KPj4+IGNoZWVycw0KPj4+IHN0ZWZh
bg0KPj4+DQo+Pj4+DQo+Pj4+IFBTLiBOb3RlIHRoYXQgb3JkZXJpbmcgYWZmZWN0cyBub3QganVz
dCBub2RlIHRyYXZlcnNhbCwgYnV0IGFsc28gdGhlDQo+Pj4+IGRvY3VtZW50IG9yZGVyaW5nIHVz
ZWQgaW4gc2VhcmNoIHJlc3VsdHMuIFRob3VnaCBpbiBwcmFjdGljZSB3ZQ0KPj4+PiBhbHJlYWR5
IG5vdyBkaXNhYmxlIGRvY3VtZW50IG9yZGVyaW5nIG9mIHNlYXJjaCByZXN1bHRzIGJ5IGRlZmF1
bHQuDQo+Pj4+DQo+Pj4+IEJSLA0KPj4+Pg0KPj4+PiBKdWtrYSBaaXR0aW5n

From dev-return-33870-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Sun Jan 22 12:36:06 2012
Return-Path: <dev-return-33870-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B2610B021
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Sun, 22 Jan 2012 12:36:06 +0000 (UTC)
Received: (qmail 36092 invoked by uid 500); 22 Jan 2012 12:36:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 36023 invoked by uid 500); 22 Jan 2012 12:36:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 36016 invoked by uid 99); 22 Jan 2012 12:36:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 22 Jan 2012 12:36:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 22 Jan 2012 12:36:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id DA14D15B59D
	for <dev@jackrabbit.apache.org>; Sun, 22 Jan 2012 12:35:39 +0000 (UTC)
Date: Sun, 22 Jan 2012 12:35:39 +0000 (UTC)
From: "David Buchmann (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1118370741.64462.1327235739894.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3215) not releasing session locks on session
 destruct
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

not releasing session locks on session destruct
-----------------------------------------------

                 Key: JCR-3215
                 URL: https://issues.apache.org/jira/browse/JCR-3215
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-jcr-client, locks
    Affects Versions: 2.3.6
            Reporter: David Buchmann


while investigating JCR-3205 i noticed that when my client java vm terminates without calling explicit session.logout() the session locks are not released. i would expect the session to do its logout job upon destruction. from what i understood, the server hes no notion of session, so its the job of the client to clean up.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33871-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 09:30:15 2012
Return-Path: <dev-return-33871-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 181359BED
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 09:30:15 +0000 (UTC)
Received: (qmail 52804 invoked by uid 500); 23 Jan 2012 09:30:14 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 51944 invoked by uid 500); 23 Jan 2012 09:30:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 51929 invoked by uid 99); 23 Jan 2012 09:30:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 09:30:04 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aklimets@adobe.com designates 64.18.1.185 as permitted sender)
Received: from [64.18.1.185] (HELO exprod6og103.obsmtp.com) (64.18.1.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 09:29:52 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob103.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx0oe5E6MRowmeJKvTt0GEDzyxkfGx70@postini.com; Mon, 23 Jan 2012 01:29:32 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0N9Rc0Y021234
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 01:27:38 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0N9TVMM026520
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 01:29:31 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Mon, 23 Jan 2012
 01:29:31 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Mon, 23 Jan 2012 09:29:27
 +0000
From: Alexander Klimetschek <aklimets@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Mon, 23 Jan 2012 09:29:26 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczZsYAdCj3Ic3dQSA+Ly34E7xBNPA==
Message-ID: <CB42E666.A05A4%aklimets@adobe.com>
In-Reply-To: <CAB+dfik8cCL3r5UfmAN5r=JuCS45iPs8bi3Zx8d9yAc9DVFVFg@mail.gmail.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

I think there is a use case for large flat unordered lists (using a node
type with orderable =3D false). For example, dictionaries, where the key an=
d
value are in the properties and the node name is not really relevant, and
where you don't want to create nested structures just for the sake of
scalability - which also increases the total number of nodes.

Cheers,
Alex

On 21.01.12 23:37, "Tobias Bocanegra" <tripod@adobe.com> wrote:

>I agree,
>so for large childnode lists, a stable but uncontrollable order would
>be ok, although violating the spec?
>
>--
>
>toby
>On Sat, Jan 21, 2012 at 5:04 AM, Stefan Guggisberg
><stefan.guggisberg@gmail.com> wrote:
>> On Sat, Jan 21, 2012 at 3:00 AM, Tobias Bocanegra <tripod@adobe.com>
>>wrote:
>>> nt:unstructured has orderable childnodes, and we also preach to use
>>> nt:unstructured whereever you can. Also, i assume that a lot of
>>> applications benefit from node ordering (like a CMS). So I think that
>>> the majority of the repositories have a lot of nodes with ordered
>>> childnodes.
>>
>>
>> agreed, at least for small child node lists (e.g. < 1k child nodes).
>> but i doubt there's a need for large (e.g. 1M entries)  orderable
>> child node lists.
>>
>>> thus i would not put too much effort in having an
>>> efficient non-ordered format, but making the ordered storage as fast
>>> as possible.
>>
>> i am thinking of large child node collections with stable order.
>> however, they wouldn't be insertion-ordered nor client-orderable.
>> that's the compromise.
>>
>>> using lexicographical ordering for unordered child nodes
>>> would certainly be a good option,
>>
>> that would be an implementation detail. as long as the order
>> is stable (repeated reads of the same node revision should
>> provide the same order of the child nodes) we shouldn't make
>> any promises about how the order is defined.
>>
>> cheers
>> stefan
>>
>>> [...] as i can reduce the lookup (but not
>>> insert). also, i think that re-orderings happen relatively rarely.
>>>
>>> regards, toby
>>>
>>> On Fri, Jan 20, 2012 at 9:13 AM, Stefan Guggisberg
>>> <stefan.guggisberg@gmail.com> wrote:
>>>> On Fri, Jan 20, 2012 at 5:43 PM, Jukka Zitting
>>>><jukka.zitting@gmail.com> wrote:
>>>>> Hi,
>>>>>
>>>>> Thinking about this more generally, it would definitely be useful to
>>>>> be able to use a more efficient underlying storage for unorderable
>>>>> nodes. However, there still are hard use cases that require us to
>>>>> support orderable nodes as indicated by the type of the parent node.
>>>>> Thus the implementation basically has two options:
>>>>>
>>>>> 1) Use a single data structure for all nodes, like Jackrabbit
>>>>> currently does. This simplifies the implementation but prevents us
>>>>> from enjoying the performance and scalability benefits of unorderable
>>>>> nodes.
>>>>>
>>>>> 2) Use two data structures, one for orderable and another for
>>>>> unorderable nodes. This is more complex (not least because it links
>>>>> node types to the underlying storage model), but is probably required
>>>>> if we want to efficiently support up to millions of child nodes per a
>>>>> single parent.
>>>>
>>>> i agree that it's probably required for efficiently handling both
>>>>large
>>>> and small child node lists.
>>>>
>>>> i am not sure that it necessarily means linking node types to the
>>>> underlying storage modal. the microkernel prototype currently has
>>>> no notion of node types and that's IMO a good thing.
>>>>
>>>> node types have a way to dominant role in the current jackrabbit
>>>> core implementation. jackrabbit started out as the official reference
>>>> implementation for jsr-170, the focus was on supporting every
>>>> feature of the spec.
>>>>
>>>> in jr3 i guess we can and should trade some 'note type correctness'
>>>> for improved efficiency.
>>>>
>>>>>
>>>>> It might also be possible to have the underlying storage model
>>>>> unorderable, and just include extra ordering metadata at a higher
>>>>> layer where also node types are handled. Option 2b, if you like, with
>>>>> probably fairly significant overhead when iterating over nodes (the
>>>>> implementation would probably need to pre-fetch all child nodes in
>>>>> advance to access their ordering metadata).
>>>>>
>>>>> If we do have native support for unorderable nodes, then I wouldn't
>>>>> promise any particular ordering (alphabetic, insertion order, etc.)
>>>>> but rather leave it undefined like in Java's Map interface. The
>>>>> underlying implementation is then free to use whatever ordering it
>>>>> thinks is best.
>>>>
>>>> i agree.
>>>>
>>>> cheers
>>>> stefan
>>>>
>>>>>
>>>>> PS. Note that ordering affects not just node traversal, but also the
>>>>> document ordering used in search results. Though in practice we
>>>>> already now disable document ordering of search results by default.
>>>>>
>>>>> BR,
>>>>>
>>>>> Jukka Zitting



--=20
Alexander Klimetschek
Developer // Adobe (Day) // Berlin - Basel





From dev-return-33872-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 09:44:39 2012
Return-Path: <dev-return-33872-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 69EBE9073
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 09:44:39 +0000 (UTC)
Received: (qmail 71173 invoked by uid 500); 23 Jan 2012 09:44:39 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 70789 invoked by uid 500); 23 Jan 2012 09:44:29 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 70780 invoked by uid 99); 23 Jan 2012 09:44:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 09:44:27 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 09:44:20 +0000
Received: by werm1 with SMTP id m1so1247118wer.1
        for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 01:43:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=XEvOS8gwW7WvinQbGx189mfiJKW5NERpNKO1da2jO2E=;
        b=UXzFzdvMnvDFhEtyt0Qxhp99F3YQLq1lzMeugJPUt33RqcT4NCsh8NuqZM7+Zl3rnB
         7nfsu0sNhrAT1i2NuizCTZirVbKXJpggLve5u9UmoGPdBT0E8fdTX306N+DE5vx70L4F
         ri1CYM1xde5NvkCE5Ar0/kWbEtYAErrAkOTVY=
Received: by 10.216.135.91 with SMTP id t69mr2802951wei.33.1327311839085; Mon,
 23 Jan 2012 01:43:59 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Mon, 23 Jan 2012 01:43:38 -0800 (PST)
In-Reply-To: <CAB+dfik8cCL3r5UfmAN5r=JuCS45iPs8bi3Zx8d9yAc9DVFVFg@mail.gmail.com>
References: <CB3F422D.22F20%mueller@adobe.com> <CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
 <CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com>
 <CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com>
 <CAFYk8N=eiVhwqN2imhE6oJ9o4JaMDRoOt=kVdoj89685s5=8SQ@mail.gmail.com> <CAB+dfik8cCL3r5UfmAN5r=JuCS45iPs8bi3Zx8d9yAc9DVFVFg@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Mon, 23 Jan 2012 10:43:38 +0100
Message-ID: <CAOFYJNbDpDMNCW1m2ZuXboGqfJhQaEBv_cHmzZsxkwYASfkKhQ@mail.gmail.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi,

On Sat, Jan 21, 2012 at 11:37 PM, Tobias Bocanegra <tripod@adobe.com> wrote:
> so for large childnode lists, a stable but uncontrollable order
> would be ok, although violating the spec?

I wouldn't violate the spec for this. If you have an orderable node
(like nt:unstructured), then the repository should keep track of the
order of child nodes regardless of how many they are. IMHO it's OK for
the repository *not* to scale up or perform well if someone dumps a
million child nodes to an orderable parent.

However, it would be great if we could implement efficient storage for
nodes with lots (i.e. millions) of unorderable children. In such a
case I'd say we can expect the client to explicitly use a parent node
with a custom node type that doesn't require orderability.

I wouldn't even promise a stable iteration order for such cases. The
repository should be free to for example reorder the internal data
structure based on frequent access patterns.

BR,

Jukka Zitting

From dev-return-33873-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 10:43:57 2012
Return-Path: <dev-return-33873-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 755119D2F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 10:43:57 +0000 (UTC)
Received: (qmail 52690 invoked by uid 500); 23 Jan 2012 10:43:57 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52597 invoked by uid 500); 23 Jan 2012 10:43:56 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 52589 invoked by uid 99); 23 Jan 2012 10:43:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 10:43:55 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 10:43:48 +0000
Received: by werm1 with SMTP id m1so1331573wer.1
        for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 02:43:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=BVsOnV+t5IGerj4D+eb9nhcoV2JmdJFdk/iPA2rwxPs=;
        b=Chz1NtbOa71Xpoxrv2hLkvSAFUIV2NfJUUZkzxxuVdDFRhfjw+EcIl88eJaQMtHBe9
         OzS8oh09EJzLoM3FCHmm04rUB6C+91+V50cnMMg5btnpxWgSV7n9cVEiEwGZFMkpTdoR
         vl05+W9kG9P2WZXb+3ndytmxus2f4AD8yTik0=
Received: by 10.216.132.148 with SMTP id o20mr3373619wei.33.1327315408115;
 Mon, 23 Jan 2012 02:43:28 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Mon, 23 Jan 2012 02:43:07 -0800 (PST)
In-Reply-To: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
References: <CAOFYJNZUZ4bAcLNqDuc1E1D3nrnkNBNnTjjViniXvqmSPniO-A@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Mon, 23 Jan 2012 11:43:07 +0100
Message-ID: <CAOFYJNYMDg-ufNJESpVaupRC7TpSy58kwndyRA-W8USkhOPDVQ@mail.gmail.com>
Subject: [RESULT] [VOTE] Release Apache Jackrabbit 2.3.7
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Thu, Jan 19, 2012 at 7:23 PM, Jukka Zitting <jukka.zitting@gmail.com> wr=
ote:
> Please vote on releasing this package as Apache Jackrabbit 2.3.7.

The vote passes as follows (* marks a PMC member):

    +1 Bart van der Schans *
    +1 Claus K=F6ll *
    +1 David Buchmann
    +1 Jukka Zitting *
    +1 Tobias Bocanegra *

Thanks! I'll push the release out.

PS. David, can you file a bug report about the problem you described?
It sounds like it could be a regression from JCR-3198.

BR,

Jukka Zitting

From dev-return-33874-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 10:44:09 2012
Return-Path: <dev-return-33874-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 965A69E6C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 10:44:09 +0000 (UTC)
Received: (qmail 54218 invoked by uid 500); 23 Jan 2012 10:44:09 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 53962 invoked by uid 500); 23 Jan 2012 10:44:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 53943 invoked by uid 99); 23 Jan 2012 10:44:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 10:44:03 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.21 as permitted sender)
Received: from [64.18.1.21] (HELO exprod6og108.obsmtp.com) (64.18.1.21)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 23 Jan 2012 10:43:55 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob108.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx051ty19J+khJ793P7Rar4RVvTki1lF@postini.com; Mon, 23 Jan 2012 02:43:35 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0NAhX2U028516
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 02:43:33 -0800 (PST)
Received: from nahub02.corp.adobe.com (nahub02.corp.adobe.com [10.8.189.98])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0NAhWPl019430
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 02:43:33 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub02.corp.adobe.com
 (10.8.189.98) with Microsoft SMTP Server (TLS) id 8.3.192.1; Mon, 23 Jan 2012
 02:43:32 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Mon, 23 Jan 2012 10:43:30
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Mon, 23 Jan 2012 10:43:30 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczZu9ief6VSOzmFRweVGzfUqMvADQ==
Message-ID: <1B72AC63-B787-4AE3-897A-E5DA3D719E4B@adobe.com>
References: <CB3F422D.22F20%mueller@adobe.com>
 <CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com>
 <CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com>
 <CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com>
 <CAFYk8N=eiVhwqN2imhE6oJ9o4JaMDRoOt=kVdoj89685s5=8SQ@mail.gmail.com>
 <CAB+dfik8cCL3r5UfmAN5r=JuCS45iPs8bi3Zx8d9yAc9DVFVFg@mail.gmail.com>
 <CAOFYJNbDpDMNCW1m2ZuXboGqfJhQaEBv_cHmzZsxkwYASfkKhQ@mail.gmail.com>
In-Reply-To: <CAOFYJNbDpDMNCW1m2ZuXboGqfJhQaEBv_cHmzZsxkwYASfkKhQ@mail.gmail.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

Am 23.01.2012 um 10:43 schrieb Jukka Zitting:

> Hi,
>=20
> On Sat, Jan 21, 2012 at 11:37 PM, Tobias Bocanegra <tripod@adobe.com> wro=
te:
>> so for large childnode lists, a stable but uncontrollable order
>> would be ok, although violating the spec?
>=20
> I wouldn't violate the spec for this. If you have an orderable node
> (like nt:unstructured), then the repository should keep track of the
> order of child nodes regardless of how many they are. IMHO it's OK for
> the repository *not* to scale up or perform well if someone dumps a
> million child nodes to an orderable parent.
>=20
> However, it would be great if we could implement efficient storage for
> nodes with lots (i.e. millions) of unorderable children. In such a
> case I'd say we can expect the client to explicitly use a parent node
> with a custom node type that doesn't require orderability.

I am not sure, whether this proposal does not open a can of worms: Consider=
 using a node for child nodes whose retrieval should be ordered by insertio=
n order. This is currently guaranteed by switching on ordered child nodes o=
n the parent node, right ?

So, applications using this will always use ordered nodes and thus suffer f=
rom performance again ... not good.


>=20
> I wouldn't even promise a stable iteration order for such cases. The
> repository should be free to for example reorder the internal data
> structure based on frequent access patterns.

+1

Though paging to the list will then not be possible at all !

Wouldn't it be such, that "unordered" might mean "no defined but stable ord=
ering" while ordered means "insertion order unless eplicitly changed" ?

Both must really perform well or we get bad press again....

Regards
Felix=

From dev-return-33875-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 11:26:31 2012
Return-Path: <dev-return-33875-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 000CB9BB9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 11:26:30 +0000 (UTC)
Received: (qmail 18712 invoked by uid 500); 23 Jan 2012 11:26:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 18570 invoked by uid 500); 23 Jan 2012 11:26:29 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 18560 invoked by uid 99); 23 Jan 2012 11:26:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 11:26:29 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aklimets@adobe.com designates 64.18.1.21 as permitted sender)
Received: from [64.18.1.21] (HELO exprod6og108.obsmtp.com) (64.18.1.21)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 11:26:19 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob108.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx1DxblTmREL0XWQYBqVdOxHQZG10qw4@postini.com; Mon, 23 Jan 2012 03:25:58 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.corp.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0NBPu2U001374
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 03:25:56 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0NBPtMM005678
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 03:25:55 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Mon, 23 Jan 2012
 03:25:55 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Mon, 23 Jan 2012 11:25:53
 +0000
From: Alexander Klimetschek <aklimets@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Mon, 23 Jan 2012 11:25:48 +0000
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
Thread-Topic: [jr3] Orderable child nodes: required (to be the default)?
Thread-Index: AczZwcRZ/rC6OOcOQ2eBgob16HcbKg==
Message-ID: <CB43023F.A063A%aklimets@adobe.com>
In-Reply-To: <1B72AC63-B787-4AE3-897A-E5DA3D719E4B@adobe.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

On 23.01.12 11:43, "Felix Meschberger" <fmeschbe@adobe.com> wrote:
>Wouldn't it be such, that "unordered" might mean "no defined but stable
>ordering" while ordered means "insertion order unless eplicitly changed" ?

+1

Alex

--=20
Alexander Klimetschek
Developer // Adobe (Day) // Berlin - Basel





From dev-return-33876-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 11:59:46 2012
Return-Path: <dev-return-33876-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 32CDC90CC
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 11:59:46 +0000 (UTC)
Received: (qmail 60001 invoked by uid 500); 23 Jan 2012 11:59:45 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 59929 invoked by uid 500); 23 Jan 2012 11:59:45 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 59920 invoked by uid 99); 23 Jan 2012 11:59:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 11:59:45 +0000
X-ASF-Spam-Status: No, hits=-0.6 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.185] (HELO exprod6og103.obsmtp.com) (64.18.1.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 11:59:37 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob103.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx1Lk2XPIN5GouzLgx5tT9Dq75ssGJ7x@postini.com; Mon, 23 Jan 2012 03:59:16 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0NBxF2U003475
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 03:59:15 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0NBxCPm004959
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 03:59:14 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Mon, 23 Jan 2012
 03:59:12 -0800
Received: from susi.local (10.136.139.151) by eurhub01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Mon, 23 Jan 2012
 11:59:12 +0000
Message-ID: <4F1D4B8F.50208@apache.org>
Date: Mon, 23 Jan 2012 11:59:11 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
References: <CB3F422D.22F20%mueller@adobe.com> <CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com> <CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com> <CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com> <CAFYk8N=eiVhwqN2imhE6oJ9o4JaMDRoOt=kVdoj89685s5=8SQ@mail.gmail.com> <CAB+dfik8cCL3r5UfmAN5r=JuCS45iPs8bi3Zx8d9yAc9DVFVFg@mail.gmail.com> <CAOFYJNbDpDMNCW1m2ZuXboGqfJhQaEBv_cHmzZsxkwYASfkKhQ@mail.gmail.com> <1B72AC63-B787-4AE3-897A-E5DA3D719E4B@adobe.com>
In-Reply-To: <1B72AC63-B787-4AE3-897A-E5DA3D719E4B@adobe.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit

>> On Sat, Jan 21, 2012 at 11:37 PM, Tobias Bocanegra<tripod@adobe.com>  wrote:
>>> so for large childnode lists, a stable but uncontrollable order
>>> would be ok, although violating the spec?
>>
>> I wouldn't violate the spec for this. If you have an orderable node
>> (like nt:unstructured), then the repository should keep track of the
>> order of child nodes regardless of how many they are. IMHO it's OK for
>> the repository *not* to scale up or perform well if someone dumps a
>> million child nodes to an orderable parent.
>>
>> However, it would be great if we could implement efficient storage for
>> nodes with lots (i.e. millions) of unorderable children. In such a
>> case I'd say we can expect the client to explicitly use a parent node
>> with a custom node type that doesn't require orderability.
>
> I am not sure, whether this proposal does not open a can of worms: Consider using a node for child nodes whose retrieval should be ordered by insertion order. This is currently guaranteed by switching on ordered child nodes on the parent node, right ?
>
> So, applications using this will always use ordered nodes and thus suffer from performance again ... not good.

Well, there is no free lunch...

If we want to go 'big data' and distributed, we will have to make trade 
offs. What we need to do IMO is to carefully identify the areas where we 
can/want to trade off and make sure these are well understood.

Michael

From dev-return-33877-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 12:00:07 2012
Return-Path: <dev-return-33877-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6CFE39121
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 12:00:07 +0000 (UTC)
Received: (qmail 61528 invoked by uid 500); 23 Jan 2012 12:00:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 61421 invoked by uid 500); 23 Jan 2012 12:00:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 61414 invoked by uid 99); 23 Jan 2012 12:00:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 12:00:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of julian.reschke@gmx.de designates 213.165.64.23 as permitted sender)
Received: from [213.165.64.23] (HELO mailout-de.gmx.net) (213.165.64.23)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 23 Jan 2012 11:59:58 +0000
Received: (qmail invoked by alias); 23 Jan 2012 11:59:36 -0000
Received: from p5DCC2D48.dip.t-dialin.net (EHLO [192.168.178.36]) [93.204.45.72]
  by mail.gmx.net (mp029) with SMTP; 23 Jan 2012 12:59:36 +0100
X-Authenticated: #1915285
X-Provags-ID: V01U2FsdGVkX19Sz2oHpwVSC9sJOhGKWRNyjfe31h43n9gQHg6oWF
	KBi3n6q8LCifCl
Message-ID: <4F1D4BA5.9040402@gmx.de>
Date: Mon, 23 Jan 2012 12:59:33 +0100
From: Julian Reschke <julian.reschke@gmx.de>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
CC: Felix Meschberger <fmeschbe@adobe.com>
Subject: Re: [jr3] Orderable child nodes: required (to be the default)?
References: <CB3F422D.22F20%mueller@adobe.com> <CAOFYJNa2KwdaKWM=S1XmBKsrQiUyvAZf8k5Yf03t0mNMrGzM0w@mail.gmail.com> <CAFYk8NkJKivf0bm+g=-R95R_=YqDVvNHM5GSUhUZSd0E+-z30w@mail.gmail.com> <CAB+dfik3jsGaeZvza4PkErPUmhU4bYxiJVcnNSXC4jrCNcAgpQ@mail.gmail.com> <CAFYk8N=eiVhwqN2imhE6oJ9o4JaMDRoOt=kVdoj89685s5=8SQ@mail.gmail.com> <CAB+dfik8cCL3r5UfmAN5r=JuCS45iPs8bi3Zx8d9yAc9DVFVFg@mail.gmail.com> <CAOFYJNbDpDMNCW1m2ZuXboGqfJhQaEBv_cHmzZsxkwYASfkKhQ@mail.gmail.com> <1B72AC63-B787-4AE3-897A-E5DA3D719E4B@adobe.com>
In-Reply-To: <1B72AC63-B787-4AE3-897A-E5DA3D719E4B@adobe.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0

On 2012-01-23 11:43, Felix Meschberger wrote:
> ...
> I am not sure, whether this proposal does not open a can of worms: Consider using a node for child nodes whose retrieval should be ordered by insertion order. This is currently guaranteed by switching on ordered child nodes on the parent node, right ?
>
> So, applications using this will always use ordered nodes and thus suffer from performance again ... not good.
> ...

How is "ordered by insertion order" and "allowing manual re-ordering" 
different from an application point of view?

> ...

Best regards, Julia

From dev-return-33878-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 13:15:05 2012
Return-Path: <dev-return-33878-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AA22A95D0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 13:15:05 +0000 (UTC)
Received: (qmail 34610 invoked by uid 500); 23 Jan 2012 13:15:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 34495 invoked by uid 500); 23 Jan 2012 13:15:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 34487 invoked by uid 99); 23 Jan 2012 13:15:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 13:15:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 13:15:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 43B3815E154
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 13:14:40 +0000 (UTC)
Date: Mon, 23 Jan 2012 13:14:40 +0000 (UTC)
From: "Gustavo Orair (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <36170062.66694.1327324480293.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1363994079.34166.1322813140001.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3166) jackrabbit is not working in JBoss
 AS7.1.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3166?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13191142#comment-13191142 ] 

Gustavo Orair commented on JCR-3166:
------------------------------------

Regarding the error:
"The following RepositoryFactory classes were consulted:
Perhaps the repository you are trying to access is not available at the moment. "

This error means no implementation classes inside jackrabbit-core were found by the classloader.

Have you already checked this link:
https://community.jboss.org/wiki/JackrabbitDeploymentInAS6AndAS7

??

                
> jackrabbit is not working in JBoss AS7.1.0
> ------------------------------------------
>
>                 Key: JCR-3166
>                 URL: https://issues.apache.org/jira/browse/JCR-3166
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>    Affects Versions: 2.3.4
>         Environment: JBoss AS 7.1.0 + Jackrabbit OCM + Spring JCR Module + Jackrabbit-JCA 2.3.4 on Windows
>            Reporter: nick
>
> Jackrabbit-jca 2.3.4.rar deployment was successful but its not creating jackrabbit specific tables (using postgresql). The intention behind filing it as a bug because, with Jackrabbit-jca-1.6.5.rar deployment is successful and its creating relevant tables but its giving a different exception while trying to add some document to the repository as follows.
> Illegal logical session called.
> With jackrabbit-jca-2.3.4 i'm getting the following error while i try to add a document to the repository.
>     Failed to create session: Unable to access a repository with the following settings: org.apache.jackrabbit.repository.conf: C:\Server\jboss-as-7.1.0.Alpha2-SNAPSHOT\standalone\configuration\jackrabbit\repository.xml org.apache.jackrabbit.repository.home: C:\Server\jboss-as-7.1.0.Alpha2-SNAPSHOT\standalone\data\jackrabbit The following RepositoryFactory classes were consulted: Perhaps the repository you are trying to access is not available at the moment.
>     IJ000658: Unexpected throwable while trying to create a connection: null
>     javax.resource.ResourceException: IJ000658: Unexpected throwable while trying to create a connection: null
> 17:36:26,363 WARN  [org.jboss.jca.core.connectionmanager.pool.strategy.OnePool] (http-127.0.0.1-127.0.0.1-8080-1) IJ000604: Throwable while attempting to get a new connection: null: javax.resource.ResourceException: Failed to create session: Unable to access a repository with the following settings:
>     org.apache.jackrabbit.repository.conf: C:\Server\jboss-as-7.1.0.Alpha2-SNAPSHOT\standalone\configuration\jackrabbit\repository.xml
>     org.apache.jackrabbit.repository.home: C:\Server\jboss-as-7.1.0.Alpha2-SNAPSHOT\standalone\data\jackrabbit
> The following RepositoryFactory classes were consulted:
> Perhaps the repository you are trying to access is not available at the moment.
>     at org.apache.jackrabbit.jca.JCAManagedConnection.openSession(JCAManagedConnection.java:107)
>     at org.apache.jackrabbit.jca.JCAManagedConnection.<init>(JCAManagedConnection.java:85)
>     at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection(JCAManagedConnectionFactory.java:163)
>     at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection(JCAManagedConnectionFactory.java:155)
>     at org.jboss.jca.core.connectionmanager.pool.mcp.SemaphoreArrayListManagedConnectionPool.createConnectionEventListener(SemaphoreArrayListManagedConnectionPool.java:736)
>     at org.jboss.jca.core.connectionmanager.pool.mcp.SemaphoreArrayListManagedConnectionPool.getConnection(SemaphoreArrayListManagedConnectionPool.java:341)
>     at org.jboss.jca.core.connectionmanager.pool.AbstractPool.getTransactionNewConnection(AbstractPool.java:492)
>     at org.jboss.jca.core.connectionmanager.pool.AbstractPool.getConnection(AbstractPool.java:373)
>     at org.jboss.jca.core.connectionmanager.AbstractConnectionManager.getManagedConnection(AbstractConnectionManager.java:332)
>     at org.jboss.jca.core.connectionmanager.tx.TxConnectionManagerImpl.getManagedConnection(TxConnectionManagerImpl.java:367)
>     at org.jboss.jca.core.connectionmanager.AbstractConnectionManager.allocateConnection(AbstractConnectionManager.java:448)
>     at org.apache.jackrabbit.jca.JCARepositoryHandle.login(JCARepositoryHandle.java:73)
> I have checked with all jackrabbit 2 versions but getting same error.
> I have filed the same in JBoss and Spring Community as well.
> If you feel its not a bug then please provide a solid example of integrating jacrabbit-jca with JBoss AS 7. I have done the integration with Jboss just like the Jackrabbit mediawiki explained.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33879-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 13:32:25 2012
Return-Path: <dev-return-33879-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6D54592BF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 13:32:25 +0000 (UTC)
Received: (qmail 70482 invoked by uid 500); 23 Jan 2012 13:32:25 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 70369 invoked by uid 500); 23 Jan 2012 13:32:24 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 70362 invoked by uid 99); 23 Jan 2012 13:32:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 13:32:24 +0000
X-ASF-Spam-Status: No, hits=-0.5 required=5.0
	tests=FREEMAIL_ENVFROM_END_DIGIT,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of maahi333@gmail.com designates 209.85.220.170 as permitted sender)
Received: from [209.85.220.170] (HELO mail-vx0-f170.google.com) (209.85.220.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 13:32:17 +0000
Received: by vcbf11 with SMTP id f11so4182708vcb.1
        for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 05:31:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=ZRa71XBXGi3qxpkMDeqB04dtQY+Cw0gAff+zTOYhljQ=;
        b=nHCCPAOXqUZZwCcEMFkMgObrMNTGEVBM8ow1NNU5Fo5dDUe57RVf5XVyI27KqTvMXY
         /NSjXxS6lYXmC9q1oxyt2T2IySZop6vLbaOlgESPsakU0HXKeI91P3mVGhPsVV7exkBD
         zKa0+QyEMD90ZoRhpWGAz9RjAKz79qq/yP5G0=
MIME-Version: 1.0
Received: by 10.220.156.201 with SMTP id y9mr4913067vcw.22.1327325517130; Mon,
 23 Jan 2012 05:31:57 -0800 (PST)
Received: by 10.220.10.18 with HTTP; Mon, 23 Jan 2012 05:31:56 -0800 (PST)
Date: Mon, 23 Jan 2012 19:01:56 +0530
Message-ID: <CACEFBuQ22q4Y2VgmPtH8aq6yO0mEHe79n9w3cwTL1c4FBtUxgg@mail.gmail.com>
Subject: "FineGrainedISMLocking" not allowing read while write lock is acquired.
From: Mahesh <maahi333@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: multipart/mixed; boundary=f46d042f93cef32a6c04b7320d54

--f46d042f93cef32a6c04b7320d54
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: quoted-printable

Hello All,

We have used jackrabbit as DMS module in our product also we have used
it as DMS for JBPM workflows. =A0We have 3 jackrabbit cluster node and
are using file journal and file datastore.

I understand that jackrabbit only allows serialized write operation
i.e. only one thread is allowed to have write lock, this can be seen
from thread dump taken on cluster environment (i.e. at a given point
of time only one jackrabbit thread has acquired write lock and others
are waiting for write lock). =A0I also had observed, many threads are
waiting for read lock while one of runnable thread has acquired write
lock.

Hence I was searching for options where reads are allowed while write
lock is acquired and found =91FineGrainedISMLocking=92 as doing this job.
Still after changing ISMLocking to =91FineGrainedISMLocking=92 there are
read locks waiting. Hence I am confused and stuck.

Attached is the thread dump for "FineGrainedISMLocking" changes.

Any help would be appreciated.

Thanks
Mahesh

--f46d042f93cef32a6c04b7320d54
Content-Type: text/plain; charset=US-ASCII; 
	name="ThreadDumpData_FineGrainedISMLocking_Enabled.txt"
Content-Disposition: attachment; 
	filename="ThreadDumpData_FineGrainedISMLocking_Enabled.txt"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gxrjbk4p0

Imh0dHAtMC4wLjAuMC04MDgwLVByb2Nlc3NvcjUwIiBkYWVtb24gcHJpbz02IHRpZD0weDA1NzBi
NDAwIG5pZD0weDU5MCBpbiBPYmplY3Qud2FpdCgpIFsweDBiMzJlMDAwXQ0KICAgamF2YS5sYW5n
LlRocmVhZC5TdGF0ZTogV0FJVElORyAob24gb2JqZWN0IG1vbml0b3IpDQoJYXQgamF2YS5sYW5n
Lk9iamVjdC53YWl0KE5hdGl2ZSBNZXRob2QpDQoJLSB3YWl0aW5nIG9uIDwweDJiODVkZGM4PiAo
YSBFRFUub3N3ZWdvLmNzLmRsLnV0aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdy
aXRlTG9jayRSZWFkZXJMb2NrKQ0KCWF0IGphdmEubGFuZy5PYmplY3Qud2FpdChPYmplY3QuamF2
YTo0ODUpDQoJYXQgRURVLm9zd2Vnby5jcy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVy
ZW5jZVJlYWRXcml0ZUxvY2skUmVhZGVyTG9jay5hY3F1aXJlKFdyaXRlclByZWZlcmVuY2VSZWFk
V3JpdGVMb2NrLmphdmE6MTYzKQ0KCS0gbG9ja2VkIDwweDJiODVkZGM4PiAoYSBFRFUub3N3ZWdv
LmNzLmRsLnV0aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdyaXRlTG9jayRSZWFk
ZXJMb2NrKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uVmVyc2lvbmlu
Z0xvY2skUmVhZExvY2suPGluaXQ+KFZlcnNpb25pbmdMb2NrLmphdmE6OTMpDQoJYXQgb3JnLmFw
YWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lvbi5WZXJzaW9uaW5nTG9jayRSZWFkTG9jay48aW5p
dD4oVmVyc2lvbmluZ0xvY2suamF2YTo4NykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29y
ZS52ZXJzaW9uLlZlcnNpb25pbmdMb2NrLmFjcXVpcmVSZWFkTG9jayhWZXJzaW9uaW5nTG9jay5q
YXZhOjUxKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxW
ZXJzaW9uTWFuYWdlckJhc2UuYWNxdWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1hbmFnZXJC
YXNlLmphdmE6MTkzKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50
ZXJuYWxWZXJzaW9uTWFuYWdlckltcGwuYWNxdWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1h
bmFnZXJJbXBsLmphdmE6NjkpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuam91cm5h
bC5BYnN0cmFjdEpvdXJuYWwubG9ja0FuZFN5bmMoQWJzdHJhY3RKb3VybmFsLmphdmE6MjYyKQ0K
CWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLmpvdXJuYWwuRGVmYXVsdFJlY29yZFByb2R1
Y2VyLmFwcGVuZChEZWZhdWx0UmVjb3JkUHJvZHVjZXIuamF2YTo1MSkNCglhdCBvcmcuYXBhY2hl
LmphY2tyYWJiaXQuY29yZS5jbHVzdGVyLkNsdXN0ZXJOb2RlJFdvcmtzcGFjZUxvY2tDaGFubmVs
LmNyZWF0ZShDbHVzdGVyTm9kZS5qYXZhOjcwNikNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQu
Y29yZS5sb2NrLkxvY2tNYW5hZ2VySW1wbC5pbnRlcm5hbFVubG9jayhMb2NrTWFuYWdlckltcGwu
amF2YTo0NTQpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUubG9jay5YQUxvY2tNYW5h
Z2VyLnVubG9jayhYQUxvY2tNYW5hZ2VyLmphdmE6MTMzKQ0KCWF0IG9yZy5hcGFjaGUuamFja3Jh
YmJpdC5jb3JlLmxvY2suU2Vzc2lvbkxvY2tNYW5hZ2VyLnVubG9jayhTZXNzaW9uTG9ja01hbmFn
ZXIuamF2YToyMDMpDQoJLSBsb2NrZWQgPDB4MTY2ZjdlOTg+IChhIG9yZy5hcGFjaGUuamFja3Jh
YmJpdC5jb3JlLmxvY2suWEFMb2NrTWFuYWdlcikNCg0KDQoiaHR0cC0wLjAuMC4wLTgwODAtUHJv
Y2Vzc29yNDkiIGRhZW1vbiBwcmlvPTYgdGlkPTB4MDU0ZTc0MDAgbmlkPTB4MTdmNCBpbiBPYmpl
Y3Qud2FpdCgpIFsweDBiMmRlMDAwXQ0KICAgamF2YS5sYW5nLlRocmVhZC5TdGF0ZTogV0FJVElO
RyAob24gb2JqZWN0IG1vbml0b3IpDQoJYXQgamF2YS5sYW5nLk9iamVjdC53YWl0KE5hdGl2ZSBN
ZXRob2QpDQoJLSB3YWl0aW5nIG9uIDwweDJiODVkZGM4PiAoYSBFRFUub3N3ZWdvLmNzLmRsLnV0
aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdyaXRlTG9jayRSZWFkZXJMb2NrKQ0K
CWF0IGphdmEubGFuZy5PYmplY3Qud2FpdChPYmplY3QuamF2YTo0ODUpDQoJYXQgRURVLm9zd2Vn
by5jcy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVyZW5jZVJlYWRXcml0ZUxvY2skUmVh
ZGVyTG9jay5hY3F1aXJlKFdyaXRlclByZWZlcmVuY2VSZWFkV3JpdGVMb2NrLmphdmE6MTYzKQ0K
CS0gbG9ja2VkIDwweDJiODVkZGM4PiAoYSBFRFUub3N3ZWdvLmNzLmRsLnV0aWwuY29uY3VycmVu
dC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdyaXRlTG9jayRSZWFkZXJMb2NrKQ0KCWF0IG9yZy5hcGFj
aGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uVmVyc2lvbmluZ0xvY2skUmVhZExvY2suPGluaXQ+
KFZlcnNpb25pbmdMb2NrLmphdmE6OTMpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUu
dmVyc2lvbi5WZXJzaW9uaW5nTG9jayRSZWFkTG9jay48aW5pdD4oVmVyc2lvbmluZ0xvY2suamF2
YTo4NykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLlZlcnNpb25pbmdM
b2NrLmFjcXVpcmVSZWFkTG9jayhWZXJzaW9uaW5nTG9jay5qYXZhOjUxKQ0KCWF0IG9yZy5hcGFj
aGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxWZXJzaW9uTWFuYWdlckJhc2UuYWNx
dWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1hbmFnZXJCYXNlLmphdmE6MTkzKQ0KCWF0IG9y
Zy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxWZXJzaW9uTWFuYWdlcklt
cGwuYWNxdWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1hbmFnZXJJbXBsLmphdmE6NjkpDQoJ
YXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuam91cm5hbC5BYnN0cmFjdEpvdXJuYWwubG9j
a0FuZFN5bmMoQWJzdHJhY3RKb3VybmFsLmphdmE6MjYyKQ0KCWF0IG9yZy5hcGFjaGUuamFja3Jh
YmJpdC5jb3JlLmpvdXJuYWwuRGVmYXVsdFJlY29yZFByb2R1Y2VyLmFwcGVuZChEZWZhdWx0UmVj
b3JkUHJvZHVjZXIuamF2YTo1MSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5jbHVz
dGVyLkNsdXN0ZXJOb2RlJFdvcmtzcGFjZVVwZGF0ZUNoYW5uZWwudXBkYXRlQ3JlYXRlZChDbHVz
dGVyTm9kZS5qYXZhOjU0MSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5zdGF0ZS5T
aGFyZWRJdGVtU3RhdGVNYW5hZ2VyJFVwZGF0ZS5iZWdpbihTaGFyZWRJdGVtU3RhdGVNYW5hZ2Vy
LmphdmE6NTU5KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnN0YXRlLlNoYXJlZEl0
ZW1TdGF0ZU1hbmFnZXIuYmVnaW5VcGRhdGUoU2hhcmVkSXRlbVN0YXRlTWFuYWdlci5qYXZhOjE0
NTgpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuU2hhcmVkSXRlbVN0YXRl
TWFuYWdlci51cGRhdGUoU2hhcmVkSXRlbVN0YXRlTWFuYWdlci5qYXZhOjE0ODgpDQoJYXQgb3Jn
LmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuTG9jYWxJdGVtU3RhdGVNYW5hZ2VyLnVwZGF0
ZShMb2NhbEl0ZW1TdGF0ZU1hbmFnZXIuamF2YTozNTEpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFi
Yml0LmNvcmUuc3RhdGUuWEFJdGVtU3RhdGVNYW5hZ2VyLnVwZGF0ZShYQUl0ZW1TdGF0ZU1hbmFn
ZXIuamF2YTozNTQpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuTG9jYWxJ
dGVtU3RhdGVNYW5hZ2VyLnVwZGF0ZShMb2NhbEl0ZW1TdGF0ZU1hbmFnZXIuamF2YTozMjYpDQoJ
YXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuU2Vzc2lvbkl0ZW1TdGF0ZU1hbmFn
ZXIudXBkYXRlKFNlc3Npb25JdGVtU3RhdGVNYW5hZ2VyLmphdmE6Mjg5KQ0KCWF0IG9yZy5hcGFj
aGUuamFja3JhYmJpdC5jb3JlLkl0ZW1TYXZlT3BlcmF0aW9uLnBlcmZvcm0oSXRlbVNhdmVPcGVy
YXRpb24uamF2YToyNTgpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc2Vzc2lvbi5T
ZXNzaW9uU3RhdGUucGVyZm9ybShTZXNzaW9uU3RhdGUuamF2YToxODgpDQoJYXQgb3JnLmFwYWNo
ZS5qYWNrcmFiYml0LmNvcmUuSXRlbUltcGwucGVyZm9ybShJdGVtSW1wbC5qYXZhOjkxKQ0KCWF0
IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLkl0ZW1JbXBsLnNhdmUoSXRlbUltcGwuamF2YToz
MjkpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc2Vzc2lvbi5TZXNzaW9uU2F2ZU9w
ZXJhdGlvbi5wZXJmb3JtKFNlc3Npb25TYXZlT3BlcmF0aW9uLmphdmE6NDIpDQoJYXQgb3JnLmFw
YWNoZS5qYWNrcmFiYml0LmNvcmUuc2Vzc2lvbi5TZXNzaW9uU3RhdGUucGVyZm9ybShTZXNzaW9u
U3RhdGUuamF2YToxODgpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuU2Vzc2lvbklt
cGwucGVyZm9ybShTZXNzaW9uSW1wbC5qYXZhOjM1NSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJi
aXQuY29yZS5TZXNzaW9uSW1wbC5zYXZlKFNlc3Npb25JbXBsLmphdmE6NzU4KQ0KDQoiaHR0cC0w
LjAuMC4wLTgwODAtUHJvY2Vzc29yNDciIGRhZW1vbiBwcmlvPTYgdGlkPTB4MDU0ZTQ0MDAgbmlk
PTB4MTBmOCBpbiBPYmplY3Qud2FpdCgpIFsweDBiMjNlMDAwXQ0KICAgamF2YS5sYW5nLlRocmVh
ZC5TdGF0ZTogV0FJVElORyAob24gb2JqZWN0IG1vbml0b3IpDQoJYXQgamF2YS5sYW5nLk9iamVj
dC53YWl0KE5hdGl2ZSBNZXRob2QpDQoJLSB3YWl0aW5nIG9uIDwweDJiODVkZGM4PiAoYSBFRFUu
b3N3ZWdvLmNzLmRsLnV0aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdyaXRlTG9j
ayRSZWFkZXJMb2NrKQ0KCWF0IGphdmEubGFuZy5PYmplY3Qud2FpdChPYmplY3QuamF2YTo0ODUp
DQoJYXQgRURVLm9zd2Vnby5jcy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVyZW5jZVJl
YWRXcml0ZUxvY2skUmVhZGVyTG9jay5hY3F1aXJlKFdyaXRlclByZWZlcmVuY2VSZWFkV3JpdGVM
b2NrLmphdmE6MTYzKQ0KCS0gbG9ja2VkIDwweDJiODVkZGM4PiAoYSBFRFUub3N3ZWdvLmNzLmRs
LnV0aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdyaXRlTG9jayRSZWFkZXJMb2Nr
KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uVmVyc2lvbmluZ0xvY2sk
UmVhZExvY2suPGluaXQ+KFZlcnNpb25pbmdMb2NrLmphdmE6OTMpDQoJYXQgb3JnLmFwYWNoZS5q
YWNrcmFiYml0LmNvcmUudmVyc2lvbi5WZXJzaW9uaW5nTG9jayRSZWFkTG9jay48aW5pdD4oVmVy
c2lvbmluZ0xvY2suamF2YTo4NykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJz
aW9uLlZlcnNpb25pbmdMb2NrLmFjcXVpcmVSZWFkTG9jayhWZXJzaW9uaW5nTG9jay5qYXZhOjUx
KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxWZXJzaW9u
TWFuYWdlckJhc2UuYWNxdWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1hbmFnZXJCYXNlLmph
dmE6MTkzKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxW
ZXJzaW9uTWFuYWdlckltcGwuYWNxdWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1hbmFnZXJJ
bXBsLmphdmE6NjkpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lvbi5JbnRl
cm5hbFZlcnNpb25NYW5hZ2VySW1wbC5nZXRJdGVtKEludGVybmFsVmVyc2lvbk1hbmFnZXJJbXBs
LmphdmE6MzIzKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJu
YWxYQVZlcnNpb25NYW5hZ2VyLmdldEl0ZW0oSW50ZXJuYWxYQVZlcnNpb25NYW5hZ2VyLmphdmE6
NDI3KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxWZXJz
aW9uTWFuYWdlckJhc2UuZ2V0VmVyc2lvbkhpc3RvcnkoSW50ZXJuYWxWZXJzaW9uTWFuYWdlckJh
c2UuamF2YToxMzEpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lvbi5JbnRl
cm5hbFhBVmVyc2lvbk1hbmFnZXIuZ2V0VmVyc2lvbkhpc3RvcnkoSW50ZXJuYWxYQVZlcnNpb25N
YW5hZ2VyLmphdmE6NTYpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lvbi5W
ZXJzaW9uTWFuYWdlckltcGxCYXNlLmdldFZlcnNpb25IaXN0b3J5KFZlcnNpb25NYW5hZ2VySW1w
bEJhc2UuamF2YTozNTYpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuVmVyc2lvbk1h
bmFnZXJJbXBsLmFjY2VzcyQ3MDAoVmVyc2lvbk1hbmFnZXJJbXBsLmphdmE6NzIpDQoJYXQgb3Jn
LmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuVmVyc2lvbk1hbmFnZXJJbXBsJDQucGVyZm9ybShWZXJz
aW9uTWFuYWdlckltcGwuamF2YToxODMpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUu
VmVyc2lvbk1hbmFnZXJJbXBsJDQucGVyZm9ybShWZXJzaW9uTWFuYWdlckltcGwuamF2YToxNzkp
DQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc2Vzc2lvbi5TZXNzaW9uU3RhdGUucGVy
Zm9ybShTZXNzaW9uU3RhdGUuamF2YToxODgpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNv
cmUuVmVyc2lvbk1hbmFnZXJJbXBsLnBlcmZvcm0oVmVyc2lvbk1hbmFnZXJJbXBsLmphdmE6OTUp
DQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuVmVyc2lvbk1hbmFnZXJJbXBsLmdldFZl
cnNpb25IaXN0b3J5KFZlcnNpb25NYW5hZ2VySW1wbC5qYXZhOjE3OSkNCglhdCBvcmcuYXBhY2hl
LmphY2tyYWJiaXQuY29yZS5Ob2RlSW1wbC5nZXRWZXJzaW9uSGlzdG9yeShOb2RlSW1wbC5qYXZh
OjI5NDApDQoNCiJodHRwLTAuMC4wLjAtODA4MC1Qcm9jZXNzb3I0MyIgZGFlbW9uIHByaW89NiB0
aWQ9MHgwNTQ0MGMwMCBuaWQ9MHg5YzggaW4gT2JqZWN0LndhaXQoKSBbMHgwYjBmZTAwMF0NCiAg
IGphdmEubGFuZy5UaHJlYWQuU3RhdGU6IFdBSVRJTkcgKG9uIG9iamVjdCBtb25pdG9yKQ0KCWF0
IGphdmEubGFuZy5PYmplY3Qud2FpdChOYXRpdmUgTWV0aG9kKQ0KCS0gd2FpdGluZyBvbiA8MHgy
Yjg1ZGRjOD4gKGEgRURVLm9zd2Vnby5jcy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVy
ZW5jZVJlYWRXcml0ZUxvY2skUmVhZGVyTG9jaykNCglhdCBqYXZhLmxhbmcuT2JqZWN0LndhaXQo
T2JqZWN0LmphdmE6NDg1KQ0KCWF0IEVEVS5vc3dlZ28uY3MuZGwudXRpbC5jb25jdXJyZW50Lldy
aXRlclByZWZlcmVuY2VSZWFkV3JpdGVMb2NrJFJlYWRlckxvY2suYWNxdWlyZShXcml0ZXJQcmVm
ZXJlbmNlUmVhZFdyaXRlTG9jay5qYXZhOjE2MykNCgktIGxvY2tlZCA8MHgyYjg1ZGRjOD4gKGEg
RURVLm9zd2Vnby5jcy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVyZW5jZVJlYWRXcml0
ZUxvY2skUmVhZGVyTG9jaykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9u
LlZlcnNpb25pbmdMb2NrJFJlYWRMb2NrLjxpbml0PihWZXJzaW9uaW5nTG9jay5qYXZhOjkzKQ0K
CWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uVmVyc2lvbmluZ0xvY2skUmVh
ZExvY2suPGluaXQ+KFZlcnNpb25pbmdMb2NrLmphdmE6ODcpDQoJYXQgb3JnLmFwYWNoZS5qYWNr
cmFiYml0LmNvcmUudmVyc2lvbi5WZXJzaW9uaW5nTG9jay5hY3F1aXJlUmVhZExvY2soVmVyc2lv
bmluZ0xvY2suamF2YTo1MSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9u
LkludGVybmFsVmVyc2lvbk1hbmFnZXJCYXNlLmFjcXVpcmVSZWFkTG9jayhJbnRlcm5hbFZlcnNp
b25NYW5hZ2VyQmFzZS5qYXZhOjE5MykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52
ZXJzaW9uLkludGVybmFsVmVyc2lvbk1hbmFnZXJJbXBsLmFjcXVpcmVSZWFkTG9jayhJbnRlcm5h
bFZlcnNpb25NYW5hZ2VySW1wbC5qYXZhOjY5KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5j
b3JlLmpvdXJuYWwuQWJzdHJhY3RKb3VybmFsLmxvY2tBbmRTeW5jKEFic3RyYWN0Sm91cm5hbC5q
YXZhOjI2MikNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5qb3VybmFsLkRlZmF1bHRS
ZWNvcmRQcm9kdWNlci5hcHBlbmQoRGVmYXVsdFJlY29yZFByb2R1Y2VyLmphdmE6NTEpDQoJYXQg
b3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuY2x1c3Rlci5DbHVzdGVyTm9kZSRXb3Jrc3BhY2VV
cGRhdGVDaGFubmVsLnVwZGF0ZUNyZWF0ZWQoQ2x1c3Rlck5vZGUuamF2YTo1NDEpDQoJYXQgb3Jn
LmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuU2hhcmVkSXRlbVN0YXRlTWFuYWdlciRVcGRh
dGUuYmVnaW4oU2hhcmVkSXRlbVN0YXRlTWFuYWdlci5qYXZhOjU1OSkNCglhdCBvcmcuYXBhY2hl
LmphY2tyYWJiaXQuY29yZS5zdGF0ZS5TaGFyZWRJdGVtU3RhdGVNYW5hZ2VyLmJlZ2luVXBkYXRl
KFNoYXJlZEl0ZW1TdGF0ZU1hbmFnZXIuamF2YToxNDU4KQ0KCWF0IG9yZy5hcGFjaGUuamFja3Jh
YmJpdC5jb3JlLnN0YXRlLlNoYXJlZEl0ZW1TdGF0ZU1hbmFnZXIudXBkYXRlKFNoYXJlZEl0ZW1T
dGF0ZU1hbmFnZXIuamF2YToxNDg4KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnN0
YXRlLkxvY2FsSXRlbVN0YXRlTWFuYWdlci51cGRhdGUoTG9jYWxJdGVtU3RhdGVNYW5hZ2VyLmph
dmE6MzUxKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnN0YXRlLlhBSXRlbVN0YXRl
TWFuYWdlci51cGRhdGUoWEFJdGVtU3RhdGVNYW5hZ2VyLmphdmE6MzU0KQ0KCWF0IG9yZy5hcGFj
aGUuamFja3JhYmJpdC5jb3JlLnN0YXRlLkxvY2FsSXRlbVN0YXRlTWFuYWdlci51cGRhdGUoTG9j
YWxJdGVtU3RhdGVNYW5hZ2VyLmphdmE6MzI2KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5j
b3JlLmxvY2suTG9ja01hbmFnZXJJbXBsLndyaXRlTG9ja1Byb3BlcnRpZXMoTG9ja01hbmFnZXJJ
bXBsLmphdmE6OTYwKQ0KCS0gbG9ja2VkIDwweDEyMWNjNjMwPiAoYSBvcmcuYXBhY2hlLmphY2ty
YWJiaXQuY29yZS5zdGF0ZS5YQUl0ZW1TdGF0ZU1hbmFnZXIpDQoJYXQgb3JnLmFwYWNoZS5qYWNr
cmFiYml0LmNvcmUubG9jay5YQUxvY2tNYW5hZ2VyLmxvY2soWEFMb2NrTWFuYWdlci5qYXZhOjgy
KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLmxvY2suU2Vzc2lvbkxvY2tNYW5hZ2Vy
LmxvY2soU2Vzc2lvbkxvY2tNYW5hZ2VyLmphdmE6MTgwKQ0KCS0gbG9ja2VkIDwweDEyMWQwNzUw
PiAoYSBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5sb2NrLlhBTG9ja01hbmFnZXIpDQoNCiJo
dHRwLTAuMC4wLjAtODA4MC1Qcm9jZXNzb3I0MiIgZGFlbW9uIHByaW89NiB0aWQ9MHgwNTQzZjQw
MCBuaWQ9MHg5ODQgaW4gT2JqZWN0LndhaXQoKSBbMHgwYjBhZTAwMF0NCiAgIGphdmEubGFuZy5U
aHJlYWQuU3RhdGU6IFdBSVRJTkcgKG9uIG9iamVjdCBtb25pdG9yKQ0KCWF0IGphdmEubGFuZy5P
YmplY3Qud2FpdChOYXRpdmUgTWV0aG9kKQ0KCS0gd2FpdGluZyBvbiA8MHgyYjg1ZGRjOD4gKGEg
RURVLm9zd2Vnby5jcy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVyZW5jZVJlYWRXcml0
ZUxvY2skUmVhZGVyTG9jaykNCglhdCBqYXZhLmxhbmcuT2JqZWN0LndhaXQoT2JqZWN0LmphdmE6
NDg1KQ0KCWF0IEVEVS5vc3dlZ28uY3MuZGwudXRpbC5jb25jdXJyZW50LldyaXRlclByZWZlcmVu
Y2VSZWFkV3JpdGVMb2NrJFJlYWRlckxvY2suYWNxdWlyZShXcml0ZXJQcmVmZXJlbmNlUmVhZFdy
aXRlTG9jay5qYXZhOjE2MykNCgktIGxvY2tlZCA8MHgyYjg1ZGRjOD4gKGEgRURVLm9zd2Vnby5j
cy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVyZW5jZVJlYWRXcml0ZUxvY2skUmVhZGVy
TG9jaykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLlZlcnNpb25pbmdM
b2NrJFJlYWRMb2NrLjxpbml0PihWZXJzaW9uaW5nTG9jay5qYXZhOjkzKQ0KCWF0IG9yZy5hcGFj
aGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uVmVyc2lvbmluZ0xvY2skUmVhZExvY2suPGluaXQ+
KFZlcnNpb25pbmdMb2NrLmphdmE6ODcpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUu
dmVyc2lvbi5WZXJzaW9uaW5nTG9jay5hY3F1aXJlUmVhZExvY2soVmVyc2lvbmluZ0xvY2suamF2
YTo1MSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLkludGVybmFsVmVy
c2lvbk1hbmFnZXJCYXNlLmFjcXVpcmVSZWFkTG9jayhJbnRlcm5hbFZlcnNpb25NYW5hZ2VyQmFz
ZS5qYXZhOjE5MykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLkludGVy
bmFsVmVyc2lvbk1hbmFnZXJJbXBsLmFjcXVpcmVSZWFkTG9jayhJbnRlcm5hbFZlcnNpb25NYW5h
Z2VySW1wbC5qYXZhOjY5KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24u
SW50ZXJuYWxWZXJzaW9uTWFuYWdlckltcGwuZ2V0SXRlbShJbnRlcm5hbFZlcnNpb25NYW5hZ2Vy
SW1wbC5qYXZhOjMyMykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLklu
dGVybmFsWEFWZXJzaW9uTWFuYWdlci5nZXRJdGVtKEludGVybmFsWEFWZXJzaW9uTWFuYWdlci5q
YXZhOjQyNykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLkludGVybmFs
VmVyc2lvbk1hbmFnZXJCYXNlLmdldFZlcnNpb25IaXN0b3J5KEludGVybmFsVmVyc2lvbk1hbmFn
ZXJCYXNlLmphdmE6MTMxKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24u
SW50ZXJuYWxYQVZlcnNpb25NYW5hZ2VyLmdldFZlcnNpb25IaXN0b3J5KEludGVybmFsWEFWZXJz
aW9uTWFuYWdlci5qYXZhOjU2KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNp
b24uVmVyc2lvbk1hbmFnZXJJbXBsQmFzZS5nZXRWZXJzaW9uSGlzdG9yeShWZXJzaW9uTWFuYWdl
ckltcGxCYXNlLmphdmE6MzU2KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLlZlcnNp
b25NYW5hZ2VySW1wbC5hY2Nlc3MkNzAwKFZlcnNpb25NYW5hZ2VySW1wbC5qYXZhOjcyKQ0KCWF0
IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLlZlcnNpb25NYW5hZ2VySW1wbCQ0LnBlcmZvcm0o
VmVyc2lvbk1hbmFnZXJJbXBsLmphdmE6MTgzKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5j
b3JlLlZlcnNpb25NYW5hZ2VySW1wbCQ0LnBlcmZvcm0oVmVyc2lvbk1hbmFnZXJJbXBsLmphdmE6
MTc5KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnNlc3Npb24uU2Vzc2lvblN0YXRl
LnBlcmZvcm0oU2Vzc2lvblN0YXRlLmphdmE6MTg4KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJp
dC5jb3JlLlZlcnNpb25NYW5hZ2VySW1wbC5wZXJmb3JtKFZlcnNpb25NYW5hZ2VySW1wbC5qYXZh
Ojk1KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLlZlcnNpb25NYW5hZ2VySW1wbC5n
ZXRWZXJzaW9uSGlzdG9yeShWZXJzaW9uTWFuYWdlckltcGwuamF2YToxNzkpDQoJYXQgb3JnLmFw
YWNoZS5qYWNrcmFiYml0LmNvcmUuTm9kZUltcGwuZ2V0VmVyc2lvbkhpc3RvcnkoTm9kZUltcGwu
amF2YToyOTQwKQ0KDQoiaHR0cC0wLjAuMC4wLTgwODAtUHJvY2Vzc29yNDAiIGRhZW1vbiBwcmlv
PTYgdGlkPTB4MDU1ZjMwMDAgbmlkPTB4MTZmOCBpbiBPYmplY3Qud2FpdCgpIFsweDBiMDBlMDAw
XQ0KICAgamF2YS5sYW5nLlRocmVhZC5TdGF0ZTogV0FJVElORyAob24gb2JqZWN0IG1vbml0b3Ip
DQoJYXQgamF2YS5sYW5nLk9iamVjdC53YWl0KE5hdGl2ZSBNZXRob2QpDQoJLSB3YWl0aW5nIG9u
IDwweDJiODVkZGM4PiAoYSBFRFUub3N3ZWdvLmNzLmRsLnV0aWwuY29uY3VycmVudC5Xcml0ZXJQ
cmVmZXJlbmNlUmVhZFdyaXRlTG9jayRSZWFkZXJMb2NrKQ0KCWF0IGphdmEubGFuZy5PYmplY3Qu
d2FpdChPYmplY3QuamF2YTo0ODUpDQoJYXQgRURVLm9zd2Vnby5jcy5kbC51dGlsLmNvbmN1cnJl
bnQuV3JpdGVyUHJlZmVyZW5jZVJlYWRXcml0ZUxvY2skUmVhZGVyTG9jay5hY3F1aXJlKFdyaXRl
clByZWZlcmVuY2VSZWFkV3JpdGVMb2NrLmphdmE6MTYzKQ0KCS0gbG9ja2VkIDwweDJiODVkZGM4
PiAoYSBFRFUub3N3ZWdvLmNzLmRsLnV0aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVh
ZFdyaXRlTG9jayRSZWFkZXJMb2NrKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZl
cnNpb24uVmVyc2lvbmluZ0xvY2skUmVhZExvY2suPGluaXQ+KFZlcnNpb25pbmdMb2NrLmphdmE6
OTMpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lvbi5WZXJzaW9uaW5nTG9j
ayRSZWFkTG9jay48aW5pdD4oVmVyc2lvbmluZ0xvY2suamF2YTo4NykNCglhdCBvcmcuYXBhY2hl
LmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLlZlcnNpb25pbmdMb2NrLmFjcXVpcmVSZWFkTG9jayhW
ZXJzaW9uaW5nTG9jay5qYXZhOjUxKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZl
cnNpb24uSW50ZXJuYWxWZXJzaW9uTWFuYWdlckJhc2UuYWNxdWlyZVJlYWRMb2NrKEludGVybmFs
VmVyc2lvbk1hbmFnZXJCYXNlLmphdmE6MTkzKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5j
b3JlLnZlcnNpb24uSW50ZXJuYWxWZXJzaW9uTWFuYWdlckltcGwuYWNxdWlyZVJlYWRMb2NrKElu
dGVybmFsVmVyc2lvbk1hbmFnZXJJbXBsLmphdmE6NjkpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFi
Yml0LmNvcmUuam91cm5hbC5BYnN0cmFjdEpvdXJuYWwubG9ja0FuZFN5bmMoQWJzdHJhY3RKb3Vy
bmFsLmphdmE6MjYyKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLmpvdXJuYWwuRGVm
YXVsdFJlY29yZFByb2R1Y2VyLmFwcGVuZChEZWZhdWx0UmVjb3JkUHJvZHVjZXIuamF2YTo1MSkN
CglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5jbHVzdGVyLkNsdXN0ZXJOb2RlJFdvcmtz
cGFjZVVwZGF0ZUNoYW5uZWwudXBkYXRlQ3JlYXRlZChDbHVzdGVyTm9kZS5qYXZhOjU0MSkNCglh
dCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5zdGF0ZS5TaGFyZWRJdGVtU3RhdGVNYW5hZ2Vy
JFVwZGF0ZS5iZWdpbihTaGFyZWRJdGVtU3RhdGVNYW5hZ2VyLmphdmE6NTU5KQ0KCWF0IG9yZy5h
cGFjaGUuamFja3JhYmJpdC5jb3JlLnN0YXRlLlNoYXJlZEl0ZW1TdGF0ZU1hbmFnZXIuYmVnaW5V
cGRhdGUoU2hhcmVkSXRlbVN0YXRlTWFuYWdlci5qYXZhOjE0NTgpDQoJYXQgb3JnLmFwYWNoZS5q
YWNrcmFiYml0LmNvcmUuc3RhdGUuU2hhcmVkSXRlbVN0YXRlTWFuYWdlci51cGRhdGUoU2hhcmVk
SXRlbVN0YXRlTWFuYWdlci5qYXZhOjE0ODgpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNv
cmUuc3RhdGUuTG9jYWxJdGVtU3RhdGVNYW5hZ2VyLnVwZGF0ZShMb2NhbEl0ZW1TdGF0ZU1hbmFn
ZXIuamF2YTozNTEpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuWEFJdGVt
U3RhdGVNYW5hZ2VyLnVwZGF0ZShYQUl0ZW1TdGF0ZU1hbmFnZXIuamF2YTozNTQpDQoJYXQgb3Jn
LmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuTG9jYWxJdGVtU3RhdGVNYW5hZ2VyLnVwZGF0
ZShMb2NhbEl0ZW1TdGF0ZU1hbmFnZXIuamF2YTozMjYpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFi
Yml0LmNvcmUubG9jay5Mb2NrTWFuYWdlckltcGwud3JpdGVMb2NrUHJvcGVydGllcyhMb2NrTWFu
YWdlckltcGwuamF2YTo5NjApDQoJLSBsb2NrZWQgPDB4MTFjYTQ4NTA+IChhIG9yZy5hcGFjaGUu
amFja3JhYmJpdC5jb3JlLnN0YXRlLlhBSXRlbVN0YXRlTWFuYWdlcikNCglhdCBvcmcuYXBhY2hl
LmphY2tyYWJiaXQuY29yZS5sb2NrLlhBTG9ja01hbmFnZXIubG9jayhYQUxvY2tNYW5hZ2VyLmph
dmE6ODIpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUubG9jay5TZXNzaW9uTG9ja01h
bmFnZXIubG9jayhTZXNzaW9uTG9ja01hbmFnZXIuamF2YToxODApDQoJLSBsb2NrZWQgPDB4MTFj
YTg5NTA+IChhIG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLmxvY2suWEFMb2NrTWFuYWdlcikN
Cg0KDQoiaHR0cC0wLjAuMC4wLTgwODAtUHJvY2Vzc29yMzgiIGRhZW1vbiBwcmlvPTYgdGlkPTB4
MDU1ZjA4MDAgbmlkPTB4ZTFjIGluIE9iamVjdC53YWl0KCkgWzB4MGFmNmUwMDBdDQogICBqYXZh
LmxhbmcuVGhyZWFkLlN0YXRlOiBXQUlUSU5HIChvbiBvYmplY3QgbW9uaXRvcikNCglhdCBqYXZh
LmxhbmcuT2JqZWN0LndhaXQoTmF0aXZlIE1ldGhvZCkNCgktIHdhaXRpbmcgb24gPDB4MmI4NWRk
Yzg+IChhIEVEVS5vc3dlZ28uY3MuZGwudXRpbC5jb25jdXJyZW50LldyaXRlclByZWZlcmVuY2VS
ZWFkV3JpdGVMb2NrJFJlYWRlckxvY2spDQoJYXQgamF2YS5sYW5nLk9iamVjdC53YWl0KE9iamVj
dC5qYXZhOjQ4NSkNCglhdCBFRFUub3N3ZWdvLmNzLmRsLnV0aWwuY29uY3VycmVudC5Xcml0ZXJQ
cmVmZXJlbmNlUmVhZFdyaXRlTG9jayRSZWFkZXJMb2NrLmFjcXVpcmUoV3JpdGVyUHJlZmVyZW5j
ZVJlYWRXcml0ZUxvY2suamF2YToxNjMpDQoJLSBsb2NrZWQgPDB4MmI4NWRkYzg+IChhIEVEVS5v
c3dlZ28uY3MuZGwudXRpbC5jb25jdXJyZW50LldyaXRlclByZWZlcmVuY2VSZWFkV3JpdGVMb2Nr
JFJlYWRlckxvY2spDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lvbi5WZXJz
aW9uaW5nTG9jayRSZWFkTG9jay48aW5pdD4oVmVyc2lvbmluZ0xvY2suamF2YTo5MykNCglhdCBv
cmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJzaW9uLlZlcnNpb25pbmdMb2NrJFJlYWRMb2Nr
Ljxpbml0PihWZXJzaW9uaW5nTG9jay5qYXZhOjg3KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJp
dC5jb3JlLnZlcnNpb24uVmVyc2lvbmluZ0xvY2suYWNxdWlyZVJlYWRMb2NrKFZlcnNpb25pbmdM
b2NrLmphdmE6NTEpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lvbi5JbnRl
cm5hbFZlcnNpb25NYW5hZ2VyQmFzZS5hY3F1aXJlUmVhZExvY2soSW50ZXJuYWxWZXJzaW9uTWFu
YWdlckJhc2UuamF2YToxOTMpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUudmVyc2lv
bi5JbnRlcm5hbFZlcnNpb25NYW5hZ2VySW1wbC5hY3F1aXJlUmVhZExvY2soSW50ZXJuYWxWZXJz
aW9uTWFuYWdlckltcGwuamF2YTo2OSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5q
b3VybmFsLkFic3RyYWN0Sm91cm5hbC5sb2NrQW5kU3luYyhBYnN0cmFjdEpvdXJuYWwuamF2YToy
NjIpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuam91cm5hbC5EZWZhdWx0UmVjb3Jk
UHJvZHVjZXIuYXBwZW5kKERlZmF1bHRSZWNvcmRQcm9kdWNlci5qYXZhOjUxKQ0KCWF0IG9yZy5h
cGFjaGUuamFja3JhYmJpdC5jb3JlLmNsdXN0ZXIuQ2x1c3Rlck5vZGUkV29ya3NwYWNlVXBkYXRl
Q2hhbm5lbC51cGRhdGVDcmVhdGVkKENsdXN0ZXJOb2RlLmphdmE6NTQxKQ0KCWF0IG9yZy5hcGFj
aGUuamFja3JhYmJpdC5jb3JlLnN0YXRlLlNoYXJlZEl0ZW1TdGF0ZU1hbmFnZXIkVXBkYXRlLmJl
Z2luKFNoYXJlZEl0ZW1TdGF0ZU1hbmFnZXIuamF2YTo1NTkpDQoJYXQgb3JnLmFwYWNoZS5qYWNr
cmFiYml0LmNvcmUuc3RhdGUuU2hhcmVkSXRlbVN0YXRlTWFuYWdlci5iZWdpblVwZGF0ZShTaGFy
ZWRJdGVtU3RhdGVNYW5hZ2VyLmphdmE6MTQ1OCkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQu
Y29yZS5zdGF0ZS5TaGFyZWRJdGVtU3RhdGVNYW5hZ2VyLnVwZGF0ZShTaGFyZWRJdGVtU3RhdGVN
YW5hZ2VyLmphdmE6MTQ4OCkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5zdGF0ZS5M
b2NhbEl0ZW1TdGF0ZU1hbmFnZXIudXBkYXRlKExvY2FsSXRlbVN0YXRlTWFuYWdlci5qYXZhOjM1
MSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5zdGF0ZS5YQUl0ZW1TdGF0ZU1hbmFn
ZXIudXBkYXRlKFhBSXRlbVN0YXRlTWFuYWdlci5qYXZhOjM1NCkNCglhdCBvcmcuYXBhY2hlLmph
Y2tyYWJiaXQuY29yZS5zdGF0ZS5Mb2NhbEl0ZW1TdGF0ZU1hbmFnZXIudXBkYXRlKExvY2FsSXRl
bVN0YXRlTWFuYWdlci5qYXZhOjMyNikNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5s
b2NrLkxvY2tNYW5hZ2VySW1wbC53cml0ZUxvY2tQcm9wZXJ0aWVzKExvY2tNYW5hZ2VySW1wbC5q
YXZhOjk2MCkNCgktIGxvY2tlZCA8MHgxMWY2NzZmOD4gKGEgb3JnLmFwYWNoZS5qYWNrcmFiYml0
LmNvcmUuc3RhdGUuWEFJdGVtU3RhdGVNYW5hZ2VyKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJp
dC5jb3JlLmxvY2suWEFMb2NrTWFuYWdlci5sb2NrKFhBTG9ja01hbmFnZXIuamF2YTo4MikNCglh
dCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5sb2NrLlNlc3Npb25Mb2NrTWFuYWdlci5sb2Nr
KFNlc3Npb25Mb2NrTWFuYWdlci5qYXZhOjE4MCkNCgktIGxvY2tlZCA8MHgxMWY2YjgyMD4gKGEg
b3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUubG9jay5YQUxvY2tNYW5hZ2VyKQ0KDQoiaHR0cC0w
LjAuMC4wLTgwODAtUHJvY2Vzc29yMzUiIGRhZW1vbiBwcmlvPTYgdGlkPTB4MDUzODZjMDAgbmlk
PTB4MTFjMCBpbiBPYmplY3Qud2FpdCgpIFsweDBhZTdlMDAwXQ0KICAgamF2YS5sYW5nLlRocmVh
ZC5TdGF0ZTogV0FJVElORyAob24gb2JqZWN0IG1vbml0b3IpDQoJYXQgamF2YS5sYW5nLk9iamVj
dC53YWl0KE5hdGl2ZSBNZXRob2QpDQoJLSB3YWl0aW5nIG9uIDwweDJiODVkZGM4PiAoYSBFRFUu
b3N3ZWdvLmNzLmRsLnV0aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdyaXRlTG9j
ayRSZWFkZXJMb2NrKQ0KCWF0IGphdmEubGFuZy5PYmplY3Qud2FpdChPYmplY3QuamF2YTo0ODUp
DQoJYXQgRURVLm9zd2Vnby5jcy5kbC51dGlsLmNvbmN1cnJlbnQuV3JpdGVyUHJlZmVyZW5jZVJl
YWRXcml0ZUxvY2skUmVhZGVyTG9jay5hY3F1aXJlKFdyaXRlclByZWZlcmVuY2VSZWFkV3JpdGVM
b2NrLmphdmE6MTYzKQ0KCS0gbG9ja2VkIDwweDJiODVkZGM4PiAoYSBFRFUub3N3ZWdvLmNzLmRs
LnV0aWwuY29uY3VycmVudC5Xcml0ZXJQcmVmZXJlbmNlUmVhZFdyaXRlTG9jayRSZWFkZXJMb2Nr
KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uVmVyc2lvbmluZ0xvY2sk
UmVhZExvY2suPGluaXQ+KFZlcnNpb25pbmdMb2NrLmphdmE6OTMpDQoJYXQgb3JnLmFwYWNoZS5q
YWNrcmFiYml0LmNvcmUudmVyc2lvbi5WZXJzaW9uaW5nTG9jayRSZWFkTG9jay48aW5pdD4oVmVy
c2lvbmluZ0xvY2suamF2YTo4NykNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS52ZXJz
aW9uLlZlcnNpb25pbmdMb2NrLmFjcXVpcmVSZWFkTG9jayhWZXJzaW9uaW5nTG9jay5qYXZhOjUx
KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxWZXJzaW9u
TWFuYWdlckJhc2UuYWNxdWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1hbmFnZXJCYXNlLmph
dmE6MTkzKQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnZlcnNpb24uSW50ZXJuYWxW
ZXJzaW9uTWFuYWdlckltcGwuYWNxdWlyZVJlYWRMb2NrKEludGVybmFsVmVyc2lvbk1hbmFnZXJJ
bXBsLmphdmE6NjkpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuam91cm5hbC5BYnN0
cmFjdEpvdXJuYWwubG9ja0FuZFN5bmMoQWJzdHJhY3RKb3VybmFsLmphdmE6MjYyKQ0KCWF0IG9y
Zy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLmpvdXJuYWwuRGVmYXVsdFJlY29yZFByb2R1Y2VyLmFw
cGVuZChEZWZhdWx0UmVjb3JkUHJvZHVjZXIuamF2YTo1MSkNCglhdCBvcmcuYXBhY2hlLmphY2ty
YWJiaXQuY29yZS5jbHVzdGVyLkNsdXN0ZXJOb2RlJFdvcmtzcGFjZVVwZGF0ZUNoYW5uZWwudXBk
YXRlQ3JlYXRlZChDbHVzdGVyTm9kZS5qYXZhOjU0MSkNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJi
aXQuY29yZS5zdGF0ZS5TaGFyZWRJdGVtU3RhdGVNYW5hZ2VyJFVwZGF0ZS5iZWdpbihTaGFyZWRJ
dGVtU3RhdGVNYW5hZ2VyLmphdmE6NTU5KQ0KCWF0IG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3Jl
LnN0YXRlLlNoYXJlZEl0ZW1TdGF0ZU1hbmFnZXIuYmVnaW5VcGRhdGUoU2hhcmVkSXRlbVN0YXRl
TWFuYWdlci5qYXZhOjE0NTgpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUu
U2hhcmVkSXRlbVN0YXRlTWFuYWdlci51cGRhdGUoU2hhcmVkSXRlbVN0YXRlTWFuYWdlci5qYXZh
OjE0ODgpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuTG9jYWxJdGVtU3Rh
dGVNYW5hZ2VyLnVwZGF0ZShMb2NhbEl0ZW1TdGF0ZU1hbmFnZXIuamF2YTozNTEpDQoJYXQgb3Jn
LmFwYWNoZS5qYWNrcmFiYml0LmNvcmUuc3RhdGUuWEFJdGVtU3RhdGVNYW5hZ2VyLnVwZGF0ZShY
QUl0ZW1TdGF0ZU1hbmFnZXIuamF2YTozNTQpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNv
cmUuc3RhdGUuTG9jYWxJdGVtU3RhdGVNYW5hZ2VyLnVwZGF0ZShMb2NhbEl0ZW1TdGF0ZU1hbmFn
ZXIuamF2YTozMjYpDQoJYXQgb3JnLmFwYWNoZS5qYWNrcmFiYml0LmNvcmUubG9jay5Mb2NrTWFu
YWdlckltcGwud3JpdGVMb2NrUHJvcGVydGllcyhMb2NrTWFuYWdlckltcGwuamF2YTo5NjApDQoJ
LSBsb2NrZWQgPDB4MTI1NTgxNzg+IChhIG9yZy5hcGFjaGUuamFja3JhYmJpdC5jb3JlLnN0YXRl
LlhBSXRlbVN0YXRlTWFuYWdlcikNCglhdCBvcmcuYXBhY2hlLmphY2tyYWJiaXQuY29yZS5sb2Nr
LlhBTG9ja01hbmFnZXIubG9jayhYQUxvY2tNYW5hZ2VyLmphdmE6ODIpDQoJYXQgb3JnLmFwYWNo
ZS5qYWNrcmFiYml0LmNvcmUubG9jay5TZXNzaW9uTG9ja01hbmFnZXIubG9jayhTZXNzaW9uTG9j
a01hbmFnZXIuamF2YToxODApDQoJLSBsb2NrZWQgPDB4MTI1NWMyNDg+IChhIG9yZy5hcGFjaGUu
amFja3JhYmJpdC5jb3JlLmxvY2suWEFMb2NrTWFuYWdlcikNCg0K
--f46d042f93cef32a6c04b7320d54--

From dev-return-33880-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 13:55:05 2012
Return-Path: <dev-return-33880-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F3CDF996E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 13:55:04 +0000 (UTC)
Received: (qmail 6607 invoked by uid 500); 23 Jan 2012 13:55:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 6541 invoked by uid 500); 23 Jan 2012 13:55:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 6534 invoked by uid 99); 23 Jan 2012 13:55:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 13:55:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 13:55:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C2A1F15D18C
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 13:54:40 +0000 (UTC)
Date: Mon, 23 Jan 2012 13:54:40 +0000 (UTC)
From: "Bart van der Schans (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <288998045.66761.1327326880819.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3216) When fetching node ids in checks for
 the checker all queries should use the same ordering
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

When fetching node ids in checks for the checker all queries should use the same ordering
-----------------------------------------------------------------------------------------

                 Key: JCR-3216
                 URL: https://issues.apache.org/jira/browse/JCR-3216
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-core
            Reporter: Bart van der Schans
            Assignee: Bart van der Schans
            Priority: Minor
             Fix For: 2.4, 2.5


The "bundleSelectAllIdsSQL" query and the "bundleSelectAllIdsFromSQL" should use the same ordering.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33881-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 14:13:06 2012
Return-Path: <dev-return-33881-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1692190E2
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 14:13:06 +0000 (UTC)
Received: (qmail 39236 invoked by uid 500); 23 Jan 2012 14:13:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 38741 invoked by uid 500); 23 Jan 2012 14:13:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 38728 invoked by uid 99); 23 Jan 2012 14:13:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:13:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:13:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9A9AB15DBC9
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 14:12:41 +0000 (UTC)
Date: Mon, 23 Jan 2012 14:12:41 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2080853358.66798.1327327961634.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1118370741.64462.1327235739894.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3215) not releasing session locks on
 session destruct
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3215?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13191165#comment-13191165 ] 

Julian Reschke commented on JCR-3215:
-------------------------------------

Well, not calling logout() can cause resources not to be freed. That's a problem no matter whether you use remoting or not...
                
> not releasing session locks on session destruct
> -----------------------------------------------
>
>                 Key: JCR-3215
>                 URL: https://issues.apache.org/jira/browse/JCR-3215
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-client, locks
>    Affects Versions: 2.3.6
>            Reporter: David Buchmann
>
> while investigating JCR-3205 i noticed that when my client java vm terminates without calling explicit session.logout() the session locks are not released. i would expect the session to do its logout job upon destruction. from what i understood, the server hes no notion of session, so its the job of the client to clean up.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33882-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 14:21:08 2012
Return-Path: <dev-return-33882-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8A25394C0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 14:21:08 +0000 (UTC)
Received: (qmail 65392 invoked by uid 500); 23 Jan 2012 14:21:08 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 65188 invoked by uid 500); 23 Jan 2012 14:21:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 65149 invoked by uid 99); 23 Jan 2012 14:21:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:21:07 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:21:05 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 225AA15D13F
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 14:20:44 +0000 (UTC)
Date: Mon, 23 Jan 2012 14:20:44 +0000 (UTC)
From: "Bart van der Schans (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1679868184.66829.1327328444142.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <288998045.66761.1327326880819.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3216) When fetching node ids in checks for
 the checker all queries should use the same ordering
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3216?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Bart van der Schans resolved JCR-3216.
--------------------------------------

    Resolution: Fixed
    
> When fetching node ids in checks for the checker all queries should use the same ordering
> -----------------------------------------------------------------------------------------
>
>                 Key: JCR-3216
>                 URL: https://issues.apache.org/jira/browse/JCR-3216
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>            Reporter: Bart van der Schans
>            Assignee: Bart van der Schans
>            Priority: Minor
>             Fix For: 2.4, 2.5
>
>
> The "bundleSelectAllIdsSQL" query and the "bundleSelectAllIdsFromSQL" should use the same ordering.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33883-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 14:27:04 2012
Return-Path: <dev-return-33883-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 830A394B9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 14:27:04 +0000 (UTC)
Received: (qmail 79471 invoked by uid 500); 23 Jan 2012 14:27:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 79419 invoked by uid 500); 23 Jan 2012 14:27:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 79412 invoked by uid 99); 23 Jan 2012 14:27:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:27:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:27:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 326F015D52D
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 14:26:40 +0000 (UTC)
Date: Mon, 23 Jan 2012 14:26:40 +0000 (UTC)
From: "Gustavo Orair (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <178498177.66863.1327328800208.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3217) NPE when getting the repository using
 JCA
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

NPE when getting the repository using JCA
-----------------------------------------

                 Key: JCR-3217
                 URL: https://issues.apache.org/jira/browse/JCR-3217
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-jca
    Affects Versions: 2.3.4
            Reporter: Gustavo Orair
            Priority: Blocker


https://issues.apache.org/jira/browse/JCR-3129 seems to open a new bug.

If config is null, it will call the method in line 108:
            config = RepositoryConfig.create(configFile, homeDir);

It will result in an NPE (Null Pointer Exception) on org.apache.jackrabbit.core.config.RepositoryConfig line 276:
        URI uri = new File(file).toURI();

Following stack trace is provided:
Caused by: java.lang.NullPointerException
at java.io.File.<init>(File.java:222)
at org.apache.jackrabbit.core.config.RepositoryConfig.create(RepositoryConfig.java:276)
at org.apache.jackrabbit.jca.JCARepositoryManager.createNonTransientRepository(JCARepositoryManager.java:108)
at org.apache.jackrabbit.jca.JCARepositoryManager.createRepository(JCARepositoryManager.java:77)
at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.getRepository(JCAManagedConnectionFactory.java:205)
at org.apache.jackrabbit.jca.JCAManagedConnection.openSession(JCAManagedConnection.java:100)
at org.apache.jackrabbit.jca.JCAManagedConnection.<init>(JCAManagedConnection.java:85)
at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection(JCAManagedConnectionFactory.java:174)
at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection(JCAManagedConnectionFactory.java:166)
at com.sun.enterprise.resource.allocator.ConnectorAllocator.createResource(ConnectorAllocator.java:160)
at com.sun.enterprise.resource.pool.ConnectionPool.createSingleResource(ConnectionPool.java:907)
... 77 more
|#] 

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33884-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 14:46:02 2012
Return-Path: <dev-return-33884-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6B2B895C1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 14:46:02 +0000 (UTC)
Received: (qmail 21356 invoked by uid 500); 23 Jan 2012 14:46:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 21202 invoked by uid 500); 23 Jan 2012 14:46:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 21195 invoked by uid 99); 23 Jan 2012 14:46:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:46:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 14:46:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 0E29B15DFC1
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 14:45:40 +0000 (UTC)
Date: Mon, 23 Jan 2012 14:45:40 +0000 (UTC)
From: =?utf-8?Q?Claus_K=C3=B6ll_=28Resolved=29_=28JIRA=29?= <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <224197859.66886.1327329940073.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <178498177.66863.1327328800208.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3217) NPE when getting the repository using
 JCA
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3217?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Claus K=C3=B6ll resolved JCR-3217.
-----------------------------

    Resolution: Duplicate

See JCR-3189
               =20
> NPE when getting the repository using JCA
> -----------------------------------------
>
>                 Key: JCR-3217
>                 URL: https://issues.apache.org/jira/browse/JCR-3217
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jca
>    Affects Versions: 2.3.4
>            Reporter: Gustavo Orair
>            Priority: Blocker
>   Original Estimate: 2h
>  Remaining Estimate: 2h
>
> https://issues.apache.org/jira/browse/JCR-3129 seems to open a new bug.
> If config is null, it will call the method in line 108:
>             config =3D RepositoryConfig.create(configFile, homeDir);
> It will result in an NPE (Null Pointer Exception) on org.apache.jackrabbi=
t.core.config.RepositoryConfig line 276:
>         URI uri =3D new File(file).toURI();
> Following stack trace is provided:
> Caused by: java.lang.NullPointerException
> at java.io.File.<init>(File.java:222)
> at org.apache.jackrabbit.core.config.RepositoryConfig.create(RepositoryCo=
nfig.java:276)
> at org.apache.jackrabbit.jca.JCARepositoryManager.createNonTransientRepos=
itory(JCARepositoryManager.java:108)
> at org.apache.jackrabbit.jca.JCARepositoryManager.createRepository(JCARep=
ositoryManager.java:77)
> at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.getRepository(JC=
AManagedConnectionFactory.java:205)
> at org.apache.jackrabbit.jca.JCAManagedConnection.openSession(JCAManagedC=
onnection.java:100)
> at org.apache.jackrabbit.jca.JCAManagedConnection.<init>(JCAManagedConnec=
tion.java:85)
> at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedCon=
nection(JCAManagedConnectionFactory.java:174)
> at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedCon=
nection(JCAManagedConnectionFactory.java:166)
> at com.sun.enterprise.resource.allocator.ConnectorAllocator.createResourc=
e(ConnectorAllocator.java:160)
> at com.sun.enterprise.resource.pool.ConnectionPool.createSingleResource(C=
onnectionPool.java:907)
> ... 77 more
> |#]=20

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33885-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 15:50:03 2012
Return-Path: <dev-return-33885-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 191539CC2
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 15:50:03 +0000 (UTC)
Received: (qmail 41930 invoked by uid 500); 23 Jan 2012 15:50:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 41834 invoked by uid 500); 23 Jan 2012 15:50:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 41827 invoked by uid 99); 23 Jan 2012 15:50:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 15:50:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 15:50:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 98C9615D32C
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 15:49:40 +0000 (UTC)
Date: Mon, 23 Jan 2012 15:49:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1990180288.67101.1327333780627.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3214?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13191215#comment-13191215 ] 

Julian Reschke commented on JCR-3214:
-------------------------------------

I just tried editing with word, and despite it sends a request with "Timeout: Second-3600", the same time out as above is returned; will have a look.
                
> [Lock] weird number for "infinite"
> ----------------------------------
>
>                 Key: JCR-3214
>                 URL: https://issues.apache.org/jira/browse/JCR-3214
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>
> (this is a follow-up of JCR-3205)
> i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):
> <D:timeout>Second-2147483</D:timeout>
> this number is
> 2^21+50331
> which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33886-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 23 17:53:05 2012
Return-Path: <dev-return-33886-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1189499D1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 23 Jan 2012 17:53:05 +0000 (UTC)
Received: (qmail 906 invoked by uid 500); 23 Jan 2012 17:53:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 527 invoked by uid 500); 23 Jan 2012 17:53:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 520 invoked by uid 99); 23 Jan 2012 17:53:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 17:53:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 23 Jan 2012 17:53:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9E94515E166
	for <dev@jackrabbit.apache.org>; Mon, 23 Jan 2012 17:52:40 +0000 (UTC)
Date: Mon, 23 Jan 2012 17:52:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <232868216.67495.1327341160651.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3214?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13191291#comment-13191291 ] 

Julian Reschke commented on JCR-3214:
-------------------------------------

OK; part of the problem are different code paths: DavResourceImpl vs DefaultItemCollection.
                
> [Lock] weird number for "infinite"
> ----------------------------------
>
>                 Key: JCR-3214
>                 URL: https://issues.apache.org/jira/browse/JCR-3214
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>
> (this is a follow-up of JCR-3205)
> i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):
> <D:timeout>Second-2147483</D:timeout>
> this number is
> 2^21+50331
> which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33887-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 08:47:41 2012
Return-Path: <dev-return-33887-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 785B695FB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 08:47:41 +0000 (UTC)
Received: (qmail 74736 invoked by uid 500); 24 Jan 2012 08:47:39 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 74417 invoked by uid 500); 24 Jan 2012 08:47:11 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 74389 invoked by uid 99); 24 Jan 2012 08:47:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 08:47:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 08:47:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 625D615FB92
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 08:46:40 +0000 (UTC)
Date: Tue, 24 Jan 2012 08:46:40 +0000 (UTC)
From: "angela (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <587708642.71076.1327394800429.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3218) UserImporter should trigger execution
 AuthorizableActions in case of user/group creation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

UserImporter should trigger execution AuthorizableActions in case of user/group creation
----------------------------------------------------------------------------------------

                 Key: JCR-3218
                 URL: https://issues.apache.org/jira/browse/JCR-3218
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-core, security
            Reporter: angela
            Assignee: angela
             Fix For: 2.3.7


in accordance to the new implementation specific extensions made to user mangement in JCR-3118 the user-importer
should be adjusted as well.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33888-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 10:13:17 2012
Return-Path: <dev-return-33888-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0EE1D9249
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 10:13:17 +0000 (UTC)
Received: (qmail 2639 invoked by uid 500); 24 Jan 2012 10:13:14 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 1982 invoked by uid 500); 24 Jan 2012 10:13:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 1754 invoked by uid 99); 24 Jan 2012 10:13:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 10:13:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 10:13:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 287CF15FFEF
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 10:12:40 +0000 (UTC)
Date: Tue, 24 Jan 2012 10:12:40 +0000 (UTC)
From: "angela (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1334843175.71226.1327399960167.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <587708642.71076.1327394800429.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3218) UserImporter should trigger execution
 AuthorizableActions in case of user/group creation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3218?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela resolved JCR-3218.
-------------------------

    Resolution: Fixed
    
> UserImporter should trigger execution AuthorizableActions in case of user/group creation
> ----------------------------------------------------------------------------------------
>
>                 Key: JCR-3218
>                 URL: https://issues.apache.org/jira/browse/JCR-3218
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core, security
>            Reporter: angela
>            Assignee: angela
>             Fix For: 2.3.7
>
>
> in accordance to the new implementation specific extensions made to user mangement in JCR-3118 the user-importer
> should be adjusted as well.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33889-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 15:25:03 2012
Return-Path: <dev-return-33889-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E43EF90C4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 15:25:02 +0000 (UTC)
Received: (qmail 16625 invoked by uid 500); 24 Jan 2012 15:25:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 16476 invoked by uid 500); 24 Jan 2012 15:25:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 16468 invoked by uid 99); 24 Jan 2012 15:25:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 15:25:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 15:25:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 2225B16031A
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 15:24:40 +0000 (UTC)
Date: Tue, 24 Jan 2012 15:24:40 +0000 (UTC)
From: "David Buchmann (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2051747550.71999.1327418680141.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3219) regression with self-join queries
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

regression with self-join queries
---------------------------------

                 Key: JCR-3219
                 URL: https://issues.apache.org/jira/browse/JCR-3219
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-jcr-server, query, sql
            Reporter: David Buchmann
            Priority: Minor


affects version 2.3.7

running a query that joins on the same node type against 2.3.6 returns 1 result, while running it against 2.3.7 returns the same node 3 times. if i join two different node types, i get only one result row...

to reproduce: in my repository, i have 2 unstructured nodes with the same jcr:mimeType and one of them having the field zeronumber with value 0.

            QueryManager qm = s.getWorkspace().getQueryManager();
            Query q = qm.createQuery("SELECT data.zeronumber FROM [nt:unstructured] AS data INNER JOIN [nt:unstructured] AS second ON data.[jcr:mimeType] = second.[jcr:mimeType] WHERE data.zeronumber = 0", Query.JCR_JQOM);
            QueryResult r = q.execute();
            RowIterator i = r.getRows();
            while (i.hasNext()) {
                Row n = i.nextRow();
                System.out.println(n.getPath("data"));
            }

jukka suspects this could be introduced by JCR-3198

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33890-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 17:06:03 2012
Return-Path: <dev-return-33890-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D4F449C88
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 17:06:03 +0000 (UTC)
Received: (qmail 10348 invoked by uid 500); 24 Jan 2012 17:06:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 10229 invoked by uid 500); 24 Jan 2012 17:06:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 10221 invoked by uid 99); 24 Jan 2012 17:06:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 17:06:02 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 17:05:56 +0000
Received: by wibhm4 with SMTP id hm4so4080415wib.1
        for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 09:05:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        bh=8+5FSMyuntSSJP6uOWHPVeWopyBK9Px9ezpbouu3zxk=;
        b=PSQKcnn+kc+lpIHlSvc2VZOwxoRUXFYe8gsXFitkaG+gKfby+D3IlqIgwir0MFJ5a/
         b5vclD3iVPWVvvq2oUC9PuFn+U+XW5f8tr6UjzDSlI6RjEtUf6pGXsv+kBp6USgHSMU3
         C1G5dvPGhIUhUHgESReQfoywXDrokR6VP2Zk4=
Received: by 10.180.105.129 with SMTP id gm1mr6173890wib.1.1327424735146; Tue,
 24 Jan 2012 09:05:35 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Tue, 24 Jan 2012 09:05:15 -0800 (PST)
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 24 Jan 2012 18:05:15 +0100
Message-ID: <CAOFYJNaw_ayuQU6qYMisX=s3qQ7ffNXgZ2_oqEUDxwxoMo-WBA@mail.gmail.com>
Subject: Jackrabbit 2.2.11 release plan
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1

Hi,

We have a need for a new Jackrabbit 2.2 patch release with the
JCR-3107 improvement included. There are also a number of smaller bug
fixes that could be backported.

Thus I'm planning to cut a Jackrabbit 2.2.11 release candidate within
the next few days. Please let me know if you'd like to see some
specific fixes included.

Note that normally we only include bugfixes in patch releases from
maintenance branches, but the benefit/risk ratio of the JCR-3107
improvement seems high enough to justify including it in 2.2.x.

BR,

Jukka Zitting

From dev-return-33891-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 17:49:02 2012
Return-Path: <dev-return-33891-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 429469C48
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 17:49:02 +0000 (UTC)
Received: (qmail 15117 invoked by uid 500); 24 Jan 2012 17:49:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 14999 invoked by uid 500); 24 Jan 2012 17:49:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 14992 invoked by uid 99); 24 Jan 2012 17:49:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 17:49:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 17:49:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 2FB0A160C95
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 17:48:40 +0000 (UTC)
Date: Tue, 24 Jan 2012 17:48:40 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1601220473.72536.1327427320197.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3214?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-3214.
---------------------------------

       Resolution: Fixed
    Fix Version/s: 2.6
    
> [Lock] weird number for "infinite"
> ----------------------------------
>
>                 Key: JCR-3214
>                 URL: https://issues.apache.org/jira/browse/JCR-3214
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>             Fix For: 2.6
>
>
> (this is a follow-up of JCR-3205)
> i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):
> <D:timeout>Second-2147483</D:timeout>
> this number is
> 2^21+50331
> which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33892-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 17:51:07 2012
Return-Path: <dev-return-33892-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 890669CCA
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 17:51:07 +0000 (UTC)
Received: (qmail 18093 invoked by uid 500); 24 Jan 2012 17:51:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 18048 invoked by uid 500); 24 Jan 2012 17:51:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 18039 invoked by uid 99); 24 Jan 2012 17:51:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 17:51:06 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 17:51:05 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4E3BC160DFD
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 17:50:45 +0000 (UTC)
Date: Tue, 24 Jan 2012 17:50:45 +0000 (UTC)
From: "Julian Reschke (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <628686453.72547.1327427445340.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3220) simple webdav server does not support
 lock timeouts
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

simple webdav server does not support lock timeouts
---------------------------------------------------

                 Key: JCR-3220
                 URL: https://issues.apache.org/jira/browse/JCR-3220
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-jcr-server, locks
            Reporter: Julian Reschke
            Assignee: Julian Reschke


The "simple" WebDAV server still does not support lock timeouts (HTTP trace shows MS word requests 3600s timeout but gets infinity).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33893-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 19:04:43 2012
Return-Path: <dev-return-33893-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C8F71985B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 19:04:43 +0000 (UTC)
Received: (qmail 47206 invoked by uid 500); 24 Jan 2012 19:04:43 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 47094 invoked by uid 500); 24 Jan 2012 19:04:42 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 47087 invoked by uid 99); 24 Jan 2012 19:04:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 19:04:42 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 19:04:36 +0000
Received: by wibhm4 with SMTP id hm4so4273092wib.1
        for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 11:04:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=vbBmOXKQ+P0gVpVoSEbellmBIDLWBVbLi5XZkwGHY84=;
        b=aHnjww7fSLLH/5AeaBVhuJkULHn+JfraWUDujtyG5P7lsXQBMn0YplOMeP3JHLx5av
         SVuECKtc/KCaP0ntwSx1pzbCqkleNXTMD9fyMwjJQUsVqecW6dlHEyfNw9YDQg0LYzub
         rex8yaVSu3R/YTBLg8EtD2I8TCn4mZPKgghUk=
Received: by 10.180.97.166 with SMTP id eb6mr23265563wib.5.1327431855108; Tue,
 24 Jan 2012 11:04:15 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Tue, 24 Jan 2012 11:03:54 -0800 (PST)
In-Reply-To: <CACEFBuQ22q4Y2VgmPtH8aq6yO0mEHe79n9w3cwTL1c4FBtUxgg@mail.gmail.com>
References: <CACEFBuQ22q4Y2VgmPtH8aq6yO0mEHe79n9w3cwTL1c4FBtUxgg@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 24 Jan 2012 20:03:54 +0100
Message-ID: <CAOFYJNaMtPRGusEW=SVDwAR41bp1NqxwwUv+FhHLBPBfmmnvYw@mail.gmail.com>
Subject: Re: "FineGrainedISMLocking" not allowing read while write lock is acquired.
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: quoted-printable

Hi,

On Mon, Jan 23, 2012 at 2:31 PM, Mahesh <maahi333@gmail.com> wrote:
> Still after changing ISMLocking to =91FineGrainedISMLocking=92 there are
> read locks waiting. Hence I am confused and stuck.

Looks like your threads are blocked accessing version histories.
Access to the version storage is controlled by a separate read/write
lock.

BR,

Jukka Zitting

From dev-return-33894-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 19:21:08 2012
Return-Path: <dev-return-33894-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 968269D57
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 19:21:08 +0000 (UTC)
Received: (qmail 1156 invoked by uid 500); 24 Jan 2012 19:21:08 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 1107 invoked by uid 500); 24 Jan 2012 19:21:07 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 1097 invoked by uid 99); 24 Jan 2012 19:21:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 19:21:07 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 19:21:06 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 6A6741607C8
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 19:20:46 +0000 (UTC)
Date: Tue, 24 Jan 2012 19:20:46 +0000 (UTC)
From: "Julian Reschke (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1103335763.73035.1327432846437.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <628686453.72547.1327427445340.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3220) simple webdav server does not support
 lock timeouts
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3220?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke resolved JCR-3220.
---------------------------------

       Resolution: Fixed
    Fix Version/s: 2.6
    
> simple webdav server does not support lock timeouts
> ---------------------------------------------------
>
>                 Key: JCR-3220
>                 URL: https://issues.apache.org/jira/browse/JCR-3220
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>             Fix For: 2.6
>
>
> The "simple" WebDAV server still does not support lock timeouts (HTTP trace shows MS word requests 3600s timeout but gets infinity).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33895-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 21:59:02 2012
Return-Path: <dev-return-33895-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E214B955D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 21:59:02 +0000 (UTC)
Received: (qmail 16825 invoked by uid 500); 24 Jan 2012 21:59:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 16712 invoked by uid 500); 24 Jan 2012 21:59:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 16678 invoked by uid 99); 24 Jan 2012 21:59:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 21:59:01 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 21:58:55 +0000
Received: by wibhm4 with SMTP id hm4so4516367wib.1
        for <multiple recipients>; Tue, 24 Jan 2012 13:58:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:sender:from:date:x-google-sender-auth:message-id
         :subject:to:content-type;
        bh=k05JPzbOPW+R7YbcssbSkXqXy7/7JPSDjqvj00bkdAY=;
        b=RUqVQ9SMRfZq53pFKVlHJMfQjrJhQ/nU0FKACAEhew6ssS9HllXzzOJQJGv4Ucxy9N
         38Ccg+5ZGIKwyOJC55LM/CgjAURjQisr8OjX0WmaIM/AptzbOfivgGN/SiCuDx4rn7yT
         Q+PcDxDs3nLjKOQJZE9Xd7rDkifmagPrjRNWg=
Received: by 10.180.93.193 with SMTP id cw1mr24078725wib.5.1327442313124; Tue,
 24 Jan 2012 13:58:33 -0800 (PST)
MIME-Version: 1.0
Sender: jukka.zitting@gmail.com
Received: by 10.180.97.67 with HTTP; Tue, 24 Jan 2012 13:58:12 -0800 (PST)
From: Jukka Zitting <jukka@apache.org>
Date: Tue, 24 Jan 2012 22:58:12 +0100
X-Google-Sender-Auth: XJohdJEPkxeRDqRLTxiyxUkpAMo
Message-ID: <CAOFYJNYYnxZJvut4Vj_+Z4apsTkb+k+1kHG3WCObOYW1zb2amQ@mail.gmail.com>
Subject: [ANNOUNCE] Apache Jackrabbit 2.3.7 released
To: announce@apache.org, announce@jackrabbit.apache.org, 
	Jackrabbit Users <users@jackrabbit.apache.org>, 
	Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1

The Apache Jackrabbit community is pleased to announce the release of
Apache Jackrabbit 2.3.7. The release is available for download at:

    http://jackrabbit.apache.org/downloads.html

See the full release notes below for details about this release.


Release Notes -- Apache Jackrabbit -- Version 2.3.7

Introduction
------------

This is Apache Jackrabbit(TM) 2.3, a fully compliant implementation of the
Content Repository for Java(TM) Technology API, version 2.0 (JCR 2.0) as
specified in the Java Specification Request 283 (JSR 283).

Apache Jackrabbit 2.3 is an unstable series of releases cut directly from
Jackrabbit trunk, with a focus on new features and other improvements.
For production use we recommend the latest stable 2.2 release.

Changes in Jackrabbit 2.3.7
---------------------------

New features

  [JCR-2859] Make open scoped locks recoverable

Improvements

  [JCR-3184] extend ConsistencyChecker API to allow adoption of orphaned ...
  [JCR-3185] refactor consistency checks in BundleDBPersistenceManager ...
  [JCR-3199] workspace-wide default for lock timeout
  [JCR-3200] consistency check should get node ids in chunks, not rely on ...
  [JCR-3202] AuthorizableImpl#memberOf and #declaredMemberOf should ...

Bug fixes

  [JCR-2543] spi2dav : Query offset not respected
  [JCR-3189] JCARepositoryManager.createNonTransientRepository throws NPE ...
  [JCR-3194] ConcurrentModificationException in CacheManager.
  [JCR-3195] wrong assumptions in test cases about lock tokens
  [JCR-3198] Broken handling of outer join results over davex
  [JCR-3205] Missing support for lock timeout and ownerHint in jcr-server
  [JCR-3210] NPE in spi2dav when server does not send all headers

Changes in Jackrabbit 2.3.6
---------------------------

New features

  [JCR-3005] Make it possible to get multiple nodes in one call via davex
  [JCR-3183] Add memory based bundle store

Improvements

  [JCR-3162] Index update overhead on cluster slave due to JCR-905
  [JCR-3172] implement PERSIST events for the EventJournal
  [JCR-3177] Remove jdk 1.4 restriction for jcr-tests
  [JCR-3178] Improve error messages for index aggregates

Bug fixes

  [JCR-2541] spi2dav : EventJournal not  implemented
  [JCR-2930] same named child nodes disappear on restore
  [JCR-3174] Destination URI should be normalized
  [JCR-3175] InputContextImpl: cannot upload file larger than 2GB
  [JCR-3176] JCARepositoryManager does not close InputStream

Changes in Jackrabbit 2.3.5
---------------------------

Improvements

  [JCR-2887] Split PrivilegeRegistry in a per-session manager instance ...
  [JCR-2906] Multivalued property sorted by last/random value
  [JCR-3138] Skip sync delay when changes are found
  [JCR-3161] Add JcrUtils.getPropertyTypeNames
  [JCR-3165] Consolidate compare behaviour for Value(s) and Comparable(s)
  [JCR-3167] Make Jackrabbit compile on Java 7
  [JCR-3170] Precompile JavaCC parsers in jackrabbit-spi-commons

Bug fixes

  [JCR-3159] LOWER operand with nested LOCALNAME operand not work with SQL2
  [JCR-3160] Session#move doesn't trigger rebuild of parent node aggregation
  [JCR-3163] NPE in RepositoryServiceImpl.getPropertyInfo()

Changes in Jackrabbit 2.3.4
---------------------------

New features

  [JCR-2936] JMX Bindings for Jackrabbit
  [JCR-3040] JMX Stats for the Session
  [JCR-3140] Add configurable hook for password validation
  [JCR-3154] Stats for Queries continued

Improvements

  [JCR-3129] It should be possible to create a non-transient Repository ...
  [JCR-3133] Query Stats should use the TimeSeries mechanism
  [JCR-3142] Create OSGi Bundles from jackrabbit-webdav and ...
  [JCR-3143] SessionImpl#isSupportedOption: Skip descriptor evaluation ...
  [JCR-3146] Text extraction may congest thread pool in the repository

Bug fixes

  [JCR-2539] spi2dav: Observation's user data not property handled
  [JCR-2540] spi2dav : move/reorder not properly handled by observation
  [JCR-2542] spi2dav: EventFilters not respected
  [JCR-3148] Using transactions still leads to memory leak
  [JCR-3149] AccessControlProvider#getEffectivePolicies for a set of ...
  [JCR-3151] SharedFieldCache can cause a memory leak
  [JCR-3152] AccessControlImporter does not import repo level ac content
  [JCR-3156] Group#getMembers may list inherited members multiple times

Changes in Jackrabbit 2.3.3
---------------------------

New features

  [JCR-3118] Configurable actions upon authorizable creation and removal

Improvements

  [JCR-1443] ake JCAManagedConnectionFactory non final, so it can be extended
  [JCR-2798] JCAManagedConnectionFactory should chain cause exception
  [JCR-3120] Change log level in UserManagerImpl#getAuthorizable(NodeImpl) ...
  [JCR-3127] Upgrade to Tika 0.10
  [JCR-3132] Test tooling updates
  [JCR-3135] Upgrade to Logback 1.0
  [JCR-3136] Add m2e lifecycle mappings for Eclipse Indigo
  [JCR-3141] Upgrade to Tika 1.0

Bug fixes

  [JCR-3093] Inconsistency between Session.getProperty and Node....
  [JCR-3110] QNodeTypeDefinitionImpl.getSerializablePropertyDefs() ...
  [JCR-3116] Cluster Node ID should be trimmed
  [JCR-3131] NPE in ItemManager when calling Session.save() with nothing ...
  [JCR-3139] missing sync in InternalVersionManagerImpl.externalUpdate ...

Changes in Jackrabbit 2.3.2
---------------------------

New features

  [JCR-3117] Stats for the PersistenceManager
  [JCR-3124] Stats for Queries

Improvements

  [JCR-2989] Support for embedded index aggregates
  [JCR-3098] Add hit miss statistics and logging to caches
  [JCR-3107] Speed up hierarchy cache initialization
  [JCR-3109] Move PersistenceManagerTest from o.a.j.core to o.a.j.core....
  [JCR-3114] expose PM for versioning manager so that the consistency ...
  [JCR-3119] Improve aggregate node indexing code
  [JCR-3122] QueryObjectModelImpl should execute queries as SessionOperation(s)

Bug fixes

  [JCR-2892] - Large fetch sizes have potentially deleterious effects on ...
  [JCR-3093] - Inconsistency between Session.getProperty and Node....
  [JCR-3108] - SQL2 ISDESCENDANTNODE can throw BooleanQuery#...
  [JCR-3111] - InternalVersionManagerBase; missing null check after getNode()
  [JCR-3112] - NodeTypeDefDiff.PropDefDiff.init() constraints change check ...
  [JCR-3115] - Versioning fixup leaves persistence in a state where the ...
  [JCR-3126] - The CredentialsWrapper should use a empty String as userId ...
  [JCR-3128] - Problem with formerly escaped JCR node names when upgrading ...

Changes in Jackrabbit 2.3.1
---------------------------

Improvements

  [JCR-3017] Version history recovery fails in case a version does not ...
  [JCR-3030] Permit using different tablespaces for tables and indexes ...
  [JCR-3084] Script for checking releases
  [JCR-3085] better diagnostics when version storage is broken
  [JCR-3091] Lucene Scorer implementations should handle the 'advance' ...
  [JCR-3102] InternalVersion.getFrozenNode confused about root version?

Bug fixes

  [JCR-2774] Access control for repository level API operations
  [JCR-3082] occasional index out of bounds exception while running ...
  [JCR-3086] potential infinite loop around InternalVersionImpl.getSuccessors
  [JCR-3089] javax.jcr.RepositoryException when a JOIN SQL2 query is ...
  [JCR-3090] setFetchSize() fails in getAllNodeIds()
  [JCR-3095] Move operation may turn AC caches stale
  [JCR-3101] recovery tool does not recover when version history can ...
  [JCR-3105] NPE when versioning operations are concurrent

In addition to the above-mentioned changes, this release contains
all the changes included up to the Apache Jackrabbit 2.3.0 release.

For more detailed information about all the changes in this and other
Jackrabbit releases, please see the Jackrabbit issue tracker at

    https://issues.apache.org/jira/browse/JCR

Release Contents
----------------

This release consists of a single source archive packaged as a zip file.
The archive can be unpacked with the jar tool from your JDK installation.
See the README.txt file for instructions on how to build this release.

The source archive is accompanied by SHA1 and MD5 checksums and a PGP
signature that you can use to verify the authenticity of your download.
The public key used for the PGP signature can be found at
https://svn.apache.org/repos/asf/jackrabbit/dist/KEYS.

About Apache Jackrabbit
-----------------------

Apache Jackrabbit is a fully conforming implementation of the Content
Repository for Java Technology API (JCR). A content repository is a
hierarchical content store with support for structured and unstructured
content, full text search, versioning, transactions, observation, and
more.

For more information, visit http://jackrabbit.apache.org/

About The Apache Software Foundation
------------------------------------

Established in 1999, The Apache Software Foundation provides organizational,
legal, and financial support for more than 100 freely-available,
collaboratively-developed Open Source projects. The pragmatic Apache License
enables individual and commercial users to easily deploy Apache software;
the Foundation's intellectual property framework limits the legal exposure
of its 2,500+ contributors.

For more information, visit http://www.apache.org/

From dev-return-33896-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 23:36:59 2012
Return-Path: <dev-return-33896-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ACFEB9597
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 23:36:59 +0000 (UTC)
Received: (qmail 44711 invoked by uid 500); 24 Jan 2012 23:36:59 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 44603 invoked by uid 500); 24 Jan 2012 23:36:58 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 44594 invoked by uid 99); 24 Jan 2012 23:36:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 23:36:58 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.23 as permitted sender)
Received: from [64.18.1.23] (HELO exprod6og109.obsmtp.com) (64.18.1.23)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 24 Jan 2012 23:36:48 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob109.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx9AeebOh7YJp6XVgvixZHGj6VOeg8k0@postini.com; Tue, 24 Jan 2012 15:36:27 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.corp.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0ONaO2U016839
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 15:36:24 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0ONaNMM002294
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 15:36:23 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 24 Jan 2012
 15:36:23 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Tue, 24 Jan 2012 23:36:20
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 24 Jan 2012 23:36:19 +0000
Subject: Jackrabbit SPI export version
Thread-Topic: Jackrabbit SPI export version
Thread-Index: Acza8PmZKNbX3/NZQbKxYz+xHSDLHQ==
Message-ID: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I got a big problem with Jackrabbit SPI version 2.3.7 just released: This i=
ncreases the export version of the org.apache.jackrabit.spi package from 2.=
4.0 to 3.0.0.

The consequence of this is dramatic: It breaks compatibility on all levels =
!

It looks like this has been done by commit 1233468 (Update OSGi package ver=
sions for a new release.)

Consequence of this is, that I have a hard time updating the Sling DavEx bu=
ndle to this latest release ... But not updating and running in a framework=
 with the new bundle will also prevent Sling DavEx from running.

Regards
Felix=

From dev-return-33897-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 24 23:46:22 2012
Return-Path: <dev-return-33897-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6C0E098E4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 24 Jan 2012 23:46:22 +0000 (UTC)
Received: (qmail 58302 invoked by uid 500); 24 Jan 2012 23:46:22 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 58245 invoked by uid 500); 24 Jan 2012 23:46:21 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 58238 invoked by uid 99); 24 Jan 2012 23:46:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 24 Jan 2012 23:46:21 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.25 as permitted sender)
Received: from [64.18.1.25] (HELO exprod6og110.obsmtp.com) (64.18.1.25)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 24 Jan 2012 23:46:12 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob110.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx9CrwD1p3Hm/AhVOrh+2BKKi5mjEcQa@postini.com; Tue, 24 Jan 2012 15:45:52 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0ONhv0Y007152
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 15:43:57 -0800 (PST)
Received: from nahub02.corp.adobe.com (nahub02.corp.adobe.com [10.8.189.98])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0ONjSPn014464
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 15:45:49 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nahub02.corp.adobe.com
 (10.8.189.98) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 24 Jan 2012
 15:45:34 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Tue, 24 Jan 2012 23:45:33
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 24 Jan 2012 23:45:31 +0000
Subject: Re: Jackrabbit SPI export version
Thread-Topic: Jackrabbit SPI export version
Thread-Index: Acza8kMcgPYr4zynQxiP4P8OkLsc2A==
Message-ID: <80CAFCD9-D789-4953-A5B2-6E05349F5530@adobe.com>
References: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
In-Reply-To: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi

Looks like this came in for JCR-3198, which indeed changes signatures on me=
thods, which is indeed breaking compatiblity.

This should probably not be done (and may new interfaces defined with new A=
PI).

Regards
Felix

Am 25.01.2012 um 00:36 schrieb Felix Meschberger:

> Hi all,
>=20
> I got a big problem with Jackrabbit SPI version 2.3.7 just released: This=
 increases the export version of the org.apache.jackrabit.spi package from =
2.4.0 to 3.0.0.
>=20
> The consequence of this is dramatic: It breaks compatibility on all level=
s !
>=20
> It looks like this has been done by commit 1233468 (Update OSGi package v=
ersions for a new release.)
>=20
> Consequence of this is, that I have a hard time updating the Sling DavEx =
bundle to this latest release ... But not updating and running in a framewo=
rk with the new bundle will also prevent Sling DavEx from running.
>=20
> Regards
> Felix


From dev-return-33898-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 00:01:23 2012
Return-Path: <dev-return-33898-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0EC989C07
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 00:01:23 +0000 (UTC)
Received: (qmail 76225 invoked by uid 500); 25 Jan 2012 00:01:22 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 76103 invoked by uid 500); 25 Jan 2012 00:01:22 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 76007 invoked by uid 99); 25 Jan 2012 00:01:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:01:21 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:01:15 +0000
Received: by wibhm4 with SMTP id hm4so4646370wib.1
        for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 16:00:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=K4CkHKbKqEhHgAMG9azYzHzS7NrgYrEy/VN1wYz2V4s=;
        b=TsW8JT3nDSh2lPUTQeiGmUGS5/Ktg0PrNs0mr38MPS9XaMz+C3hL3P2u+N1sx+3jJB
         4EAh9e6HH1qReyUm04w+2JrQj1frb6dCVb2brM20QUz0aAb8WcUOVy6zLriHs8kyXR5Z
         P8yhAmKWZEgfCHeBg9VeUjhFcVDsUGiusDHs8=
Received: by 10.180.97.166 with SMTP id eb6mr24721508wib.5.1327449654115; Tue,
 24 Jan 2012 16:00:54 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Tue, 24 Jan 2012 16:00:34 -0800 (PST)
In-Reply-To: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
References: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Wed, 25 Jan 2012 01:00:34 +0100
Message-ID: <CAOFYJNa7Sza60WOv4iDm+aUYUhtTcP2K=C4-WCPRYThGq4QKqg@mail.gmail.com>
Subject: Re: Jackrabbit SPI export version
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi,

On Wed, Jan 25, 2012 at 12:36 AM, Felix Meschberger <fmeschbe@adobe.com> wrote:
> I got a big problem with Jackrabbit SPI version 2.3.7 just released: This increases the
> export version of the org.apache.jackrabit.spi package from 2.4.0 to 3.0.0.

Yes, I changed the SPI in a minor but backwards-incompatible way in
JCR-3198 (the QueryInfo.getSelectorNames signature was clearly wrong,
as selector names are opaque strings, not qualified names). Thus the
increase in the package version.

> Consequence of this is, that I have a hard time updating the Sling DavEx
> bundle to this latest release ...

What's the exact problem you're having?

BR,

Jukka Zitting

From dev-return-33899-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 00:05:15 2012
Return-Path: <dev-return-33899-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 449D69CBF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 00:05:15 +0000 (UTC)
Received: (qmail 84588 invoked by uid 500); 25 Jan 2012 00:05:15 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 84531 invoked by uid 500); 25 Jan 2012 00:05:14 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 84524 invoked by uid 99); 25 Jan 2012 00:05:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:05:14 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.181 as permitted sender)
Received: from [64.18.1.181] (HELO exprod6og101.obsmtp.com) (64.18.1.181)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 25 Jan 2012 00:05:05 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob101.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx9HHHvOsKc9HTB8j+fNAq03rA5C1Dj6@postini.com; Tue, 24 Jan 2012 16:04:45 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0P02p0Y009229
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 16:02:51 -0800 (PST)
Received: from nacas02.corp.adobe.com (nacas02.corp.adobe.com [10.8.189.100])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0P04iMM011505
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 16:04:44 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas02.corp.adobe.com
 (10.8.189.100) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 24 Jan
 2012 16:04:43 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Wed, 25 Jan 2012 00:04:42
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Wed, 25 Jan 2012 00:04:41 +0000
Subject: Re: Jackrabbit SPI export version
Thread-Topic: Jackrabbit SPI export version
Thread-Index: Acza9H2k+SnC1hVxSni/HGzCtG98XwAAHIS1
Message-ID: <b7oeuwvd686kiwqpsoubraos.1327449866784@email.android.com>
Accept-Language: de-DE, en-US
Content-Language: de-DE
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Wanted to upgrade the Sling build to Jacktabbit 2.3.7 bundles .. Due to thi=
s incompatibility this is not possible without updating everything Jackrabb=
it to 2.3.7...
Regards
Felix

Jukka Zitting <jukka.zitting@gmail.com> schrieb:


Hi,

On Wed, Jan 25, 2012 at 12:36 AM, Felix Meschberger <fmeschbe@adobe.com> wr=
ote:
> I got a big problem with Jackrabbit SPI version 2.3.7 just released: This=
 increases the
> export version of the org.apache.jackrabit.spi package from 2.4.0 to 3.0.=
0.

Yes, I changed the SPI in a minor but backwards-incompatible way in
JCR-3198 (the QueryInfo.getSelectorNames signature was clearly wrong,
as selector names are opaque strings, not qualified names). Thus the
increase in the package version.

> Consequence of this is, that I have a hard time updating the Sling DavEx
> bundle to this latest release ...

What's the exact problem you're having?

BR,

Jukka Zitting

From dev-return-33900-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 00:06:48 2012
Return-Path: <dev-return-33900-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B080F9D27
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 00:06:48 +0000 (UTC)
Received: (qmail 89507 invoked by uid 500); 25 Jan 2012 00:06:48 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 89459 invoked by uid 500); 25 Jan 2012 00:06:47 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 89452 invoked by uid 99); 25 Jan 2012 00:06:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:06:47 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tripod@adobe.com designates 64.18.1.185 as permitted sender)
Received: from [64.18.1.185] (HELO exprod6og103.obsmtp.com) (64.18.1.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:06:38 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob103.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx9HeelmPqjBfKt87TeOrzhvWxNeZsyE@postini.com; Tue, 24 Jan 2012 16:06:18 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0P04N0Y009363
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 16:04:24 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0P06FPl019561
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 16:06:15 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 24 Jan 2012
 16:06:15 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Wed, 25 Jan 2012 00:06:13
 +0000
From: Tobias Bocanegra <tripod@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Wed, 25 Jan 2012 00:06:08 +0000
Subject: Re: Jackrabbit SPI export version
Thread-Topic: Jackrabbit SPI export version
Thread-Index: Acza9SYWA9q860olSFWnpnRO7k7feQ==
Message-ID: <CAB+dfikj9OYcpkGZrxM_e46tk1APv2FMkc1nfTJx_XiQX9-OFw@mail.gmail.com>
References: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
	<CAOFYJNa7Sza60WOv4iDm+aUYUhtTcP2K=C4-WCPRYThGq4QKqg@mail.gmail.com>
In-Reply-To: <CAOFYJNa7Sza60WOv4iDm+aUYUhtTcP2K=C4-WCPRYThGq4QKqg@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

SSBhZ3JlZSB3aXRoIGZlbGl4LA0KDQrCoCDCoCDCoC8qKg0KLSDCoCDCoCAqIEByZXR1cm4gYW4g
YXJyYXkgb2YgPGNvZGU+TmFtZTwvY29kZT5zIHJlcHJlc2VudGluZyB0aGUNCnNlbGVjdG9yIG5h
bWVzIG9mDQorIMKgIMKgICogQHJldHVybiBhbiBhcnJheSBvZiA8Y29kZT5TdHJpbmc8L2NvZGU+
cyByZXByZXNlbnRpbmcgdGhlDQpzZWxlY3RvciBuYW1lcyBvZg0KwqAgwqAgwqAgKiDCoCDCoCDC
oCDCoCB0aGUgcXVlcnkgcmVzdWx0Lg0KwqAgwqAgwqAgKiBAc2VlIGphdmF4Lmpjci5xdWVyeS5R
dWVyeVJlc3VsdCNnZXRTZWxlY3Rvck5hbWVzKCkNCsKgIMKgIMKgICovDQotIMKgIMKgcHVibGlj
IE5hbWVbXSBnZXRTZWxlY3Rvck5hbWVzKCk7DQorIMKgIMKgcHVibGljIFN0cmluZ1tdIGdldFNl
bGVjdG9yTmFtZXMoKTsNCg0KaXMgbm90IGEgYmFja3dhcmQgY29tcGF0aWJsZSBjaGFuZ2UhDQp0
aGUgcHJvYmxlbSBpcywgdGhhdCAyLjMuNyBjYW4ndCBiZSB1c2VkIG5vdyBieSBhbnkgYnVuZGxl
cyB0aGF0IHN0aWxsDQpuZWVkIDIuNCBhbmQgdGhlcmUgaXMgbm90IHN0YWJsZSAyLjQgdmVyc2lv
bi4NCg0KaG93IGFib3V0IGFkZGluZyBnZXRTZWxlY3Rvckpjck5hbWVzKCkgYW5kIGRlcHJlY2F0
ZSB0aGUgb3RoZXIgb25lPw0KQW5kIGlmIGl0IGNhbid0IGJlIGltcGxlbWVudGVkLCByYXRoZXIg
dGhyb3cgYW4gVW5zdXBwb3J0ZWRFeGNlcHRpb24NCnRoYW4gY2hhbmdpbmcgdGhlIHNpZ25hdHVy
ZS4NCg0KcmVnYXJkcywgdG9ieQ0KDQoNCk9uIFR1ZSwgSmFuIDI0LCAyMDEyIGF0IDQ6MDAgUE0s
IEp1a2thIFppdHRpbmcgPGp1a2thLnppdHRpbmdAZ21haWwuY29tPiB3cm90ZToNCj4gSGksDQo+
DQo+IE9uIFdlZCwgSmFuIDI1LCAyMDEyIGF0IDEyOjM2IEFNLCBGZWxpeCBNZXNjaGJlcmdlciA8
Zm1lc2NoYmVAYWRvYmUuY29tPiB3cm90ZToNCj4+IEkgZ290IGEgYmlnIHByb2JsZW0gd2l0aCBK
YWNrcmFiYml0IFNQSSB2ZXJzaW9uIDIuMy43IGp1c3QgcmVsZWFzZWQ6IFRoaXMgaW5jcmVhc2Vz
IHRoZQ0KPj4gZXhwb3J0IHZlcnNpb24gb2YgdGhlIG9yZy5hcGFjaGUuamFja3JhYml0LnNwaSBw
YWNrYWdlIGZyb20gMi40LjAgdG8gMy4wLjAuDQo+DQo+IFllcywgSSBjaGFuZ2VkIHRoZSBTUEkg
aW4gYSBtaW5vciBidXQgYmFja3dhcmRzLWluY29tcGF0aWJsZSB3YXkgaW4NCj4gSkNSLTMxOTgg
KHRoZSBRdWVyeUluZm8uZ2V0U2VsZWN0b3JOYW1lcyBzaWduYXR1cmUgd2FzIGNsZWFybHkgd3Jv
bmcsDQo+IGFzIHNlbGVjdG9yIG5hbWVzIGFyZSBvcGFxdWUgc3RyaW5ncywgbm90IHF1YWxpZmll
ZCBuYW1lcykuIFRodXMgdGhlDQo+IGluY3JlYXNlIGluIHRoZSBwYWNrYWdlIHZlcnNpb24uDQo+
DQo+PiBDb25zZXF1ZW5jZSBvZiB0aGlzIGlzLCB0aGF0IEkgaGF2ZSBhIGhhcmQgdGltZSB1cGRh
dGluZyB0aGUgU2xpbmcgRGF2RXgNCj4+IGJ1bmRsZSB0byB0aGlzIGxhdGVzdCByZWxlYXNlIC4u
Lg0KPg0KPiBXaGF0J3MgdGhlIGV4YWN0IHByb2JsZW0geW91J3JlIGhhdmluZz8NCj4NCj4gQlIs
DQo+DQo+IEp1a2thIFppdHRpbmc=

From dev-return-33901-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 00:20:42 2012
Return-Path: <dev-return-33901-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4417F92B0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 00:20:42 +0000 (UTC)
Received: (qmail 13896 invoked by uid 500); 25 Jan 2012 00:20:41 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 13797 invoked by uid 500); 25 Jan 2012 00:20:41 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 13790 invoked by uid 99); 25 Jan 2012 00:20:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:20:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of julian.reschke@gmx.de designates 213.165.64.23 as permitted sender)
Received: from [213.165.64.23] (HELO mailout-de.gmx.net) (213.165.64.23)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 25 Jan 2012 00:20:33 +0000
Received: (qmail invoked by alias); 25 Jan 2012 00:20:11 -0000
Received: from p5DCC2B6A.dip.t-dialin.net (EHLO [192.168.178.36]) [93.204.43.106]
  by mail.gmx.net (mp057) with SMTP; 25 Jan 2012 01:20:11 +0100
X-Authenticated: #1915285
X-Provags-ID: V01U2FsdGVkX19U8JsLFlJUkFpIQpJjmt5SFN+4FItDD7lM56+WOK
	2CGdMQoJ9ndEtI
Message-ID: <4F1F4AA9.8000105@gmx.de>
Date: Wed, 25 Jan 2012 01:19:53 +0100
From: Julian Reschke <julian.reschke@gmx.de>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
CC: Felix Meschberger <fmeschbe@adobe.com>
Subject: Re: Jackrabbit SPI export version
References: <b7oeuwvd686kiwqpsoubraos.1327449866784@email.android.com>
In-Reply-To: <b7oeuwvd686kiwqpsoubraos.1327449866784@email.android.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0

On 2012-01-25 01:04, Felix Meschberger wrote:
> Wanted to upgrade the Sling build to Jacktabbit 2.3.7 bundles .. Due to this incompatibility this is not possible without updating everything Jackrabbit to 2.3.7...
> Regards
> Felix
> ...

Which IMHO is exactly the right thing to do...

From dev-return-33902-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 00:38:33 2012
Return-Path: <dev-return-33902-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1D6BA9345
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 00:38:33 +0000 (UTC)
Received: (qmail 40789 invoked by uid 500); 25 Jan 2012 00:38:32 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 40664 invoked by uid 500); 25 Jan 2012 00:38:31 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 40652 invoked by uid 99); 25 Jan 2012 00:38:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:38:31 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.50 as permitted sender)
Received: from [74.125.82.50] (HELO mail-ww0-f50.google.com) (74.125.82.50)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 00:38:25 +0000
Received: by wgbdr11 with SMTP id dr11so4996268wgb.19
        for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 16:38:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=DnWBsUdU2v0ks0Dg4WnW8Q/JxDu9P/D2DISnco/fm5U=;
        b=VcDzfM5Sk5x+xGSBSSnVGgQ2EfW8CYjwtIs3XDvNXE/QZKcIBup6nbLYOcwup6O89T
         /89mcrgAaQHe36ZCbJulpiBciazUqeokoSrJnQmmxchXDIV722tGgmaRx0oyaMQYzGym
         Mwa7tcwSXsK5jX7L/V8RxLz+COC0yFirl/3gA=
Received: by 10.180.93.193 with SMTP id cw1mr24732855wib.5.1327451884085; Tue,
 24 Jan 2012 16:38:04 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Tue, 24 Jan 2012 16:37:44 -0800 (PST)
In-Reply-To: <CAB+dfikj9OYcpkGZrxM_e46tk1APv2FMkc1nfTJx_XiQX9-OFw@mail.gmail.com>
References: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
 <CAOFYJNa7Sza60WOv4iDm+aUYUhtTcP2K=C4-WCPRYThGq4QKqg@mail.gmail.com> <CAB+dfikj9OYcpkGZrxM_e46tk1APv2FMkc1nfTJx_XiQX9-OFw@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Wed, 25 Jan 2012 01:37:44 +0100
Message-ID: <CAOFYJNZqhn-5zCbGWq-Qyr8xZ3s+9tquwCELDZpk__2PVdPD9Q@mail.gmail.com>
Subject: Re: Jackrabbit SPI export version
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi,

On Wed, Jan 25, 2012 at 1:06 AM, Tobias Bocanegra <tripod@adobe.com> wrote:
> how about adding getSelectorJcrNames() and deprecate the other one?

Yes, we can do that. It just feels silly that we have to go through
hoops like that when AFAICT were the only ones using and implementing
this interface.

And (correct me if I'm wrong), isn't the OSGi framework supposed to be
able to deal with cases where for backwards compatibility reasons more
than one version of a package needs to be present?

I'd understand this desire better if the objection was about 1233468
(the actual API change) rather than 1227240 (the OSGi package version
update). Is there any actual client or implementation code that gets
broken by revision 1233468 but that I didn't already update? Why then
is revision 1227240 causing trouble?

BR,

Jukka Zitting

From dev-return-33903-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 07:53:56 2012
Return-Path: <dev-return-33903-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 99EFB9989
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 07:53:56 +0000 (UTC)
Received: (qmail 35260 invoked by uid 500); 25 Jan 2012 07:53:56 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 34872 invoked by uid 500); 25 Jan 2012 07:53:51 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 34830 invoked by uid 99); 25 Jan 2012 07:53:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 07:53:47 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.183 as permitted sender)
Received: from [64.18.1.183] (HELO exprod6og102.obsmtp.com) (64.18.1.183)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 25 Jan 2012 07:53:39 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob102.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTx+07ocafOsbXwQHb0MnPeJKB5Vsmn52@postini.com; Tue, 24 Jan 2012 23:53:18 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0IFdn2V013020
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 23:53:17 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0P7rGPl002319
	for <dev@jackrabbit.apache.org>; Tue, 24 Jan 2012 23:53:16 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 24 Jan 2012
 23:53:15 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Wed, 25 Jan 2012 07:53:14
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Wed, 25 Jan 2012 07:53:08 +0000
Subject: Re: Jackrabbit SPI export version
Thread-Topic: Jackrabbit SPI export version
Thread-Index: AczbNmP3CNrg2t/pSPOHDZj6hTXxLA==
Message-ID: <3BB11E47-27F0-422C-9959-1FDDF4539552@adobe.com>
References: <E4DC72C4-AECD-4F6B-B1F4-E7EABC6B7DB4@adobe.com>
 <CAOFYJNa7Sza60WOv4iDm+aUYUhtTcP2K=C4-WCPRYThGq4QKqg@mail.gmail.com>
 <CAB+dfikj9OYcpkGZrxM_e46tk1APv2FMkc1nfTJx_XiQX9-OFw@mail.gmail.com>
 <CAOFYJNZqhn-5zCbGWq-Qyr8xZ3s+9tquwCELDZpk__2PVdPD9Q@mail.gmail.com>
In-Reply-To: <CAOFYJNZqhn-5zCbGWq-Qyr8xZ3s+9tquwCELDZpk__2PVdPD9Q@mail.gmail.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

Am 25.01.2012 um 01:37 schrieb Jukka Zitting:

> Hi,
>=20
> On Wed, Jan 25, 2012 at 1:06 AM, Tobias Bocanegra <tripod@adobe.com> wrot=
e:
>> how about adding getSelectorJcrNames() and deprecate the other one?
>=20
> Yes, we can do that. It just feels silly that we have to go through
> hoops like that when AFAICT were the only ones using and implementing
> this interface.

True, but think about downstream deployers and secondary users like Sling.

But, hmm, hmm, hmm, I may have made a mistake .. updating the SPI, SPI Comm=
ons, WebDav, and JCR Commons bundles to 2.3.7 while still having had an old=
 DavEx build embedding JCR Server 2.3.4 (or another pre-2.3.7 version).

This bombed because the DavEx bundle imported spi at [2.4,3) thus precludin=
g to operate with SPI 2.3.7 exporting spi at 3.

>=20
> And (correct me if I'm wrong), isn't the OSGi framework supposed to be
> able to deal with cases where for backwards compatibility reasons more
> than one version of a package needs to be present?

You don't want to enter the arena of deploying the same bundle in different=
 versions. The framework perfectly knows how to deal with this. Our softwar=
e probably not ... Point is building a consistent class space where differe=
nt actors use the same classes.

>=20
> I'd understand this desire better if the objection was about 1233468
> (the actual API change) rather than 1227240 (the OSGi package version
> update). Is there any actual client or implementation code that gets
> broken by revision 1233468 but that I didn't already update? Why then
> is revision 1227240 causing trouble?

The export version changed caused the problem to be flagged. Given the API =
change, the version change was the right thing to do such that the issue co=
uld be flagged. I tried to make this clear in my follow-up.

Maybe the real problem is with the setup of the JCR Server library: we made=
 this a bundle without any exports but with a Declarative Services descript=
or for the added DavexServletService.

This requires me in Sling to embed the JCR Server library to implement some=
thing slightly different on-top of the JcrRemotingServlet.

Maybe we should export packages from the JCR Server library and modify the =
DavexServletService setup such that it is inoperable unless configuration i=
s provided (or support configuration to disable it). This would help me in =
Sling to my stuff based on JcrRemotingServlet and be less bound to Jackrabb=
it internal dependencies.

Nevertheless, I think that breaking backwards compatibility in exported pac=
kages should not have been done.

Regards
Felix

>=20
> BR,
>=20
> Jukka Zitting


From dev-return-33904-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 12:09:06 2012
Return-Path: <dev-return-33904-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9C0C49DBF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 12:09:06 +0000 (UTC)
Received: (qmail 36876 invoked by uid 500); 25 Jan 2012 12:09:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 36845 invoked by uid 500); 25 Jan 2012 12:09:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 36835 invoked by uid 99); 25 Jan 2012 12:09:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 12:09:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 12:09:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 5B42C1621E0
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 12:08:40 +0000 (UTC)
Date: Wed, 25 Jan 2012 12:08:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <261156514.76292.1327493320375.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <509444105.65025.1303148885765.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-2950) CachingEntryCollector ineffective if
 number of accessed policies exceeds cache size
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-2950?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13192995#comment-13192995 ] 

Julian Reschke commented on JCR-2950:
-------------------------------------

Should we try to make the cache work concurrently? See <http://stackoverflow.com/questions/221525/how-would-you-implement-an-lru-cache-in-java-6> which has a few suggestions.

Also, partitioning into a set of caches may be an option (<http://stackoverflow.com/a/613495>)
                
> CachingEntryCollector ineffective if number of accessed policies exceeds cache size
> -----------------------------------------------------------------------------------
>
>                 Key: JCR-2950
>                 URL: https://issues.apache.org/jira/browse/JCR-2950
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core, security
>    Affects Versions: 2.2.4
>         Environment: Repository with ACEs > 1000
>            Reporter: Honwai Wong
>            Assignee: angela
>
> The CachingEntryCollector's cache (LRUMap, max size: 1000) seems to become ineffective in case there are more than 1000 ACEs present in the repository. Since access to the cache is synchronized, many threads are basically blocked, waiting to get access to the cache.
> Java callstack:
> at org/apache/jackrabbit/core/security/authorization/acl/CachingEntryCollector.getEntries(CachingEntryCollector.java:99(Compiled Code))
> at org/apache/jackrabbit/core/security/authorization/acl/EntryCollector.collectEntries(EntryCollector.java:134(Compiled Code))
> at org/apache/jackrabbit/core/security/authorization/acl/CompiledPermissionsImpl.canRead(CompiledPermissionsImpl.java:250(Compiled Code))
> at org/apache/jackrabbit/core/security/DefaultAccessManager.canRead(DefaultAccessManager.java:251(Compiled Code))
> at org/apache/jackrabbit/core/ItemManager.canRead(ItemManager.java:426(Compiled Code))
> at org/apache/jackrabbit/core/ItemManager.createItemData(ItemManager.java(Compiled Code))
> at org/apache/jackrabbit/core/ItemManager.getItemData(ItemManager.java:379(Compiled Code))
> at org/apache/jackrabbit/core/ItemManager.itemExists(ItemManager.java:292(Compiled Code))
> at org/apache/jackrabbit/core/ItemManager.itemExists(ItemManager.java:464(Compiled Code))
> at org/apache/jackrabbit/core/session/SessionItemOperation$1.perform(SessionItemOperation.java:49(Compiled Code))
> at org/apache/jackrabbit/core/session/SessionItemOperation$1.perform(SessionItemOperation.java:46(Compiled Code))
> at org/apache/jackrabbit/core/session/SessionItemOperation.perform(SessionItemOperation.java:187(Compiled Code))
> at org/apache/jackrabbit/core/session/SessionState.perform(SessionState.java:200(Compiled Code))
> at org/apache/jackrabbit/core/SessionImpl.perform(SessionImpl.java:355(Compiled Code))
> at org/apache/jackrabbit/core/SessionImpl.itemExists(SessionImpl.java:751(Compiled Code))

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33905-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:11:09 2012
Return-Path: <dev-return-33905-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 35A5F96E3
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:11:09 +0000 (UTC)
Received: (qmail 73951 invoked by uid 500); 25 Jan 2012 13:11:09 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 73731 invoked by uid 500); 25 Jan 2012 13:11:08 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 73718 invoked by uid 99); 25 Jan 2012 13:11:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:11:08 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:11:05 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A3DCD162D08
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:10:43 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:10:43 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <606435583.76353.1327497043700.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-2638) Litmus locks test failures
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-2638?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13193008#comment-13193008 ] 

Julian Reschke commented on JCR-2638:
-------------------------------------

For the current trunk I get:

-> running `locks':
 0. init.................. pass
 1. begin................. pass
 2. options............... pass
 3. precond............... pass
 4. init_locks............ pass
 5. put................... pass
 6. lock_excl............. pass
 7. discover.............. pass
 8. refresh............... pass
 9. notowner_modify....... pass
10. notowner_lock......... pass
11. owner_modify.......... pass
12. notowner_modify....... pass
13. notowner_lock......... pass
14. copy.................. pass
15. cond_put.............. pass
16. fail_cond_put......... pass
17. cond_put_with_not..... pass
18. cond_put_corrupt_token pass
19. complex_cond_put...... pass
20. fail_complex_cond_put. pass
21. unlock................ pass
22. fail_cond_put_unlocked FAIL (conditional PUT with invalid lock-token should fail: 204 No Content)
23. lock_shared........... FAIL (LOCK on `/jackrabbit/repository/default/litmus/lockme': 412 Precondition Failed)
24. notowner_modify....... SKIPPED
25. notowner_lock......... SKIPPED
26. owner_modify.......... SKIPPED
27. double_sharedlock..... SKIPPED
28. notowner_modify....... SKIPPED
29. notowner_lock......... SKIPPED
30. unlock................ SKIPPED
31. prep_collection....... pass
32. lock_collection....... pass
33. owner_modify.......... pass
34. notowner_modify....... pass
35. refresh............... pass
36. indirect_refresh...... pass
37. unlock................ pass
38. unmapped_lock......... FAIL (LOCK on /jackrabbit/repository/default/litmus/lockcoll/ via /jackrabbit/repository/default/litmus/unmapped_url: 423 Locked)
39. unlock................ SKIPPED
40. finish................ pass
-> 8 tests were skipped.
<- summary for `locks': of 33 tests run: 30 passed, 3 failed. 90.9%



                
> Litmus locks test failures
> --------------------------
>
>                 Key: JCR-2638
>                 URL: https://issues.apache.org/jira/browse/JCR-2638
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, jackrabbit-webdav
>    Affects Versions: 2.1
>            Reporter: Jukka Zitting
>            Priority: Minor
>
> The locks part of the Litmus test suite contains a few warnings and failures when run against Jackrabbit:
> -> running `locks':
>  0. init.................. pass
>  1. begin................. pass
>  2. options............... pass
>  3. precond............... pass
>  4. init_locks............ pass
>  5. put................... pass
>  6. lock_excl............. pass
>  7. discover.............. pass
>  8. refresh............... pass
>  9. notowner_modify....... pass
> 10. notowner_lock......... [Fatal Error] :1:1: Content is not allowed in prolog.
> pass
> 11. owner_modify.......... pass
> 12. notowner_modify....... pass
> 13. notowner_lock......... [Fatal Error] :1:1: Content is not allowed in prolog.
> pass
> 14. copy.................. pass
> 15. cond_put.............. pass
> 16. fail_cond_put......... pass
> 17. cond_put_with_not..... pass
> 18. cond_put_corrupt_token WARNING: PUT failed with 412 not 423
>     ...................... pass (with 1 warning)
> 19. complex_cond_put...... pass
> 20. fail_complex_cond_put. pass
> 21. unlock................ [Fatal Error] :1:1: Content is not allowed in prolog.
> FAIL (UNLOCK on `/default/litmus/lockme': 400 Bad Request)
> 22. fail_cond_put_unlocked pass
> 23. lock_shared........... FAIL (LOCK on `/default/litmus/lockme': 412 Precondition Failed)
> 24. notowner_modify....... SKIPPED
> 25. notowner_lock......... SKIPPED
> 26. owner_modify.......... SKIPPED
> 27. double_sharedlock..... SKIPPED
> 28. notowner_modify....... SKIPPED
> 29. notowner_lock......... SKIPPED
> 30. unlock................ SKIPPED
> 31. prep_collection....... pass
> 32. lock_collection....... pass
> 33. owner_modify.......... pass
> 34. notowner_modify....... pass
> 35. refresh............... pass
> 36. indirect_refresh...... pass
> 37. unlock................ pass
> 38. unmapped_lock......... WARNING: LOCK on unmapped url returned 200 not 201 (RFC4918:S7.3)
>     ...................... pass (with 1 warning)
> 39. unlock................ FAIL (UNLOCK on `/default/litmus/unmapped_url': 412 Precondition Failed)
> 40. finish................ pass
> -> 7 tests were skipped.
> <- summary for `locks': of 34 tests run: 31 passed, 3 failed. 91.2%
> -> 2 warnings were issued.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33906-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:15:06 2012
Return-Path: <dev-return-33906-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E143597AB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:15:06 +0000 (UTC)
Received: (qmail 78703 invoked by uid 500); 25 Jan 2012 13:15:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 78655 invoked by uid 500); 25 Jan 2012 13:15:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 78648 invoked by uid 99); 25 Jan 2012 13:15:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:15:05 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:15:04 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id BBC05162ED9
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:14:44 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:14:44 +0000 (UTC)
From: "Jukka Zitting (Closed) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <742155564.76360.1327497284770.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Closed] (JCR-2541) spi2dav : EventJournal not  implemented
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-2541?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting closed JCR-2541.
------------------------------

    
> spi2dav : EventJournal not  implemented
> ---------------------------------------
>
>                 Key: JCR-2541
>                 URL: https://issues.apache.org/jira/browse/JCR-2541
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, JCR 2.0, observation
>    Affects Versions: 2.0
>            Reporter: angela
>            Assignee: Julian Reschke
>             Fix For: 2.3.6
>
>         Attachments: 2541.diff, JCR-2541.diff
>
>
> i didn't look at the details just realized that all EventJournalTest of the TCK fail in the setup
> jcr2spi - spi2dav(ex) - jcr-server.
> i assume that this is due to missing implementation (the corresponding SPI method throws UnsupportedRepositoryOperationException).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33907-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:19:02 2012
Return-Path: <dev-return-33907-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AF1DB98E2
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:19:02 +0000 (UTC)
Received: (qmail 87112 invoked by uid 500); 25 Jan 2012 13:19:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 86919 invoked by uid 500); 25 Jan 2012 13:19:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 86893 invoked by uid 99); 25 Jan 2012 13:19:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:19:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:19:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 248061621EA
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:18:40 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:18:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1666051874.76391.1327497520151.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <288998045.66761.1327326880819.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3216) When fetching node ids in checks for
 the checker all queries should use the same ordering
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3216?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3216:
-------------------------------

    Fix Version/s:     (was: 2.5)
    
> When fetching node ids in checks for the checker all queries should use the same ordering
> -----------------------------------------------------------------------------------------
>
>                 Key: JCR-3216
>                 URL: https://issues.apache.org/jira/browse/JCR-3216
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>            Reporter: Bart van der Schans
>            Assignee: Bart van der Schans
>            Priority: Minor
>             Fix For: 2.4
>
>
> The "bundleSelectAllIdsSQL" query and the "bundleSelectAllIdsFromSQL" should use the same ordering.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33908-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:23:05 2012
Return-Path: <dev-return-33908-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 13BC79A0A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:23:05 +0000 (UTC)
Received: (qmail 98513 invoked by uid 500); 25 Jan 2012 13:23:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 98451 invoked by uid 500); 25 Jan 2012 13:23:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 98444 invoked by uid 99); 25 Jan 2012 13:23:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:23:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:23:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 5C9691623C6
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:22:40 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:22:40 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <58959929.76406.1327497760380.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-406) If header evaluation compliance problems
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-406?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-406:
-------------------------------

    Component/s: jackrabbit-jcr-server
    
> If header evaluation compliance problems
> ----------------------------------------
>
>                 Key: JCR-406
>                 URL: https://issues.apache.org/jira/browse/JCR-406
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, jackrabbit-webdav
>            Reporter: Julian Reschke
>         Attachments: JCR-406.patch
>
>
> There is a problem with the implementation of If header checking in WebdavRequestImpl.matchesIfHeader(), causing warnings and errors in the Litmus test suite, notably test cases cond_put_corrupt_token and fail_cond_put_unlocked.
> The main cause seems to be the assumption that evaluation of the If header isn't necessary if the resource isn't locked. That's incorrect, because If header evaluation should occur independently of the state of the resource (even if it doesn't exist). In particular, for a state token known not to represent the current state of the resource, such as "DAV:not-a-lock", the If header
>   If: (<DAV:not-a-lock>)
>   
> should evaluate to false (causing the request to fail with status 412), and consequently,
>   If: (<x>) (Not <DAV:not-a-lock>)
>   
> should always avaluate to true (for any x), because there is one untagged list production evaluating to true; thus the request should proceed.
> In RFC2518bis, the WebDAV WG has tried to clarify If header evaluation, see (<http://greenbytes.de/tech/webdav/draft-ietf-webdav-rfc2518bis-14.html#rfc.section.10.4>).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33909-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:43:13 2012
Return-Path: <dev-return-33909-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 101919ADB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:43:13 +0000 (UTC)
Received: (qmail 47547 invoked by uid 500); 25 Jan 2012 13:43:12 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 47350 invoked by uid 500); 25 Jan 2012 13:43:11 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 47335 invoked by uid 99); 25 Jan 2012 13:43:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:43:11 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:43:10 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 6446B162D9A
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:42:50 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:42:50 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2143241303.76472.1327498970432.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3209:
-------------------------------

    Issue Type: Improvement  (was: Task)

Do we want to include this already in 2.4? Seems like a relatively low-risk change so we could still backport this before the 2.4.0 release gets cut.
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>         Attachments: JCR-3209.diff
>
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33910-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:45:10 2012
Return-Path: <dev-return-33910-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3D4AE9B44
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:45:10 +0000 (UTC)
Received: (qmail 52733 invoked by uid 500); 25 Jan 2012 13:45:09 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52684 invoked by uid 500); 25 Jan 2012 13:45:09 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 52677 invoked by uid 99); 25 Jan 2012 13:45:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:45:09 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:45:08 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 5CBF9162EB2
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:44:43 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:44:43 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <595147401.76476.1327499087174.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <587708642.71076.1327394800429.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3218) UserImporter should trigger execution
 AuthorizableActions in case of user/group creation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3218?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3218:
-------------------------------

    Fix Version/s:     (was: 2.3.7)
                   2.4

Merged to the 2.4 branch in revision 1235741.
                
> UserImporter should trigger execution AuthorizableActions in case of user/group creation
> ----------------------------------------------------------------------------------------
>
>                 Key: JCR-3218
>                 URL: https://issues.apache.org/jira/browse/JCR-3218
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core, security
>            Reporter: angela
>            Assignee: angela
>             Fix For: 2.4
>
>
> in accordance to the new implementation specific extensions made to user mangement in JCR-3118 the user-importer
> should be adjusted as well.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33911-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:47:06 2012
Return-Path: <dev-return-33911-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E77139C00
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:47:05 +0000 (UTC)
Received: (qmail 58641 invoked by uid 500); 25 Jan 2012 13:47:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 58581 invoked by uid 500); 25 Jan 2012 13:47:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 58574 invoked by uid 99); 25 Jan 2012 13:47:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:47:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:47:04 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 431D6162FAC
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:46:41 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:46:41 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1177821386.76485.1327499202914.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <628686453.72547.1327427445340.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3220) simple webdav server does not support
 lock timeouts
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3220?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3220:
-------------------------------

    Affects Version/s: 2.3.7
        Fix Version/s:     (was: 2.6)
                       2.4

Merged to the 2.4 branch in revision 1235743.
                
> simple webdav server does not support lock timeouts
> ---------------------------------------------------
>
>                 Key: JCR-3220
>                 URL: https://issues.apache.org/jira/browse/JCR-3220
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>    Affects Versions: 2.3.7
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>             Fix For: 2.4
>
>
> The "simple" WebDAV server still does not support lock timeouts (HTTP trace shows MS word requests 3600s timeout but gets infinity).

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33912-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:51:04 2012
Return-Path: <dev-return-33912-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D2A819CCE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:51:04 +0000 (UTC)
Received: (qmail 64525 invoked by uid 500); 25 Jan 2012 13:51:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 64455 invoked by uid 500); 25 Jan 2012 13:51:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 64445 invoked by uid 99); 25 Jan 2012 13:51:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:51:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:51:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 6239E162167
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:50:40 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:50:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <387748504.76489.1327499440421.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <758521340.60049.1327069841119.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3214) [Lock] weird number for "infinite"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3214?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3214:
-------------------------------

    Fix Version/s:     (was: 2.6)
                   2.4

Merged to the 2.4 branch in revision 1235746.
                
> [Lock] weird number for "infinite"
> ----------------------------------
>
>                 Key: JCR-3214
>                 URL: https://issues.apache.org/jira/browse/JCR-3214
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-jcr-server, locks
>            Reporter: David Buchmann
>            Assignee: Julian Reschke
>             Fix For: 2.4
>
>
> (this is a follow-up of JCR-3205)
> i am surprised by the davex reply to a lock request with infinite timeout (before and after the fix from JCR-3205):
> <D:timeout>Second-2147483</D:timeout>
> this number is
> 2^21+50331
> which seems pretty random to me. coincidally, this number is exactly 2^31 - 1 (2147483647) without the last 3 digits. can it be that there are some weird string operations happening on server side?

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33913-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 13:57:05 2012
Return-Path: <dev-return-33913-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F18E9D55
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 13:57:05 +0000 (UTC)
Received: (qmail 68960 invoked by uid 500); 25 Jan 2012 13:57:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 68878 invoked by uid 500); 25 Jan 2012 13:57:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 68867 invoked by uid 99); 25 Jan 2012 13:57:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:57:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 13:57:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9BA8E162417
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 13:56:40 +0000 (UTC)
Date: Wed, 25 Jan 2012 13:56:40 +0000 (UTC)
From: "Julian Reschke (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1293048354.76497.1327499800652.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <806517552.44732.1326722200790.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3209) lock token validity
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3209?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13193048#comment-13193048 ] 

Julian Reschke commented on JCR-3209:
-------------------------------------

it's both low-risk and low-prio, so it might be something that can wait...
                
> lock token validity
> -------------------
>
>                 Key: JCR-3209
>                 URL: https://issues.apache.org/jira/browse/JCR-3209
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav, locks
>            Reporter: Julian Reschke
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.6
>
>         Attachments: JCR-3209.diff
>
>
> There are several minor issues in the mapping between JCR lock tokens and WebDAV lock tokens:
> 1) WebDAV lock tokens are supposed to use URI syntax (such as opaquelocktoken: or urn:uuid:)
> 2) The server currently computes lock tokens for session-scoped locks based on the node id; these are not valid JCR lock tokens though and cause exceptions when they are re-added when they appear in a Lock-Token header or an If header. This will likely cause requests to fail that use both types of locks (yes, maybe academic but should be fixed anyway)
> Proposal:
> a) Map lock tokens to oqaquelocktoken URIs, using a constant UUID plus a postfix encoding the original lock token
> b) Use a syntax that allows to distinguish between tokens for open-scoped locks or session-scoped locks, so that we do not try to add the latter type to the Session (alternatively, handle exceptions doing so gracefully)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33914-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 14:23:06 2012
Return-Path: <dev-return-33914-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 64D03966A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 14:23:06 +0000 (UTC)
Received: (qmail 1327 invoked by uid 500); 25 Jan 2012 14:23:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 1121 invoked by uid 500); 25 Jan 2012 14:23:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 1107 invoked by uid 99); 25 Jan 2012 14:23:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 14:23:05 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 14:23:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CB81A162F6F
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 14:22:41 +0000 (UTC)
Date: Wed, 25 Jan 2012 14:22:41 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <524125069.76527.1327501361835.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1036526867.30552.1321357251750.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3148) Using transactions still leads to
 memory leak
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3148?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3148:
-------------------------------

    Fix Version/s: 2.2.11

Merged to the 2.2 branch in revision 1235755.
               =20
> Using transactions still leads to memory leak
> ---------------------------------------------
>
>                 Key: JCR-3148
>                 URL: https://issues.apache.org/jira/browse/JCR-3148
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: transactions
>    Affects Versions: 2.2.5
>            Reporter: Boris Pruessmann
>            Assignee: Claus K=C3=B6ll
>             Fix For: 2.2.11, 2.3.4
>
>         Attachments: XASessionImpl.patch
>
>
> This is a result of the way that JCR-395 was fixed. If you look at the co=
de, you'll see that txGlobal.remove(xid) is called as the last statement in=
 both XASessionImpl.commit() and XASessionImpl.rollback(). However, in both=
 methods an exception could be thrown either as a result of calling tx.comm=
it() (or tx.prepare()) and tx.rollback().=20
> As a result, the transaction will not be removed from txGlobals whenever =
the commit or the rollback has failed for any reason. My suggestion would b=
e to move the txGlobal.remove(xid) into a finally block.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33915-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 14:31:03 2012
Return-Path: <dev-return-33915-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0AB4A91A9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 14:31:02 +0000 (UTC)
Received: (qmail 11753 invoked by uid 500); 25 Jan 2012 14:31:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 11694 invoked by uid 500); 25 Jan 2012 14:31:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 11686 invoked by uid 99); 25 Jan 2012 14:31:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 14:31:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 14:31:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id B923D1623FF
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 14:30:40 +0000 (UTC)
Date: Wed, 25 Jan 2012 14:30:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2069900372.76562.1327501840772.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1147037872.35257.1322843860000.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3167) Make Jackrabbit compile on Java 7
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3167?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3167:
-------------------------------

    Fix Version/s: 2.2.11

Merged to the 2.2 branch in revision 1235761.
                
> Make Jackrabbit compile on Java 7
> ---------------------------------
>
>                 Key: JCR-3167
>                 URL: https://issues.apache.org/jira/browse/JCR-3167
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-core
>            Reporter: Jukka Zitting
>            Assignee: Jukka Zitting
>            Priority: Minor
>             Fix For: 2.2.11, 2.3.5
>
>
> Compiling on Java 7 fails with the following error:
>     jackrabbit-core/src/main/java/org/apache/jackrabbit/core/util/db/DataSourceWrapper.java:[30,7] error:
>     DataSourceWrapper is not abstract and does not override abstract method getParentLogger() in CommonDataSource
> We should fix that.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33916-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 14:53:05 2012
Return-Path: <dev-return-33916-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 501949831
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 14:53:05 +0000 (UTC)
Received: (qmail 45732 invoked by uid 500); 25 Jan 2012 14:53:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 45535 invoked by uid 500); 25 Jan 2012 14:53:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 45448 invoked by uid 99); 25 Jan 2012 14:53:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 14:53:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 14:53:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 03C1A162DF5
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 14:52:41 +0000 (UTC)
Date: Wed, 25 Jan 2012 14:52:41 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1820545627.76609.1327503161016.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1882701158.62880.1323631720035.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3174) Destination URI should be normalized
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3174?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3174:
-------------------------------

    Affects Version/s: 2.2.10
        Fix Version/s: 2.2.11

Merged to the 2.2 branch in revision 1235779.
                
> Destination URI should be normalized
> ------------------------------------
>
>                 Key: JCR-3174
>                 URL: https://issues.apache.org/jira/browse/JCR-3174
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-webdav
>    Affects Versions: 2.2.10, 2.3.6
>         Environment: Not applicable
>            Reporter: Javier Godoy
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.2.11, 2.3.6
>
>   Original Estimate: 10m
>  Remaining Estimate: 10m
>
> WebdavRequestImpl.getHrefLocator tests if the URI passed as parameter starts with the context path, and passes the next segments to the locator factory.
>  
> There is a potential hole if the parameter contains "..", because "http://example.com/dav/../foo" starts with the context path "http://example.com/dav" but represents to "http://example.com/foo". Currently, it is up to the locator factory to detect this situation, meaning that every locator factory should implement this check. Additionally, DavLocatorFactory.createResourceLocator cannot throw exceptions, hence it would not fail cleanly (RuntimeException causing a 500 INTERNAL SERVER ERROR response, when a 403 FORBIDDEN status code would have been apropriate)
> Note that the Request-URI should have already been normalized by the servlet container, but in COPY/MOVE operations, the Destination-URI is not normalized.
> Conformant clients MUST NOT use dot-segments ("." or "..")  [RFC 4918, Section 8.3] in Simple-Ref constructions such as the Destination header [RFC 4918, Section 10.3]), but the server should be able to detect this error.
> Proposed change in WebdavRequestImpl:193 (in package org.apache.jackrabbit.webdav from webdav/java)
> - ref = uri.getRawPath();
> + ref = uri.normalize().getRawPath();
> (This causes /dav/../foo to be rejected because it doesn't start with the context path, and accepts dav/foo/../bar because it starts with the context path)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33917-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 15:05:07 2012
Return-Path: <dev-return-33917-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CE27C9F20
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 15:05:07 +0000 (UTC)
Received: (qmail 82456 invoked by uid 500); 25 Jan 2012 15:05:07 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 82063 invoked by uid 500); 25 Jan 2012 15:05:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 81995 invoked by uid 99); 25 Jan 2012 15:05:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 15:05:05 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 15:05:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D1F361625CC
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 15:04:41 +0000 (UTC)
Date: Wed, 25 Jan 2012 15:04:41 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1850688418.76676.1327503881861.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1204560441.746.1323677431191.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3175) InputContextImpl: cannot upload file
 larger than 2GB
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3175?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3175:
-------------------------------

    Affects Version/s:     (was: 2.4)
                       2.2.10
                       2.3.5
        Fix Version/s: 2.2.11

Merged to the 2.2 branch in revision 1235791.
                
> InputContextImpl: cannot upload file larger than 2GB
> ----------------------------------------------------
>
>                 Key: JCR-3175
>                 URL: https://issues.apache.org/jira/browse/JCR-3175
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-webdav
>    Affects Versions: 2.2.10, 2.3.5
>         Environment: Not applicable
>            Reporter: Javier Godoy
>            Assignee: Julian Reschke
>            Priority: Minor
>             Fix For: 2.2.11, 2.3.6
>
>         Attachments: patch
>
>   Original Estimate: 10m
>  Remaining Estimate: 10m
>
> If an entity is larger than 2GB, the Content-Length cannot be obtained by using getIntHeader because of integer overflow. One needs to parse the value of the header from string to long. This issue affects InputContextImpl.getContentLength() in org.apache.jackrabbit.webdav.io from webdav/java (the current behavior is that the header is converted from string to int by the servlet API, then from int to long by Jackrabbit)
> Testcase: largefile from Litmus. (test 3 - large_put fails when the PUT request is received)

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33918-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 15:15:02 2012
Return-Path: <dev-return-33918-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9F6B291E1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 15:15:02 +0000 (UTC)
Received: (qmail 6541 invoked by uid 500); 25 Jan 2012 15:15:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 6482 invoked by uid 500); 25 Jan 2012 15:15:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 6468 invoked by uid 99); 25 Jan 2012 15:15:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 15:15:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 15:15:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 5744F162A4D
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 15:14:40 +0000 (UTC)
Date: Wed, 25 Jan 2012 15:14:40 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <219643208.76721.1327504480359.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1883485972.45339.1326736539556.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3210) NPE in spi2dav when server does not
 send all headers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3210?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3210:
-------------------------------

    Affects Version/s:     (was: 2.3.5)
                       2.2.10
                       2.3.6
        Fix Version/s: 2.2.11

Merged to the 2.2 branch in revision 1235796.
                
> NPE in spi2dav when server does not send all headers
> ----------------------------------------------------
>
>                 Key: JCR-3210
>                 URL: https://issues.apache.org/jira/browse/JCR-3210
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-spi2dav
>    Affects Versions: 2.2.10, 2.3.6
>            Reporter: Tobias Bocanegra
>            Assignee: Tobias Bocanegra
>            Priority: Minor
>             Fix For: 2.2.11, 2.3.7
>
>
> The ValueLoader may throw a NPE if the desired headers are not present in the response:
> org.apache.jackrabbit.spi2davex.ValueLoader:
>     public Map<String, String> loadHeaders(String uri, String[] headerNames) throws IOException, RepositoryException {
>     ....
>                 for (String name : headerNames) {
> --->                headers.put(name, method.getResponseHeader(name).getValue());
>                 }
>     .....
>     }
> In my case, the server does not return the ETag response header, but the 'loadHeaders' is indirectly called by the QValueFactoryImpl:
>                         this.preInitialize(new String[] {HEADER_ETAG, HEADER_LAST_MODIFIED});

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33919-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 16:11:20 2012
Return-Path: <dev-return-33919-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 66B819989
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 16:11:20 +0000 (UTC)
Received: (qmail 6559 invoked by uid 500); 25 Jan 2012 16:11:20 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 6445 invoked by uid 500); 25 Jan 2012 16:11:19 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 6438 invoked by uid 99); 25 Jan 2012 16:11:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:11:19 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:11:17 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 2C263C010B
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 16:10:57 +0000 (UTC)
Date: Wed, 25 Jan 2012 16:10:57 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <653342059.7861327507857178.JavaMail.hudson@aegis>
Subject: Build failed in Jenkins: Jackrabbit-2.2 #57
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: Jackrabbit-2.2
X-Jenkins-Result: FAILURE

See <https://builds.apache.org/job/Jackrabbit-2.2/57/changes>

Changes:

[jukka] 2.2: Merged revision 1232100 (JCR-3210)

[jukka] 2.2: Merged revision 1213276 (JCR-3175)

[jukka] 2.2: Merged revision 1213289 (JCR-3174)

[jukka] 2.2: Merged revision 1209581 (JCR-3167)

[jukka] 2.2: Merged revision 1202144 (JCR-3148)

------------------------------------------
[...truncated 115 lines...]
There are no tests to run.

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[TASKS] Skipping maven reporter: there is already a result available.
[JENKINS] Recording test results[INFO] [bundle:bundle {execution: default-bundle}]

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [apache-rat:check {execution: default}]
[INFO] Exclude: .checkstyle

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [install:install {execution: default-install}]
[INFO] Installing <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/target/jackrabbit-api-2.2.11-SNAPSHOT.jar> to /home/jenkins/.m2/repository/org/apache/jackrabbit/jackrabbit-api/2.2.11-SNAPSHOT/jackrabbit-api-2.2.11-SNAPSHOT.jar

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [bundle:install {execution: default-install}]
[INFO] Parsing file:/home/jenkins/.m2/repository/repository.xml

[INFO] Installing org/apache/jackrabbit/jackrabbit-api/2.2.11-SNAPSHOT/jackrabbit-api-2.2.11-SNAPSHOT.jar
[INFO] Writing OBR metadata
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [deploy:deploy {execution: default-deploy}]
[INFO] Retrieving previous build number from apache.snapshots.https

Uploading: https://repository.apache.org/content/repositories/snapshots/org/apache/jackrabbit/jackrabbit-api/2.2.11-SNAPSHOT/jackrabbit-api-2.2.11-20120125.160930-3.jar
23K uploaded  (jackrabbit-api-2.2.11-20120125.160930-3.jar)
[INFO] Uploading project information for jackrabbit-api 2.2.11-20120125.160930-3
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'snapshot org.apache.jackrabbit:jackrabbit-api:2.2.11-SNAPSHOT'
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'artifact org.apache.jackrabbit:jackrabbit-api'
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [bundle:deploy {execution: default-deploy}]
[INFO] Remote OBR update disabled (enable with -DremoteOBR)

[TASKS] Skipping maven reporter: there is already a result available.
[JENKINS] Archiving disabled - not archiving <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/pom.xml>
[JENKINS] Archiving disabled - not archiving <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/target/jackrabbit-api-2.2.11-SNAPSHOT.jar>
[INFO] ------------------------------------------------------------------------
[INFO] Building Jackrabbit JCR Commons
[INFO]    task-segment: [clean, deploy]
[INFO] ------------------------------------------------------------------------
[INFO] [clean:clean {execution: default-clean}]
[INFO] Deleting file set: <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target> (included: [**], excluded: [])
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/main/java'> for tasks ... 
[TASKS] Found 6.
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/test/java'> for tasks ... 
[TASKS] Found 5.
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/main/resources'> for tasks ... 
[TASKS] Found 0.
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/test/resources'...>
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[INFO] [remote-resources:process {execution: default}]
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [resources:resources {execution: default-resources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] Copying 3 resources

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [compiler:compile {execution: default-compile}]

[INFO] Compiling 123 source files to <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/classes>
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [resources:testResources {execution: default-testResources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/test/resources>
[INFO] Copying 3 resources

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [compiler:testCompile {execution: default-testCompile}]
[INFO] Compiling 17 source files to <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/test-classes>

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [surefire:test {execution: default-test}]
[INFO] Surefire report directory: <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/surefire-reports>


-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.jackrabbit.util.ISO9075Test
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.039 sec
Running org.apache.jackrabbit.util.Base64Test
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.968 sec
Running org.apache.jackrabbit.util.TimerTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 9.011 sec
Running org.apache.jackrabbit.commons.JcrUtilsTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.136 sec
Running org.apache.jackrabbit.commons.xml.ToXmlContentHandlerTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec
Running org.apache.jackrabbit.commons.AbstractRepositoryTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec
Running org.apache.jackrabbit.commons.json.TestAll
Tests run: 21, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.026 sec
Running org.apache.jackrabbit.commons.xml.SerializingContentHandlerTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.019 sec
Running org.apache.jackrabbit.commons.flat.RankTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 20.736 sec
Running org.apache.jackrabbit.commons.json.JsonUtilTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec
Running org.apache.jackrabbit.commons.xml.ParsingContentHandlerTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.025 sec
Running org.apache.jackrabbit.commons.iterator.FilteredRangeIteratorTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec
Running org.apache.jackrabbit.util.TextTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 sec
Running org.apache.jackrabbit.commons.json.JsonParserTest
Tests run: 20, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec
Running org.apache.jackrabbit.value.BinaryValueTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec
Running org.apache.jackrabbit.commons.xml.XmlnsContentHandlerTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 sec

Results :

Tests run: 88, Failures: 0, Errors: 0, Skipped: 0

[TASKS] Skipping maven reporter: there is already a result available.
[JENKINS] Recording test results
[INFO] [bundle:bundle {execution: default-bundle}]
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [apache-rat:check {execution: default}]
[INFO] Exclude: release.properties

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [install:install {execution: default-install}]
[INFO] Installing <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/jackrabbit-jcr-commons-2.2.11-SNAPSHOT.jar> to /home/jenkins/.m2/repository/org/apache/jackrabbit/jackrabbit-jcr-commons/2.2.11-SNAPSHOT/jackrabbit-jcr-commons-2.2.11-SNAPSHOT.jar

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [bundle:install {execution: default-install}]
[INFO] Parsing file:/home/jenkins/.m2/repository/repository.xml

[INFO] Installing org/apache/jackrabbit/jackrabbit-jcr-commons/2.2.11-SNAPSHOT/jackrabbit-jcr-commons-2.2.11-SNAPSHOT.jar
[INFO] Writing OBR metadata
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [deploy:deploy {execution: default-deploy}]
[INFO] Retrieving previous build number from apache.snapshots.https

Uploading: https://repository.apache.org/content/repositories/snapshots/org/apache/jackrabbit/jackrabbit-jcr-commons/2.2.11-SNAPSHOT/jackrabbit-jcr-commons-2.2.11-20120125.160930-3.jar
280K uploaded  (jackrabbit-jcr-commons-2.2.11-20120125.160930-3.jar)
[INFO] Uploading project information for jackrabbit-jcr-commons 2.2.11-20120125.160930-3
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'artifact org.apache.jackrabbit:jackrabbit-jcr-commons'
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'snapshot org.apache.jackrabbit:jackrabbit-jcr-commons:2.2.11-SNAPSHOT'
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [bundle:deploy {execution: default-deploy}]
[INFO] Remote OBR update disabled (enable with -DremoteOBR)

[TASKS] Skipping maven reporter: there is already a result available.
[JENKINS] Archiving disabled - not archiving <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/pom.xml>
[JENKINS] Archiving disabled - not archiving <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/jackrabbit-jcr-commons-2.2.11-SNAPSHOT.jar>
[INFO] ------------------------------------------------------------------------
[INFO] Building Jackrabbit JCR Tests
[INFO]    task-segment: [clean, deploy]
[INFO] ------------------------------------------------------------------------
[INFO] [clean:clean {execution: default-clean}]
[INFO] Deleting file set: <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/target> (included: [**], excluded: [])
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/src/main/java'> for tasks ... 
[TASKS] Found 38.
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/src/test/java'...>
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/src/main/resources'> for tasks ... 
[TASKS] Found 0.
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/src/test/resources'...>
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[INFO] [remote-resources:process {execution: default}]
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [resources:resources {execution: default-resources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 31 resources

[INFO] Copying 3 resources
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [compiler:compile {execution: default-compile}]

[INFO] Compiling 314 source files to <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/target/classes>
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [resources:testResources {execution: default-testResources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/src/test/resources>
[INFO] Copying 3 resources

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [compiler:testCompile {execution: default-testCompile}]
[INFO] No sources to compile

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [surefire:test {execution: default-test}]
[INFO] Surefire report directory: <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-tests/target/surefire-reports>

Jan 25, 2012 4:10:54 PM hudson.remoting.Channel$ReaderThread run
SEVERE: I/O error in channel channel
java.io.StreamCorruptedException
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1332)
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:348)
	at hudson.remoting.Channel$ReaderThread.run(Channel.java:1109)
killed.
channel stopped
[INFO] ------------------------------------------------------------------------
[ERROR] FATAL ERROR
[INFO] ------------------------------------------------------------------------
[INFO] null
[INFO] ------------------------------------------------------------------------
[INFO] Trace
java.lang.reflect.UndeclaredThrowableException
	at $Proxy2.isArchivingDisabled(Unknown Source)
	at hudson.maven.MavenBuildProxy$Filter.isArchivingDisabled(MavenBuildProxy.java:227)
	at hudson.maven.reporters.MavenArtifact.archive(MavenArtifact.java:216)
	at hudson.maven.reporters.MavenArtifactArchiver.postBuild(MavenArtifactArchiver.java:106)
	at hudson.maven.Maven2Builder.postModule(Maven2Builder.java:127)
	at hudson.maven.MavenBuilder$Adapter.fireLeaveModule(MavenBuilder.java:327)
	at hudson.maven.MavenBuilder$Adapter.postBuild(MavenBuilder.java:285)
	at org.apache.maven.lifecycle.LifecycleExecutorInterceptor.execute(LifecycleExecutorInterceptor.java:68)
	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:328)
	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:138)
	at org.apache.maven.cli.MavenCli.main(MavenCli.java:362)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:592)
	at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
	at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
	at hudson.maven.agent.Main.launch(Main.java:185)
	at hudson.maven.MavenBuilder.call(MavenBuilder.java:151)
	at hudson.maven.Maven2Builder.call(Maven2Builder.java:77)
	at hudson.maven.Maven2Builder.call(Maven2Builder.java:53)
	at hudson.remoting.UserRequest.perform(UserRequest.java:118)
	at hudson.remoting.UserRequest.perform(UserRequest.java:48)
	at hudson.remoting.Request$2.run(Request.java:287)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:417)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)
	at java.util.concurrent.FutureTask.run(FutureTask.java:123)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:651)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:676)
	at java.lang.Thread.run(Thread.java:595)
Caused by: hudson.remoting.ChannelClosedException: channel is already closed
	at hudson.remoting.Channel.send(Channel.java:499)
	at hudson.remoting.Request.call(Request.java:110)
	at hudson.remoting.Channel.call(Channel.java:681)
	at hudson.remoting.RemoteInvocationHandler.invoke(RemoteInvocationHandler.java:158)
	... 30 more
Caused by: java.io.StreamCorruptedException
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1332)
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:348)
	at hudson.remoting.Channel$ReaderThread.run(Channel.java:1109)
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1 minute 46 seconds
[INFO] Finished at: Wed Jan 25 16:10:54 UTC 2012
[INFO] Final Memory: 49M/321M
[INFO] ------------------------------------------------------------------------
[TASKS] Aggregating results of Jackrabbit Parent POM
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[TASKS] Aggregating results of Apache Jackrabbit API
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[TASKS] Aggregating results of Jackrabbit JCR Commons
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[locks-and-latches] Releasing all the locks
[locks-and-latches] All the locks released
ERROR: Maven JVM terminated unexpectedly with exit code 0



From dev-return-33920-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 16:14:21 2012
Return-Path: <dev-return-33920-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B11C99B9C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 16:14:21 +0000 (UTC)
Received: (qmail 12505 invoked by uid 500); 25 Jan 2012 16:14:21 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 12449 invoked by uid 500); 25 Jan 2012 16:14:20 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 12442 invoked by uid 99); 25 Jan 2012 16:14:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:14:20 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:14:14 +0000
Received: by werm1 with SMTP id m1so5807067wer.1
        for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 08:13:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=5W2NJTGf4eSAjDSx63w2ZJdU66CluzLlIT3mpcGdUgI=;
        b=GKd42kWGyo0ZWhBtA/Skyy3jlDhEQAhITr3ba7KceA0fSp4f++ObGK7fKgg8gHrpUq
         hf3eu5Z7qa4q4+0G4pvChBIN8RphEvepgDwpK9f5aoQOdrjRYaU2Phj39F7W/E5hDR01
         pemMTcVWBicdbpjXizPzLRrvb9uvqi2LvSaMI=
Received: by 10.216.134.149 with SMTP id s21mr7664252wei.41.1327508033125;
 Wed, 25 Jan 2012 08:13:53 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.97.67 with HTTP; Wed, 25 Jan 2012 08:13:32 -0800 (PST)
In-Reply-To: <653342059.7861327507857178.JavaMail.hudson@aegis>
References: <653342059.7861327507857178.JavaMail.hudson@aegis>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Wed, 25 Jan 2012 17:13:32 +0100
Message-ID: <CAOFYJNaBfY=kopD8B4az0UtND=ToqEUrB6gOsjQtt_NZB5x4SA@mail.gmail.com>
Subject: Re: Build failed in Jenkins: Jackrabbit-2.2 #57
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

On Wed, Jan 25, 2012 at 5:10 PM, Apache Jenkins Server
<jenkins@builds.apache.org> wrote:
> Jan 25, 2012 4:10:54 PM hudson.remoting.Channel$ReaderThread run
> SEVERE: I/O error in channel channel
> java.io.StreamCorruptedException
> =A0 =A0 =A0 =A0at java.io.ObjectInputStream.readObject0(ObjectInputStream=
.java:1332)
> =A0 =A0 =A0 =A0at java.io.ObjectInputStream.readObject(ObjectInputStream.=
java:348)
> =A0 =A0 =A0 =A0at hudson.remoting.Channel$ReaderThread.run(Channel.java:1=
109)
> killed.
> channel stopped

Trouble again with Apache's Jenkins server. I'll look at alternative
locations for running our CI builds.

BR,

Jukka Zitting

From dev-return-33921-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 16:40:49 2012
Return-Path: <dev-return-33921-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 36BF19584
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 16:40:49 +0000 (UTC)
Received: (qmail 98913 invoked by uid 500); 25 Jan 2012 16:40:48 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 98773 invoked by uid 500); 25 Jan 2012 16:40:47 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 98766 invoked by uid 99); 25 Jan 2012 16:40:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:40:47 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of michid@gmail.com designates 64.18.1.35 as permitted sender)
Received: from [64.18.1.35] (HELO exprod6og115.obsmtp.com) (64.18.1.35)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:40:38 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob115.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyAwcNw0vpCtIm44IIsGBJoNqrGYrmhA@postini.com; Wed, 25 Jan 2012 08:40:17 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0PGeF2U017368
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 08:40:15 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0PGeFPl026711
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 08:40:15 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Wed, 25 Jan
 2012 08:40:14 -0800
Received: from susi.local (10.136.140.49) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Wed, 25 Jan 2012
 16:40:11 +0000
Message-ID: <4F20306B.9030301@gmail.com>
Date: Wed, 25 Jan 2012 16:40:11 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <michid@gmail.com>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: [jr3 Microkernel] semantics of revisionId in commit method
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Microkernel.commit() has a revisionId parameter. Could someone (Stefan?) 
clarify the semantics of this parameter? The Javadoc only says "revision 
the changes are based on". But it fails to explain the actual effect of 
that parameter.

Michael

From dev-return-33922-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 16:51:07 2012
Return-Path: <dev-return-33922-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7AA4F98A5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 16:51:07 +0000 (UTC)
Received: (qmail 26203 invoked by uid 500); 25 Jan 2012 16:51:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 25955 invoked by uid 500); 25 Jan 2012 16:51:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 25942 invoked by uid 99); 25 Jan 2012 16:51:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:51:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:51:03 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 32EE7162AA6
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 16:50:42 +0000 (UTC)
Date: Wed, 25 Jan 2012 16:50:42 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1167419454.76848.1327510242210.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-2406) Upgrade httpclient dependency to 4.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-2406?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-2406:
--------------------------------

          Component/s: jackrabbit-jcr-server
    Affects Version/s:     (was: 2.0-beta1)
   =20
> Upgrade httpclient dependency to 4.0
> ------------------------------------
>
>                 Key: JCR-2406
>                 URL: https://issues.apache.org/jira/browse/JCR-2406
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server, jackrabbit-spi2dav
>            Reporter: S=C3=A9bastien Launay
>            Priority: Minor
>
> Httpclient is one of these libs that tends to be pulled by another third =
party lib and often with conflicted versions (in a traditional environment =
contrary to OSGi).
> Upgrading from 3.0 to 4.0 allows applications to use both Jackrabbit and =
the latest release of HttpClient.
> As discussed in JCR-2389, this is a sensitive task as it can introduce re=
gression.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33923-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 16:59:05 2012
Return-Path: <dev-return-33923-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DE6609A2A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 16:59:05 +0000 (UTC)
Received: (qmail 40209 invoked by uid 500); 25 Jan 2012 16:59:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 40165 invoked by uid 500); 25 Jan 2012 16:59:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 40157 invoked by uid 99); 25 Jan 2012 16:59:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:59:04 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 16:59:02 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 6464D162E10
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 16:58:41 +0000 (UTC)
Date: Wed, 25 Jan 2012 16:58:41 +0000 (UTC)
From: "Julian Reschke (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <190745546.76865.1327510721423.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1047400331.28339.1324332572529.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3186) Export size of Observation eventQueue
 to JMX
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3186?page=3Dcom.atlassian.=
jira.plugin.system.issuetabpanels:all-tabpanel ]

Julian Reschke updated JCR-3186:
--------------------------------

    Assignee:     (was: Julian Reschke)
   =20
> Export size of Observation eventQueue to JMX
> --------------------------------------------
>
>                 Key: JCR-3186
>                 URL: https://issues.apache.org/jira/browse/JCR-3186
>             Project: Jackrabbit Content Repository
>          Issue Type: Wish
>          Components: jackrabbit-core
>            Reporter: J=C3=B6rg Hoh
>            Priority: Minor
>         Attachments: JR-observationQueueJMX-trunk.patch
>
>
> export the size of the event queue of JCR Observation to JMX.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33924-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Wed Jan 25 17:04:43 2012
Return-Path: <dev-return-33924-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A60F99C19
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Wed, 25 Jan 2012 17:04:43 +0000 (UTC)
Received: (qmail 52953 invoked by uid 500); 25 Jan 2012 17:04:43 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52911 invoked by uid 500); 25 Jan 2012 17:04:42 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 52903 invoked by uid 99); 25 Jan 2012 17:04:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 17:04:42 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.31] (HELO exprod6og113.obsmtp.com) (64.18.1.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 25 Jan 2012 17:04:33 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob113.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyA2DGVL/RbMVKoAyiWEtOdqxaX7p0B0@postini.com; Wed, 25 Jan 2012 09:04:13 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.corp.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0PH4A2U021951
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 09:04:11 -0800 (PST)
Received: from nacas02.corp.adobe.com (nacas02.corp.adobe.com [10.8.189.100])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0PH49MN015128
	for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 09:04:10 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas02.corp.adobe.com
 (10.8.189.100) with Microsoft SMTP Server (TLS) id 8.3.192.1; Wed, 25 Jan
 2012 09:04:09 -0800
Received: from susi.local (10.136.140.49) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Wed, 25 Jan 2012
 17:04:08 +0000
Message-ID: <4F203608.3050200@apache.org>
Date: Wed, 25 Jan 2012 17:04:08 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: [jr3 Microkernel] how should we handle failed save operations?
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit


Hi,

In an earlier discussion (probably offline), we decided to not implement 
Item.refresh() since it doesn't go well with the MVCC model jr3 is based 
on. Furthermore, JCR doesn't have an Item.undo() method for undoing changes.

This may lead to problems when a Session.save() fails due to the 
underlying Microkernel.commit failing because it detected a conflict. 
Now there might be some transient changes (like deletions) which can't 
be selectively undone by the user. So the user is left with a transient 
space containing his changes but he can only discard them as a whole. 
Not very satisfactory.

Possible solutions:

1) The Microkernel makes as much effort as possible to three way merge 
changes.

2) The user needs to do a session refresh with keep changes = true and 
save again.

3) Introduce a Item.undo method on the JCR API.


1) Mitigates the problem such that it only occurs rarely.

2) Is really nothing more than moving the problem of the failed commit 
due to a conflict from the Microkernel to the transient space: now the 
transient space needs to do conflict resolution.

3) Is what I think we should do. This enable the user to resolve his 
conflicts selectively.

Michael

From dev-return-33925-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 02:09:54 2012
Return-Path: <dev-return-33925-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D65D898B2
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 02:09:54 +0000 (UTC)
Received: (qmail 61748 invoked by uid 500); 26 Jan 2012 02:09:54 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 61637 invoked by uid 500); 26 Jan 2012 02:09:53 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 61630 invoked by uid 99); 26 Jan 2012 02:09:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 02:09:53 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of peri.subrahmanya@gmail.com designates 209.85.210.42 as permitted sender)
Received: from [209.85.210.42] (HELO mail-pz0-f42.google.com) (209.85.210.42)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 02:09:44 +0000
Received: by dalz17 with SMTP id z17so131194dal.1
        for <dev@jackrabbit.apache.org>; Wed, 25 Jan 2012 18:09:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=from:content-type:content-transfer-encoding:subject:date:message-id
         :to:mime-version:x-mailer;
        bh=Pyi1mxoIHGEC1HuSXDuELikzW+hVoni7jDlH1FZ42Q4=;
        b=wVqtKJNKdAqQOpse3s4wG61oN4WasUfsSY9rfZio/+R0GPb6f9mxe2JNiKQ7dfngkQ
         tIju9BJ/nfOaplKkzTJ85jSRvR7NbsRHgxovUWOZOkYwKkV5v4g4m1QzEdU+AEfu4Yum
         m/MNET6gcK2PBl2yf98EPWugbY8tWS2a5cOyY=
Received: by 10.68.116.237 with SMTP id jz13mr667664pbb.100.1327543763277;
        Wed, 25 Jan 2012 18:09:23 -0800 (PST)
Received: from static-083.127.57.27.airteldataservices.com ([27.57.127.83])
        by mx.google.com with ESMTPS id k9sm7011773pbl.18.2012.01.25.18.09.20
        (version=TLSv1/SSLv3 cipher=OTHER);
        Wed, 25 Jan 2012 18:09:21 -0800 (PST)
From: Peri Subrahmanya <peri.subrahmanya@gmail.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: Storing large number of files
Date: Thu, 26 Jan 2012 07:39:19 +0530
Message-Id: <B011EE28-DA13-455C-9626-769B4870AE23@gmail.com>
To: dev@jackrabbit.apache.org
Mime-Version: 1.0 (Apple Message framework v1251.1)
X-Mailer: Apple Mail (2.1251.1)
X-Virus-Checked: Checked by ClamAV on apache.org

I am using JCR 2.3.7 (latest stable release) for storing large number of =
files. I am keeping the node sizes to 10K (requirement is to store upto =
100M records) but I am seeing a performance issues no matter how I =
organize the node structure. Using Oracle DB for datastore. Takes around =
50 minutes to save 50K files (5kB each). Is there any way to improve the =
performance or what would be the recommended way.

Thanks
-PeriS=

From dev-return-33926-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 08:11:16 2012
Return-Path: <dev-return-33926-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 906A49BA0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 08:11:16 +0000 (UTC)
Received: (qmail 87781 invoked by uid 500); 26 Jan 2012 08:11:16 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 87170 invoked by uid 500); 26 Jan 2012 08:11:09 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 87152 invoked by uid 99); 26 Jan 2012 08:11:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 08:11:07 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 08:10:59 +0000
Received: by iaoo28 with SMTP id o28so1013979iao.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 00:10:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=04exa+frM1HxOwgGmXSad85OTxhBMP6eifQEfB8B9Bo=;
        b=lQCDLsoiJujCEspA9DLUKno9mUZzPhpI1dO0d/zwyYOef68bWjwSMOa8ctLZ1MKmU/
         45InrUxIyESVoTwWU2/G+7YJBCA6U2Ky5TMp2yPGr2vnq7b8w05+3Py5YxfBQhg6M5pC
         sFH4pYyR9DOoGYlkrXQ98bGIUHCQK35D9MYGs=
MIME-Version: 1.0
Received: by 10.42.147.72 with SMTP id m8mr768952icv.56.1327565438458; Thu, 26
 Jan 2012 00:10:38 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Thu, 26 Jan 2012 00:10:38 -0800 (PST)
In-Reply-To: <B011EE28-DA13-455C-9626-769B4870AE23@gmail.com>
References: <B011EE28-DA13-455C-9626-769B4870AE23@gmail.com>
Date: Thu, 26 Jan 2012 09:10:38 +0100
Message-ID: <CAFYk8NkuZD0UP6GDDShPZ+fdqKb-gFtzVHvvvmsp=LwTjWhKJA@mail.gmail.com>
Subject: Re: Storing large number of files
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Jan 26, 2012 at 3:09 AM, Peri Subrahmanya
<peri.subrahmanya@gmail.com> wrote:
> I am using JCR 2.3.7 (latest stable release) for storing large number of =
files. I am keeping the node sizes to 10K (requirement is to store upto 100=
M records) but I am seeing a performance issues no matter how I organize th=
e node structure. Using Oracle DB for datastore. Takes around 50 minutes to=
 save 50K files (5kB each). Is there any way to improve the performance or =
what would be the recommended way.

yes, don't use oracle db for datastore. use the filesystem based datastore.

cheers
stefan

>
> Thanks
> -PeriS

From dev-return-33927-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 08:48:54 2012
Return-Path: <dev-return-33927-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 717439225
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 08:48:54 +0000 (UTC)
Received: (qmail 51553 invoked by uid 500); 26 Jan 2012 08:48:53 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 51173 invoked by uid 500); 26 Jan 2012 08:48:42 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 51166 invoked by uid 99); 26 Jan 2012 08:48:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 08:48:38 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mueller@adobe.com designates 64.18.1.33 as permitted sender)
Received: from [64.18.1.33] (HELO exprod6og114.obsmtp.com) (64.18.1.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 08:48:28 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob114.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyETRu7d2Akae0UalgYz+sc53XZ7EABZ@postini.com; Thu, 26 Jan 2012 00:48:07 PST
Received: from inner-relay-1.corp.adobe.com (ms-exchange.macromedia.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0Q8m42U012441
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 00:48:05 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0Q8m3MM023817
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 00:48:04 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 26 Jan 2012
 00:48:03 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Thu, 26 Jan 2012 08:48:03
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Thu, 26 Jan 2012 08:48:00 +0000
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
Thread-Topic: [jr3 Microkernel] how should we handle failed save operations?
Thread-Index: AczcBzaeoWws8nqaTJqjXzdsjN92rw==
Message-ID: <CB46CE28.23534%mueller@adobe.com>
In-Reply-To: <4F203608.3050200@apache.org>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I would try 1). I would not try 3) because the user wouldn't know which
item conflicted (well he could parse the message, but that would be
weird). Also, I would try to avoid a new API.

For the case 'double delete' another solution is possible.

* session1 deleted node /test and does some other changes
* session2 deleted node /test and does some other changes
* session1 save (successful)
* session2 save (fails: /test can't be deleted because it doesn't exist
any more)

4): The microkernel could ignore delete operations on paths that don't
currently exist. This is somewhat similar to what databases do: "delete
from test where id=3D1" will be successful if there is no row with id 1. Or
with JCR setProperty(..., null) for a non-existent property (which
currently works fine).

Regards,
Thomas





On 1/25/12 6:04 PM, "Michael D=FCrig" <mduerig@apache.org> wrote:

>
>Hi,
>
>In an earlier discussion (probably offline), we decided to not implement
>Item.refresh() since it doesn't go well with the MVCC model jr3 is based
>on. Furthermore, JCR doesn't have an Item.undo() method for undoing
>changes.
>
>This may lead to problems when a Session.save() fails due to the
>underlying Microkernel.commit failing because it detected a conflict.
>Now there might be some transient changes (like deletions) which can't
>be selectively undone by the user. So the user is left with a transient
>space containing his changes but he can only discard them as a whole.
>Not very satisfactory.
>
>Possible solutions:
>
>1) The Microkernel makes as much effort as possible to three way merge
>changes.
>
>2) The user needs to do a session refresh with keep changes =3D true and
>save again.
>
>3) Introduce a Item.undo method on the JCR API.
>
>
>1) Mitigates the problem such that it only occurs rarely.
>
>2) Is really nothing more than moving the problem of the failed commit
>due to a conflict from the Microkernel to the transient space: now the
>transient space needs to do conflict resolution.
>
>3) Is what I think we should do. This enable the user to resolve his
>conflicts selectively.
>
>Michael


From dev-return-33928-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 10:56:49 2012
Return-Path: <dev-return-33928-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0BBED92A4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 10:56:49 +0000 (UTC)
Received: (qmail 30501 invoked by uid 500); 26 Jan 2012 10:56:48 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 29704 invoked by uid 500); 26 Jan 2012 10:56:47 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 29697 invoked by uid 99); 26 Jan 2012 10:56:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 10:56:46 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 10:56:37 +0000
Received: by werm1 with SMTP id m1so677408wer.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 02:56:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=frqMSBJjCPGbrozcH/bsRatmBTueq91kb+ZvIQCi6C8=;
        b=UWABVsyuEUcc/ZtpD1xUuQbJJzvAH7wVPFBZoFcyLmkjglFrVAzxX+Ca/Gd+GV3ivG
         Ooft2N7hQP0c0hkSlEJWErjMwtBNR1AnuPifXCdDMqZF8oC0ykIWMI+rq5VTzHCmQsF9
         mEltlEPSEJ6ScYAXCv16ZA/uJ+TIJ9jqtfh3I=
Received: by 10.216.132.148 with SMTP id o20mr803686wei.33.1327575377098; Thu,
 26 Jan 2012 02:56:17 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Thu, 26 Jan 2012 02:55:57 -0800 (PST)
In-Reply-To: <4F203608.3050200@apache.org>
References: <4F203608.3050200@apache.org>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Thu, 26 Jan 2012 11:55:57 +0100
Message-ID: <CAOFYJNa-yLbRgJwhKj-stpy0jqXkqC1gObdZw5XLaeDh6AuBRg@mail.gmail.com>
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Wed, Jan 25, 2012 at 6:04 PM, Michael D=FCrig <mduerig@apache.org> wrote=
:
> In an earlier discussion (probably offline), we decided to not implement
> Item.refresh() since it doesn't go well with the MVCC model jr3 is based =
on.

I'd implement Item.refresh() like this:

    public void refresh(boolean keepChanges) throws RepositoryException {
        if (!keepChanges) {
            discardTransientChangesBelowThisItem();
        }

        // Update the MVCC base state of this session to the latest
        // state of the workspace.
        getSession().refresh(true);
    }

In other words, Item.refresh() would always trigger a refresh() of the
entire session. That's OK spec-wise, since it's always OK for the
implementation to refresh the session state at any point of time it
wants.

> Furthermore, JCR doesn't have an Item.undo() method for undoing changes.

I'd treat refresh(false) as undo(), both on Item and Session level.

> This may lead to problems when a Session.save() fails due to the underlyi=
ng
> Microkernel.commit failing because it detected a conflict. Now there migh=
t
> be some transient changes (like deletions) which can't be selectively und=
one
> by the user. So the user is left with a transient space containing his
> changes but he can only discard them as a whole. Not very satisfactory.

I think that's fine, especially if we implement Item.refresh(false)
with an internal discardTransientChangesBelowThisItem() operation as
described above.

> 1) The Microkernel makes as much effort as possible to three way merge
> changes.

I think we should do this in any case.

> 2) The user needs to do a session refresh with keep changes =3D true and =
save
> again.

I'd always automatically trigger a refresh(true) at the beginning of a
save() call.

> 3) Introduce a Item.undo method on the JCR API.

As mentioned above, I think Item.refresh(false) could already cover
the required functionality.

BR,

Jukka Zitting

From dev-return-33929-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 11:09:12 2012
Return-Path: <dev-return-33929-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD475973E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 11:09:12 +0000 (UTC)
Received: (qmail 41126 invoked by uid 500); 26 Jan 2012 11:09:12 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 41082 invoked by uid 500); 26 Jan 2012 11:09:11 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 41075 invoked by uid 99); 26 Jan 2012 11:09:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 11:09:11 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 11:09:05 +0000
Received: by iaoo28 with SMTP id o28so1494317iao.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 03:08:44 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=EbvSmS1xxm4YUXgjx7JkQjJjMOU8zj03VHjYmtxfp5o=;
        b=DEI0i396JeOYF6RNZHRqAYVAK1L/6cwOIVGvGqJ5pGwAZWVMdf223F7fZ13mQ9gAiq
         KVsx2yCRWAvKHXBdVLeeyh6LcUxjaqYQkmPhbZYRLinY/K9vK9tUDPLg3RbBj561x42o
         yJQvlbW1TUc5/rK1yj2Iz7/PeCBHmziVmmJVY=
MIME-Version: 1.0
Received: by 10.42.161.70 with SMTP id s6mr1311761icx.48.1327576124834; Thu,
 26 Jan 2012 03:08:44 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Thu, 26 Jan 2012 03:08:44 -0800 (PST)
In-Reply-To: <4F203608.3050200@apache.org>
References: <4F203608.3050200@apache.org>
Date: Thu, 26 Jan 2012 12:08:44 +0100
Message-ID: <CAFYk8Nn50Vvkd1b3pjNUS+TrG1_wu0u3z4pO4By=G2GyV1sS-g@mail.gmail.com>
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Wed, Jan 25, 2012 at 6:04 PM, Michael D=FCrig <mduerig@apache.org> wrote=
:
>
> Hi,
>
> In an earlier discussion (probably offline), we decided to not implement
> Item.refresh() since it doesn't go well with the MVCC model jr3 is based =
on.
> Furthermore, JCR doesn't have an Item.undo() method for undoing changes.

please note that Item.refresh() will most likely be deprecated in JCR 2.1.

>
> This may lead to problems when a Session.save() fails due to the underlyi=
ng
> Microkernel.commit failing because it detected a conflict. Now there migh=
t
> be some transient changes (like deletions) which can't be selectively und=
one
> by the user. So the user is left with a transient space containing his
> changes but he can only discard them as a whole. Not very satisfactory.

this is IMO a rather theoretical problem. i am not aware of any jcr client =
code
which actually does re-try a failed save operation after having
partially discarded
and fixed transient changes by calling Item.refresh(false);

however, i agree that, theroretically, it is an issue ;)

>
> Possible solutions:
>
> 1) The Microkernel makes as much effort as possible to three way merge
> changes.

+1, agreed.

>
> 2) The user needs to do a session refresh with keep changes =3D true and =
save
> again.
>
> 3) Introduce a Item.undo method on the JCR API.

i don't think we need that because IMO there's no real world use case.

cheers
stefan

>
>
> 1) Mitigates the problem such that it only occurs rarely.
>
> 2) Is really nothing more than moving the problem of the failed commit du=
e
> to a conflict from the Microkernel to the transient space: now the transi=
ent
> space needs to do conflict resolution.
>
> 3) Is what I think we should do. This enable the user to resolve his
> conflicts selectively.
>
> Michael

From dev-return-33930-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 11:35:11 2012
Return-Path: <dev-return-33930-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 97DED9C88
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 11:35:11 +0000 (UTC)
Received: (qmail 72608 invoked by uid 500); 26 Jan 2012 11:35:11 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 72538 invoked by uid 500); 26 Jan 2012 11:35:10 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 72531 invoked by uid 99); 26 Jan 2012 11:35:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 11:35:09 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.185] (HELO exprod6og103.obsmtp.com) (64.18.1.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 11:35:00 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob103.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyE6TwtyqHnCCTHcFiY0nduqtti1JyEQ@postini.com; Thu, 26 Jan 2012 03:34:40 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.sea.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QBYb2U024402
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 03:34:38 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QBYbMM018593
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 03:34:37 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 26 Jan 2012
 03:34:37 -0800
Received: from susi.local (10.130.225.50) by eurhub01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Thu, 26 Jan 2012
 11:34:35 +0000
Message-ID: <4F213A4B.30207@apache.org>
Date: Thu, 26 Jan 2012 11:34:35 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
References: <4F203608.3050200@apache.org> <CAOFYJNa-yLbRgJwhKj-stpy0jqXkqC1gObdZw5XLaeDh6AuBRg@mail.gmail.com>
In-Reply-To: <CAOFYJNa-yLbRgJwhKj-stpy0jqXkqC1gObdZw5XLaeDh6AuBRg@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit



On 26.1.12 10:55, Jukka Zitting wrote:
> Hi,
>
> On Wed, Jan 25, 2012 at 6:04 PM, Michael Drig<mduerig@apache.org>  wrote:
>> In an earlier discussion (probably offline), we decided to not implement
>> Item.refresh() since it doesn't go well with the MVCC model jr3 is based on.
>
> I'd implement Item.refresh() like this:
>
>      public void refresh(boolean keepChanges) throws RepositoryException {
>          if (!keepChanges) {
>              discardTransientChangesBelowThisItem();
>          }
>
>          // Update the MVCC base state of this session to the latest
>          // state of the workspace.
>          getSession().refresh(true);
>      }
>
> In other words, Item.refresh() would always trigger a refresh() of the
> entire session. That's OK spec-wise, since it's always OK for the
> implementation to refresh the session state at any point of time it
> wants.

That's an interesting approach. Will think about it. I think this 
together with 1) will could be a viable solution.

Michael

>
>> Furthermore, JCR doesn't have an Item.undo() method for undoing changes.
>
> I'd treat refresh(false) as undo(), both on Item and Session level.
>
>> This may lead to problems when a Session.save() fails due to the underlying
>> Microkernel.commit failing because it detected a conflict. Now there might
>> be some transient changes (like deletions) which can't be selectively undone
>> by the user. So the user is left with a transient space containing his
>> changes but he can only discard them as a whole. Not very satisfactory.
>
> I think that's fine, especially if we implement Item.refresh(false)
> with an internal discardTransientChangesBelowThisItem() operation as
> described above.
>
>> 1) The Microkernel makes as much effort as possible to three way merge
>> changes.
>
> I think we should do this in any case.
>
>> 2) The user needs to do a session refresh with keep changes = true and save
>> again.
>
> I'd always automatically trigger a refresh(true) at the beginning of a
> save() call.
>
>> 3) Introduce a Item.undo method on the JCR API.
>
> As mentioned above, I think Item.refresh(false) could already cover
> the required functionality.
>
> BR,
>
> Jukka Zitting

From dev-return-33931-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 11:40:30 2012
Return-Path: <dev-return-33931-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 671529DB0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 11:40:30 +0000 (UTC)
Received: (qmail 78097 invoked by uid 500); 26 Jan 2012 11:40:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 77986 invoked by uid 500); 26 Jan 2012 11:40:29 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 77976 invoked by uid 99); 26 Jan 2012 11:40:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 11:40:29 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.31] (HELO exprod6og113.obsmtp.com) (64.18.1.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 11:40:20 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob113.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyE7j7W9AmHyT7/a44E1lodJsrB3gYdq@postini.com; Thu, 26 Jan 2012 03:39:59 PST
Received: from inner-relay-1.corp.adobe.com (ms-exchange.macromedia.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QBdv2U024753
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 03:39:58 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QBdvMM019718
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 03:39:57 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 26 Jan 2012
 03:39:57 -0800
Received: from susi.local (10.130.225.50) by eurhub01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Thu, 26 Jan 2012
 11:39:55 +0000
Message-ID: <4F213B8A.2090008@apache.org>
Date: Thu, 26 Jan 2012 11:39:54 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
References: <4F203608.3050200@apache.org> <CAFYk8Nn50Vvkd1b3pjNUS+TrG1_wu0u3z4pO4By=G2GyV1sS-g@mail.gmail.com>
In-Reply-To: <CAFYk8Nn50Vvkd1b3pjNUS+TrG1_wu0u3z4pO4By=G2GyV1sS-g@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit

>> This may lead to problems when a Session.save() fails due to the underlying
>> Microkernel.commit failing because it detected a conflict. Now there might
>> be some transient changes (like deletions) which can't be selectively undone
>> by the user. So the user is left with a transient space containing his
>> changes but he can only discard them as a whole. Not very satisfactory.
>
> this is IMO a rather theoretical problem. i am not aware of any jcr client code
> which actually does re-try a failed save operation after having
> partially discarded
> and fixed transient changes by calling Item.refresh(false);
>
> however, i agree that, theroretically, it is an issue ;)

In don't think so. Consider two users concurrently working on the same 
web page. The user who saves last and runs into a conflict loses *all* 
his work. No way to merge, partially apply or keep it otherwise. His 
only option is to discard all of his work and to do it again from start.

Michael

>
>>
>> Possible solutions:
>>
>> 1) The Microkernel makes as much effort as possible to three way merge
>> changes.
>
> +1, agreed.
>
>>
>> 2) The user needs to do a session refresh with keep changes = true and save
>> again.
>>
>> 3) Introduce a Item.undo method on the JCR API.
>
> i don't think we need that because IMO there's no real world use case.
>
> cheers
> stefan
>
>>
>>
>> 1) Mitigates the problem such that it only occurs rarely.
>>
>> 2) Is really nothing more than moving the problem of the failed commit due
>> to a conflict from the Microkernel to the transient space: now the transient
>> space needs to do conflict resolution.
>>
>> 3) Is what I think we should do. This enable the user to resolve his
>> conflicts selectively.
>>
>> Michael

From dev-return-33932-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 13:25:55 2012
Return-Path: <dev-return-33932-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E21FE971A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 13:25:55 +0000 (UTC)
Received: (qmail 32683 invoked by uid 500); 26 Jan 2012 13:25:55 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 32518 invoked by uid 500); 26 Jan 2012 13:25:55 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 32511 invoked by uid 99); 26 Jan 2012 13:25:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:25:54 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.161.170 as permitted sender)
Received: from [209.85.161.170] (HELO mail-gx0-f170.google.com) (209.85.161.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:25:47 +0000
Received: by ggni2 with SMTP id i2so350781ggn.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 05:25:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=5FDmRlrTSrW0AiWX/ISs7JZ+XyABAcCzNbB2Ba1b6Vc=;
        b=xDFSOPJKvqo/YCrWb9Zrugt7C/b8/QNnAM2/Vyva+I8VlZpR09UdOh7bjHNMvMmfU6
         N37yZ56Z8APcpqdAA/U0QVho7P7KiBgzOoSg/EikHFAaluy4sSbxATlvrXmyeIvWhjtE
         smB8LkL9zfZ23/mX0N9Sp73eRcfPgFbPni5uY=
MIME-Version: 1.0
Received: by 10.50.15.169 with SMTP id y9mr2681199igc.9.1327584325968; Thu, 26
 Jan 2012 05:25:25 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Thu, 26 Jan 2012 05:25:25 -0800 (PST)
In-Reply-To: <CB46CE28.23534%mueller@adobe.com>
References: <4F203608.3050200@apache.org>
	<CB46CE28.23534%mueller@adobe.com>
Date: Thu, 26 Jan 2012 14:25:25 +0100
Message-ID: <CAFYk8N=z1VFFn=eV3m=PnYVpHQMdzoHHzK2_He7tKp9tPkomTg@mail.gmail.com>
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Jan 26, 2012 at 9:48 AM, Thomas Mueller <mueller@adobe.com> wrote:
> Hi,
>
> I would try 1). I would not try 3) because the user wouldn't know which
> item conflicted (well he could parse the message, but that would be
> weird). Also, I would try to avoid a new API.
>
> For the case 'double delete' another solution is possible.
>
> * session1 deleted node /test and does some other changes
> * session2 deleted node /test and does some other changes
> * session1 save (successful)
> * session2 save (fails: /test can't be deleted because it doesn't exist
> any more)
>
> 4): The microkernel could ignore delete operations on paths that don't
> currently exist. This is somewhat similar to what databases do: "delete
> from test where id=3D1" will be successful if there is no row with id 1. =
Or
> with JCR setProperty(..., null) for a non-existent property (which
> currently works fine).

BTW: the current microkernel prototype doesn't consider concurrent
removal of a specific node a conflict, i.e. it already implements the
proposed behavior.

cheers
stefan

>
> Regards,
> Thomas
>
>
>
>
>
> On 1/25/12 6:04 PM, "Michael D=FCrig" <mduerig@apache.org> wrote:
>
>>
>>Hi,
>>
>>In an earlier discussion (probably offline), we decided to not implement
>>Item.refresh() since it doesn't go well with the MVCC model jr3 is based
>>on. Furthermore, JCR doesn't have an Item.undo() method for undoing
>>changes.
>>
>>This may lead to problems when a Session.save() fails due to the
>>underlying Microkernel.commit failing because it detected a conflict.
>>Now there might be some transient changes (like deletions) which can't
>>be selectively undone by the user. So the user is left with a transient
>>space containing his changes but he can only discard them as a whole.
>>Not very satisfactory.
>>
>>Possible solutions:
>>
>>1) The Microkernel makes as much effort as possible to three way merge
>>changes.
>>
>>2) The user needs to do a session refresh with keep changes =3D true and
>>save again.
>>
>>3) Introduce a Item.undo method on the JCR API.
>>
>>
>>1) Mitigates the problem such that it only occurs rarely.
>>
>>2) Is really nothing more than moving the problem of the failed commit
>>due to a conflict from the Microkernel to the transient space: now the
>>transient space needs to do conflict resolution.
>>
>>3) Is what I think we should do. This enable the user to resolve his
>>conflicts selectively.
>>
>>Michael
>

From dev-return-33933-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 13:43:12 2012
Return-Path: <dev-return-33933-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1C3E09DC5
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 13:43:12 +0000 (UTC)
Received: (qmail 52488 invoked by uid 500); 26 Jan 2012 13:43:11 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52398 invoked by uid 500); 26 Jan 2012 13:43:11 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 52391 invoked by uid 99); 26 Jan 2012 13:43:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:43:10 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [64.18.1.25] (HELO exprod6og110.obsmtp.com) (64.18.1.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:43:01 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob110.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyFYT/Mzqmnelw6zlBHNHTjxzXAmnJUD@postini.com; Thu, 26 Jan 2012 05:42:40 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QDgc2U001709
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 05:42:38 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0QDgaPm029471
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 05:42:37 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 26 Jan
 2012 05:42:35 -0800
Received: from susi.eur.adobe.com (10.130.225.50) by eurhub01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Thu, 26 Jan 2012
 13:42:32 +0000
Message-ID: <4F215847.9020204@apache.org>
Date: Thu, 26 Jan 2012 13:42:31 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
References: <4F203608.3050200@apache.org> <CB46CE28.23534%mueller@adobe.com> <CAFYk8N=z1VFFn=eV3m=PnYVpHQMdzoHHzK2_He7tKp9tPkomTg@mail.gmail.com>
In-Reply-To: <CAFYk8N=z1VFFn=eV3m=PnYVpHQMdzoHHzK2_He7tKp9tPkomTg@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org


> BTW: the current microkernel prototype doesn't consider concurrent
> removal of a specific node a conflict, i.e. it already implements the
> proposed behavior.

Hmm no?

     String head = mk.getHeadRevision();
     head = mk.commit("/", "+\"qoo\":{}", head, "");

     String r1 = mk.commit("/", "-\"qoo\"", head, "");
     String r2 = mk.commit("/", "-\"qoo\"", head, "");

The commit for r2 gives me an error:
org.apache.jackrabbit.mk.api.MicroKernelException: 
org.apache.jackrabbit.mk.store.NotFoundException: /qoo

Michael


>
> cheers
> stefan
>
>>
>> Regards,
>> Thomas
>>
>>
>>
>>
>>
>> On 1/25/12 6:04 PM, "Michael Drig"<mduerig@apache.org>  wrote:
>>
>>>
>>> Hi,
>>>
>>> In an earlier discussion (probably offline), we decided to not implement
>>> Item.refresh() since it doesn't go well with the MVCC model jr3 is based
>>> on. Furthermore, JCR doesn't have an Item.undo() method for undoing
>>> changes.
>>>
>>> This may lead to problems when a Session.save() fails due to the
>>> underlying Microkernel.commit failing because it detected a conflict.
>>> Now there might be some transient changes (like deletions) which can't
>>> be selectively undone by the user. So the user is left with a transient
>>> space containing his changes but he can only discard them as a whole.
>>> Not very satisfactory.
>>>
>>> Possible solutions:
>>>
>>> 1) The Microkernel makes as much effort as possible to three way merge
>>> changes.
>>>
>>> 2) The user needs to do a session refresh with keep changes = true and
>>> save again.
>>>
>>> 3) Introduce a Item.undo method on the JCR API.
>>>
>>>
>>> 1) Mitigates the problem such that it only occurs rarely.
>>>
>>> 2) Is really nothing more than moving the problem of the failed commit
>>> due to a conflict from the Microkernel to the transient space: now the
>>> transient space needs to do conflict resolution.
>>>
>>> 3) Is what I think we should do. This enable the user to resolve his
>>> conflicts selectively.
>>>
>>> Michael
>>

From dev-return-33934-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 13:50:48 2012
Return-Path: <dev-return-33934-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0125A915C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 13:50:48 +0000 (UTC)
Received: (qmail 64077 invoked by uid 500); 26 Jan 2012 13:50:47 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 64033 invoked by uid 500); 26 Jan 2012 13:50:47 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 64026 invoked by uid 99); 26 Jan 2012 13:50:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:50:46 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:50:40 +0000
Received: by iaoo28 with SMTP id o28so1915915iao.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 05:50:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=4hLQOBXw9UJyrk+o/2jTw+hm8BNacrB4rlL2wFpQqjs=;
        b=fYcm5kPWDoIcWr0KRopTriKru5dJHkKgtHh2AWxbhS+gjE5j8j9Ft0s2kMMzq6K8XH
         Jluy2WAeFf5//cuXS31sbj6n7b+Zx2RB6GyoLcEYO7RE8WqXzoqT8ATr2CwszBw+A5Qv
         f14EpGplpX9jGyLsmz5WAB6xyAYzRCE5xL1fI=
MIME-Version: 1.0
Received: by 10.42.161.70 with SMTP id s6mr1721756icx.48.1327585819873; Thu,
 26 Jan 2012 05:50:19 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Thu, 26 Jan 2012 05:50:19 -0800 (PST)
In-Reply-To: <4F215847.9020204@apache.org>
References: <4F203608.3050200@apache.org>
	<CB46CE28.23534%mueller@adobe.com>
	<CAFYk8N=z1VFFn=eV3m=PnYVpHQMdzoHHzK2_He7tKp9tPkomTg@mail.gmail.com>
	<4F215847.9020204@apache.org>
Date: Thu, 26 Jan 2012 14:50:19 +0100
Message-ID: <CAFYk8N=YEZ2=1BfAA-psNHHA2-ebvq4q2o4R6r13zKUgX0HcZA@mail.gmail.com>
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Thu, Jan 26, 2012 at 2:42 PM, Michael D=FCrig <mduerig@apache.org> wrote=
:
>
>> BTW: the current microkernel prototype doesn't consider concurrent
>> removal of a specific node a conflict, i.e. it already implements the
>> proposed behavior.
>
>
> Hmm no?
>
> =A0 =A0String head =3D mk.getHeadRevision();
> =A0 =A0head =3D mk.commit("/", "+\"qoo\":{}", head, "");
>
> =A0 =A0String r1 =3D mk.commit("/", "-\"qoo\"", head, "");
> =A0 =A0String r2 =3D mk.commit("/", "-\"qoo\"", head, "");
>
> The commit for r2 gives me an error:
> org.apache.jackrabbit.mk.api.MicroKernelException:
> org.apache.jackrabbit.mk.store.NotFoundException: /qoo

i should have been more specific. i meant concurrent, i.e.
overlapping, not sequential commits ;)

but you're right, the above scenario could/should be
handled gracefully.

cheers
stefan
>
> Michael
>
>
>
>>
>> cheers
>> stefan
>>
>>>
>>> Regards,
>>> Thomas
>>>
>>>
>>>
>>>
>>>
>>> On 1/25/12 6:04 PM, "Michael D=FCrig"<mduerig@apache.org> =A0wrote:
>>>
>>>>
>>>> Hi,
>>>>
>>>> In an earlier discussion (probably offline), we decided to not impleme=
nt
>>>> Item.refresh() since it doesn't go well with the MVCC model jr3 is bas=
ed
>>>> on. Furthermore, JCR doesn't have an Item.undo() method for undoing
>>>> changes.
>>>>
>>>> This may lead to problems when a Session.save() fails due to the
>>>> underlying Microkernel.commit failing because it detected a conflict.
>>>> Now there might be some transient changes (like deletions) which can't
>>>> be selectively undone by the user. So the user is left with a transien=
t
>>>> space containing his changes but he can only discard them as a whole.
>>>> Not very satisfactory.
>>>>
>>>> Possible solutions:
>>>>
>>>> 1) The Microkernel makes as much effort as possible to three way merge
>>>> changes.
>>>>
>>>> 2) The user needs to do a session refresh with keep changes =3D true a=
nd
>>>> save again.
>>>>
>>>> 3) Introduce a Item.undo method on the JCR API.
>>>>
>>>>
>>>> 1) Mitigates the problem such that it only occurs rarely.
>>>>
>>>> 2) Is really nothing more than moving the problem of the failed commit
>>>> due to a conflict from the Microkernel to the transient space: now the
>>>> transient space needs to do conflict resolution.
>>>>
>>>> 3) Is what I think we should do. This enable the user to resolve his
>>>> conflicts selectively.
>>>>
>>>> Michael
>>>
>>>
>

From dev-return-33935-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 13:59:13 2012
Return-Path: <dev-return-33935-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 55B58972B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 13:59:13 +0000 (UTC)
Received: (qmail 78805 invoked by uid 500); 26 Jan 2012 13:59:13 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 78742 invoked by uid 500); 26 Jan 2012 13:59:12 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 78735 invoked by uid 99); 26 Jan 2012 13:59:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:59:12 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mueller@adobe.com designates 64.18.1.39 as permitted sender)
Received: from [64.18.1.39] (HELO exprod6og117.obsmtp.com) (64.18.1.39)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 13:59:04 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob117.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyFcE5sk0teBtTDRiYlktyRv5CJIeK+Z@postini.com; Thu, 26 Jan 2012 05:58:44 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QDwg2U002606
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 05:58:42 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0QDwgPl002087
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 05:58:42 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 26 Jan 2012
 05:58:41 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Thu, 26 Jan 2012 13:58:39
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Thu, 26 Jan 2012 13:58:37 +0000
Subject: Re: [jr3 Microkernel] how should we handle failed save operations?
Thread-Topic: [jr3 Microkernel] how should we handle failed save operations?
Thread-Index: AczcMpsET4MDn13iQhCiLzHAx6jGXA==
Message-ID: <CB471933.235A2%mueller@adobe.com>
In-Reply-To: <CAFYk8N=YEZ2=1BfAA-psNHHA2-ebvq4q2o4R6r13zKUgX0HcZA@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

>but you're right, the above scenario could/should be
>handled gracefully.

That makes sense. I have added a test case and changed the
MemoryKernelImpl in the sandbox.

Regards,
Thomas


From dev-return-33936-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 14:31:51 2012
Return-Path: <dev-return-33936-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1AF2C9D44
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 14:31:51 +0000 (UTC)
Received: (qmail 44774 invoked by uid 500); 26 Jan 2012 14:31:50 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 44688 invoked by uid 500); 26 Jan 2012 14:31:50 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 44681 invoked by uid 99); 26 Jan 2012 14:31:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 14:31:49 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.161.170 as permitted sender)
Received: from [209.85.161.170] (HELO mail-gx0-f170.google.com) (209.85.161.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 14:31:43 +0000
Received: by ggni2 with SMTP id i2so433993ggn.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 06:31:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=WDg8YVcrFPessG/UR3ePY6c0QqcYHNOO7dY5RLDaw1s=;
        b=in/1kPpWPiyanqA65GN73Kz5NLW1mqWQskG+AmJwvlg/ZwG4GcL6NwlGFtNetPpqjr
         +A0pYywd370TlfjrCoFalQwrYkCp/k+Ot5HL02iYEhXrtB80lKVaKX7QKdux8r1B9al1
         BnA87S2dJSdF104+qYw8tLmp4Hn9Offv0wctY=
MIME-Version: 1.0
Received: by 10.50.156.196 with SMTP id wg4mr2445463igb.13.1327588282870; Thu,
 26 Jan 2012 06:31:22 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Thu, 26 Jan 2012 06:31:22 -0800 (PST)
In-Reply-To: <4F20306B.9030301@gmail.com>
References: <4F20306B.9030301@gmail.com>
Date: Thu, 26 Jan 2012 15:31:22 +0100
Message-ID: <CAFYk8NkE6zm1Azpd6301QYtqmc9JdkOidaU5FqPVcSQoTn_WbQ@mail.gmail.com>
Subject: Re: [jr3 Microkernel] semantics of revisionId in commit method
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Wed, Jan 25, 2012 at 5:40 PM, Michael D=FCrig <michid@gmail.com> wrote:
>
> Hi,
>
> Microkernel.commit() has a revisionId parameter. Could someone (Stefan?)
> clarify the semantics of this parameter? The Javadoc only says "revision =
the
> changes are based on". But it fails to explain the actual effect of that
> parameter.

the revisionId parameter of the commit method provides the
context of the changes specified by the jsonDiff parameter.

while it's true that all changes are always applied on the
current HEAD revision, the 'baseRevision' of a commit allows
for smarter 3-way merges/conflict resolutions.

an example:

assume a node /foo exists in rev0 of the tree and
sessions s1 and s2 are both based on rev0.

now s1 moves /foo to /bar while s2 sets a property on /foo :

// s1
mk.commit("/", ">\"foo\": \"bar\"", rev0, "");
// s2
mk.commit("/", "^\"foo/prop\" : \"blah\"", rev0, "");

knowing the context of the commit (-> rev0) allows the
2nd commit to apply the property modification on /bar
instead of throwing a "path not found: /foo" exception.

please note that this specific use case is currently not
yet implemented in MicroKernelImpl.

cheers
stefan

>
> Michael

From dev-return-33937-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 14:55:10 2012
Return-Path: <dev-return-33937-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9C79A926D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 14:55:10 +0000 (UTC)
Received: (qmail 12781 invoked by uid 500); 26 Jan 2012 14:55:10 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 12682 invoked by uid 500); 26 Jan 2012 14:55:09 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 12674 invoked by uid 99); 26 Jan 2012 14:55:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 14:55:09 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of peri.subrahmanya@gmail.com designates 209.85.160.42 as permitted sender)
Received: from [209.85.160.42] (HELO mail-pw0-f42.google.com) (209.85.160.42)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 14:55:01 +0000
Received: by pbz3 with SMTP id 3so1259782pbz.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 06:54:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=2ivd94WLULccmapB6u/lJo5fAhndJ2YUj13UByGKi9A=;
        b=kjS6xlM0sURJaCmbHS/wMZqj67P0Ii7ousm7FyIQwDItnfzhHIOdBn9vyseIkRvIJW
         cfeiZT00479LT/gGChHDIN4McLMlwrO5OxeqzaSS047DdgFUJdjnbQs6ZoJ4pHbebbsP
         3cwDI25lqPl4IxF2HnxjRK44dWLVqLcorqXNc=
Received: by 10.68.219.69 with SMTP id pm5mr5884147pbc.5.1327589681455;
        Thu, 26 Jan 2012 06:54:41 -0800 (PST)
Received: from [27.61.235.95] ([27.61.235.95])
        by mx.google.com with ESMTPS id n8sm11871044pbq.7.2012.01.26.06.54.39
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 26 Jan 2012 06:54:40 -0800 (PST)
Content-Type: text/plain; charset=iso-8859-1
Mime-Version: 1.0 (Apple Message framework v1251.1)
Subject: Re: Storing large number of files
From: Peri Subrahmanya <peri.subrahmanya@gmail.com>
In-Reply-To: <CAFYk8NkuZD0UP6GDDShPZ+fdqKb-gFtzVHvvvmsp=LwTjWhKJA@mail.gmail.com>
Date: Thu, 26 Jan 2012 20:24:37 +0530
Content-Transfer-Encoding: quoted-printable
Message-Id: <BC51DFA6-EB65-4D21-8BD9-EA11E741EF71@gmail.com>
References: <B011EE28-DA13-455C-9626-769B4870AE23@gmail.com> <CAFYk8NkuZD0UP6GDDShPZ+fdqKb-gFtzVHvvvmsp=LwTjWhKJA@mail.gmail.com>
To: dev@jackrabbit.apache.org
X-Mailer: Apple Mail (2.1251.1)

Stefan,

As I understood filesystem model doesn't provide atomocity i.e no =
transactional support which may lead to corrupted nodes if there is a =
system crash for some reason during saving. Is it still recommended in =
production environments?

Thanks

On Jan 26, 2012, at 1:40 PM, Stefan Guggisberg wrote:

> On Thu, Jan 26, 2012 at 3:09 AM, Peri Subrahmanya
> <peri.subrahmanya@gmail.com> wrote:
>> I am using JCR 2.3.7 (latest stable release) for storing large number =
of files. I am keeping the node sizes to 10K (requirement is to store =
upto 100M records) but I am seeing a performance issues no matter how I =
organize the node structure. Using Oracle DB for datastore. Takes around =
50 minutes to save 50K files (5kB each). Is there any way to improve the =
performance or what would be the recommended way.
>=20
> yes, don't use oracle db for datastore. use the filesystem based =
datastore.
>=20
> cheers
> stefan
>=20
>>=20
>> Thanks
>> -PeriS


From dev-return-33938-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 15:16:10 2012
Return-Path: <dev-return-33938-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D85E89076
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 15:16:09 +0000 (UTC)
Received: (qmail 51032 invoked by uid 500); 26 Jan 2012 15:16:09 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 50951 invoked by uid 500); 26 Jan 2012 15:16:08 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 50944 invoked by uid 99); 26 Jan 2012 15:16:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:16:08 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mueller@adobe.com designates 64.18.1.23 as permitted sender)
Received: from [64.18.1.23] (HELO exprod6og109.obsmtp.com) (64.18.1.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:15:58 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob109.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyFuGTi7D4x1DH6SA0Wviajub+mffEbt@postini.com; Thu, 26 Jan 2012 07:15:38 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QFDh0Y020072
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 07:13:43 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0QFE4Pr019811
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 07:15:35 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 26 Jan 2012
 07:14:33 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Thu, 26 Jan 2012 15:14:32
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Thu, 26 Jan 2012 15:14:30 +0000
Subject: Re: Storing large number of files
Thread-Topic: Storing large number of files
Thread-Index: AczcPTSIZYgCjV9HQZ+5LEdpLSnVbw==
Message-ID: <CB472A02.235CC%mueller@adobe.com>
In-Reply-To: <BC51DFA6-EB65-4D21-8BD9-EA11E741EF71@gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

>As I understood filesystem model doesn't provide atomocity i.e no
>transactional support

I'm not sure if you read the data store documentation at
http://wiki.apache.org/jackrabbit/DataStore - the data store is
write-only, and doesn't require that much transactional support (what the
file system provided is sufficient). Also, the data store doesn't store
nodes, just binaries.

Regards,
Thomas


From dev-return-33939-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 15:21:47 2012
Return-Path: <dev-return-33939-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 10B179295
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 15:21:47 +0000 (UTC)
Received: (qmail 67155 invoked by uid 500); 26 Jan 2012 15:21:46 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 67105 invoked by uid 500); 26 Jan 2012 15:21:46 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 67098 invoked by uid 99); 26 Jan 2012 15:21:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:21:45 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of peri.subrahmanya@gmail.com designates 209.85.210.42 as permitted sender)
Received: from [209.85.210.42] (HELO mail-pz0-f42.google.com) (209.85.210.42)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:21:38 +0000
Received: by dalz17 with SMTP id z17so953468dal.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 07:21:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=Z+CUKFt4Pa00H4wE1znaLvObMWM4WQTqF/BLl1X+eNo=;
        b=WPM8NPqmxfZWViA29yG6Q1Y8WceQJHzOR5C2rZnGn0WC7rvyHytlHgHVg6ACq5V5Ae
         n53MW5HRbwX5vBjnTXF/vkowmjqO+gp6g5xILfAj1XaS/yORdk6kSW27qi9b7+5nBFVC
         Q/erQ0oT9RZhn7NfmrJYBXvSRRVaY2XuKtObc=
Received: by 10.68.73.68 with SMTP id j4mr5859932pbv.40.1327591277914;
        Thu, 26 Jan 2012 07:21:17 -0800 (PST)
Received: from [27.61.235.95] ([27.61.235.95])
        by mx.google.com with ESMTPS id o7sm12033087pbq.8.2012.01.26.07.21.15
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 26 Jan 2012 07:21:17 -0800 (PST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1251.1)
Subject: Re: Storing large number of files
From: Peri Subrahmanya <peri.subrahmanya@gmail.com>
In-Reply-To: <CB472A02.235CC%mueller@adobe.com>
Date: Thu, 26 Jan 2012 20:51:14 +0530
Content-Transfer-Encoding: quoted-printable
Message-Id: <B8FC1457-E2B7-47C9-9E50-9FF2ACAA1707@gmail.com>
References: <CB472A02.235CC%mueller@adobe.com>
To: dev@jackrabbit.apache.org
X-Mailer: Apple Mail (2.1251.1)

Thomas,

Thanks for the response. I did read the documentation and I think I got =
mixed up the on the information about datastore vs persistence managers =
in that the file based persistence managers are not atomic but the =
database persistence managers are. And in my case even though I am using =
FileDataStore for the DataStore, I am still using =
OraclePersistenceManager so I should be ok. You are right in your =
response that the file datastore would only store the binaries and not =
the nodes.

-PeriS

On Jan 26, 2012, at 8:44 PM, Thomas Mueller wrote:

> Hi,
>=20
>> As I understood filesystem model doesn't provide atomocity i.e no
>> transactional support
>=20
> I'm not sure if you read the data store documentation at
> http://wiki.apache.org/jackrabbit/DataStore - the data store is
> write-only, and doesn't require that much transactional support (what =
the
> file system provided is sufficient). Also, the data store doesn't =
store
> nodes, just binaries.
>=20
> Regards,
> Thomas
>=20


From dev-return-33940-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 15:51:02 2012
Return-Path: <dev-return-33940-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 35D9D9DDD
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 15:51:02 +0000 (UTC)
Received: (qmail 24331 invoked by uid 500); 26 Jan 2012 15:51:01 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 23967 invoked by uid 500); 26 Jan 2012 15:51:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 23942 invoked by uid 99); 26 Jan 2012 15:51:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:51:00 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:50:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CF766165150
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 15:50:38 +0000 (UTC)
Date: Thu, 26 Jan 2012 15:50:38 +0000 (UTC)
From: "Rohit Nijhawan (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Jackrabbit in Sling won't bootstrap against oracle
--------------------------------------------------

                 Key: JCR-3221
                 URL: https://issues.apache.org/jira/browse/JCR-3221
             Project: Jackrabbit Content Repository
          Issue Type: Test
          Components: config
         Environment: Windows 7, Java JRE 1.6.0_29
            Reporter: Rohit Nijhawan


1. Trying to use jackrabbit persistence config to Oracle under Sling 
2. Trying to run the jackrabbit standalone server against Oracle

in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.


And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...

I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.


2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated

	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33941-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 15:51:04 2012
Return-Path: <dev-return-33941-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9F43D9DF1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 15:51:04 +0000 (UTC)
Received: (qmail 24856 invoked by uid 500); 26 Jan 2012 15:51:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 24806 invoked by uid 500); 26 Jan 2012 15:51:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 24799 invoked by uid 99); 26 Jan 2012 15:51:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:51:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:51:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 8DFC1165159
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 15:50:39 +0000 (UTC)
Date: Thu, 26 Jan 2012 15:50:39 +0000 (UTC)
From: "Rohit Nijhawan (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <975914582.81682.1327593039583.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Rohit Nijhawan updated JCR-3221:
--------------------------------

    Affects Version/s: 2.2.10
    
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33942-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 15:57:28 2012
Return-Path: <dev-return-33942-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C0944914C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 15:57:28 +0000 (UTC)
Received: (qmail 34852 invoked by uid 500); 26 Jan 2012 15:57:28 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 34012 invoked by uid 500); 26 Jan 2012 15:57:26 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 34005 invoked by uid 99); 26 Jan 2012 15:57:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:57:26 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [64.18.1.21] (HELO exprod6og108.obsmtp.com) (64.18.1.21)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 15:57:18 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob108.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyF3yC1IweqzDEMRGcwuHvMd/7isgVKm@postini.com; Thu, 26 Jan 2012 07:56:58 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0QFuu2U013473
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 07:56:56 -0800 (PST)
Received: from nahub02.corp.adobe.com (nahub02.corp.adobe.com [10.8.189.98])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0QFutPl001895
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 07:56:55 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub02.corp.adobe.com
 (10.8.189.98) with Microsoft SMTP Server (TLS) id 8.3.192.1; Thu, 26 Jan 2012
 07:56:54 -0800
Received: from susi.local (10.136.140.129) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Thu, 26 Jan 2012
 15:56:52 +0000
Message-ID: <4F2177C4.1010904@apache.org>
Date: Thu, 26 Jan 2012 15:56:52 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] semantics of revisionId in commit method
References: <4F20306B.9030301@gmail.com> <CAFYk8NkE6zm1Azpd6301QYtqmc9JdkOidaU5FqPVcSQoTn_WbQ@mail.gmail.com>
In-Reply-To: <CAFYk8NkE6zm1Azpd6301QYtqmc9JdkOidaU5FqPVcSQoTn_WbQ@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for clarifying.

To summarize (if I got it right) the revision parameter specifies the 
base revision for a three way merge of the transient changes into the 
current head revision.

So this can actually be used to implement 1) (see 
http://markmail.org/message/e2ipk54t2bhrepab) right?

Michael

On 26.1.12 14:31, Stefan Guggisberg wrote:
> On Wed, Jan 25, 2012 at 5:40 PM, Michael Drig<michid@gmail.com>  wrote:
>>
>> Hi,
>>
>> Microkernel.commit() has a revisionId parameter. Could someone (Stefan?)
>> clarify the semantics of this parameter? The Javadoc only says "revision the
>> changes are based on". But it fails to explain the actual effect of that
>> parameter.
>
> the revisionId parameter of the commit method provides the
> context of the changes specified by the jsonDiff parameter.
>
> while it's true that all changes are always applied on the
> current HEAD revision, the 'baseRevision' of a commit allows
> for smarter 3-way merges/conflict resolutions.
>
> an example:
>
> assume a node /foo exists in rev0 of the tree and
> sessions s1 and s2 are both based on rev0.
>
> now s1 moves /foo to /bar while s2 sets a property on /foo :
>
> // s1
> mk.commit("/", ">\"foo\": \"bar\"", rev0, "");
> // s2
> mk.commit("/", "^\"foo/prop\" : \"blah\"", rev0, "");
>
> knowing the context of the commit (->  rev0) allows the
> 2nd commit to apply the property modification on /bar
> instead of throwing a "path not found: /foo" exception.
>
> please note that this specific use case is currently not
> yet implemented in MicroKernelImpl.
>
> cheers
> stefan
>
>>
>> Michael

From dev-return-33943-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 16:28:51 2012
Return-Path: <dev-return-33943-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DB7139F78
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 16:28:50 +0000 (UTC)
Received: (qmail 3752 invoked by uid 500); 26 Jan 2012 16:28:50 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 3669 invoked by uid 500); 26 Jan 2012 16:28:49 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 3662 invoked by uid 99); 26 Jan 2012 16:28:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 16:28:49 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 16:28:44 +0000
Received: by iaoo28 with SMTP id o28so2294509iao.1
        for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 08:28:24 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=kTvU/SdTFIMmPnx5GTF84PPDw+j03LUdBceeVQaDyIE=;
        b=NRoLDUKW10wf+kZ5nGT4pxhLQYVszEsJI0wpKut3I4RnrHLTLCyf0wfPiUCc7xMAiK
         LzzWvDf2aJCzLk7s6XQ2AcVy4xzSxJavnS7MEf2B3dh5a3vM84BbFtPWN8NIVe9qAv4o
         8Fv6moq2N7HOoqqdUqp+mQhXLPcsD+YMYefEw=
MIME-Version: 1.0
Received: by 10.50.42.199 with SMTP id q7mr2877827igl.9.1327595302640; Thu, 26
 Jan 2012 08:28:22 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Thu, 26 Jan 2012 08:28:22 -0800 (PST)
In-Reply-To: <4F2177C4.1010904@apache.org>
References: <4F20306B.9030301@gmail.com>
	<CAFYk8NkE6zm1Azpd6301QYtqmc9JdkOidaU5FqPVcSQoTn_WbQ@mail.gmail.com>
	<4F2177C4.1010904@apache.org>
Date: Thu, 26 Jan 2012 17:28:22 +0100
Message-ID: <CAFYk8Nk-KhWnL51jhxBcTVwKw-BS8jv3E7Qvf2Rna2C0AnqXYQ@mail.gmail.com>
Subject: Re: [jr3 Microkernel] semantics of revisionId in commit method
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Thu, Jan 26, 2012 at 4:56 PM, Michael D=FCrig <mduerig@apache.org> wrote=
:
>
> Thanks for clarifying.
>
> To summarize (if I got it right) the revision parameter specifies the bas=
e
> revision for a three way merge of the transient changes into the current
> head revision.

correct

>
> So this can actually be used to implement 1) (see
> http://markmail.org/message/e2ipk54t2bhrepab) right?

yes

cheers
stefan

>
> Michael
>
>
> On 26.1.12 14:31, Stefan Guggisberg wrote:
>>
>> On Wed, Jan 25, 2012 at 5:40 PM, Michael D=FCrig<michid@gmail.com> =A0wr=
ote:
>>>
>>>
>>> Hi,
>>>
>>> Microkernel.commit() has a revisionId parameter. Could someone (Stefan?=
)
>>> clarify the semantics of this parameter? The Javadoc only says "revisio=
n
>>> the
>>> changes are based on". But it fails to explain the actual effect of tha=
t
>>> parameter.
>>
>>
>> the revisionId parameter of the commit method provides the
>> context of the changes specified by the jsonDiff parameter.
>>
>> while it's true that all changes are always applied on the
>> current HEAD revision, the 'baseRevision' of a commit allows
>> for smarter 3-way merges/conflict resolutions.
>>
>> an example:
>>
>> assume a node /foo exists in rev0 of the tree and
>> sessions s1 and s2 are both based on rev0.
>>
>> now s1 moves /foo to /bar while s2 sets a property on /foo :
>>
>> // s1
>> mk.commit("/", ">\"foo\": \"bar\"", rev0, "");
>> // s2
>> mk.commit("/", "^\"foo/prop\" : \"blah\"", rev0, "");
>>
>> knowing the context of the commit (-> =A0rev0) allows the
>> 2nd commit to apply the property modification on /bar
>> instead of throwing a "path not found: /foo" exception.
>>
>> please note that this specific use case is currently not
>> yet implemented in MicroKernelImpl.
>>
>> cheers
>> stefan
>>
>>>
>>> Michael

From dev-return-33944-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 18:05:02 2012
Return-Path: <dev-return-33944-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 923B19001
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 18:05:02 +0000 (UTC)
Received: (qmail 8040 invoked by uid 500); 26 Jan 2012 18:05:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 7979 invoked by uid 500); 26 Jan 2012 18:05:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 7972 invoked by uid 99); 26 Jan 2012 18:05:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 18:05:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 18:04:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 5DA22165C2D
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 18:04:38 +0000 (UTC)
Date: Thu, 26 Jan 2012 18:04:38 +0000 (UTC)
From: "Jukka Zitting (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3222) Allow servlet filters to specify custom
 session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org

Allow servlet filters to specify custom session providers
---------------------------------------------------------

                 Key: JCR-3222
                 URL: https://issues.apache.org/jira/browse/JCR-3222
             Project: Jackrabbit Content Repository
          Issue Type: Improvement
          Components: jackrabbit-jcr-server
            Reporter: Jukka Zitting
            Priority: Minor


In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.

One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33945-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 18:19:02 2012
Return-Path: <dev-return-33945-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BA32199F9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 18:19:02 +0000 (UTC)
Received: (qmail 38157 invoked by uid 500); 26 Jan 2012 18:19:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 38013 invoked by uid 500); 26 Jan 2012 18:19:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 37996 invoked by uid 99); 26 Jan 2012 18:19:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 18:19:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 18:18:59 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 5E4A316442B
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 18:18:38 +0000 (UTC)
Date: Thu, 26 Jan 2012 18:18:38 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <693643279.82118.1327601918387.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3222) Allow servlet filters to specify custom
 session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3222:
-------------------------------

    Attachment: jackrabbit-jcr-server-2.6-SNAPSHOT.jar

Proposed patch.
                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33946-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 18:54:07 2012
Return-Path: <dev-return-33946-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DB7A29054
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 18:54:06 +0000 (UTC)
Received: (qmail 21387 invoked by uid 500); 26 Jan 2012 18:54:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 21083 invoked by uid 500); 26 Jan 2012 18:54:05 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 21074 invoked by uid 99); 26 Jan 2012 18:54:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 18:54:05 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 18:54:03 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 36E5B1656DD
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 18:53:42 +0000 (UTC)
Date: Thu, 26 Jan 2012 18:53:42 +0000 (UTC)
From: "Felix Meschberger (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <589119080.82233.1327604022226.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3222) Allow servlet filters to specify
 custom session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13194074#comment-13194074 ] 

Felix Meschberger commented on JCR-3222:
----------------------------------------

Unfortunately this is a compiled library and I cannot see, what's changed ....

But then, somehow this feels like official Reflection Programming ....

How about using OSGi services ?

(0) The DavexServletService is already registered as a Servlet service for Whiteboard Http Service registration
(1) We could add a contextId configuration which could be configured to refer to a HttpContext service used by the Whiteboard registration
(2) Support a SessionProvider service providing pluggability

Sling (or other OSGi based use cases) could then just provide the missing pieces.

Will provide a proposed patch.
                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33947-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 19:14:04 2012
Return-Path: <dev-return-33947-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1947C97D4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 19:14:04 +0000 (UTC)
Received: (qmail 54799 invoked by uid 500); 26 Jan 2012 19:14:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 54610 invoked by uid 500); 26 Jan 2012 19:14:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 54602 invoked by uid 99); 26 Jan 2012 19:14:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 19:14:02 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 19:14:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id B1052165FCF
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 19:13:41 +0000 (UTC)
Date: Thu, 26 Jan 2012 19:13:41 +0000 (UTC)
From: "Felix Meschberger (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <697839019.82347.1327605221726.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3222) Allow servlet filters to specify custom
 session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Felix Meschberger updated JCR-3222:
-----------------------------------

    Attachment: JCR-3222-fmeschbe.patch

Proposed patch enhancing DavexServletService
                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: JCR-3222-fmeschbe.patch, jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33948-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Thu Jan 26 21:12:03 2012
Return-Path: <dev-return-33948-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 23ED09282
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Thu, 26 Jan 2012 21:12:03 +0000 (UTC)
Received: (qmail 60608 invoked by uid 500); 26 Jan 2012 21:12:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 60507 invoked by uid 500); 26 Jan 2012 21:12:02 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 60500 invoked by uid 99); 26 Jan 2012 21:12:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 21:12:01 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 26 Jan 2012 21:12:00 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id D7CD31653B1
	for <dev@jackrabbit.apache.org>; Thu, 26 Jan 2012 21:11:40 +0000 (UTC)
Date: Thu, 26 Jan 2012 21:11:40 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1531523119.82822.1327612300885.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3222) Allow servlet filters to specify
 custom session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13194180#comment-13194180 ] 

Jukka Zitting commented on JCR-3222:
------------------------------------

I considered the OSGi whiteboard pattern for this, but it doesn't work for the Sling davex bundle. The Sling authentication code needs to be able to take over the entire processing of a request instead of just servicing a getSession() call. Thus a Sling component that interacts with the default Jackrabbit davex servlet in any case needs to be set up as a servlet filter (or a subclass like it currently is). Therefore passing the appropriate SessionProvider as a request attribute is IMHO a much more straightforward solution. And it works nicely also in non-OSGi deployments.
                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: JCR-3222-fmeschbe.patch, jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33949-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 06:10:13 2012
Return-Path: <dev-return-33949-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9D520980E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 06:10:13 +0000 (UTC)
Received: (qmail 52188 invoked by uid 500); 27 Jan 2012 06:10:12 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 51541 invoked by uid 500); 27 Jan 2012 06:10:06 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 51492 invoked by uid 99); 27 Jan 2012 06:10:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 06:10:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 06:10:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A5D44165E5F
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 06:09:41 +0000 (UTC)
Date: Fri, 27 Jan 2012 06:09:41 +0000 (UTC)
From: "Felix Meschberger (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1739212397.84640.1327644581680.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3222) Allow servlet filters to specify
 custom session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13194507#comment-13194507 ] 

Felix Meschberger commented on JCR-3222:
----------------------------------------

> The Sling authentication code needs to be able to take over the entire processing of a request instead of just servicing a getSession() call. 

This is wrong.

The DavexServletService is registered as a servlet service and gets processing the request from the service call. A service in OSGi registered along with an Osgi HttpContext object which has a handleSecurity method, which handles authentication before the servlet is even called. By having a contextId service property a whiteboard servlet service can refer to a whiteboard HttpContext service which implements that method accordingly.

Thus my patch allows to plug a HttpContext service which we in Sling can provide to call the Sling authentication processing. This then makes the ResourceResolver and hence the Session available to the servlet.

Inside the servlet, the patch implements the getSessionProvider method to return a proxy SessionProvider which either provides a registered SessionProvider service or returns the default from the parent class. Sling will den provide a SessionProvider service which knows about the Sling authentication and can extract the session from the ResourceResolver.

Existing uses of the JcrRemotingServlet need not be changed as does the JcrRemotingServlet. Everything is done in the DavexServletService with proper OSGi oriented actions -- except for the ResourceResolver defined as a request attribute, which we already have.
                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: JCR-3222-fmeschbe.patch, jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33950-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 08:51:19 2012
Return-Path: <dev-return-33950-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3C0FF98CB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 08:51:19 +0000 (UTC)
Received: (qmail 20217 invoked by uid 500); 27 Jan 2012 08:51:18 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 18546 invoked by uid 500); 27 Jan 2012 08:51:10 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 18534 invoked by uid 99); 27 Jan 2012 08:51:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 08:51:08 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanhalderen@1hippo.com designates 64.18.2.215 as permitted sender)
Received: from [64.18.2.215] (HELO exprod7og114.obsmtp.com) (64.18.2.215)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 27 Jan 2012 08:50:59 +0000
Received: from mail-tul01m020-f169.google.com ([209.85.214.169]) (using TLSv1) by exprod7ob114.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTyJlXgGTwvwJ8b3ZRzK/L5+DOfBhkZRM@postini.com; Fri, 27 Jan 2012 00:50:39 PST
Received: by mail-tul01m020-f169.google.com with SMTP id ta7so2008755obb.14
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 00:50:38 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.47.10 with SMTP id z10mr5594440obm.19.1327654237969; Fri,
 27 Jan 2012 00:50:37 -0800 (PST)
Received: by 10.182.37.164 with HTTP; Fri, 27 Jan 2012 00:50:37 -0800 (PST)
Date: Fri, 27 Jan 2012 09:50:37 +0100
Message-ID: <CAEbjtkjktyJPU29S-532_rbJTJ_ggiNXcqS8FjCATE+KboOVOw@mail.gmail.com>
Subject: Clustering persistent storage consistency issues
From: Berry van Halderen <b.vanhalderen@1hippo.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

  Dear devs,

Recently I dove into some issues that plagued our production systems,
where consistency checks regularly showed that some nodes are not quite as
they should be.  Mainly orphaned nodes (nodes no longer being referenced
from their supposed parent), but also missing child nodes (nodes being
referenced from a parent, but non-existent in the database) and wrongly
located child nodes (nodes referenced as a child from a parent, but the
actual node indicates a different parent).  There were some others as
well, but these were most prominent.

Now there is a lock of additional logic on top of Jackrabbit, so it took
some time narrowing down the actual issue, but I've been able to confirm
the issue due to clustering.  We intensively use set-ups of Jackrabbit
that are clustered.  Multiple Jackrabbit instances, with a single MySQL
database which includes the binary storage (so no NFS needed).  We also
use no JCR locking and no transactions, and it may be that when using
those the issue becomes less that in our case.  But I believe that even
with using JCR locking and/or transactions there is still the possibility
of the above consistencies issues.

To show where I think it is going wrong let me go to the logic of the
clustering as I think it works.
Before a JCR save action, the journal table in the database is
consulted.  If there are logged actions performed by other Jackrabbit
instances in the cluster than these actions are imported/replayed first
(SharedItemStateManager.doExternalUpdate).  Then the actual changes
are written to the database.  Where this fails, it that in between the
check for external updates and actually writing stuff into the database,
there might actually be update performed by another Jackrabbit instance.
And in case these happen to be at the same node, we will simply overwrite
the changes of the other node.
This is not just a failed action, or even lost data, but actually
inconsistencies will occur.

I've been able to confirm this using a unit test bashing two cluster
nodes over jcr-rmi.

There are solutions to this, however they come at a hefty price, one of
them I've got working.  One of my first attempt was to introduce a
modification count column in the bundle data table.  This field is
actually a duplication of the modcount in the bundle itself, but then
when updating a bundle you'll update using "UPDATE .. WHERE id = ?
AND modcount = 'expected-old-modcount'"  You end up with some additional
plumbing to remember the old persisted modcount.  This does work
in part, no changes are overwritten.
However because Jackrabbit writes a changelog using individual updates
without a transaction, the other actions will go through, while it
should be all-or-nothing.  The options which works is to then use
transactions at this low level, but this is quite expensive.

I've tested this, and then all consistency issues go away.

There are other options, like locking tables, using a journal,
but all these options I think of are quite intrusive also, while a
simple fix at code level without creating cluster barriers seems
infeasible.  But again my current fix isn't that nice either.

But perhaps you have other ideas concerning this problem?

\Berry

From dev-return-33951-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 09:36:50 2012
Return-Path: <dev-return-33951-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E77DA9CC4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 09:36:49 +0000 (UTC)
Received: (qmail 81259 invoked by uid 500); 27 Jan 2012 09:36:48 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 80785 invoked by uid 500); 27 Jan 2012 09:36:36 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 80749 invoked by uid 99); 27 Jan 2012 09:36:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 09:36:27 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanhalderen@1hippo.com designates 64.18.2.177 as permitted sender)
Received: from [64.18.2.177] (HELO exprod7og112.obsmtp.com) (64.18.2.177)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 27 Jan 2012 09:36:19 +0000
Received: from mail-tul01m020-f181.google.com ([209.85.214.181]) (using TLSv1) by exprod7ob112.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTyJv/Q1wyFX8oWYjAkR6X5vnGUE/JOe6@postini.com; Fri, 27 Jan 2012 01:35:58 PST
Received: by mail-tul01m020-f181.google.com with SMTP id up10so1791665obb.12
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 01:35:57 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.54.80 with SMTP id h16mr5628947obp.59.1327656957406; Fri,
 27 Jan 2012 01:35:57 -0800 (PST)
Received: by 10.182.37.164 with HTTP; Fri, 27 Jan 2012 01:35:57 -0800 (PST)
In-Reply-To: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
References: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
Date: Fri, 27 Jan 2012 10:35:57 +0100
Message-ID: <CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
Subject: Re: Reloading node types in clustered environment
From: Berry van Halderen <b.vanhalderen@1hippo.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Dec 6, 2011 at 4:40 PM, Berry van Halderen
<b.vanhalderen@1hippo.com> wrote:
> We've run into log messages that have come us to suspect one of our
> practices, namely to reregister node types. =A0The reregistering occurs
> in a clustered environment, where other clustered nodes keep on using
> the node types, but on rare occasion certain exceptions are thrown,
> most particular an exception from getEffetiveNodeType when retrieving
> a node from the persistent store. =A0I've still to evaluate if it is
> indeed the case, but we're wondering if it is at all safe to do
> changing node type operations in a clustered environment.
> Note, before 2.2.x we did not see these kind of errors, currently on
> 2.2.9 we are.

I was able myself to track it down.  It turns out that before
re-registering there
was also a call to unregister a node type. That caused a small gap
between the unregister and the re-register where other cluster nodes could
have received the unregister but not the new type.

I've fixed this in our own code, but still I'm a bit worried about this cha=
nge
of behavior It used to be impossible to unregister a node type when it
was still in use (or at least never to unregister a node type).  Not being
able to unregister a node type when still in use seems to be the most
correct semantics.

But what actually happened in Jackrabbit was actually quite scary.
By being able to unregister a node type in use, other nodes load and
modify a node with a mixin type that is being unregistered.  The
mixin type is silently dropped from the node, but any properties tied
to the mixin node type are kept.  There is a window where such a
node can be persisted back into database.

What is then left in the persisted storage is a node with properties
that cannot be part of that node according to its node type.  And
this node cannot be loaded, cannot be deleted, cannot be fixed.
The only option is to go into sql level to delete the node or fix the
binary bundle data stored in the record.

Maybe it's a good idea that we're not able to remove node types that
are still in use, wdyt?

\Berry

From dev-return-33952-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 10:16:52 2012
Return-Path: <dev-return-33952-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2E33B9707
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 10:16:52 +0000 (UTC)
Received: (qmail 24830 invoked by uid 500); 27 Jan 2012 10:16:51 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 24556 invoked by uid 500); 27 Jan 2012 10:16:47 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 24545 invoked by uid 99); 27 Jan 2012 10:16:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:16:44 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:16:38 +0000
Received: by werm1 with SMTP id m1so2474375wer.1
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 02:16:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=zHfERNlnJpFTg1sewNv60DMxVM9q42hy21vlmpAGyQw=;
        b=FibzC6rpKjTZX/7QyLHfvNBm+io/xi/cY14iHCQAgY/eZ0NUxhElL0PfukoZzHx4rb
         tjKqdzjtjAmHJyfws0iGGKOyeY/7A7XRXwKyQcFqM7pmep9R4gzWANPb7aZ466DGPHc7
         lC/k6kyMqn3YW4Z1w7RwG3js2IUvggLk3NbWc=
Received: by 10.216.135.91 with SMTP id t69mr2498584wei.33.1327659377111; Fri,
 27 Jan 2012 02:16:17 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Fri, 27 Jan 2012 02:15:57 -0800 (PST)
In-Reply-To: <CAEbjtkjktyJPU29S-532_rbJTJ_ggiNXcqS8FjCATE+KboOVOw@mail.gmail.com>
References: <CAEbjtkjktyJPU29S-532_rbJTJ_ggiNXcqS8FjCATE+KboOVOw@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Fri, 27 Jan 2012 11:15:57 +0100
Message-ID: <CAOFYJNYMZinahPYJrr16AdhFXNZqFxp4ovB6-Sf3psyFi8u4WQ@mail.gmail.com>
Subject: Re: Clustering persistent storage consistency issues
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

On Fri, Jan 27, 2012 at 9:50 AM, Berry van Halderen
<b.vanhalderen@1hippo.com> wrote:
> Before a JCR save action, the journal table in the database is
> consulted. =A0If there are logged actions performed by other Jackrabbit
> instances in the cluster than these actions are imported/replayed first
> (SharedItemStateManager.doExternalUpdate). =A0Then the actual changes
> are written to the database. =A0Where this fails, it that in between the
> check for external updates and actually writing stuff into the database,
> there might actually be update performed by another Jackrabbit instance.

That shouldn't be possible since the first cluster node should be
holding the cluster lock during the entire "update-persist" operation.
Thus another cluster node shouldn't be able to make any concurrent
changes.

BR,

Jukka Zitting

From dev-return-33953-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 10:30:59 2012
Return-Path: <dev-return-33953-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B298C931F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 10:30:59 +0000 (UTC)
Received: (qmail 39224 invoked by uid 500); 27 Jan 2012 10:30:59 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 39086 invoked by uid 500); 27 Jan 2012 10:30:57 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 39079 invoked by uid 99); 27 Jan 2012 10:30:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:30:57 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.50 as permitted sender)
Received: from [74.125.82.50] (HELO mail-ww0-f50.google.com) (74.125.82.50)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:30:52 +0000
Received: by wgbdr11 with SMTP id dr11so1637719wgb.19
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 02:30:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=SRPNduzcfLYCABjrS9T8yTUnHLPUuZg2cQkQPKWTim0=;
        b=Xyy3X1NxnQZNpmTchyj4/ogpVo2Hv17nBGrga0OuOppP3tX6DmjwNACICg65szrxly
         AzTwGq35fQmlR6sewNLGhHv8CQ6N9FfZtxL+M1o//L31IGAP5NVzvfcpvpdxvmH/IOYI
         AJrNveebucl8Q8uB6DY2D7LjavhOyLv7/lR6c=
Received: by 10.180.99.225 with SMTP id et1mr9967611wib.2.1327660231114; Fri,
 27 Jan 2012 02:30:31 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Fri, 27 Jan 2012 02:30:11 -0800 (PST)
In-Reply-To: <CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
References: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
 <CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Fri, 27 Jan 2012 11:30:11 +0100
Message-ID: <CAOFYJNacOM1gJxWaXtKQeEtpyMmWeOenxk7Pvc3MDDSkZCnY0w@mail.gmail.com>
Subject: Re: Reloading node types in clustered environment
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

On Fri, Jan 27, 2012 at 10:35 AM, Berry van Halderen
<b.vanhalderen@1hippo.com> wrote:
> I've fixed this in our own code, but still I'm a bit worried about this c=
hange
> of behavior It used to be impossible to unregister a node type when it
> was still in use (or at least never to unregister a node type). =A0Not be=
ing
> able to unregister a node type when still in use seems to be the most
> correct semantics.

That should still be the case. The
NodeTypeRegistry.unregisterNodeTypes() method calls the protected
checkForReferencesInContent() method before actually removing the
type. The default implementation of checkForReferencesInContent()
simply throws a RepositoryException with a "not yet implemented"
message, which in practice prevents any node types from being
unregisted.

Until a the checkForReferencesInContent() is properly implemented (see
the javadoc for ideas on how to do that), it's possible for downstream
projects or deployments to override the method in case they already
have some other mechanism for guaranteeing that a node type can safely
be removed. I suppose the repository you're using does override the
method, but doesn't give such a strong guarantee of consistency.

BR,

Jukka Zitting

From dev-return-33954-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 10:32:06 2012
Return-Path: <dev-return-33954-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5D29D933F
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 10:32:06 +0000 (UTC)
Received: (qmail 40047 invoked by uid 500); 27 Jan 2012 10:32:06 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 39753 invoked by uid 500); 27 Jan 2012 10:32:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 39621 invoked by uid 99); 27 Jan 2012 10:32:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:32:04 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:31:59 +0000
Received: by iaoo28 with SMTP id o28so4601256iao.1
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 02:31:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=LEVCCsMlMuL3yKf/14YIk+5UWR+3C+2lmg3Qj8H+rMk=;
        b=Wo//Ks0crBr9LzG6WYQldih6YmVdLoaYDQAoN72VX63RA93Ux63bRaVhUyX7oU2w2W
         v14QDkSZcFsZ0uHf6KrqbQlttx17rfR1YKImIivyjZ8GVxFWMJ6uDVkSOdR8k/DlGhZf
         HX1E9PThrTngh9pL7S53SL1HrUokYdRh6pUM0=
MIME-Version: 1.0
Received: by 10.50.236.5 with SMTP id uq5mr5702278igc.13.1327660298800; Fri,
 27 Jan 2012 02:31:38 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Fri, 27 Jan 2012 02:31:38 -0800 (PST)
In-Reply-To: <CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
References: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
	<CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
Date: Fri, 27 Jan 2012 11:31:38 +0100
Message-ID: <CAFYk8N=oqW6CZ3nHj7W+wu0q7dK5ygx6ignjxRH0GvwFgquFPw@mail.gmail.com>
Subject: Re: Reloading node types in clustered environment
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Fri, Jan 27, 2012 at 10:35 AM, Berry van Halderen
<b.vanhalderen@1hippo.com> wrote:
> On Tue, Dec 6, 2011 at 4:40 PM, Berry van Halderen
> <b.vanhalderen@1hippo.com> wrote:
>> We've run into log messages that have come us to suspect one of our
>> practices, namely to reregister node types. =A0The reregistering occurs
>> in a clustered environment, where other clustered nodes keep on using
>> the node types, but on rare occasion certain exceptions are thrown,
>> most particular an exception from getEffetiveNodeType when retrieving
>> a node from the persistent store. =A0I've still to evaluate if it is
>> indeed the case, but we're wondering if it is at all safe to do
>> changing node type operations in a clustered environment.
>> Note, before 2.2.x we did not see these kind of errors, currently on
>> 2.2.9 we are.
>
> I was able myself to track it down. =A0It turns out that before
> re-registering there
> was also a call to unregister a node type. That caused a small gap
> between the unregister and the re-register where other cluster nodes coul=
d
> have received the unregister but not the new type.
>
> I've fixed this in our own code, but still I'm a bit worried about this c=
hange
> of behavior It used to be impossible to unregister a node type when it
> was still in use (or at least never to unregister a node type). =A0Not be=
ing
> able to unregister a node type when still in use seems to be the most
> correct semantics.

agreed, but unortunately also the most expensive/difficult to implement...

AFAIK it's currently not possible to unregister a node type through the
public api (javax.jcr.NodeTypeManager#unregisterNodeType)

the key here is the following method:

NodeTypeRegistry.checkForReferencesInContent()

this method currently throws unconditionally. the javadoc explains
why.

>
> But what actually happened in Jackrabbit was actually quite scary.
> By being able to unregister a node type in use, other nodes load and
> modify a node with a mixin type that is being unregistered. =A0The
> mixin type is silently dropped from the node, but any properties tied
> to the mixin node type are kept. =A0There is a window where such a
> node can be persisted back into database.
>
> What is then left in the persisted storage is a node with properties
> that cannot be part of that node according to its node type. =A0And
> this node cannot be loaded, cannot be deleted, cannot be fixed.
> The only option is to go into sql level to delete the node or fix the
> binary bundle data stored in the record.
>
> Maybe it's a good idea that we're not able to remove node types that
> are still in use, wdyt?

theoretically, yes. the hard part is to determine whether it's
actually in use...

cheers
stefan
>
> \Berry

From dev-return-33955-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 10:37:35 2012
Return-Path: <dev-return-33955-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C5B53958B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 10:37:35 +0000 (UTC)
Received: (qmail 42530 invoked by uid 500); 27 Jan 2012 10:37:34 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 42480 invoked by uid 500); 27 Jan 2012 10:37:34 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 42472 invoked by uid 99); 27 Jan 2012 10:37:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:37:33 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 10:37:28 +0000
Received: by iaoo28 with SMTP id o28so4616456iao.1
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 02:37:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=7H9Oeu5/LIphGSNMrPzwDgZqD8gNej4wcYHDMk3Wajw=;
        b=VXkRsJi/1rU/Nl37/6OoQcBOFvsxc0f9O6MW3CebvyHbG84Nx4+KsY//pUtvnCvr9c
         h3ZunIUhIakLbzNb7UnbIY4G7JH1quWgq/Bhw/ZECMvtSkmQLoP53wANtnfFyPNFbO2e
         TakIUtCOm3aQOJkaxXfzlbtiMRb0Gdd5mJAvU=
MIME-Version: 1.0
Received: by 10.50.156.196 with SMTP id wg4mr6068166igb.13.1327660628221; Fri,
 27 Jan 2012 02:37:08 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Fri, 27 Jan 2012 02:37:08 -0800 (PST)
In-Reply-To: <CAOFYJNacOM1gJxWaXtKQeEtpyMmWeOenxk7Pvc3MDDSkZCnY0w@mail.gmail.com>
References: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
	<CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
	<CAOFYJNacOM1gJxWaXtKQeEtpyMmWeOenxk7Pvc3MDDSkZCnY0w@mail.gmail.com>
Date: Fri, 27 Jan 2012 11:37:08 +0100
Message-ID: <CAFYk8N=pCDHyD-TvOGG0f=2soV0kD3+Rg4rG0gbhGYHp0zsqtQ@mail.gmail.com>
Subject: Re: Reloading node types in clustered environment
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Fri, Jan 27, 2012 at 11:30 AM, Jukka Zitting <jukka.zitting@gmail.com> w=
rote:
> Hi,
>
> On Fri, Jan 27, 2012 at 10:35 AM, Berry van Halderen
> <b.vanhalderen@1hippo.com> wrote:
>> I've fixed this in our own code, but still I'm a bit worried about this =
change
>> of behavior It used to be impossible to unregister a node type when it
>> was still in use (or at least never to unregister a node type). =A0Not b=
eing
>> able to unregister a node type when still in use seems to be the most
>> correct semantics.
>
> That should still be the case. The
> NodeTypeRegistry.unregisterNodeTypes() method calls the protected
> checkForReferencesInContent() method before actually removing the
> type. The default implementation of checkForReferencesInContent()
> simply throws a RepositoryException with a "not yet implemented"
> message, which in practice prevents any node types from being
> unregisted.
>
> Until a the checkForReferencesInContent() is properly implemented (see
> the javadoc for ideas on how to do that), it's possible for downstream
> projects or deployments to override the method in case they already
> have some other mechanism for guaranteeing that a node type can safely
> be removed. I suppose the repository you're using does override the
> method, but doesn't give such a strong guarantee of consistency.
>

doh! jukka beat me by a few seconds ;)

cheers
stefan

> BR,
>
> Jukka Zitting

From dev-return-33956-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 12:54:25 2012
Return-Path: <dev-return-33956-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4C459965C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 12:54:25 +0000 (UTC)
Received: (qmail 12090 invoked by uid 500); 27 Jan 2012 12:54:25 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 11936 invoked by uid 500); 27 Jan 2012 12:54:24 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 11920 invoked by uid 99); 27 Jan 2012 12:54:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 12:54:24 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 12:54:21 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id C29D11661EC
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 12:54:00 +0000 (UTC)
Date: Fri, 27 Jan 2012 12:54:00 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <2050842468.85445.1327668840798.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3222) Allow servlet filters to specify
 custom session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13194663#comment-13194663 ] 

Jukka Zitting commented on JCR-3222:
------------------------------------

> This is wrong. 

That's what the HttpContext.handleSecurity() method does, right? It's needs to be able to take over the entire processing of a request.

> By having a contextId service property a whiteboard servlet service can refer to a whiteboard
> HttpContext service which implements that method accordingly.

You need some code to actually implement the HttpContext interface. That code could simply do request.setAttribute(SessionProvider.class.getName(), customSessionProvider) in the handleSecurity() method, right? I don't see why the SessionProvider instance would need to be an OSGi service in this case.

Of course, if there is a case why some component would want to implement the SessionProvider interface without the ability to terminate request processing or to send a custom HTTP response, then I could see why accessing SessionProviders as OSGi services would be useful. In such a case though, we should support potentially more than just a single SessionProvider service and make sure that the releaseSession() calls get routed to the correct provider (which your current patch doesn't guarantee).

                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: JCR-3222-fmeschbe.patch, jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33957-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 13:26:43 2012
Return-Path: <dev-return-33957-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ACF1A9C87
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 13:26:43 +0000 (UTC)
Received: (qmail 51112 invoked by uid 500); 27 Jan 2012 13:26:43 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 51007 invoked by uid 500); 27 Jan 2012 13:26:42 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 51000 invoked by uid 99); 27 Jan 2012 13:26:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 13:26:42 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of b.vanhalderen@1hippo.com designates 64.18.2.171 as permitted sender)
Received: from [64.18.2.171] (HELO exprod7og109.obsmtp.com) (64.18.2.171)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 27 Jan 2012 13:26:36 +0000
Received: from mail-tul01m020-f179.google.com ([209.85.214.179]) (using TLSv1) by exprod7ob109.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTyKl9ze0b1gLVM8pbPbpbDrfnkr9cOh5@postini.com; Fri, 27 Jan 2012 05:26:15 PST
Received: by mail-tul01m020-f179.google.com with SMTP id up6so1496642obb.10
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 05:26:15 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.41.5 with SMTP id b5mr6341303obl.79.1327670775050; Fri, 27
 Jan 2012 05:26:15 -0800 (PST)
Received: by 10.182.37.164 with HTTP; Fri, 27 Jan 2012 05:26:15 -0800 (PST)
In-Reply-To: <CAOFYJNacOM1gJxWaXtKQeEtpyMmWeOenxk7Pvc3MDDSkZCnY0w@mail.gmail.com>
References: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
	<CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
	<CAOFYJNacOM1gJxWaXtKQeEtpyMmWeOenxk7Pvc3MDDSkZCnY0w@mail.gmail.com>
Date: Fri, 27 Jan 2012 14:26:15 +0100
Message-ID: <CAEbjtkiuxCE3Zc95+4S9FU0KYdUsF7ksu9KpJq6g2ajoxzm+oA@mail.gmail.com>
Subject: Re: Reloading node types in clustered environment
From: Berry van Halderen <b.vanhalderen@1hippo.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Fri, Jan 27, 2012 at 11:30 AM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> On Fri, Jan 27, 2012 at 10:35 AM, Berry van Halderen
> <b.vanhalderen@1hippo.com> wrote:
> That should still be the case. The
> NodeTypeRegistry.unregisterNodeTypes() method calls the protected
> checkForReferencesInContent() method before actually removing the
> type. The default implementation of checkForReferencesInContent()
> simply throws a RepositoryException with a "not yet implemented"
> message, which in practice prevents any node types from being
> unregisted.

Which is the problem actually, the throw statement in
checkForReferencesInContent() is commented out in the 2.2.x versions.
Small investigation shows that some fix for JCR-2587 inadvertently
contained this change, which was reverted (much) later on the trunk,
but after the 2.1.x and 2.2.x branch were made.
Hence this will work on trunk and 2.3.x, but not on 2.1.x and 2.2.x
branches.
Though not a big issue, I'd like to merge this change also back
into the 2.1.x and 2.2.x branches (unless objections, I'll do this).

\Berry

From dev-return-33958-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 13:27:04 2012
Return-Path: <dev-return-33958-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 62F399E94
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 13:27:04 +0000 (UTC)
Received: (qmail 51701 invoked by uid 500); 27 Jan 2012 13:27:04 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 51663 invoked by uid 500); 27 Jan 2012 13:27:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 51656 invoked by uid 99); 27 Jan 2012 13:27:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 13:27:03 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 13:27:01 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 60B9216658A
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 13:26:40 +0000 (UTC)
Date: Fri, 27 Jan 2012 13:26:40 +0000 (UTC)
From: "Felix Meschberger (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1114005866.85620.1327670800398.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3222) Allow servlet filters to specify
 custom session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13194699#comment-13194699 ] 

Felix Meschberger commented on JCR-3222:
----------------------------------------

> That's what the HttpContext.handleSecurity() method does, right? It's needs to be able to take over the entire processing of a request. 

No, this is called by the Http Service before calling the servlet. The handleSecurity method either returns true in which case the servlet is called or false in which case the request is terminated and the servlet is not called.

The handleSecurity method must set up to three request attributes which are used to implement HttpServletRequest methods (getRemoteUser, getAuthType, getUserPrincipal). In addition the Sling implementation could provide the ResourceResolver (what we do in the Sling DavEx bundle.

The handleSecurity method could of course set the SessionProvider, too. But I don't like this -- special case handling affecting all but used by one only.

In addtion: unless you will be implementing a special proxy SessionProvider looking for the actual provider on each request, the getSessionProvider() method is AFAICT only called once no matter how many different SessionProviders are found in the request attributes... The SessionProvider is not something request specific but something setup specific. Hence a service and not request attribute.
                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: JCR-3222-fmeschbe.patch, jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33959-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 13:27:47 2012
Return-Path: <dev-return-33959-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 388179254
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 13:27:47 +0000 (UTC)
Received: (qmail 52352 invoked by uid 500); 27 Jan 2012 13:27:46 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52129 invoked by uid 500); 27 Jan 2012 13:27:46 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 52121 invoked by uid 99); 27 Jan 2012 13:27:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 13:27:46 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of b.vanhalderen@1hippo.com designates 64.18.2.28 as permitted sender)
Received: from [64.18.2.28] (HELO exprod7og125.obsmtp.com) (64.18.2.28)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 27 Jan 2012 13:27:38 +0000
Received: from mail-tul01m020-f171.google.com ([209.85.214.171]) (using TLSv1) by exprod7ob125.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTyKmNSvJVyW6/v8UqnbWzdRU1USNOOxb@postini.com; Fri, 27 Jan 2012 05:27:18 PST
Received: by mail-tul01m020-f171.google.com with SMTP id uy19so2952651obc.30
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 05:27:17 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.48.36 with SMTP id i4mr6499308obn.9.1327670837797; Fri, 27
 Jan 2012 05:27:17 -0800 (PST)
Received: by 10.182.37.164 with HTTP; Fri, 27 Jan 2012 05:27:17 -0800 (PST)
In-Reply-To: <CAOFYJNYMZinahPYJrr16AdhFXNZqFxp4ovB6-Sf3psyFi8u4WQ@mail.gmail.com>
References: <CAEbjtkjktyJPU29S-532_rbJTJ_ggiNXcqS8FjCATE+KboOVOw@mail.gmail.com>
	<CAOFYJNYMZinahPYJrr16AdhFXNZqFxp4ovB6-Sf3psyFi8u4WQ@mail.gmail.com>
Date: Fri, 27 Jan 2012 14:27:17 +0100
Message-ID: <CAEbjtkjY=ypYO-FsTz9XZkF_6r3t4FUuuOTNuzg43W5G9OAW0w@mail.gmail.com>
Subject: Re: Clustering persistent storage consistency issues
From: Berry van Halderen <b.vanhalderen@1hippo.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Fri, Jan 27, 2012 at 11:15 AM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> On Fri, Jan 27, 2012 at 9:50 AM, Berry van Halderen
> That shouldn't be possible since the first cluster node should be
> holding the cluster lock during the entire "update-persist" operation.
> Thus another cluster node shouldn't be able to make any concurrent
> changes.

Let me get back on that, because I'm looking at a possible fault in my
unit test.

\Berry

From dev-return-33960-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 14:30:40 2012
Return-Path: <dev-return-33960-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 21792956E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 14:30:40 +0000 (UTC)
Received: (qmail 51076 invoked by uid 500); 27 Jan 2012 14:30:39 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 50832 invoked by uid 500); 27 Jan 2012 14:30:39 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 50819 invoked by uid 99); 27 Jan 2012 14:30:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 14:30:38 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.50 as permitted sender)
Received: from [74.125.82.50] (HELO mail-ww0-f50.google.com) (74.125.82.50)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 14:30:32 +0000
Received: by wgbdr11 with SMTP id dr11so1908093wgb.19
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 06:30:12 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=q7j97XHFUR5C3tlUbWM9qRe9vx4KaG8t2Mj54sbMXNY=;
        b=h+99JyAPCYSao02++E0adGSHzw3ggBA9zyBXbOGB39FpnOAeWqMJe4pUNqPTjmeo4L
         s3HgrXhv5tFFlOPnbmoecI2RrDf26nHDHiblZ6mQC0znEWT+6pEk6IG4qnpgvFGkDZ1E
         v6u09PFY8Pduvd5jFBJrRzttPrTdtXFc5c9QE=
Received: by 10.180.93.193 with SMTP id cw1mr11435549wib.5.1327674612137; Fri,
 27 Jan 2012 06:30:12 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Fri, 27 Jan 2012 06:29:52 -0800 (PST)
In-Reply-To: <CAEbjtkiuxCE3Zc95+4S9FU0KYdUsF7ksu9KpJq6g2ajoxzm+oA@mail.gmail.com>
References: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
 <CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
 <CAOFYJNacOM1gJxWaXtKQeEtpyMmWeOenxk7Pvc3MDDSkZCnY0w@mail.gmail.com> <CAEbjtkiuxCE3Zc95+4S9FU0KYdUsF7ksu9KpJq6g2ajoxzm+oA@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Fri, 27 Jan 2012 15:29:52 +0100
Message-ID: <CAOFYJNZT0iP+EBU+SJ175vf_3H1rORwUf3_xALvO9yFht4KwRA@mail.gmail.com>
Subject: Re: Reloading node types in clustered environment
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Fri, Jan 27, 2012 at 2:26 PM, Berry van Halderen
<b.vanhalderen@1hippo.com> wrote:
> Small investigation shows that some fix for JCR-2587 inadvertently
> contained this change, which was reverted (much) later on the trunk,
> but after the 2.1.x and 2.2.x branch were made.

Argh, we definitely should fix that. Good catch!

> Though not a big issue, I'd like to merge this change also back
> into the 2.1.x and 2.2.x branches (unless objections, I'll do this).

Please do so. I'm all set to cut the 2.2.11 release candidate, and
having this fix in would be great.

BR,

Jukka Zitting

From dev-return-33961-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 14:36:37 2012
Return-Path: <dev-return-33961-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6483396A6
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 14:36:37 +0000 (UTC)
Received: (qmail 63465 invoked by uid 500); 27 Jan 2012 14:36:37 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 63252 invoked by uid 500); 27 Jan 2012 14:36:36 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 63239 invoked by uid 99); 27 Jan 2012 14:36:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 14:36:36 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 14:36:35 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 00139167EB5
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 14:36:14 +0000 (UTC)
Date: Fri, 27 Jan 2012 14:36:14 +0000 (UTC)
From: "Berry van Halderen (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <461046790.44.1327674975002.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3223) Disallow unregistering of node types
 still (possibly) in use
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Disallow unregistering of node types still (possibly) in use
------------------------------------------------------------

                 Key: JCR-3223
                 URL: https://issues.apache.org/jira/browse/JCR-3223
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-core
    Affects Versions: 2.2.10, 2.1.6
            Reporter: Berry van Halderen
            Assignee: Berry van Halderen
             Fix For: 2.1.7, 2.2.11




--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33962-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 14:42:35 2012
Return-Path: <dev-return-33962-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F23B59853
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 14:42:34 +0000 (UTC)
Received: (qmail 80090 invoked by uid 500); 27 Jan 2012 14:42:34 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 79846 invoked by uid 500); 27 Jan 2012 14:42:34 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 79732 invoked by uid 99); 27 Jan 2012 14:42:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 14:42:33 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 14:42:31 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E7B0E13454F
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 14:42:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 14:42:10 +0000 (UTC)
From: "Berry van Halderen (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1553826658.98.1327675330950.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <461046790.44.1327674975002.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3223) Disallow unregistering of node types
 still (possibly) in use
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3223?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Berry van Halderen resolved JCR-3223.
-------------------------------------

    Resolution: Fixed

Simple fix by aligning code to actual code on trunk.
                
> Disallow unregistering of node types still (possibly) in use
> ------------------------------------------------------------
>
>                 Key: JCR-3223
>                 URL: https://issues.apache.org/jira/browse/JCR-3223
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>    Affects Versions: 2.1.6, 2.2.10
>            Reporter: Berry van Halderen
>            Assignee: Berry van Halderen
>             Fix For: 2.1.7, 2.2.11
>
>


--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33963-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 14:42:40 2012
Return-Path: <dev-return-33963-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9299E986B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 14:42:40 +0000 (UTC)
Received: (qmail 80531 invoked by uid 500); 27 Jan 2012 14:42:40 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 80491 invoked by uid 500); 27 Jan 2012 14:42:39 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 80484 invoked by uid 99); 27 Jan 2012 14:42:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 14:42:39 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanhalderen@1hippo.com designates 64.18.2.175 as permitted sender)
Received: from [64.18.2.175] (HELO exprod7og111.obsmtp.com) (64.18.2.175)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 27 Jan 2012 14:42:30 +0000
Received: from mail-gx0-f177.google.com ([209.85.161.177]) (using TLSv1) by exprod7ob111.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTyK3wTOO9dSL5dfugRSI81/VxYroFlot@postini.com; Fri, 27 Jan 2012 06:42:10 PST
Received: by mail-gx0-f177.google.com with SMTP id h4so969001ggn.36
        for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 06:42:09 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.231.7 with SMTP id tc7mr6704200obc.29.1327675329161; Fri,
 27 Jan 2012 06:42:09 -0800 (PST)
Received: by 10.182.37.164 with HTTP; Fri, 27 Jan 2012 06:42:09 -0800 (PST)
In-Reply-To: <CAOFYJNZT0iP+EBU+SJ175vf_3H1rORwUf3_xALvO9yFht4KwRA@mail.gmail.com>
References: <CAEbjtkjn6TmcXh26QT8sqyeJAm+Zm7OPEUKh1YU-5xum-+yMKg@mail.gmail.com>
	<CAEbjtkj7+9p63n8NgXog681wsJYLTbL-JAe_XLw2vH7FKi9wUA@mail.gmail.com>
	<CAOFYJNacOM1gJxWaXtKQeEtpyMmWeOenxk7Pvc3MDDSkZCnY0w@mail.gmail.com>
	<CAEbjtkiuxCE3Zc95+4S9FU0KYdUsF7ksu9KpJq6g2ajoxzm+oA@mail.gmail.com>
	<CAOFYJNZT0iP+EBU+SJ175vf_3H1rORwUf3_xALvO9yFht4KwRA@mail.gmail.com>
Date: Fri, 27 Jan 2012 15:42:09 +0100
Message-ID: <CAEbjtkgmoREWY0oGL5ZzfnTtdX9KGK3f-sSp2b+nQ6diJV_J_Q@mail.gmail.com>
Subject: Re: Reloading node types in clustered environment
From: Berry van Halderen <b.vanhalderen@1hippo.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Jan 27, 2012 at 3:29 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> Please do so. I'm all set to cut the 2.2.11 release candidate, and
> having this fix in would be great.

Go ahead, it's committed.

Thx,
\Berry

From dev-return-33964-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 15:08:21 2012
Return-Path: <dev-return-33964-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8EABB9FD1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 15:08:21 +0000 (UTC)
Received: (qmail 21787 invoked by uid 500); 27 Jan 2012 15:08:21 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 21562 invoked by uid 500); 27 Jan 2012 15:08:20 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 21555 invoked by uid 99); 27 Jan 2012 15:08:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 15:08:19 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 15:08:17 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id 9C837C00A0
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 15:07:57 +0000 (UTC)
Date: Fri, 27 Jan 2012 15:07:57 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <527194126.11201327676877625.JavaMail.hudson@aegis>
In-Reply-To: <653342059.7861327507857178.JavaMail.hudson@aegis>
References: <653342059.7861327507857178.JavaMail.hudson@aegis>
Subject: Build failed in Jenkins: Jackrabbit-2.2 #58
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: Jackrabbit-2.2
X-Jenkins-Result: FAILURE

See <https://builds.apache.org/job/Jackrabbit-2.2/58/changes>

Changes:

[halderen] JCR-3223, JCR-2587: revert accidental commit which causes unregistering of node types to be allowed even though possibly still in use.

------------------------------------------
[...truncated 4034 lines...]
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/transaction/TxLockManagerImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/transaction/TransactionListener.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/VersionControlledItemCollection.java
A         jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/nodetype
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/nodetype/PropertyDefinitionImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/nodetype/NodeDefinitionImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/nodetype/ItemDefinitionImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/nodetype/NodeTypeProperty.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/DavLocatorFactoryImpl.java
A         jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/lock
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/lock/JcrActiveLock.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/lock/SessionScopedLockEntry.java
A         jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/observation
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/observation/SubscriptionManagerImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/observation/SubscriptionImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/AbstractResource.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/DefaultItemResource.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/JcrDavSession.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/JcrValueType.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/DefaultItemCollection.java
A         jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/search
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/search/SearchResourceImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/search/SearchResultProperty.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/WorkspaceResourceImpl.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/JcrDavException.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/AbstractItemResource.java
AU        jackrabbit-jcr-server/src/main/java/org/apache/jackrabbit/webdav/jcr/DavResourceFactoryImpl.java
A         jackrabbit-jcr-server/src/main/javadoc
A         jackrabbit-jcr-server/src/main/javadoc/org
A         jackrabbit-jcr-server/src/main/javadoc/org/apache
A         jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit
A         jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/server
A         jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/server/io
AU        jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/server/io/package.html
A         jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/webdav
A         jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/webdav/jcr
A         jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/webdav/jcr/version
A         jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/webdav/jcr/version/report
AU        jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/webdav/jcr/version/report/package.html
AU        jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/webdav/jcr/version/package.html
AU        jackrabbit-jcr-server/src/main/javadoc/org/apache/jackrabbit/webdav/jcr/package.html
A         jackrabbit-jcr-server/src/main/appended-resources
A         jackrabbit-jcr-server/src/main/appended-resources/META-INF
AU        jackrabbit-jcr-server/src/main/appended-resources/META-INF/NOTICE
A         jackrabbit-jcr-server/src/main/resources
A         jackrabbit-jcr-server/src/main/resources/org
A         jackrabbit-jcr-server/src/main/resources/org/apache
A         jackrabbit-jcr-server/src/main/resources/org/apache/jackrabbit
A         jackrabbit-jcr-server/src/main/resources/org/apache/jackrabbit/server
A         jackrabbit-jcr-server/src/main/resources/org/apache/jackrabbit/server/io
AU        jackrabbit-jcr-server/src/main/resources/org/apache/jackrabbit/server/io/mimetypes.properties
AU        jackrabbit-jcr-server/pom.xml
AU        jackrabbit-jcr-server/README.txt
AU        assembly.xml
 U        .
At revision 1236705
[locks-and-latches] Checking to see if we really have the locks
[locks-and-latches] Have all the locks, build can start
Parsing POMs
[2.2] $ /home/hudson/tools/java/latest1.5/bin/java -cp /home/jenkins/jenkins-slave/maven-agent.jar:/home/jenkins/jenkins-slave/classworlds.jar hudson.maven.agent.Main /home/hudson/tools/maven/apache-maven-2.2.1 /home/jenkins/jenkins-slave/slave.jar /home/jenkins/jenkins-slave/maven-interceptor.jar 38642 /home/jenkins/jenkins-slave/maven2.1-interceptor.jar
<===[JENKINS REMOTING CAPACITY]===>channel started
   Executing Maven:  -B -f <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/pom.xml> clean deploy -Ppedantic,integrationTesting -Dlitmus=/home/hudson/tools/litmus/latest/bin/litmus
[INFO] Scanning for projects...
[INFO] Reactor build order: 
[INFO]   Jackrabbit Parent POM
[INFO]   Apache Jackrabbit API
[INFO]   Jackrabbit JCR Commons
[INFO]   Jackrabbit JCR Tests
[INFO]   Jackrabbit SPI
[INFO]   Jackrabbit SPI Commons
[INFO]   Jackrabbit Core
[INFO]   Jackrabbit WebDAV Library
[INFO]   Jackrabbit JCR Server
[INFO]   Jackrabbit JCR-RMI
[INFO]   Jackrabbit JCR Servlets
[INFO]   Jackrabbit Web Application
[INFO]   Jackrabbit JCA Resource Adapter
[INFO]   Jackrabbit JCR to SPI
[INFO]   Jackrabbit SPI to JCR
[INFO]   Jackrabbit SPI to WebDAV
[INFO]   Jackrabbit JCR to WebDAV
[INFO]   Jackrabbit JCR Client
[INFO]   Jackrabbit Standalone
[INFO]   Apache Jackrabbit
[INFO] ------------------------------------------------------------------------
[INFO] Building Jackrabbit Parent POM
[INFO]    task-segment: [clean, deploy]
[INFO] ------------------------------------------------------------------------
[INFO] [clean:clean {execution: default-clean}]
log4j:WARN No appenders could be found for logger (org.apache.commons.beanutils.converters.BooleanConverter).
log4j:WARN Please initialize the log4j system properly.
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-parent/src/main/java'...>
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-parent/src/test/java'...>
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-parent/src/main/resources'...>
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-parent/src/test/resources'...>
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[INFO] Setting property: classpath.resource.loader.class => 'org.codehaus.plexus.velocity.ContextClassLoaderResourceLoader'.
[INFO] Setting property: velocimacro.messages.on => 'false'.
[INFO] Setting property: resource.loader => 'classpath'.
[INFO] Setting property: resource.manager.logwhenfound => 'false'.
[INFO] [remote-resources:process {execution: default}]
[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [site:attach-descriptor {execution: default-attach-descriptor}]
[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [apache-rat:check {execution: default}]
[INFO] Exclude: release.properties
[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [install:install {execution: default-install}]
[INFO] Installing <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-parent/pom.xml> to /home/jenkins/.m2/repository/org/apache/jackrabbit/jackrabbit-parent/2.2.11-SNAPSHOT/jackrabbit-parent-2.2.11-SNAPSHOT.pom
[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [deploy:deploy {execution: default-deploy}]
[INFO] Retrieving previous build number from apache.snapshots.https
Uploading: https://repository.apache.org/content/repositories/snapshots/org/apache/jackrabbit/jackrabbit-parent/2.2.11-SNAPSHOT/jackrabbit-parent-2.2.11-20120127.150730-4.pom
10K uploaded  (jackrabbit-parent-2.2.11-20120127.150730-4.pom)
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'snapshot org.apache.jackrabbit:jackrabbit-parent:2.2.11-SNAPSHOT'
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'artifact org.apache.jackrabbit:jackrabbit-parent'
[TASKS] Skipping maven reporter: there is already a result available.
[JENKINS] Archiving disabled - not archiving <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-parent/pom.xml>
[JENKINS] Archiving disabled - not archiving /home/jenkins/.m2/repository/org/apache/jackrabbit/jackrabbit-parent/2.2.11-SNAPSHOT/jackrabbit-parent-2.2.11-SNAPSHOT.pom
[INFO] ------------------------------------------------------------------------
[INFO] Building Apache Jackrabbit API
[INFO]    task-segment: [clean, deploy]
[INFO] ------------------------------------------------------------------------
[INFO] [clean:clean {execution: default-clean}]
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/src/main/java'> for tasks ... 
[TASKS] Found 4.
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/src/test/java'...>
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/src/main/resources'...>
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/src/test/resources'...>
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[INFO] [remote-resources:process {execution: default}]
[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [resources:resources {execution: default-resources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/src/main/resources>
[INFO] Copying 3 resources
[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [compiler:compile {execution: default-compile}]
[INFO] Compiling 28 source files to <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/target/classes>
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [resources:testResources {execution: default-testResources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/src/test/resources>
[INFO] Copying 3 resources

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [compiler:testCompile {execution: default-testCompile}]
[INFO] No sources to compile

[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [surefire:test {execution: default-test}]
[INFO] Surefire report directory: <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/target/surefire-reports>

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
There are no tests to run.

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[TASKS] Skipping maven reporter: there is already a result available.
[JENKINS] Recording test results[INFO] [bundle:bundle {execution: default-bundle}]

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [apache-rat:check {execution: default}]
[INFO] Exclude: .checkstyle

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [install:install {execution: default-install}]
[INFO] Installing <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/target/jackrabbit-api-2.2.11-SNAPSHOT.jar> to /home/jenkins/.m2/repository/org/apache/jackrabbit/jackrabbit-api/2.2.11-SNAPSHOT/jackrabbit-api-2.2.11-SNAPSHOT.jar

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [bundle:install {execution: default-install}]
[INFO] Parsing file:/home/jenkins/.m2/repository/repository.xml

[INFO] Installing org/apache/jackrabbit/jackrabbit-api/2.2.11-SNAPSHOT/jackrabbit-api-2.2.11-SNAPSHOT.jar
[INFO] Writing OBR metadata
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [deploy:deploy {execution: default-deploy}]
[INFO] Retrieving previous build number from apache.snapshots.https

Uploading: https://repository.apache.org/content/repositories/snapshots/org/apache/jackrabbit/jackrabbit-api/2.2.11-SNAPSHOT/jackrabbit-api-2.2.11-20120127.150730-4.jar
23K uploaded  (jackrabbit-api-2.2.11-20120127.150730-4.jar)
[INFO] Uploading project information for jackrabbit-api 2.2.11-20120127.150730-4
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'snapshot org.apache.jackrabbit:jackrabbit-api:2.2.11-SNAPSHOT'
[INFO] Retrieving previous metadata from apache.snapshots.https
[INFO] Uploading repository metadata for: 'artifact org.apache.jackrabbit:jackrabbit-api'
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [bundle:deploy {execution: default-deploy}]
[INFO] Remote OBR update disabled (enable with -DremoteOBR)

[TASKS] Skipping maven reporter: there is already a result available.
[JENKINS] Archiving disabled - not archiving <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/pom.xml>
[JENKINS] Archiving disabled - not archiving <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-api/target/jackrabbit-api-2.2.11-SNAPSHOT.jar>
[INFO] ------------------------------------------------------------------------
[INFO] Building Jackrabbit JCR Commons
[INFO]    task-segment: [clean, deploy]
[INFO] ------------------------------------------------------------------------
[INFO] [clean:clean {execution: default-clean}]
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/main/java'> for tasks ... 
[TASKS] Found 6.
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/test/java'> for tasks ... 
[TASKS] Found 5.
[TASKS] Scanning folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/main/resources'> for tasks ... 
[TASKS] Found 0.
[TASKS] Skipping non-existent folder '<https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/test/resources'...>
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[INFO] [remote-resources:process {execution: default}]
[TASKS] Skipping maven reporter: there is already a result available.
[INFO] [resources:resources {execution: default-resources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] Copying 3 resources
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [compiler:compile {execution: default-compile}]

[INFO] Compiling 123 source files to <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/classes>
[TASKS] Skipping maven reporter: there is already a result available.[INFO] [resources:testResources {execution: default-testResources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/src/test/resources>
[INFO] Copying 3 resources

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [compiler:testCompile {execution: default-testCompile}]
[INFO] Compiling 17 source files to <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/test-classes>

[TASKS] Skipping maven reporter: there is already a result available.[INFO] [surefire:test {execution: default-test}]
[INFO] Surefire report directory: <https://builds.apache.org/job/Jackrabbit-2.2/ws/2.2/jackrabbit-jcr-commons/target/surefire-reports>

Jan 27, 2012 3:07:55 PM hudson.remoting.Channel$ReaderThread run
SEVERE: I/O error in channel channel
java.io.StreamCorruptedException
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1332)
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:348)
	at hudson.remoting.Channel$ReaderThread.run(Channel.java:1109)
killed.
channel stopped
[INFO] ------------------------------------------------------------------------
[ERROR] FATAL ERROR
[INFO] ------------------------------------------------------------------------
[TASKS] Aggregating results of Jackrabbit Parent POM
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[TASKS] Aggregating results of Apache Jackrabbit API
[TASKS] Using set difference to compute new warnings
[TASKS] Not changing build status, since no threshold has been exceeded
[locks-and-latches] Releasing all the locks
[locks-and-latches] All the locks released
ERROR: Maven JVM terminated unexpectedly with exit code 0



From dev-return-33965-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 15:20:32 2012
Return-Path: <dev-return-33965-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EB8AD92EF
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 15:20:32 +0000 (UTC)
Received: (qmail 45581 invoked by uid 500); 27 Jan 2012 15:20:32 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 45493 invoked by uid 500); 27 Jan 2012 15:20:32 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 45480 invoked by uid 99); 27 Jan 2012 15:20:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 15:20:31 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 15:20:30 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 84C491357CC
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 15:20:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 15:20:10 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1744808081.346.1327677610545.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <461046790.44.1327674975002.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3223) Disallow unregistering of node types
 still (possibly) in use
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3223?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3223:
-------------------------------

    Fix Version/s: 2.4

Thanks!

Since this accidental "feature" has been out for quite a while in Jackrabbit 2.1 and 2.2, there are probably already users who are relying on this mistaken behavior. To avoid breaking the functionality entirely for such users, I introduced a -DdisableCheckForReferencesInContentException=true feature flag in in trunk revision 1236709 and merged it also to the 2.2 and 2.1 branches. Setting that system property will restore the earlier broken behavior where the exception from checkForReferencesInContent() was disabled.
                
> Disallow unregistering of node types still (possibly) in use
> ------------------------------------------------------------
>
>                 Key: JCR-3223
>                 URL: https://issues.apache.org/jira/browse/JCR-3223
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>    Affects Versions: 2.1.6, 2.2.10
>            Reporter: Berry van Halderen
>            Assignee: Berry van Halderen
>             Fix For: 2.1.7, 2.2.11, 2.4
>
>


--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33966-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 15:52:35 2012
Return-Path: <dev-return-33966-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AE8D69AB7
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 15:52:35 +0000 (UTC)
Received: (qmail 4587 invoked by uid 500); 27 Jan 2012 15:52:35 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 4519 invoked by uid 500); 27 Jan 2012 15:52:34 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 4512 invoked by uid 99); 27 Jan 2012 15:52:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 15:52:34 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 15:52:31 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 21AE3135CE3
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 15:52:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 15:52:10 +0000 (UTC)
From: "Rohit Nijhawan (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1892832866.506.1327679530139.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3221?page=3Dcom.atlassian.j=
ira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=3D131948=
65#comment-13194865 ]=20

Rohit Nijhawan commented on JCR-3221:
-------------------------------------

The real bug is in NodePropBundle.java and BundleDbPersistenceManager.java
=20
We have these lines: NodePropBundle
    /**
     * flag that indicates if this bundle is new
     */
    private boolean isNew =3D true;
=20
Later the code in BundleDBPersistenceManager checks this as below. The inte=
ntion is right =E2=80=93 to use bundleUpdateSQL. But it never gets picked u=
p neither in derby nor other databases.=20
=20
bundle.isNew() ? bundleInsertSQL : bundleUpdateSQL;

The solution is to actually check the database to ensure that the bundle is=
 actually new. The same code as loadBundle method can be used to return a b=
oolean.
               =20
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling=20
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAUL=
T_BUNDLE, the server starts up in sling but only 28/75 bundles are active a=
nd only 101/152 services launch after all the bundles are manually made act=
ive by pressing the |>| play button beside them. AuthenticationSupport serv=
ice never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT=
_BUNDLE, the server never starts up fully. It stays at Starting the server.=
..
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePer=
sistenceManager classes. I've seen similar issues with 'writing the bundle'=
 error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108=
 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DE=
FAULT_BUNDLE_IDX) violated
> =09at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.ja=
va:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:=
Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:=
Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle =
JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatemen=
t.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedS=
tatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleState=
ment.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePr=
eparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedSt=
atement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> =09at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(Delegat=
ingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(Delegat=
ingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(Connect=
ionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(Co=
nnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(Connecti=
onHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(Connecti=
onHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.do=
Try(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(Connecti=
onHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceMana=
ger.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalon=
e-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersist=
enceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbi=
t-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersist=
enceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackr=
abbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersist=
enceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-st=
andalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceMana=
ger.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.1=
0.jar:na]
> =09at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootN=
odeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.ja=
r:na]
> =09at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(Shar=
edItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(Re=
positoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitializ=
e(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(=
RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(Rep=
ositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.jav=
a:342) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.jav=
a:605) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServle=
t.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.=
jar:na]
> =09at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrab=
bit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.j=
ava:440) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:=
263) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.jav=
a:50) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.=
java:685) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [j=
ackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.j=
ava:1250) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.jav=
a:517) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:4=
67) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.jav=
a:50) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.jav=
a:130) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandl=
er.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.jav=
a:50) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.jav=
a:130) [jackrabbit-standalone-2.2.10.jar:na]
> =09at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-stand=
alone-2.2.10.jar:na]
> =09at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.jav=
a:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrato=
rs: https://issues.apache.org/jira/secure/ContactAdministrators!default.jsp=
a
For more information on JIRA, see: http://www.atlassian.com/software/jira

       

From dev-return-33967-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 16:38:31 2012
Return-Path: <dev-return-33967-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0C7969CD8
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 16:38:30 +0000 (UTC)
Received: (qmail 9485 invoked by uid 500); 27 Jan 2012 16:38:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 9278 invoked by uid 500); 27 Jan 2012 16:38:30 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 9271 invoked by uid 99); 27 Jan 2012 16:38:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:38:29 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Received: from [140.211.11.8] (HELO aegis.apache.org) (140.211.11.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:38:29 +0000
Received: from aegis (localhost [127.0.0.1])
	by aegis.apache.org (Postfix) with ESMTP id E04E9C00A0
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 16:38:08 +0000 (UTC)
Date: Fri, 27 Jan 2012 16:38:08 +0000 (UTC)
From: Apache Jenkins Server <jenkins@builds.apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <337184961.11301327682288902.JavaMail.hudson@aegis>
In-Reply-To: <527194126.11201327676877625.JavaMail.hudson@aegis>
References: <527194126.11201327676877625.JavaMail.hudson@aegis>
Subject: Jenkins build is back to normal : Jackrabbit-2.2 #59
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: Jackrabbit-2.2
X-Jenkins-Result: SUCCESS

See <https://builds.apache.org/job/Jackrabbit-2.2/59/changes>



From dev-return-33968-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 16:46:33 2012
Return-Path: <dev-return-33968-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5F3309F82
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 16:46:33 +0000 (UTC)
Received: (qmail 31437 invoked by uid 500); 27 Jan 2012 16:46:32 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 31355 invoked by uid 500); 27 Jan 2012 16:46:32 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 31335 invoked by uid 99); 27 Jan 2012 16:46:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:46:31 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:46:30 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 9887B135A3C
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 16:46:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 16:46:10 +0000 (UTC)
From: "angela (Created) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <749788068.742.1327682770626.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Created] (JCR-3224) SystemSession#createSession should
 return SessionImpl again
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

SystemSession#createSession should return SessionImpl again
-----------------------------------------------------------

                 Key: JCR-3224
                 URL: https://issues.apache.org/jira/browse/JCR-3224
             Project: Jackrabbit Content Repository
          Issue Type: Bug
          Components: jackrabbit-core
            Reporter: angela


a long with the fix of  JCR-2890 (revision 1089436) the behavior of SystemSession#createSession has changed to
return a SystemSession instead of SessionImpl as it used to be.

while i basically consider this move to be correct and the better way of dealing with that session-cloning
mechanism as it prevents the user of this method to convert a SystemSession into a regular session
for extra writing operations (such as e.g. access control editing that is not supported with the
system session to prevent chicken-egg-problems on repo startup).

therefore i would like to revert that change for the 2.4 release in order to prevent regressions.

for the time after 2.4 i would however suggest that we finally take the time to clearly define the
usages, abilities and responsibilities of the system session and also review how and where we
expose them to the individual 'modules' of jackrabbit core..  i started working on this but decided
that this is definitely too risky for 2.4 whereas reverting the change mentioned above should
imo impose very limited risk as all usages of those sessions i am aware of use them as "Session"
or "SesssionImpl", most of them not even having access to the SystemSession class.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33969-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 16:46:34 2012
Return-Path: <dev-return-33969-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 578A69F94
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 16:46:34 +0000 (UTC)
Received: (qmail 31864 invoked by uid 500); 27 Jan 2012 16:46:33 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 31384 invoked by uid 500); 27 Jan 2012 16:46:32 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 31333 invoked by uid 99); 27 Jan 2012 16:46:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:46:31 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:46:30 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id B24F5135A40
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 16:46:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 16:46:10 +0000 (UTC)
From: "angela (Assigned) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <87741724.744.1327682770732.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <749788068.742.1327682770626.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Assigned] (JCR-3224) SystemSession#createSession should
 return SessionImpl again
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3224?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela reassigned JCR-3224:
---------------------------

    Assignee: angela
    
> SystemSession#createSession should return SessionImpl again
> -----------------------------------------------------------
>
>                 Key: JCR-3224
>                 URL: https://issues.apache.org/jira/browse/JCR-3224
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>            Reporter: angela
>            Assignee: angela
>             Fix For: 2.4
>
>
> a long with the fix of  JCR-2890 (revision 1089436) the behavior of SystemSession#createSession has changed to
> return a SystemSession instead of SessionImpl as it used to be.
> while i basically consider this move to be correct and the better way of dealing with that session-cloning
> mechanism as it prevents the user of this method to convert a SystemSession into a regular session
> for extra writing operations (such as e.g. access control editing that is not supported with the
> system session to prevent chicken-egg-problems on repo startup).
> therefore i would like to revert that change for the 2.4 release in order to prevent regressions.
> for the time after 2.4 i would however suggest that we finally take the time to clearly define the
> usages, abilities and responsibilities of the system session and also review how and where we
> expose them to the individual 'modules' of jackrabbit core..  i started working on this but decided
> that this is definitely too risky for 2.4 whereas reverting the change mentioned above should
> imo impose very limited risk as all usages of those sessions i am aware of use them as "Session"
> or "SesssionImpl", most of them not even having access to the SystemSession class.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33970-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 16:46:34 2012
Return-Path: <dev-return-33970-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 737EF9FA9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 16:46:34 +0000 (UTC)
Received: (qmail 31890 invoked by uid 500); 27 Jan 2012 16:46:33 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 31780 invoked by uid 500); 27 Jan 2012 16:46:33 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 31334 invoked by uid 99); 27 Jan 2012 16:46:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:46:31 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 16:46:30 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id CD7C8135A42
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 16:46:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 16:46:10 +0000 (UTC)
From: "angela (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <650318532.746.1327682770843.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <749788068.742.1327682770626.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3224) SystemSession#createSession should
 return SessionImpl again
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3224?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela updated JCR-3224:
------------------------

    Fix Version/s: 2.4
    
> SystemSession#createSession should return SessionImpl again
> -----------------------------------------------------------
>
>                 Key: JCR-3224
>                 URL: https://issues.apache.org/jira/browse/JCR-3224
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>            Reporter: angela
>            Assignee: angela
>             Fix For: 2.4
>
>
> a long with the fix of  JCR-2890 (revision 1089436) the behavior of SystemSession#createSession has changed to
> return a SystemSession instead of SessionImpl as it used to be.
> while i basically consider this move to be correct and the better way of dealing with that session-cloning
> mechanism as it prevents the user of this method to convert a SystemSession into a regular session
> for extra writing operations (such as e.g. access control editing that is not supported with the
> system session to prevent chicken-egg-problems on repo startup).
> therefore i would like to revert that change for the 2.4 release in order to prevent regressions.
> for the time after 2.4 i would however suggest that we finally take the time to clearly define the
> usages, abilities and responsibilities of the system session and also review how and where we
> expose them to the individual 'modules' of jackrabbit core..  i started working on this but decided
> that this is definitely too risky for 2.4 whereas reverting the change mentioned above should
> imo impose very limited risk as all usages of those sessions i am aware of use them as "Session"
> or "SesssionImpl", most of them not even having access to the SystemSession class.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33971-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 17:36:38 2012
Return-Path: <dev-return-33971-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E830C9DD4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 17:36:38 +0000 (UTC)
Received: (qmail 33859 invoked by uid 500); 27 Jan 2012 17:36:37 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 33197 invoked by uid 500); 27 Jan 2012 17:36:36 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 32884 invoked by uid 99); 27 Jan 2012 17:36:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 17:36:36 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 17:36:34 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4A6DA1353FF
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 17:36:13 +0000 (UTC)
Date: Fri, 27 Jan 2012 17:36:13 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <868624113.1013.1327685773307.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3222) Allow servlet filters to specify custom
 session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3222:
-------------------------------

    Attachment: 0001-JCR-3222-Allow-servlet-filters-to-specify-custom-ses.patch

> But I don't like this -- special case handling affecting all but used by one only.

You don't have the same concern about injecting the ResourceResolver instance as a request attribute? Just like the OSGi service space, the attributes support in servlet requests (or servlet context, etc.) is a whiteboard shared by multiple providers and consumers. Why would adding a properly namespaced attribute affect anyone but the consumer of that attribute?

Additionally, the AuthHttpContext class in the Sling davex bundle is already designed specifically for the needs of the davex servlet (it needs to interpret the workspace part of the URL). So I don't see how this would affect anyone but the davex servlet.

Anyway, I guess we should simply allow both approaches and let downstream users decide which mechanism they want to use.

PS. Sorry about uploading the wrong file above... :-) I've uploaded the actual patch.
                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Priority: Minor
>         Attachments: 0001-JCR-3222-Allow-servlet-filters-to-specify-custom-ses.patch, JCR-3222-fmeschbe.patch, jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33972-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 18:04:32 2012
Return-Path: <dev-return-33972-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B1D4596C9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 18:04:32 +0000 (UTC)
Received: (qmail 82798 invoked by uid 500); 27 Jan 2012 18:04:32 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 82636 invoked by uid 500); 27 Jan 2012 18:04:31 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 82626 invoked by uid 99); 27 Jan 2012 18:04:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 18:04:31 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 18:04:30 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 74CE21351E5
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 18:04:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 18:04:10 +0000 (UTC)
From: "angela (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1720244776.1142.1327687450479.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <749788068.742.1327682770626.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3224) SystemSession#createSession should
 return SessionImpl again
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3224?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

angela resolved JCR-3224.
-------------------------

    Resolution: Fixed
    
> SystemSession#createSession should return SessionImpl again
> -----------------------------------------------------------
>
>                 Key: JCR-3224
>                 URL: https://issues.apache.org/jira/browse/JCR-3224
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>          Components: jackrabbit-core
>            Reporter: angela
>            Assignee: angela
>             Fix For: 2.4
>
>
> a long with the fix of  JCR-2890 (revision 1089436) the behavior of SystemSession#createSession has changed to
> return a SystemSession instead of SessionImpl as it used to be.
> while i basically consider this move to be correct and the better way of dealing with that session-cloning
> mechanism as it prevents the user of this method to convert a SystemSession into a regular session
> for extra writing operations (such as e.g. access control editing that is not supported with the
> system session to prevent chicken-egg-problems on repo startup).
> therefore i would like to revert that change for the 2.4 release in order to prevent regressions.
> for the time after 2.4 i would however suggest that we finally take the time to clearly define the
> usages, abilities and responsibilities of the system session and also review how and where we
> expose them to the individual 'modules' of jackrabbit core..  i started working on this but decided
> that this is definitely too risky for 2.4 whereas reverting the change mentioned above should
> imo impose very limited risk as all usages of those sessions i am aware of use them as "Session"
> or "SesssionImpl", most of them not even having access to the SystemSession class.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33973-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 18:18:34 2012
Return-Path: <dev-return-33973-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 08D439CB1
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 18:18:34 +0000 (UTC)
Received: (qmail 8500 invoked by uid 500); 27 Jan 2012 18:18:33 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 8261 invoked by uid 500); 27 Jan 2012 18:18:32 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 8251 invoked by uid 99); 27 Jan 2012 18:18:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 18:18:32 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 18:18:31 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id E805313596E
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 18:18:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 18:18:10 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1510334315.1175.1327688290952.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13194970#comment-13194970 ] 

Jukka Zitting commented on JCR-3221:
------------------------------------

Sounds like you may have some other Jackrabbit instance concurrently accessing the same database backend. Make sure that you start with a clean database and only run a single Jackrabbit instance at a time.

If you you're setting up a cluster, note that you need to explicitly configure all nodes instead of just sharing the same repository.xml configuration file. See http://wiki.apache.org/jackrabbit/Clustering for details.
                
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33974-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 19:12:35 2012
Return-Path: <dev-return-33974-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 18E589CE7
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 19:12:35 +0000 (UTC)
Received: (qmail 13976 invoked by uid 500); 27 Jan 2012 19:12:34 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 13703 invoked by uid 500); 27 Jan 2012 19:12:34 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 13686 invoked by uid 99); 27 Jan 2012 19:12:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 19:12:33 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 19:12:31 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id A4733135D9E
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 19:12:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 19:12:10 +0000 (UTC)
From: "Jukka Zitting (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1302392361.1466.1327691530676.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <964400749.82069.1327601078385.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3222) Allow servlet filters to specify
 custom session providers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3222?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting resolved JCR-3222.
--------------------------------

       Resolution: Fixed
    Fix Version/s: 2.4
         Assignee: Jukka Zitting

OK, I've now combined the two approaches. Revision 1236819 is my original patch and revision 1236821 a modified version of Felix' patch with support for potentially more than just a single external SessionProvider service. Note that the request attribute mechanism works for all webdav servlets, while the OSGi service mechanism only works for the davex servlet (since it's the only servlet configured as an OSGi service).

Additionally in revision 1236820 I moved some extra SessionProviderImpl code (added in JCR-2539 and JCR-2542) to the JCRWebdavServlet class where it belongs better. That clears up the SessionProvider API contract and avoids breaking functionality when using custom SessionProvider implementations.

Merged to the 2.4 branch in revision 1236837.

                
> Allow servlet filters to specify custom session providers
> ---------------------------------------------------------
>
>                 Key: JCR-3222
>                 URL: https://issues.apache.org/jira/browse/JCR-3222
>             Project: Jackrabbit Content Repository
>          Issue Type: Improvement
>          Components: jackrabbit-jcr-server
>            Reporter: Jukka Zitting
>            Assignee: Jukka Zitting
>            Priority: Minor
>             Fix For: 2.4
>
>         Attachments: 0001-JCR-3222-Allow-servlet-filters-to-specify-custom-ses.patch, JCR-3222-fmeschbe.patch, jackrabbit-jcr-server-2.6-SNAPSHOT.jar
>
>
> In order to integrate the Jackrabbit davex server functionality with their custom authentication logic, the Sling project currently needs to embed and subclass the davex servlet classes. It would be cleaner if such tight coupling wasn't needed.
> One way to achieve something like that would be to allow external components to provide a custom SessionProvider instance as an extra request attribute. This way for example a servlet filter that implements such custom authentication logic could easily make its functionality available to the standard davex servlet in Jackrabbit.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33975-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Fri Jan 27 22:32:36 2012
Return-Path: <dev-return-33975-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 46DD89654
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Fri, 27 Jan 2012 22:32:36 +0000 (UTC)
Received: (qmail 29804 invoked by uid 500); 27 Jan 2012 22:32:36 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 29709 invoked by uid 500); 27 Jan 2012 22:32:35 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 29702 invoked by uid 99); 27 Jan 2012 22:32:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 22:32:35 +0000
X-ASF-Spam-Status: No, hits=-1998.9 required=5.0
	tests=ALL_TRUSTED,TRACKER_ID,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 27 Jan 2012 22:32:31 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 80F06167A00
	for <dev@jackrabbit.apache.org>; Fri, 27 Jan 2012 22:32:10 +0000 (UTC)
Date: Fri, 27 Jan 2012 22:32:10 +0000 (UTC)
From: "Rohit Nijhawan (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1100466277.2132.1327703530529.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13195164#comment-13195164 ] 

Rohit Nijhawan commented on JCR-3221:
-------------------------------------

I've been at it for 10 full days and have looked at the code very meticulously. Even against derby (Remember, there are no unique constraint indexes on the derby ddl), we get the insertion of this data multiple times.

deadbeef-cafe-babe-cafe-babecafebabe

Against oracle, it croaks immediately. I have run it against totally clean oracle database instances. And i have only ever run 1 copy of jackrabbit. I started it from sling. The fact that jackrabbit persistence instructions are not right doesn't help the matter either. Please see: https://issues.apache.org/jira/browse/SLING-2384

I was able to fix my issue by patching the jar with this code

In: BundleDbPersistenceManager.storeBundle(NodePropBundle bundle)

String sql = isNewBundle(bundle.getId()) ? bundleInsertSQL : bundleUpdateSQL;

and with this method

    private synchronized boolean isNewBundle(NodeId id) throws ItemStateException {
    	ResultSet rs = null;
    	try {
    		rs = conHelper.exec(bundleSelectSQL, getKey(id), false, 0);
    		if (!rs.next()) {
    			return true;
    		}
    		return false;
    	} catch (Exception e) {
    		String msg = "Bundle discovery error for: " + id + ": " + e;
    		log.error(msg);
    		throw new ItemStateException(msg, e);
    	} finally {
    		DbUtility.close(rs);
    	}
    }

Now everything is working except after uploading I don't see my content node in the repository browser, but i can download my uploaded content with a full url path. I had to set the datastore to db as well

Thanks
                
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33976-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Sat Jan 28 09:12:25 2012
Return-Path: <dev-return-33976-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9E8619968
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Sat, 28 Jan 2012 09:12:25 +0000 (UTC)
Received: (qmail 11893 invoked by uid 500); 28 Jan 2012 09:12:15 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 11501 invoked by uid 500); 28 Jan 2012 09:11:59 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 11490 invoked by uid 99); 28 Jan 2012 09:11:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 28 Jan 2012 09:11:52 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 28 Jan 2012 09:11:48 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 4E6231685BF
	for <dev@jackrabbit.apache.org>; Sat, 28 Jan 2012 09:11:27 +0000 (UTC)
Date: Sat, 28 Jan 2012 09:11:27 +0000 (UTC)
From: "Jukka Zitting (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1083198968.3925.1327741887323.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13195464#comment-13195464 ] 

Jukka Zitting commented on JCR-3221:
------------------------------------

The isNew() method of NodePropBundle is managed internally by Jackrabbit. The flag is set to false if the bundle is loaded from the underlying persistence store, and to true if the bundle was created in memory and is now for the first time being persisted.

The SharedItemStateManager initialization code referenced in the stack trace above does the following:

        if (!hasNonVirtualItemState(rootNodeId)) {
            createRootNodeState(rootNodeId, ntReg);
        }

Since Jackrabbit is supposed to be the only instance accessing the underlying database, there should be no need to double-check this flag with a bundleSelectSQL instruction. The only case I can think of when something like this could happen is when another Jackrabbit instance is concurrently accessing the same database.

I suspect this might rather be a Sling problem instead of a Jackrabbit one. Can you check whether you can reproduce the problem with the following command when you have no other Java processes running:

    $ java -jar jackrabbit-standalone-2.2.10.jar --conf /path/to/repository.xml

If this also fails, please attach the repository.xml file (you can remove any sensitive database connection details) so we can try reproducing the problem. The above command certainly works with the default Jackrabbit configuration.
                
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33977-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Sat Jan 28 13:41:36 2012
Return-Path: <dev-return-33977-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E82709FE3
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Sat, 28 Jan 2012 13:41:36 +0000 (UTC)
Received: (qmail 75568 invoked by uid 500); 28 Jan 2012 13:41:36 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 74937 invoked by uid 500); 28 Jan 2012 13:41:35 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 74267 invoked by uid 99); 28 Jan 2012 13:41:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 28 Jan 2012 13:41:34 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 28 Jan 2012 13:41:31 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 2038F169868
	for <dev@jackrabbit.apache.org>; Sat, 28 Jan 2012 13:41:10 +0000 (UTC)
Date: Sat, 28 Jan 2012 13:41:10 +0000 (UTC)
From: "Stefan Guggisberg (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1045592046.4333.1327758070133.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13195533#comment-13195533 ] 

Stefan Guggisberg commented on JCR-3221:
----------------------------------------

> Rohit Nijhawan added a comment - 27/Jan/12 22:31
> [...] Even against derby (Remember, there are no unique constraint indexes on the derby ddl) [...]

FWIW: there's a PRIMARY KEY constraint in the CREATE TABLE statement. a primary key *uniquely* identifies a row in the table.
                
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33978-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 30 16:54:52 2012
Return-Path: <dev-return-33978-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6B5459228
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 30 Jan 2012 16:54:52 +0000 (UTC)
Received: (qmail 84082 invoked by uid 500); 30 Jan 2012 16:54:52 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 83957 invoked by uid 500); 30 Jan 2012 16:54:51 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 83950 invoked by uid 99); 30 Jan 2012 16:54:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 16:54:51 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of dpfister@adobe.com designates 64.18.1.23 as permitted sender)
Received: from [64.18.1.23] (HELO exprod6og109.obsmtp.com) (64.18.1.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 16:54:42 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob109.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTybLO5wOs5fmzNny5cWL13b0ELKelVV5@postini.com; Mon, 30 Jan 2012 08:54:21 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0UGsIbR023450
	for <dev@jackrabbit.apache.org>; Mon, 30 Jan 2012 08:54:18 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0UGs9Pm015942
	for <dev@jackrabbit.apache.org>; Mon, 30 Jan 2012 08:54:14 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Mon, 30 Jan 2012
 08:54:13 -0800
Received: from [10.136.171.213] (10.136.171.213) by eurhub01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Mon, 30 Jan 2012
 16:54:10 +0000
Message-ID: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
From: Dominique Pfister <dpfister@adobe.com>
To: <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset="US-ASCII"; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
MIME-Version: 1.0 (Apple Message framework v936)
Subject: [jr3 Microkernel] compiler settings in pom.xml
Date: Mon, 30 Jan 2012 17:54:09 +0100
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Just stumbled across this compilation setting in microkernel's pom.xml:

             <plugin>
                 <artifactId>maven-compiler-plugin</artifactId>
                 <version>2.3.2</version>
                 <configuration>
                     <source>1.5</source>
                     <target>1.5</target>
                 </configuration>
             </plugin>

When actually _using_ a 1.5 jdk (on Mac OS X this can be done with the  
Java Preferences tool), the maven-compiler-plugin will report 12  
errors due to use of Java 1.6 methods.

So my question is: should we change this setting from 1.5 to 1.6  
(which I favor) or review our code?

Regards
Dominique

From dev-return-33979-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 30 18:58:33 2012
Return-Path: <dev-return-33979-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 29E0998B6
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 30 Jan 2012 18:58:33 +0000 (UTC)
Received: (qmail 18981 invoked by uid 500); 30 Jan 2012 18:58:32 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 18913 invoked by uid 500); 30 Jan 2012 18:58:32 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 18906 invoked by uid 99); 30 Jan 2012 18:58:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 18:58:32 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 18:58:30 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 3395D16DF53
	for <dev@jackrabbit.apache.org>; Mon, 30 Jan 2012 18:58:10 +0000 (UTC)
Date: Mon, 30 Jan 2012 18:58:10 +0000 (UTC)
From: "Rohit Nijhawan (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1267901634.8509.1327949890212.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Rohit Nijhawan updated JCR-3221:
--------------------------------

    Attachment: repositorya.xml

This is the repository xml settings file that I am using.
                
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>         Attachments: repositorya.xml
>
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33980-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 30 19:00:37 2012
Return-Path: <dev-return-33980-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EC4B4996C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 30 Jan 2012 19:00:36 +0000 (UTC)
Received: (qmail 20830 invoked by uid 500); 30 Jan 2012 19:00:36 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 20761 invoked by uid 500); 30 Jan 2012 19:00:36 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 20753 invoked by uid 99); 30 Jan 2012 19:00:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 19:00:35 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 19:00:32 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 1A6B516E054
	for <dev@jackrabbit.apache.org>; Mon, 30 Jan 2012 19:00:11 +0000 (UTC)
Date: Mon, 30 Jan 2012 19:00:11 +0000 (UTC)
From: "Rohit Nijhawan (Commented) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <288187126.8521.1327950011110.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Commented] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


    [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=13196314#comment-13196314 ] 

Rohit Nijhawan commented on JCR-3221:
-------------------------------------

FWIW... yes there is a primary key on the derby table, except, the schema is entirely different. There's a node_id_lo and a node_id_hi. The data itself does not have any role in the key. However, in the oracle.ddl schema, NODE_ID comes from bundle.id and I myself observed duplicate bundles being written in the derby db, on startup as well.

Further, once I start my server against an initialized oracle database (one with nodes and content and initial data), I get this error:


30.01.2012 13:58:22.966 *ERROR* [Repository Pinger] org.apache.sling.jcr.jackrabbit.server acquireRepository: Repository problem starting repository from file:/D:/wss/ws3/sling/jackrabbit/repository.xml in D:\wss\ws3\sling\jackrabbit (javax.jcr.RepositoryException: The repository home D:\wss\ws3\sling\jackrabbit appears to be in use since the file named .lock is already locked by the current process.) javax.jcr.RepositoryException: The repository home D:\wss\ws3\sling\jackrabbit appears to be in use since the file named .lock is already locked by the current process.
	at org.apache.jackrabbit.core.util.RepositoryLock.tryLock(RepositoryLock.java:159)
	at org.apache.jackrabbit.core.util.RepositoryLock.acquire(RepositoryLock.java:138)
	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:302)
	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:673)
	at org.apache.sling.jcr.jackrabbit.server.impl.SlingServerRepository.acquireRepository(SlingServerRepository.java:141)
	at org.apache.sling.jcr.base.AbstractSlingRepository.startRepository(AbstractSlingRepository.java:795)
	at org.apache.sling.jcr.base.AbstractSlingRepository.run(AbstractSlingRepository.java:925)
	at java.lang.Thread.run(Thread.java:662)
                
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>         Attachments: repositorya.xml
>
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33981-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Mon Jan 30 19:29:33 2012
Return-Path: <dev-return-33981-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E9D25918B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Mon, 30 Jan 2012 19:29:33 +0000 (UTC)
Received: (qmail 70073 invoked by uid 500); 30 Jan 2012 19:29:33 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 69747 invoked by uid 500); 30 Jan 2012 19:29:32 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 69722 invoked by uid 99); 30 Jan 2012 19:29:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 19:29:32 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 30 Jan 2012 19:29:30 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 7C11E16E5A2
	for <dev@jackrabbit.apache.org>; Mon, 30 Jan 2012 19:29:10 +0000 (UTC)
Date: Mon, 30 Jan 2012 19:29:10 +0000 (UTC)
From: "Rohit Nijhawan (Resolved) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <560794138.8700.1327951750509.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1540943234.81673.1327593038851.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Resolved] (JCR-3221) Jackrabbit in Sling won't bootstrap
 against oracle
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/JCR-3221?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Rohit Nijhawan resolved JCR-3221.
---------------------------------

    Resolution: Invalid

This issue is invalid. The problem is in repository.xml 

Because there was an error raised saying this: 
Replacement not found for ${wsp.name}

I changed it to a fixed literal jcr_default_

Therefore, for both, default and security workspaces, the name in the database schema was exactly the same. When jackrabbit tried to insert bundles, they went into the exact same tables which prompted me to open this bug in error.
                
> Jackrabbit in Sling won't bootstrap against oracle
> --------------------------------------------------
>
>                 Key: JCR-3221
>                 URL: https://issues.apache.org/jira/browse/JCR-3221
>             Project: Jackrabbit Content Repository
>          Issue Type: Test
>          Components: config
>    Affects Versions: 2.2.10
>         Environment: Windows 7, Java JRE 1.6.0_29
>            Reporter: Rohit Nijhawan
>         Attachments: repositorya.xml
>
>   Original Estimate: 48h
>  Remaining Estimate: 48h
>
> 1. Trying to use jackrabbit persistence config to Oracle under Sling 
> 2. Trying to run the jackrabbit standalone server against Oracle
> in Sling, seeing this error repeatedly. If I run a DELETE FROM JCR_DEFAULT_BUNDLE, the server starts up in sling but only 28/75 bundles are active and only 101/152 services launch after all the bundles are manually made active by pressing the |>| play button beside them. AuthenticationSupport service never runs. I can log in but not upload content.
> And in the the jackrabbit standalone server, if I delete from JCR_DEFAULT_BUNDLE, the server never starts up fully. It stays at Starting the server...
> I have tried both: the pool.OraclePersistenceManager and bundle.OraclePersistenceManager classes. I've seen similar issues with 'writing the bundle' error but not one that was enforced on a unique constraint from an index.
> 2012-01-26 10:32:14.533 ERROR [main] BundleDbPersistenceManager.java:1108 FATAL error while writing the bundle: deadbeef-cafe-babe-cafe-babecafebabe
> java.sql.SQLException: ORA-00001: unique constraint (MIC_COMMON_SB.JCR_DEFAULT_BUNDLE_IDX) violated
> 	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:113) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:754) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:972) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1192) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3415) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3521) ~[na:Oracle JDBC Driver version - "10.2.0.5.0"]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.execute(ConnectionHelper.java:474) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.reallyUpdate(ConnectionHelper.java:335) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:323) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$2.call(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper$RetryManager.doTry(ConnectionHelper.java:487) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.util.db.ConnectionHelper.update(ConnectionHelper.java:319) ~[jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.storeBundle(BundleDbPersistenceManager.java:1095) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.putBundle(AbstractBundlePersistenceManager.java:699) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.storeInternal(AbstractBundlePersistenceManager.java:641) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.bundle.AbstractBundlePersistenceManager.store(AbstractBundlePersistenceManager.java:518) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager.store(BundleDbPersistenceManager.java:479) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.createRootNodeState(SharedItemStateManager.java:1679) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.state.SharedItemStateManager.<init>(SharedItemStateManager.java:212) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.createItemStateManager(RepositoryImpl.java:1379) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.doInitialize(RepositoryImpl.java:2025) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl$WorkspaceInfo.initialize(RepositoryImpl.java:1998) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.initStartupWorkspaces(RepositoryImpl.java:533) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.<init>(RepositoryImpl.java:342) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.core.RepositoryImpl.create(RepositoryImpl.java:605) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.apache.jackrabbit.servlet.jackrabbit.JackrabbitRepositoryServlet.init(JackrabbitRepositoryServlet.java:103) [jackrabbit-standalone-2.2.10.jar:na]
> 	at javax.servlet.GenericServlet.init(GenericServlet.java:241) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.RequestLogHandler.doStart(RequestLogHandler.java:115) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.jetty.Server.doStart(Server.java:224) [jackrabbit-standalone-2.2.10.jar:na]
> 	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jackrabbit-standalone-2.2.10.jar:na]

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-33982-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 00:19:06 2012
Return-Path: <dev-return-33982-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1F2B795C2
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 00:19:06 +0000 (UTC)
Received: (qmail 49562 invoked by uid 500); 31 Jan 2012 00:19:03 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 49198 invoked by uid 500); 31 Jan 2012 00:19:03 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Delivered-To: moderator for dev@jackrabbit.apache.org
Received: (qmail 83995 invoked by uid 99); 30 Jan 2012 20:50:53 -0000
X-ASF-Spam-Status: No, hits=3.0 required=5.0
	tests=FORGED_YAHOO_RCVD,SPF_NEUTRAL,URI_HEX
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Date: Mon, 30 Jan 2012 12:50:27 -0800 (PST)
From: antbully12345 <ant_bully@yahoo.com>
To: dev@jackrabbit.apache.org
Message-ID: <1327956627718-4342519.post@n4.nabble.com>
Subject: Repository.xml cluster journal definition
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

I have my cluster tag defined as below:
<Cluster>
    <Journal class="org.apache.jackrabbit.core.journal.JNDIDatabaseJournal">
      
      
      
      
      
    </Journal>
  </Cluster>

When I start my server, it is trying to create journal table and is erroring
out. The reason is that the query to create this journal table has
'${tablespace}' in the end.

Can someone please let me know how to fix this issue?

Thanks in advance.

--
View this message in context: http://jackrabbit.510166.n4.nabble.com/Repository-xml-cluster-journal-definition-tp4342519p4342519.html
Sent from the Jackrabbit - Dev mailing list archive at Nabble.com.

From dev-return-33983-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 08:15:58 2012
Return-Path: <dev-return-33983-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 126649AC9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 08:15:58 +0000 (UTC)
Received: (qmail 72250 invoked by uid 500); 31 Jan 2012 08:15:56 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 71902 invoked by uid 500); 31 Jan 2012 08:15:49 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 71894 invoked by uid 99); 31 Jan 2012 08:15:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 08:15:47 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.187 as permitted sender)
Received: from [64.18.1.187] (HELO exprod6og104.obsmtp.com) (64.18.1.187)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 08:15:38 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob104.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyejFOJPjWUp2yqhFq8xP6YI31Nc1l2R@postini.com; Tue, 31 Jan 2012 00:15:18 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.sea.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0V8FFbR015641
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 00:15:16 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0V8FEMM024029
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 00:15:14 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 00:15:14 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Tue, 31 Jan 2012 08:15:11
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 08:15:11 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: Aczf8HP7yoVW/Z+WRSGC9IjcuY6KCA==
Message-ID: <1602C61E-029A-4A17-9995-C2A5B5AA4916@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
In-Reply-To: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

Am 30.01.2012 um 17:54 schrieb Dominique Pfister:

> Hi,
>=20
> Just stumbled across this compilation setting in microkernel's pom.xml:
>=20
>             <plugin>
>                 <artifactId>maven-compiler-plugin</artifactId>
>                 <version>2.3.2</version>
>                 <configuration>
>                     <source>1.5</source>
>                     <target>1.5</target>
>                 </configuration>
>             </plugin>
>=20
> When actually _using_ a 1.5 jdk (on Mac OS X this can be done with the =20
> Java Preferences tool), the maven-compiler-plugin will report 12 =20
> errors due to use of Java 1.6 methods.

Using the animal sniffer plugin would help, yet ...
>=20
> So my question is: should we change this setting from 1.5 to 1.6 =20
> (which I favor) or review our code?

I agree that it is about time to abandon Java 5 ...

Regards
Felix

From dev-return-33984-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 08:22:40 2012
Return-Path: <dev-return-33984-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 960539DCE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 08:22:40 +0000 (UTC)
Received: (qmail 89836 invoked by uid 500); 31 Jan 2012 08:22:39 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 85697 invoked by uid 500); 31 Jan 2012 08:22:28 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 85072 invoked by uid 99); 31 Jan 2012 08:22:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 08:22:23 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mueller@adobe.com designates 64.18.1.39 as permitted sender)
Received: from [64.18.1.39] (HELO exprod6og117.obsmtp.com) (64.18.1.39)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 08:22:13 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob117.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyekoOo8wbpVraTaMKhm+J+POLhrhDFu@postini.com; Tue, 31 Jan 2012 00:21:53 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.corp.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0V8LpbR016010
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 00:21:51 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0V8LoMM027784
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 00:21:50 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 00:21:50 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Tue, 31 Jan 2012 08:21:47
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 08:21:45 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: Aczf8V+Y5K0H0mxiTGWnrBZavyhLEA==
Message-ID: <CB4D62EA.2393E%mueller@adobe.com>
In-Reply-To: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

+1 for changing to 1.6.

Regards,
Thomas


On 1/30/12 5:54 PM, "Dominique Pfister" <dpfister@adobe.com> wrote:

>Hi,
>
>Just stumbled across this compilation setting in microkernel's pom.xml:
>
>             <plugin>
>                 <artifactId>maven-compiler-plugin</artifactId>
>                 <version>2.3.2</version>
>                 <configuration>
>                     <source>1.5</source>
>                     <target>1.5</target>
>                 </configuration>
>             </plugin>
>
>When actually _using_ a 1.5 jdk (on Mac OS X this can be done with the
>Java Preferences tool), the maven-compiler-plugin will report 12
>errors due to use of Java 1.6 methods.
>
>So my question is: should we change this setting from 1.5 to 1.6
>(which I favor) or review our code?
>
>Regards
>Dominique


From dev-return-33985-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 08:40:36 2012
Return-Path: <dev-return-33985-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 07EA39FA9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 08:40:36 +0000 (UTC)
Received: (qmail 14962 invoked by uid 500); 31 Jan 2012 08:40:35 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 14547 invoked by uid 500); 31 Jan 2012 08:40:28 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 14521 invoked by uid 99); 31 Jan 2012 08:40:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 08:40:25 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.210.170 as permitted sender)
Received: from [209.85.210.170] (HELO mail-iy0-f170.google.com) (209.85.210.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 08:40:17 +0000
Received: by iakk32 with SMTP id k32so5290866iak.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 00:39:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=WRWnfbGXldlBhZ90Tlz7S5EV/bSv7Rj1dwhlCsf/cnk=;
        b=eptHGhvMjULmoxWb50+r4oSuMuQsFEDot2NOWJNmIzU+WY0eQUn4qgwbGYS8DeTsXy
         7H2pIWEADHii61acP6aENVlFQRGr1bOjM8uk0fH2zaCDQDuj6SOo5AQrTYNHrA1svYLU
         LzRdIBqkyial5XIhwnL4VaFy7CXKGyVcZozTs=
MIME-Version: 1.0
Received: by 10.50.236.5 with SMTP id uq5mr1446212igc.13.1327999196721; Tue,
 31 Jan 2012 00:39:56 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Tue, 31 Jan 2012 00:39:56 -0800 (PST)
In-Reply-To: <CB4D62EA.2393E%mueller@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
	<CB4D62EA.2393E%mueller@adobe.com>
Date: Tue, 31 Jan 2012 09:39:56 +0100
Message-ID: <CAFYk8NnabyxcGbuurmPzq6-34Sa0vOS8QAKH3JwxnW7rwJkHAg@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Tue, Jan 31, 2012 at 9:21 AM, Thomas Mueller <mueller@adobe.com> wrote:
> Hi,
>
> +1 for changing to 1.6.

yup.

cheers
stefan

>
> Regards,
> Thomas
>
>
> On 1/30/12 5:54 PM, "Dominique Pfister" <dpfister@adobe.com> wrote:
>
>>Hi,
>>
>>Just stumbled across this compilation setting in microkernel's pom.xml:
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 <plugin>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <artifactId>maven-compiler-plugin</artif=
actId>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <version>2.3.2</version>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <configuration>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <source>1.5</source>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <target>1.5</target>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 </configuration>
>> =A0 =A0 =A0 =A0 =A0 =A0 </plugin>
>>
>>When actually _using_ a 1.5 jdk (on Mac OS X this can be done with the
>>Java Preferences tool), the maven-compiler-plugin will report 12
>>errors due to use of Java 1.6 methods.
>>
>>So my question is: should we change this setting from 1.5 to 1.6
>>(which I favor) or review our code?
>>
>>Regards
>>Dominique
>

From dev-return-33986-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 10:44:30 2012
Return-Path: <dev-return-33986-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4B98E9005
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 10:44:30 +0000 (UTC)
Received: (qmail 79542 invoked by uid 500); 31 Jan 2012 10:44:30 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 78996 invoked by uid 500); 31 Jan 2012 10:44:23 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 78966 invoked by uid 99); 31 Jan 2012 10:44:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 10:44:20 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 209.85.212.170 as permitted sender)
Received: from [209.85.212.170] (HELO mail-wi0-f170.google.com) (209.85.212.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 10:44:13 +0000
Received: by wibhm4 with SMTP id hm4so8522218wib.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 02:43:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=qWXuppKa8PeXqm8ziyW3j70UGHusb+NtIK3kt04I9LE=;
        b=qiRIHD782uRkI53hAHyK8kYrACfWlvO4Drejqge4i5M7BLhz1u7xf9F/AJG1V6ega5
         1Lag6ZGOJg3E8PVPu4X5THpOceiGdeWBlc+znwBKiSuOHMRaO5gBG4AOa7Yg38zjbTBD
         49BMHZhFhJy0U46Nl++oafuYt7WU25ef6NkDQ=
Received: by 10.180.86.198 with SMTP id r6mr2850554wiz.2.1328006632100; Tue,
 31 Jan 2012 02:43:52 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Tue, 31 Jan 2012 02:43:32 -0800 (PST)
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 31 Jan 2012 11:43:32 +0100
Message-ID: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
Subject: [VOTE] Release Apache Jackrabbit 2.2.11
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

A candidate for the Jackrabbit 2.2.11 release is available at:

    http://people.apache.org/~jukka/jackrabbit/2.2.11/

The release candidate is a zip archive of the sources in:

=A0 =A0 http://svn.apache.org/repos/asf/jackrabbit/tags/2.2.11/

The SHA1 checksum of the archive is 9d7c16265ee5c8578fef3b120389a0c22a4e4d4=
f.

A staged Maven repository is available for review at:

=A0 =A0 https://repository.apache.org/content/repositories/orgapachejackrab=
bit-163/

The command for running automated checks against this release candidate is:

=A0 =A0 $ sh check-release.sh jukka 2.2.11 9d7c16265ee5c8578fef3b120389a0c2=
2a4e4d4f

Please vote on releasing this package as Apache Jackrabbit 2.2.11.
The vote is open for the next 72 hours and passes if a majority of at
least three +1 Jackrabbit PMC votes are cast.

=A0 =A0 [ ] +1 Release this package as Apache Jackrabbit 2.2.11
=A0 =A0 [ ] -1 Do not release this package because...

My vote is +1.

BR,

Jukka Zitting

From dev-return-33987-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 10:54:23 2012
Return-Path: <dev-return-33987-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 823EA95F9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 10:54:23 +0000 (UTC)
Received: (qmail 92628 invoked by uid 500); 31 Jan 2012 10:54:23 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 92413 invoked by uid 500); 31 Jan 2012 10:54:21 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 92406 invoked by uid 99); 31 Jan 2012 10:54:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 10:54:21 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of dpfister@adobe.com designates 64.18.1.39 as permitted sender)
Received: from [64.18.1.39] (HELO exprod6og117.obsmtp.com) (64.18.1.39)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 10:54:12 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob117.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyfIPnk3cogfVQDEaRC3ZugvR8dalfr4@postini.com; Tue, 31 Jan 2012 02:53:51 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VArnbR028405
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 02:53:49 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0VArmPl004826
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 02:53:49 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan
 2012 02:53:48 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Tue, 31 Jan 2012 10:53:46
 +0000
From: Dominique Pfister <dpfister@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 10:54:53 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: AczgBpqMeP1JZ2cUROGpF6Sid1U2kw==
Message-ID: <8FEDB400-33AD-44F1-BB06-A6E41F04B7DA@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
 <1602C61E-029A-4A17-9995-C2A5B5AA4916@adobe.com>
In-Reply-To: <1602C61E-029A-4A17-9995-C2A5B5AA4916@adobe.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Felix,

On Jan 31, 2012, at 9:15 AM, Felix Meschberger wrote:

> Hi,
>=20
> Am 30.01.2012 um 17:54 schrieb Dominique Pfister:
>=20
>> Hi,
>>=20
>> Just stumbled across this compilation setting in microkernel's pom.xml:
>>=20
>>            <plugin>
>>                <artifactId>maven-compiler-plugin</artifactId>
>>                <version>2.3.2</version>
>>                <configuration>
>>                    <source>1.5</source>
>>                    <target>1.5</target>
>>                </configuration>
>>            </plugin>
>>=20
>> When actually _using_ a 1.5 jdk (on Mac OS X this can be done with the =
=20
>> Java Preferences tool), the maven-compiler-plugin will report 12 =20
>> errors due to use of Java 1.6 methods.
>=20
> Using the animal sniffer plugin would help, yet ...

Cool, just gave it a try:

[ERROR] Undefined reference: java/io/IOException.<init>(Ljava/lang/Throwabl=
e;)V in /Users/dpfister/Projects/microkernel/target/classes/org/apache/jack=
rabbit/mk/blobs/BlobStoreInputStream.class
[ERROR] Undefined reference: java/util/Arrays.copyOfRange([Ljava/lang/Objec=
t;IILjava/lang/Class;)[Ljava/lang/Object; in /Users/dpfister/Projects/micro=
kernel/target/classes/org/apache/jackrabbit/mk/index/BTreeLeaf.class
[ERROR] Undefined reference: java/util/Arrays.copyOfRange([Ljava/lang/Objec=
t;IILjava/lang/Class;)[Ljava/lang/Object; in /Users/dpfister/Projects/micro=
kernel/target/classes/org/apache/jackrabbit/mk/index/BTreeNode.class
[ERROR] Undefined reference: java/io/PipedInputStream.<init>(I)V in /Users/=
dpfister/Projects/microkernel/target/classes/org/apache/jackrabbit/mk/util/=
MemorySockets$PipedSocket.class

Good to know, thanks!
Dominique


From dev-return-33988-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 11:11:45 2012
Return-Path: <dev-return-33988-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CDCA49194
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 11:11:45 +0000 (UTC)
Received: (qmail 27524 invoked by uid 500); 31 Jan 2012 11:11:45 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 27439 invoked by uid 500); 31 Jan 2012 11:11:44 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 27431 invoked by uid 99); 31 Jan 2012 11:11:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 11:11:44 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.21] (HELO exprod6og108.obsmtp.com) (64.18.1.21)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 11:11:35 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob108.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyfMUrCn4M90Srk/uwdVQMARH5jczESD@postini.com; Tue, 31 Jan 2012 03:11:15 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VB9L0Y017691
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 03:09:21 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VBBEMM001547
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 03:11:14 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 03:11:14 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 11:11:12 +0000
Message-ID: <4F27CC50.2080207@apache.org>
Date: Tue, 31 Jan 2012 11:11:12 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
In-Reply-To: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit


+1 for 1.6
Michael

On 30.1.12 16:54, Dominique Pfister wrote:
> Hi,
>
> Just stumbled across this compilation setting in microkernel's pom.xml:
>
> <plugin>
> <artifactId>maven-compiler-plugin</artifactId>
> <version>2.3.2</version>
> <configuration>
> <source>1.5</source>
> <target>1.5</target>
> </configuration>
> </plugin>
>
> When actually _using_ a 1.5 jdk (on Mac OS X this can be done with the
> Java Preferences tool), the maven-compiler-plugin will report 12 errors
> due to use of Java 1.6 methods.
>
> So my question is: should we change this setting from 1.5 to 1.6 (which
> I favor) or review our code?
>
> Regards
> Dominique

From dev-return-33989-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 11:29:19 2012
Return-Path: <dev-return-33989-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2041590EB
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 11:29:19 +0000 (UTC)
Received: (qmail 48742 invoked by uid 500); 31 Jan 2012 11:29:18 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 48695 invoked by uid 500); 31 Jan 2012 11:29:18 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 48688 invoked by uid 99); 31 Jan 2012 11:29:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 11:29:18 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 11:29:11 +0000
Received: by werm1 with SMTP id m1so8813423wer.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 03:28:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=J81652+M2r74nm4ZeRSnISmN76mp5ZQ8YaPHCMVFLfI=;
        b=JNyZ0435Rvviy7Y8TnzK9BMjHYvI7I5La0OWf0i/BK/X6sYUNmXTmWtzX3+M2hWo1z
         HKlGl9K4IY32PuoiJR38tJ2p0fjdbn9UHtnXmtXdam87InDGYw43FUJNyANl6rtQMTxf
         s4BoX62qJL3nS7x44YsMF5b0w5wh9E8/+496A=
Received: by 10.216.135.91 with SMTP id t69mr8653797wei.33.1328009331127; Tue,
 31 Jan 2012 03:28:51 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Tue, 31 Jan 2012 03:28:31 -0800 (PST)
In-Reply-To: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 31 Jan 2012 12:28:31 +0100
Message-ID: <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Mon, Jan 30, 2012 at 5:54 PM, Dominique Pfister <dpfister@adobe.com> wrote:
> So my question is: should we change this setting from 1.5 to 1.6 (which I
> favor) or review our code?

+1 to 1.6

And while we're at it, would people be interested in using a "language
enhancement" tool like Lombok [1] to reduce the amount of commonly
needed boilerplate code? The downside is that the such custom
extensions increase the entry barrier for people trying to understand
the code and might make some tool integration (debugging, etc.) a bit
harder. Personally I think the benefits would be worth it.

[1] http://projectlombok.org/

BR,

Jukka Zitting

From dev-return-33990-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 11:51:21 2012
Return-Path: <dev-return-33990-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4BF439833
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 11:51:21 +0000 (UTC)
Received: (qmail 76081 invoked by uid 500); 31 Jan 2012 11:51:21 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 75985 invoked by uid 500); 31 Jan 2012 11:51:20 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 75886 invoked by uid 99); 31 Jan 2012 11:51:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 11:51:19 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mueller@adobe.com designates 64.18.1.37 as permitted sender)
Received: from [64.18.1.37] (HELO exprod6og116.obsmtp.com) (64.18.1.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 11:51:11 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob116.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyfVmlh7YhaSVgBZQbajAc0PDwzluxFx@postini.com; Tue, 31 Jan 2012 03:50:51 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VBonbR002498
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 03:50:49 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0VBonPl016716
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 03:50:49 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 03:50:48 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Tue, 31 Jan 2012 11:50:45
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 11:50:44 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: AczgDpDeZOwYc1UZQiSItLqAwaYdqA==
Message-ID: <CB4D9325.23982%mueller@adobe.com>
In-Reply-To: <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

>Lombok

It would be OK for me (even if I personally wouldn't use such feature
currently).


I never used Lombok and don't know if there would be disadvantages, for
example, does it work well in Eclipse. I guess the only way to find out is
to try.

Regards,
Thomas


From dev-return-33991-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 12:46:21 2012
Return-Path: <dev-return-33991-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B379E97EA
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 12:46:21 +0000 (UTC)
Received: (qmail 41909 invoked by uid 500); 31 Jan 2012 12:46:21 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 41872 invoked by uid 500); 31 Jan 2012 12:46:20 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 41865 invoked by uid 99); 31 Jan 2012 12:46:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 12:46:20 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of alex.parvulescu@gmail.com designates 209.85.216.170 as permitted sender)
Received: from [209.85.216.170] (HELO mail-qy0-f170.google.com) (209.85.216.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 12:46:14 +0000
Received: by qcmt36 with SMTP id t36so548266qcm.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 04:45:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=WgMit6rdEeep3ErUugYvOGUOh4szTuvaf9yhuD9J93Y=;
        b=otRbKTvON+F3eF045OZbEDdkcZ9zNLCjcWSGRvH5hgLw3v6e+g++EjoNMgFupDUc5n
         BDj6LsYfJNU62zk3X5/YKBezgq7ts3AOermkxTRk7hptW2O01F8a26Zu6OYKL/c3nWHm
         ihD0m/RRYG074N4kMp+HdYcmX4MQe9yqkKh+Q=
MIME-Version: 1.0
Received: by 10.224.183.81 with SMTP id cf17mr27264742qab.48.1328013952560;
 Tue, 31 Jan 2012 04:45:52 -0800 (PST)
Received: by 10.229.96.15 with HTTP; Tue, 31 Jan 2012 04:45:52 -0800 (PST)
In-Reply-To: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
References: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
Date: Tue, 31 Jan 2012 13:45:52 +0100
Message-ID: <CAB-0WTBtHkNMfEYnXEL9kqZcWuU0QWd67kL=j7=gyXnZL3QrfA@mail.gmail.com>
Subject: Re: [VOTE] Release Apache Jackrabbit 2.2.11
From: Alex Parvulescu <alex.parvulescu@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: multipart/alternative; boundary=20cf303b39fde62f3f04b7d25731

--20cf303b39fde62f3f04b7d25731
Content-Type: text/plain; charset=ISO-8859-1

+1

the check is good,
alex

On Tue, Jan 31, 2012 at 11:43 AM, Jukka Zitting <jukka.zitting@gmail.com>wrote:

> Hi,
>
> A candidate for the Jackrabbit 2.2.11 release is available at:
>
>    http://people.apache.org/~jukka/jackrabbit/2.2.11/
>
> The release candidate is a zip archive of the sources in:
>
>     http://svn.apache.org/repos/asf/jackrabbit/tags/2.2.11/
>
> The SHA1 checksum of the archive is
> 9d7c16265ee5c8578fef3b120389a0c22a4e4d4f.
>
> A staged Maven repository is available for review at:
>
>
> https://repository.apache.org/content/repositories/orgapachejackrabbit-163/
>
> The command for running automated checks against this release candidate is:
>
>     $ sh check-release.sh jukka 2.2.11
> 9d7c16265ee5c8578fef3b120389a0c22a4e4d4f
>
> Please vote on releasing this package as Apache Jackrabbit 2.2.11.
> The vote is open for the next 72 hours and passes if a majority of at
> least three +1 Jackrabbit PMC votes are cast.
>
>     [ ] +1 Release this package as Apache Jackrabbit 2.2.11
>     [ ] -1 Do not release this package because...
>
> My vote is +1.
>
> BR,
>
> Jukka Zitting
>

--20cf303b39fde62f3f04b7d25731
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

+1=A0<div><br></div><div>the check is good,<div>alex<br><br><div class=3D"g=
mail_quote">On Tue, Jan 31, 2012 at 11:43 AM, Jukka Zitting <span dir=3D"lt=
r">&lt;<a href=3D"mailto:jukka.zitting@gmail.com">jukka.zitting@gmail.com</=
a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">Hi,<br>
<br>
A candidate for the Jackrabbit 2.2.11 release is available at:<br>
<br>
 =A0 =A0<a href=3D"http://people.apache.org/~jukka/jackrabbit/2.2.11/" targ=
et=3D"_blank">http://people.apache.org/~jukka/jackrabbit/2.2.11/</a><br>
<br>
The release candidate is a zip archive of the sources in:<br>
<br>
=A0 =A0 <a href=3D"http://svn.apache.org/repos/asf/jackrabbit/tags/2.2.11/"=
 target=3D"_blank">http://svn.apache.org/repos/asf/jackrabbit/tags/2.2.11/<=
/a><br>
<br>
The SHA1 checksum of the archive is 9d7c16265ee5c8578fef3b120389a0c22a4e4d4=
f.<br>
<br>
A staged Maven repository is available for review at:<br>
<br>
=A0 =A0 <a href=3D"https://repository.apache.org/content/repositories/orgap=
achejackrabbit-163/" target=3D"_blank">https://repository.apache.org/conten=
t/repositories/orgapachejackrabbit-163/</a><br>
<br>
The command for running automated checks against this release candidate is:=
<br>
<br>
=A0 =A0 $ sh check-release.sh jukka 2.2.11 9d7c16265ee5c8578fef3b120389a0c2=
2a4e4d4f<br>
<br>
Please vote on releasing this package as Apache Jackrabbit 2.2.11.<br>
The vote is open for the next 72 hours and passes if a majority of at<br>
least three +1 Jackrabbit PMC votes are cast.<br>
<br>
=A0 =A0 [ ] +1 Release this package as Apache Jackrabbit 2.2.11<br>
=A0 =A0 [ ] -1 Do not release this package because...<br>
<br>
My vote is +1.<br>
<br>
BR,<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
Jukka Zitting<br>
</font></span></blockquote></div><br></div></div>

--20cf303b39fde62f3f04b7d25731--

From dev-return-33992-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 12:47:00 2012
Return-Path: <dev-return-33992-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2FBAD9840
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 12:47:00 +0000 (UTC)
Received: (qmail 45618 invoked by uid 500); 31 Jan 2012 12:46:59 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 45575 invoked by uid 500); 31 Jan 2012 12:46:59 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 45567 invoked by uid 99); 31 Jan 2012 12:46:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 12:46:59 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of stefan.guggisberg@gmail.com designates 209.85.214.170 as permitted sender)
Received: from [209.85.214.170] (HELO mail-tul01m020-f170.google.com) (209.85.214.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 12:46:52 +0000
Received: by obbup3 with SMTP id up3so12273631obb.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 04:46:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=aJez26N9H7wVlZ7KNp+a4tEuvyYnWHKe+qVPLQW0tB0=;
        b=BQlpsDD4xE94JugTnGFWOe4n4EdAVyMuCLuXA30JvmBrQYBQ18RaNZXxt2dNbjjP60
         JLHU+EdlXe1yJRh7hvjRpvqUuY0g5IDoAHprjMqwQcC2gXmuSfmPYjrQ5A3elUBg5sJ1
         y65ioQFzfLrlmaXbd+WzcOzjUWN2wj1IOZDkY=
MIME-Version: 1.0
Received: by 10.50.202.67 with SMTP id kg3mr11906836igc.13.1328013991223; Tue,
 31 Jan 2012 04:46:31 -0800 (PST)
Received: by 10.43.124.195 with HTTP; Tue, 31 Jan 2012 04:46:31 -0800 (PST)
In-Reply-To: <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
	<CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
Date: Tue, 31 Jan 2012 13:46:31 +0100
Message-ID: <CAFYk8NkR_vewV0hjV0rQisqtz5hgu8UmnjTs67zyn=ibRaLHNQ@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
From: Stefan Guggisberg <stefan.guggisberg@gmail.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Jan 31, 2012 at 12:28 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> Hi,
>
> On Mon, Jan 30, 2012 at 5:54 PM, Dominique Pfister <dpfister@adobe.com> wrote:
>> So my question is: should we change this setting from 1.5 to 1.6 (which I
>> favor) or review our code?
>
> +1 to 1.6
>
> And while we're at it, would people be interested in using a "language
> enhancement" tool like Lombok [1] to reduce the amount of commonly
> needed boilerplate code? The downside is that the such custom
> extensions increase the entry barrier for people trying to understand
> the code and might make some tool integration (debugging, etc.) a bit
> harder. Personally I think the benefits would be worth it.
>
> [1] http://projectlombok.org/

-0, i am not a big fan of *magic* code generating frameworks. i prefer to see
(and debug) plain java code in my ide.

cheers
stefan

>
> BR,
>
> Jukka Zitting

From dev-return-33993-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 13:23:22 2012
Return-Path: <dev-return-33993-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7519E96DE
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 13:23:22 +0000 (UTC)
Received: (qmail 30213 invoked by uid 500); 31 Jan 2012 13:23:22 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 30163 invoked by uid 500); 31 Jan 2012 13:23:21 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 30156 invoked by uid 99); 31 Jan 2012 13:23:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 13:23:21 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.191] (HELO exprod6og106.obsmtp.com) (64.18.1.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 13:23:14 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob106.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyfrLQJqMkzCWBv3rBZYUnZMH3UbmKls@postini.com; Tue, 31 Jan 2012 05:22:53 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VDKw0Y025963
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 05:20:58 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0VDMoPl004893
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 05:22:51 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 05:22:50 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 13:22:46 +0000
Message-ID: <4F27EB26.1070007@apache.org>
Date: Tue, 31 Jan 2012 13:22:46 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com> <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
In-Reply-To: <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit


On 31.1.12 11:28, Jukka Zitting wrote:
> And while we're at it, would people be interested in using a "language
> enhancement" tool like Lombok [1] to reduce the amount of commonly
> needed boilerplate code? The downside is that the such custom
> extensions increase the entry barrier for people trying to understand
> the code and might make some tool integration (debugging, etc.) a bit
> harder. Personally I think the benefits would be worth it.
>
> [1] http://projectlombok.org/

Mixed feelings. While the boilerplate addressed by Lombok continues to 
bother me, I'm a bit reluctant to use 3rd party magic here. I fear 
subtle bugs will sneak in through the back door in the long run...

I'd rather go for a modern language instead of taping things together ;-)

Michael


From dev-return-33994-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 13:32:18 2012
Return-Path: <dev-return-33994-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E020F930E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 13:32:17 +0000 (UTC)
Received: (qmail 39674 invoked by uid 500); 31 Jan 2012 13:32:17 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 39609 invoked by uid 500); 31 Jan 2012 13:32:16 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 39597 invoked by uid 99); 31 Jan 2012 13:32:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 13:32:16 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.42 as permitted sender)
Received: from [74.125.82.42] (HELO mail-ww0-f42.google.com) (74.125.82.42)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 13:32:10 +0000
Received: by wgbgn7 with SMTP id gn7so4882927wgb.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 05:31:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=jRBKrHeuM2k3OtZcGO9ZUauazXjEvF2EdGu4N3DrmmQ=;
        b=giq/ONtTX7MNLNHvfvSK5pyWWZ7G1CuLk1NXNCm5X4AZ1OfBFobpq8i0PdflEuLttD
         JZOLGXJ7P03RweCrnTGE1TfoasKt2vGcqK8qYVC8eU3vMpNnVxd9FOzZcKiXoHwG2R8v
         ikJRKahReZSnK/oJZ9Ntdllo49c37k0CuBMho=
Received: by 10.180.97.166 with SMTP id eb6mr34846428wib.5.1328016709133; Tue,
 31 Jan 2012 05:31:49 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Tue, 31 Jan 2012 05:31:29 -0800 (PST)
In-Reply-To: <4F27EB26.1070007@apache.org>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
 <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com> <4F27EB26.1070007@apache.org>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 31 Jan 2012 14:31:29 +0100
Message-ID: <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

On Tue, Jan 31, 2012 at 2:22 PM, Michael D=FCrig <mduerig@apache.org> wrote=
:
> I'd rather go for a modern language instead of taping things together ;-)

Indeed, that's another point I've been thinking about....

Are there significant parts of Jackrabbit 3 that would be better
expressed in some other programming language than Java, one with which
enough of us (at least everyone working on those parts) are familiar
and comfortable?

I'd expect the answer to be no, especially given the latter
constraint, but if we do want to do something like this, now would be
the right time to make that decision.

BR,

Jukka Zitting

From dev-return-33995-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 13:44:57 2012
Return-Path: <dev-return-33995-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9FBA3992C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 13:44:57 +0000 (UTC)
Received: (qmail 60458 invoked by uid 500); 31 Jan 2012 13:44:57 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 60397 invoked by uid 500); 31 Jan 2012 13:44:56 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 60386 invoked by uid 99); 31 Jan 2012 13:44:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 13:44:56 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.35 as permitted sender)
Received: from [64.18.1.35] (HELO exprod6og115.obsmtp.com) (64.18.1.35)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 13:44:47 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob115.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyfwOlcGmbfUZr2r+61uGNmqVl5JSGv0@postini.com; Tue, 31 Jan 2012 05:44:27 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VDgW0Y027348
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 05:42:33 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VDiQMM017325
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 05:44:26 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan
 2012 05:44:26 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Tue, 31 Jan 2012 13:44:24
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 13:44:24 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: AczgHnGG7vCKdsqvQ8K8N5qpka7LBw==
Message-ID: <3BE576AB-CD8D-4D22-8CFA-2CB06D017B64@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
 <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
 <4F27EB26.1070007@apache.org>
 <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
In-Reply-To: <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

Am 31.01.2012 um 14:31 schrieb Jukka Zitting:

> Hi,
>=20
> On Tue, Jan 31, 2012 at 2:22 PM, Michael D=FCrig <mduerig@apache.org> wro=
te:
>> I'd rather go for a modern language instead of taping things together ;-=
)

Michael is certainly thinking of Scala which has its own can of issues ... =
Syntax not being the least of it ;)

>=20
> Indeed, that's another point I've been thinking about....

I am not really sure, whether we should really open this can of worms ...

I for my part I would expect JR 3 to still be easily embedded in a JVM (dep=
loyed in an OSGi framework running in a JVM, actually), which pretty much e=
xcludes anything not being compiled to Java Byte Code executable by the JVM=
.

Regards
Felix=

From dev-return-33996-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 13:51:22 2012
Return-Path: <dev-return-33996-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8D1B29B0D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 13:51:22 +0000 (UTC)
Received: (qmail 69467 invoked by uid 500); 31 Jan 2012 13:51:22 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 69405 invoked by uid 500); 31 Jan 2012 13:51:21 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 69398 invoked by uid 99); 31 Jan 2012 13:51:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 13:51:21 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.185] (HELO exprod6og103.obsmtp.com) (64.18.1.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 13:51:14 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob103.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyfxvZ/7SM6nTT2pqa+S0ZDqbX/nmuiC@postini.com; Tue, 31 Jan 2012 05:50:53 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VDoqbR010480
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 05:50:52 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0VDopPl012814
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 05:50:52 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 05:50:51 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 13:50:50 +0000
Message-ID: <4F27F1B9.4050902@apache.org>
Date: Tue, 31 Jan 2012 13:50:49 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [VOTE] Release Apache Jackrabbit 2.2.11
References: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
In-Reply-To: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit


using check-release.sh everything seems fine. However, I had a test 
failure on the first build:

testCloseSessionWhileRunningGc(org.apache.jackrabbit.core.data.GarbageCollectorTest) 
  Time elapsed: 0.548 sec  <<< FAILURE!
junit.framework.AssertionFailedError: Exception 'session has been 
closed' expected
	at junit.framework.Assert.fail(Assert.java:47)
	at 
org.apache.jackrabbit.core.data.GarbageCollectorTest.testCloseSessionWhileRunningGc(GarbageCollectorTest.java:68)


With the second build all tests passed.

So +1 given above failure is not considered a blocker.

Michael



On 31.1.12 10:43, Jukka Zitting wrote:
> Hi,
>
> A candidate for the Jackrabbit 2.2.11 release is available at:
>
>      http://people.apache.org/~jukka/jackrabbit/2.2.11/
>
> The release candidate is a zip archive of the sources in:
>
>      http://svn.apache.org/repos/asf/jackrabbit/tags/2.2.11/
>
> The SHA1 checksum of the archive is 9d7c16265ee5c8578fef3b120389a0c22a4e4d4f.
>
> A staged Maven repository is available for review at:
>
>      https://repository.apache.org/content/repositories/orgapachejackrabbit-163/
>
> The command for running automated checks against this release candidate is:
>
>      $ sh check-release.sh jukka 2.2.11 9d7c16265ee5c8578fef3b120389a0c22a4e4d4f
>
> Please vote on releasing this package as Apache Jackrabbit 2.2.11.
> The vote is open for the next 72 hours and passes if a majority of at
> least three +1 Jackrabbit PMC votes are cast.
>
>      [ ] +1 Release this package as Apache Jackrabbit 2.2.11
>      [ ] -1 Do not release this package because...
>
> My vote is +1.
>
> BR,
>
> Jukka Zitting

From dev-return-33997-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 14:08:21 2012
Return-Path: <dev-return-33997-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2FC8992CD
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 14:08:21 +0000 (UTC)
Received: (qmail 13677 invoked by uid 500); 31 Jan 2012 14:08:20 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 13598 invoked by uid 500); 31 Jan 2012 14:08:20 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 13591 invoked by uid 99); 31 Jan 2012 14:08:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:08:20 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:08:12 +0000
Received: by werm1 with SMTP id m1so82624wer.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 06:07:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=uiIXJL89CLqSGyOA+1ppWzGVe0GBCwkvbDsjdxDBqhY=;
        b=B6WdLtmJmDzj/ga+AA3RpoUxAxtwACdP5iZ1F0bDjvkVG0PHbSwDCgZ2uJuHlyA6uf
         zvloZo/27ryQOmRctNlivSa4Sc1wgjroAGvsM7w2fLhaQtVOT28dzVMrJ3QRSODIzzJV
         GyBFyjWUHfAUFV7AT46WKXcn8d4AzWdF1uryo=
Received: by 10.216.135.91 with SMTP id t69mr8892852wei.33.1328018872288; Tue,
 31 Jan 2012 06:07:52 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Tue, 31 Jan 2012 06:07:32 -0800 (PST)
In-Reply-To: <CAOFYJNam6nsaQmexzNQ5xpJarNnP+19KyU4AvaFsmjuxAfRjxg@mail.gmail.com>
References: <CAOFYJNZQSm6UEuY0SPW9bVR92Dd4M-vix73PNVZN24RTPt6WeA@mail.gmail.com>
 <CAOFYJNYSVrZ6YgEPH+GbZ_qibhT9jBLZKbHLBoNnhxgKL5cUxQ@mail.gmail.com> <CAOFYJNam6nsaQmexzNQ5xpJarNnP+19KyU4AvaFsmjuxAfRjxg@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 31 Jan 2012 15:07:32 +0100
Message-ID: <CAOFYJNauhpGs+54VGJK5J-oFxZ1VMAvngoOueCF2oa52M9Vaig@mail.gmail.com>
Subject: Re: Jackrabbit 2.4 release plan
To: Jackrabbit Developers <dev@jackrabbit.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Mon, Jan 16, 2012 at 6:46 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> I think we should postpone cutting the 2.4.0 release two weeks ahead
> to the end of January.

OK, I think it's now time to start making the release. I already
started drafting the release notes, and will still go through the
issue tracker for any pending tasks that we may have missed.

I won't cut the release candidate before tomorrow at the earliest, so
if you still have some improvements that really should be in 2.4 but
aren't committed yet, please let me know and I'll see what we can do
to get them included. Once the 2.4.0 release is out, we'll switch the
2.4 branch to maintenance mode and target all new features to the
unstable 2.5.x release series.

BR,

Jukka Zitting

From dev-return-33998-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 14:27:16 2012
Return-Path: <dev-return-33998-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 80E6B9697
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 14:27:16 +0000 (UTC)
Received: (qmail 66344 invoked by uid 500); 31 Jan 2012 14:27:16 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 66262 invoked by uid 500); 31 Jan 2012 14:27:15 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 66255 invoked by uid 99); 31 Jan 2012 14:27:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:27:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.210.42] (HELO mail-pz0-f42.google.com) (209.85.210.42)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:27:09 +0000
Received: by dang27 with SMTP id g27so6340545dan.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 06:26:48 -0800 (PST)
MIME-Version: 1.0
Received: by 10.68.74.72 with SMTP id r8mr50170030pbv.8.1328020008172; Tue, 31
 Jan 2012 06:26:48 -0800 (PST)
Received: by 10.68.12.9 with HTTP; Tue, 31 Jan 2012 06:26:48 -0800 (PST)
In-Reply-To: <CAOFYJNauhpGs+54VGJK5J-oFxZ1VMAvngoOueCF2oa52M9Vaig@mail.gmail.com>
References: <CAOFYJNZQSm6UEuY0SPW9bVR92Dd4M-vix73PNVZN24RTPt6WeA@mail.gmail.com>
	<CAOFYJNYSVrZ6YgEPH+GbZ_qibhT9jBLZKbHLBoNnhxgKL5cUxQ@mail.gmail.com>
	<CAOFYJNam6nsaQmexzNQ5xpJarNnP+19KyU4AvaFsmjuxAfRjxg@mail.gmail.com>
	<CAOFYJNauhpGs+54VGJK5J-oFxZ1VMAvngoOueCF2oa52M9Vaig@mail.gmail.com>
Date: Wed, 1 Feb 2012 00:26:48 +1000
Message-ID: <CAJw7DjDzsD49-4RR0b6O_8n_y8Z0Wmk4tjg735d=p=edSac77Q@mail.gmail.com>
Subject: Re: Jackrabbit 2.4 release plan
From: Torgeir Veimo <torgeir@netenviron.com>
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On 1 February 2012 00:07, Jukka Zitting <jukka.zitting@gmail.com> wrote:
> Hi,
>
> On Mon, Jan 16, 2012 at 6:46 PM, Jukka Zitting <jukka.zitting@gmail.com> wrote:
>> I think we should postpone cutting the 2.4.0 release two weeks ahead
>> to the end of January.
>
> OK, I think it's now time to start making the release. I already
> started drafting the release notes, and will still go through the
> issue tracker for any pending tasks that we may have missed.
>
> I won't cut the release candidate before tomorrow at the earliest, so
> if you still have some improvements that really should be in 2.4 but
> aren't committed yet, please let me know and I'll see what we can do
> to get them included. Once the 2.4.0 release is out, we'll switch the
> 2.4 branch to maintenance mode and target all new features to the
> unstable 2.5.x release series.

Any hope for support for lucene version > 3.3?


-- 
-Tor

From dev-return-33999-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 14:31:12 2012
Return-Path: <dev-return-33999-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 59AE89F79
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 14:31:12 +0000 (UTC)
Received: (qmail 70635 invoked by uid 500); 31 Jan 2012 14:31:12 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 70583 invoked by uid 500); 31 Jan 2012 14:31:11 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 70576 invoked by uid 99); 31 Jan 2012 14:31:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:31:11 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [64.18.1.187] (HELO exprod6og104.obsmtp.com) (64.18.1.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:31:01 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob104.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyf7DvDaBo3O//82D38osSDyO3dsRX8B@postini.com; Tue, 31 Jan 2012 06:30:40 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.corp.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VEUbbR013639
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 06:30:38 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VEUZMN006296
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 06:30:36 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 06:30:36 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 14:30:35 +0000
Message-ID: <4F27FB0A.9070109@apache.org>
Date: Tue, 31 Jan 2012 14:30:34 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com> <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com> <4F27EB26.1070007@apache.org> <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
In-Reply-To: <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org


On 31.1.12 13:31, Jukka Zitting wrote:
> Hi,
>
> On Tue, Jan 31, 2012 at 2:22 PM, Michael Drig<mduerig@apache.org>  wrote:
>> I'd rather go for a modern language instead of taping things together ;-)
>
> Indeed, that's another point I've been thinking about....
>
> Are there significant parts of Jackrabbit 3 that would be better
> expressed in some other programming language than Java, one with which
> enough of us (at least everyone working on those parts) are familiar
> and comfortable?

Like Felix guessed I was primarily thinking of Scala. However there are 
other options like Clojure and Kotlin. If it weren't for the JVM I'd 
even say Haskell.

Generally languages supporting/emphasising a more functional style (lazy 
evaluation, immutable/algebraic data types, higher order functions) are 
a much better fit for upcoming requirements like big data and massive 
concurrency.

Michael


>
> I'd expect the answer to be no, especially given the latter
> constraint, but if we do want to do something like this, now would be
> the right time to make that decision.
>
> BR,
>
> Jukka Zitting

From dev-return-34000-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 14:42:51 2012
Return-Path: <dev-return-34000-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9DB6D963E
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 14:42:51 +0000 (UTC)
Received: (qmail 99736 invoked by uid 500); 31 Jan 2012 14:42:51 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 99639 invoked by uid 500); 31 Jan 2012 14:42:50 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 99632 invoked by uid 99); 31 Jan 2012 14:42:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:42:50 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.50 as permitted sender)
Received: from [74.125.82.50] (HELO mail-ww0-f50.google.com) (74.125.82.50)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:42:44 +0000
Received: by wgbdq11 with SMTP id dq11so19695wgb.19
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 06:42:24 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=q/ohrFaCS0S65rKoasn6r88m4cc4uEYkrDdXVowT3UY=;
        b=eW04dhZ3mzNarQohtUr72jOIEoA/VSAJtCTe7hJlkc4PVieOm9WQdhWY8syzj1JY2O
         DpsFgHHzNhVt+64qw7uluJtwBrY/sz5yaGbQN1gbyFn/y6FI9AdIIQYzfuHtJBBCyHQO
         oJPTBVCW/6F95OcI8k3Fkd9ibzKrcvpSHsJ8M=
Received: by 10.180.90.194 with SMTP id by2mr11706203wib.5.1328020944131; Tue,
 31 Jan 2012 06:42:24 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Tue, 31 Jan 2012 06:42:04 -0800 (PST)
In-Reply-To: <CAJw7DjDzsD49-4RR0b6O_8n_y8Z0Wmk4tjg735d=p=edSac77Q@mail.gmail.com>
References: <CAOFYJNZQSm6UEuY0SPW9bVR92Dd4M-vix73PNVZN24RTPt6WeA@mail.gmail.com>
 <CAOFYJNYSVrZ6YgEPH+GbZ_qibhT9jBLZKbHLBoNnhxgKL5cUxQ@mail.gmail.com>
 <CAOFYJNam6nsaQmexzNQ5xpJarNnP+19KyU4AvaFsmjuxAfRjxg@mail.gmail.com>
 <CAOFYJNauhpGs+54VGJK5J-oFxZ1VMAvngoOueCF2oa52M9Vaig@mail.gmail.com> <CAJw7DjDzsD49-4RR0b6O_8n_y8Z0Wmk4tjg735d=p=edSac77Q@mail.gmail.com>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 31 Jan 2012 15:42:04 +0100
Message-ID: <CAOFYJNYBrw=gFUY5yNTC9UOMxr5X3mDL1BTUUYk3-YwAr_XfWg@mail.gmail.com>
Subject: Re: Jackrabbit 2.4 release plan
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Tue, Jan 31, 2012 at 3:26 PM, Torgeir Veimo <torgeir@netenviron.com> wrote:
> Any hope for support for lucene version > 3.3?

I think it's too late for a potentially risky change like that. It
would have been great to integrate such a change a few weeks or months
ago for 2.3.x if there had been a patch that passed all integration
tests. Now it's best to postpone the Lucene upgrade to Jackrabbit
2.5.x.

BR,

Jukka Zitting

From dev-return-34001-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 14:48:29 2012
Return-Path: <dev-return-34001-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E341C9880
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 14:48:28 +0000 (UTC)
Received: (qmail 13620 invoked by uid 500); 31 Jan 2012 14:48:28 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 13581 invoked by uid 500); 31 Jan 2012 14:48:27 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 13573 invoked by uid 99); 31 Jan 2012 14:48:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:48:27 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.23] (HELO exprod6og109.obsmtp.com) (64.18.1.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 14:48:18 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob109.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTyf/HQWKC0R+YmwZKvDO9B/V11rUjt4Q@postini.com; Tue, 31 Jan 2012 06:47:58 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VElobR015186
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 06:47:51 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VElnMN014505
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 06:47:50 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan
 2012 06:47:49 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 14:47:45 +0000
Message-ID: <4F27FF11.50808@apache.org>
Date: Tue, 31 Jan 2012 14:47:45 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com> <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com> <4F27EB26.1070007@apache.org> <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com> <3BE576AB-CD8D-4D22-8CFA-2CB06D017B64@adobe.com>
In-Reply-To: <3BE576AB-CD8D-4D22-8CFA-2CB06D017B64@adobe.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit


>> On Tue, Jan 31, 2012 at 2:22 PM, Michael Drig<mduerig@apache.org>  wrote:
>>> I'd rather go for a modern language instead of taping things together ;-)
>
> Michael is certainly thinking of Scala which has its own can of issues ... Syntax not being the least of it ;)

While syntax is to a certain degree a matter of taste (like int foo vs. 
foo: int), Scala's syntax is at least much more consistent, clean, and 
concise than Java's. However, most of Scala's (or any other more 
functional oriented language) real value is not its syntax. Its about 
having a better suited tool for concurrency (immutability) and big data 
(lazy evaluation, higher order functions).

>> Indeed, that's another point I've been thinking about....
>
> I am not really sure, whether we should really open this can of worms ...

We should be *very* careful here: while "opening this can of worms" 
might confront us with a lot of challenges, it also opens up a lot of 
chances. Foremost, having to use a new language is a big effort for 
everyone involved. But it can also be an eye opener and a real booster 
in the long run.

OTOH, sticking with Java might leave us lagging behind, entrapped in 
never ending concurrency night mares and memory contention issues.

Michael

>
> I for my part I would expect JR 3 to still be easily embedded in a JVM (deployed in an OSGi framework running in a JVM, actually), which pretty much excludes anything not being compiled to Java Byte Code executable by the JVM.
>
> Regards
> Felix

From dev-return-34002-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 15:36:51 2012
Return-Path: <dev-return-34002-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D7594933A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 15:36:51 +0000 (UTC)
Received: (qmail 19021 invoked by uid 500); 31 Jan 2012 15:36:51 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 18945 invoked by uid 500); 31 Jan 2012 15:36:50 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 18937 invoked by uid 99); 31 Jan 2012 15:36:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 15:36:50 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.50 as permitted sender)
Received: from [74.125.82.50] (HELO mail-ww0-f50.google.com) (74.125.82.50)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 15:36:44 +0000
Received: by wgbdq11 with SMTP id dq11so93534wgb.19
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 07:36:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=LE+SiCefcCzTCEliuAHK3RbtDo7Vj7k3IyqfTeaiC84=;
        b=xN0AozQWb9ZV+8OlQcZSxOo9TRdiCIhoLpzUHtDn5QhGeV4qMcrM+hQ4D4mK8b4cmR
         17p4MvDjJXwsG4vhphYD9Whwh2DxjO57d7lCg6phsKuIdnx/t3RgzYaJ2YcLbpW8J0J0
         or2HLOtTY5y7ZA9VkoLRpLVoXpTE4HAJfkA28=
Received: by 10.180.90.194 with SMTP id by2mr12052248wib.5.1328024183181; Tue,
 31 Jan 2012 07:36:23 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Tue, 31 Jan 2012 07:36:03 -0800 (PST)
In-Reply-To: <4F27FB0A.9070109@apache.org>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
 <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
 <4F27EB26.1070007@apache.org> <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
 <4F27FB0A.9070109@apache.org>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 31 Jan 2012 16:36:03 +0100
Message-ID: <CAOFYJNaMYBdfttkhLg01q7nMwMpNQ9NaQ6oAFKfjmKEGLN7CzA@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

On Tue, Jan 31, 2012 at 3:30 PM, Michael D=FCrig <mduerig@apache.org> wrote=
:
> On 31.1.12 13:31, Jukka Zitting wrote:
>> Are there significant parts of Jackrabbit 3 that would be better
>> expressed in some other programming language than Java, one with which
>> enough of us (at least everyone working on those parts) are familiar
>> and comfortable?
>
> Like Felix guessed I was primarily thinking of Scala. However there are
> other options like Clojure and Kotlin. If it weren't for the JVM I'd even
> say Haskell.

All of these fail to qualify against the criteria of enough of us
being familiar and comfortable with the language.

The only languages besides Java that I think we could seriously
consider for selected components are JavaScript (with Rhino), Python
(with Jython), or possibly C(++) for some lower-level stuff. Even with
these I suspect we'd turn off about 50% of the committers.

BR,

Jukka Zitting

From dev-return-34003-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 15:53:36 2012
Return-Path: <dev-return-34003-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D600B99F9
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 15:53:36 +0000 (UTC)
Received: (qmail 54855 invoked by uid 500); 31 Jan 2012 15:53:36 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 54781 invoked by uid 500); 31 Jan 2012 15:53:35 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 54774 invoked by uid 99); 31 Jan 2012 15:53:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 15:53:35 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.16 as permitted sender)
Received: from [64.18.2.16] (HELO exprod7og119.obsmtp.com) (64.18.2.16)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 15:53:28 +0000
Received: from mail-tul01m020-f182.google.com ([209.85.214.182]) (using TLSv1) by exprod7ob119.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTygOYlqcqCUYoNi7KbHEZ1JvFJ6fLcIx@postini.com; Tue, 31 Jan 2012 07:53:07 PST
Received: by mail-tul01m020-f182.google.com with SMTP id wo16so136816obc.13
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 07:53:06 -0800 (PST)
Received: by 10.182.15.105 with SMTP id w9mr35793309obc.18.1328025186562; Tue,
 31 Jan 2012 07:53:06 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Tue, 31 Jan 2012 07:52:46 -0800 (PST)
In-Reply-To: <CB4D62EA.2393E%mueller@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com> <CB4D62EA.2393E%mueller@adobe.com>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Tue, 31 Jan 2012 16:52:46 +0100
Message-ID: <CAAOnkMsJst_kb1fAZeGK03dhabd3SJowMnDv-XaoTPjZcXsEYA@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

+1 for 1.6 !

Regards,
Bart

On Tue, Jan 31, 2012 at 9:21 AM, Thomas Mueller <mueller@adobe.com> wrote:
> Hi,
>
> +1 for changing to 1.6.
>
> Regards,
> Thomas
>
>
> On 1/30/12 5:54 PM, "Dominique Pfister" <dpfister@adobe.com> wrote:
>
>>Hi,
>>
>>Just stumbled across this compilation setting in microkernel's pom.xml:
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 <plugin>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <artifactId>maven-compiler-plugin</artif=
actId>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <version>2.3.2</version>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <configuration>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <source>1.5</source>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 <target>1.5</target>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 </configuration>
>> =A0 =A0 =A0 =A0 =A0 =A0 </plugin>
>>
>>When actually _using_ a 1.5 jdk (on Mac OS X this can be done with the
>>Java Preferences tool), the maven-compiler-plugin will report 12
>>errors due to use of Java 1.6 methods.
>>
>>So my question is: should we change this setting from 1.5 to 1.6
>>(which I favor) or review our code?
>>
>>Regards
>>Dominique
>



--=20
Amsterdam - Oosteinde 11, 1017 WT Amsterdam
Boston - 1 Broadway, Cambridge, MA 02142

US +1 877 414 4776 (toll free)
Europe +31(0)20 522 4466
www.onehippo.com

From dev-return-34004-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:03:16 2012
Return-Path: <dev-return-34004-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E73979D01
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:03:15 +0000 (UTC)
Received: (qmail 73021 invoked by uid 500); 31 Jan 2012 16:03:15 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 72971 invoked by uid 500); 31 Jan 2012 16:03:15 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 72960 invoked by uid 99); 31 Jan 2012 16:03:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:03:14 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.6 as permitted sender)
Received: from [64.18.2.6] (HELO exprod7og117.obsmtp.com) (64.18.2.6)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 16:03:07 +0000
Received: from mail-tul01m020-f177.google.com ([209.85.214.177]) (using TLSv1) by exprod7ob117.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTygQppweoxsbQztQM7RfvZCKqSFRBjNa@postini.com; Tue, 31 Jan 2012 08:02:46 PST
Received: by mail-tul01m020-f177.google.com with SMTP id uz6so131729obc.8
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:02:46 -0800 (PST)
Received: by 10.182.8.69 with SMTP id p5mr35923489oba.28.1328025766244; Tue,
 31 Jan 2012 08:02:46 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Tue, 31 Jan 2012 08:02:26 -0800 (PST)
In-Reply-To: <CAOFYJNaMYBdfttkhLg01q7nMwMpNQ9NaQ6oAFKfjmKEGLN7CzA@mail.gmail.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
 <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
 <4F27EB26.1070007@apache.org> <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
 <4F27FB0A.9070109@apache.org> <CAOFYJNaMYBdfttkhLg01q7nMwMpNQ9NaQ6oAFKfjmKEGLN7CzA@mail.gmail.com>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Tue, 31 Jan 2012 17:02:26 +0100
Message-ID: <CAAOnkMtC34q5QDFjsSDuYY6_QNdfxkv6_PhRLVVySW6REesRYA@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

On Tue, Jan 31, 2012 at 4:36 PM, Jukka Zitting <jukka.zitting@gmail.com> wr=
ote:
> Hi,
>
> On Tue, Jan 31, 2012 at 3:30 PM, Michael D=FCrig <mduerig@apache.org> wro=
te:
>> On 31.1.12 13:31, Jukka Zitting wrote:
>>> Are there significant parts of Jackrabbit 3 that would be better
>>> expressed in some other programming language than Java, one with which
>>> enough of us (at least everyone working on those parts) are familiar
>>> and comfortable?
>>
>> Like Felix guessed I was primarily thinking of Scala. However there are
>> other options like Clojure and Kotlin. If it weren't for the JVM I'd eve=
n
>> say Haskell.
>
> All of these fail to qualify against the criteria of enough of us
> being familiar and comfortable with the language.
>
> The only languages besides Java that I think we could seriously
> consider for selected components are JavaScript (with Rhino), Python
> (with Jython), or possibly C(++) for some lower-level stuff. Even with
> these I suspect we'd turn off about 50% of the committers.

I don't think using C or C++ makes much sense. You'll need a complete
new toolbox with compilers and have to deal with cross platform stuff.

The only thing that could make sense (to me) is using a language that
can run inside the (same) jvm.  For some higher level things scripting
languages could be useful especially when dealing with (user) input
and output.

For the lower level stuff I would prefer to stick to just java. Having
multiple levels in there would only raise the bar for people joining
the project imho.

On a personal note: I don't like scale. But that's just me and I don't
want to start the whole java vs scala debate here. I also don't really
buy into the idea that changing to another language will solve all
your concurrency issues.

Regards,
Bart

From dev-return-34005-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:12:02 2012
Return-Path: <dev-return-34005-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C57169FE0
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:12:02 +0000 (UTC)
Received: (qmail 94792 invoked by uid 500); 31 Jan 2012 16:12:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 94679 invoked by uid 500); 31 Jan 2012 16:12:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 94672 invoked by uid 99); 31 Jan 2012 16:12:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:12:01 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.33 as permitted sender)
Received: from [64.18.1.33] (HELO exprod6og114.obsmtp.com) (64.18.1.33)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 16:11:51 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob114.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTygSsUJp5jrbJq6FERT/Ady1J6WBHc95@postini.com; Tue, 31 Jan 2012 08:11:30 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4.adobe.com [193.104.215.14])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VG9Z0Y010928
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:09:35 -0800 (PST)
Received: from nacas01.corp.adobe.com (nacas01.corp.adobe.com [10.8.189.99])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0VGBQPm002367
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:11:27 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas01.corp.adobe.com
 (10.8.189.99) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 08:11:26 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Tue, 31 Jan 2012 16:11:24
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 16:11:19 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: AczgMvqCcjgQB2plRL6Qf43sCOtDYg==
Message-ID: <B940D549-B1F8-4264-8B1F-A9BFFCE17210@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
 <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
 <4F27EB26.1070007@apache.org>
 <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
 <3BE576AB-CD8D-4D22-8CFA-2CB06D017B64@adobe.com> <4F27FF11.50808@apache.org>
In-Reply-To: <4F27FF11.50808@apache.org>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Am 31.01.2012 um 15:47 schrieb Michael D=FCrig:

> OTOH, sticking with Java might leave us lagging behind, entrapped in=20
> never ending concurrency night mares and memory contention issues.

This is probably and simply not true: It is not the language's fault that d=
evelopers are not adhering to fundamental concurrency tenets like for examp=
le immutable objects ... In fact it is a long-standing recommendation to st=
rive for immutable objects.

Regards
Felix=

From dev-return-34006-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:26:02 2012
Return-Path: <dev-return-34006-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AE12C9F7D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:26:02 +0000 (UTC)
Received: (qmail 23786 invoked by uid 500); 31 Jan 2012 16:26:02 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 23641 invoked by uid 500); 31 Jan 2012 16:26:01 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 23634 invoked by uid 99); 31 Jan 2012 16:26:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:26:01 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.31] (HELO exprod6og113.obsmtp.com) (64.18.1.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:25:52 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob113.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTygV+6ioI6COTtLw5lzxkKvojhkJ6Qb9@postini.com; Tue, 31 Jan 2012 08:25:32 PST
Received: from inner-relay-1.corp.adobe.com (inner-relay-1.corp.adobe.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VGPTbR025347
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:25:30 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VGPTMM000394
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:25:29 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 08:25:29 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 16:25:27 +0000
Message-ID: <4F2815F7.8040206@apache.org>
Date: Tue, 31 Jan 2012 16:25:27 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com> <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com> <4F27EB26.1070007@apache.org> <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com> <3BE576AB-CD8D-4D22-8CFA-2CB06D017B64@adobe.com> <4F27FF11.50808@apache.org> <B940D549-B1F8-4264-8B1F-A9BFFCE17210@adobe.com>
In-Reply-To: <B940D549-B1F8-4264-8B1F-A9BFFCE17210@adobe.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit



On 31.1.12 16:11, Felix Meschberger wrote:
> Hi,
>
> Am 31.01.2012 um 15:47 schrieb Michael Drig:
>
>> OTOH, sticking with Java might leave us lagging behind, entrapped in
>> never ending concurrency night mares and memory contention issues.
>
> This is probably and simply not true: It is not the language's fault that developers are not adhering to fundamental concurrency tenets like for example immutable objects ... In fact it is a long-standing recommendation to strive for immutable objects.
Which includes the whole Java collection framework: mutability around 
every corner ready to bite...

Michael

>
> Regards
> Felix

From dev-return-34007-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:29:49 2012
Return-Path: <dev-return-34007-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A7E5A91D4
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:29:49 +0000 (UTC)
Received: (qmail 30308 invoked by uid 500); 31 Jan 2012 16:29:49 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 30270 invoked by uid 500); 31 Jan 2012 16:29:48 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 30263 invoked by uid 99); 31 Jan 2012 16:29:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:29:48 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fmeschbe@adobe.com designates 64.18.1.183 as permitted sender)
Received: from [64.18.1.183] (HELO exprod6og102.obsmtp.com) (64.18.1.183)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 16:29:40 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob102.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTygW388XK2SNGiDEJJomMgdGEcPKF8X3@postini.com; Tue, 31 Jan 2012 08:29:20 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VGTIbR025733
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:29:18 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0VGTHPl008909
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:29:18 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 08:29:17 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurcas01.eur.adobe.com ([10.128.4.27]) with mapi; Tue, 31 Jan 2012 16:29:16
 +0000
From: Felix Meschberger <fmeschbe@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 16:29:10 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: AczgNXjhhgtomLnRSR2cVKpk0k1YLQ==
Message-ID: <7A2D30F9-F6DC-4D10-BA7D-FCC4CBEEDE95@adobe.com>
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com>
 <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com>
 <4F27EB26.1070007@apache.org>
 <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com>
 <3BE576AB-CD8D-4D22-8CFA-2CB06D017B64@adobe.com> <4F27FF11.50808@apache.org>
 <B940D549-B1F8-4264-8B1F-A9BFFCE17210@adobe.com>
 <4F2815F7.8040206@apache.org>
In-Reply-To: <4F2815F7.8040206@apache.org>
Accept-Language: de-DE, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: de-DE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

Am 31.01.2012 um 17:25 schrieb Michael D=FCrig:

>=20
>=20
> On 31.1.12 16:11, Felix Meschberger wrote:
>> Hi,
>>=20
>> Am 31.01.2012 um 15:47 schrieb Michael D=FCrig:
>>=20
>>> OTOH, sticking with Java might leave us lagging behind, entrapped in
>>> never ending concurrency night mares and memory contention issues.
>>=20
>> This is probably and simply not true: It is not the language's fault tha=
t developers are not adhering to fundamental concurrency tenets like for ex=
ample immutable objects ... In fact it is a long-standing recommendation to=
 strive for immutable objects.
> Which includes the whole Java collection framework: mutability around=20
> every corner ready to bite...

Well, this framework is built around this --- after all a collection is her=
e to be modified.

But then they knew what they did and documented it ...

Regards
Felix=

From dev-return-34008-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:41:01 2012
Return-Path: <dev-return-34008-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DFEAC97D8
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:41:00 +0000 (UTC)
Received: (qmail 57018 invoked by uid 500); 31 Jan 2012 16:41:00 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 56969 invoked by uid 500); 31 Jan 2012 16:41:00 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 56962 invoked by uid 99); 31 Jan 2012 16:40:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:40:59 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.6 as permitted sender)
Received: from [64.18.2.6] (HELO exprod7og117.obsmtp.com) (64.18.2.6)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 16:40:52 +0000
Received: from mail-gx0-f180.google.com ([209.85.161.180]) (using TLSv1) by exprod7ob117.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTygZfsWFZg0EoFxHdnEtEFd0kIr3he9P@postini.com; Tue, 31 Jan 2012 08:40:32 PST
Received: by ggnr1 with SMTP id r1so187163ggn.11
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:40:30 -0800 (PST)
Received: by 10.182.41.98 with SMTP id e2mr34237115obl.68.1328028030322; Tue,
 31 Jan 2012 08:40:30 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Tue, 31 Jan 2012 08:40:10 -0800 (PST)
In-Reply-To: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
References: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Tue, 31 Jan 2012 17:40:10 +0100
Message-ID: <CAAOnkMtBytfv0Gb=ZeDVcW+ZGbqffBQQP9U6g4jX5myKs-b62Q@mail.gmail.com>
Subject: Re: [VOTE] Release Apache Jackrabbit 2.2.11
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

+1

Regards,
Bart

On Tue, Jan 31, 2012 at 11:43 AM, Jukka Zitting <jukka.zitting@gmail.com> w=
rote:
> Hi,
>
> A candidate for the Jackrabbit 2.2.11 release is available at:
>
> =A0 =A0http://people.apache.org/~jukka/jackrabbit/2.2.11/
>
> The release candidate is a zip archive of the sources in:
>
> =A0 =A0 http://svn.apache.org/repos/asf/jackrabbit/tags/2.2.11/
>
> The SHA1 checksum of the archive is 9d7c16265ee5c8578fef3b120389a0c22a4e4=
d4f.
>
> A staged Maven repository is available for review at:
>
> =A0 =A0 https://repository.apache.org/content/repositories/orgapachejackr=
abbit-163/
>
> The command for running automated checks against this release candidate i=
s:
>
> =A0 =A0 $ sh check-release.sh jukka 2.2.11 9d7c16265ee5c8578fef3b120389a0=
c22a4e4d4f
>
> Please vote on releasing this package as Apache Jackrabbit 2.2.11.
> The vote is open for the next 72 hours and passes if a majority of at
> least three +1 Jackrabbit PMC votes are cast.
>
> =A0 =A0 [ ] +1 Release this package as Apache Jackrabbit 2.2.11
> =A0 =A0 [ ] -1 Do not release this package because...
>
> My vote is +1.
>
> BR,
>
> Jukka Zitting



--=20
Amsterdam - Oosteinde 11, 1017 WT Amsterdam
Boston - 1 Broadway, Cambridge, MA 02142

US +1 877 414 4776 (toll free)
Europe +31(0)20 522 4466
www.onehippo.com

From dev-return-34009-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:44:05 2012
Return-Path: <dev-return-34009-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BAC14988A
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:44:05 +0000 (UTC)
Received: (qmail 64295 invoked by uid 500); 31 Jan 2012 16:44:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 64107 invoked by uid 500); 31 Jan 2012 16:44:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 64100 invoked by uid 99); 31 Jan 2012 16:44:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:44:04 +0000
X-ASF-Spam-Status: No, hits=-2.3 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mueller@adobe.com designates 64.18.1.37 as permitted sender)
Received: from [64.18.1.37] (HELO exprod6og116.obsmtp.com) (64.18.1.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:43:54 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob116.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTygaNOoRYBPC61pvqtelCuqYvaX5RlgC@postini.com; Tue, 31 Jan 2012 08:43:33 PST
Received: from inner-relay-1.corp.adobe.com (ms-exchange.macromedia.com [153.32.1.51])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VGhUbR027781
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:43:31 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VGhRMT009897
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:43:30 -0800 (PST)
Received: from eurhub01.eur.adobe.com (10.128.4.30) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan
 2012 08:42:29 -0800
Received: from eurmbx01.eur.adobe.com ([10.128.4.32]) by
 eurhub01.eur.adobe.com ([10.128.4.30]) with mapi; Tue, 31 Jan 2012 16:42:28
 +0000
From: Thomas Mueller <mueller@adobe.com>
To: "dev@jackrabbit.apache.org" <dev@jackrabbit.apache.org>
Date: Tue, 31 Jan 2012 16:42:20 +0000
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
Thread-Topic: [jr3 Microkernel] compiler settings in pom.xml
Thread-Index: AczgN1EhDdtcNJPiSiuLTbi8caH+vA==
Message-ID: <CB4DD726.23A01%mueller@adobe.com>
In-Reply-To: <7A2D30F9-F6DC-4D10-BA7D-FCC4CBEEDE95@adobe.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Microsoft-MacOutlook/14.14.0.111121
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I would prefer we stick with what we know: Java.

If we need immutable collections: I'm sure there are libraries for Java
that provide such features.

Regards,
Thomas


From dev-return-34010-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:49:48 2012
Return-Path: <dev-return-34010-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EC2A89CBC
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:49:48 +0000 (UTC)
Received: (qmail 75715 invoked by uid 500); 31 Jan 2012 16:49:48 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 75671 invoked by uid 500); 31 Jan 2012 16:49:48 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 75664 invoked by uid 99); 31 Jan 2012 16:49:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:49:47 +0000
X-ASF-Spam-Status: No, hits=-1.3 required=5.0
	tests=FRT_ADOBE2,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of b.vanderschans@1hippo.com designates 64.18.2.157 as permitted sender)
Received: from [64.18.2.157] (HELO exprod7og102.obsmtp.com) (64.18.2.157)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 16:49:38 +0000
Received: from mail-tul01m020-f178.google.com ([209.85.214.178]) (using TLSv1) by exprod7ob102.postini.com ([64.18.6.12]) with SMTP
	ID DSNKTygbjYM3/BWubFpw/0z5rPiheR6hu0Kq@postini.com; Tue, 31 Jan 2012 08:49:18 PST
Received: by mail-tul01m020-f178.google.com with SMTP id wc7so215683obb.23
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:49:17 -0800 (PST)
Received: by 10.182.11.71 with SMTP id o7mr31853385obb.58.1328028557278; Tue,
 31 Jan 2012 08:49:17 -0800 (PST)
MIME-Version: 1.0
Received: by 10.182.73.168 with HTTP; Tue, 31 Jan 2012 08:48:57 -0800 (PST)
In-Reply-To: <CB4DD726.23A01%mueller@adobe.com>
References: <7A2D30F9-F6DC-4D10-BA7D-FCC4CBEEDE95@adobe.com> <CB4DD726.23A01%mueller@adobe.com>
From: Bart van der Schans <b.vanderschans@onehippo.com>
Date: Tue, 31 Jan 2012 17:48:57 +0100
Message-ID: <CAAOnkMt4ur-o5-bnxH-yz=963H4zk7173zvv+3iCBg1k7DO=UA@mail.gmail.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Jan 31, 2012 at 5:42 PM, Thomas Mueller <mueller@adobe.com> wrote:
> Hi,
>
> I would prefer we stick with what we know: Java.
>
> If we need immutable collections: I'm sure there are libraries for Java
> that provide such features.

I would suggest using guava [1].

Regards,
Bart

[1] http://code.google.com/p/guava-libraries/


>
> Regards,
> Thomas
>

From dev-return-34011-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 16:55:35 2012
Return-Path: <dev-return-34011-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5091E922C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 16:55:35 +0000 (UTC)
Received: (qmail 91655 invoked by uid 500); 31 Jan 2012 16:55:34 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 91457 invoked by uid 500); 31 Jan 2012 16:55:33 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 91442 invoked by uid 99); 31 Jan 2012 16:55:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:55:33 +0000
X-ASF-Spam-Status: No, hits=-2000.0 required=5.0
	tests=ALL_TRUSTED,T_RP_MATCHES_RCVD
X-Spam-Check-By: apache.org
Received: from [140.211.11.116] (HELO hel.zones.apache.org) (140.211.11.116)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:55:31 +0000
Received: from hel.zones.apache.org (hel.zones.apache.org [140.211.11.116])
	by hel.zones.apache.org (Postfix) with ESMTP id 85AA9181378
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 16:55:10 +0000 (UTC)
Date: Tue, 31 Jan 2012 16:55:10 +0000 (UTC)
From: "Jukka Zitting (Updated) (JIRA)" <jira@apache.org>
To: dev@jackrabbit.apache.org
Message-ID: <1251863037.12039.1328028910549.JavaMail.tomcat@hel.zones.apache.org>
In-Reply-To: <1273584924.3087.1317903509791.JavaMail.tomcat@hel.zones.apache.org>
Subject: [jira] [Updated] (JCR-3097) Occasional
 testCloseSessionWhileRunningGc test failures
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394
X-Virus-Checked: Checked by ClamAV on apache.org


     [ https://issues.apache.org/jira/browse/JCR-3097?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Jukka Zitting updated JCR-3097:
-------------------------------

    Affects Version/s: 2.2.11

Occurs also in 2.2.11
                
> Occasional testCloseSessionWhileRunningGc test failures
> -------------------------------------------------------
>
>                 Key: JCR-3097
>                 URL: https://issues.apache.org/jira/browse/JCR-3097
>             Project: Jackrabbit Content Repository
>          Issue Type: Bug
>    Affects Versions: 2.2.11, 2.3
>            Reporter: Jukka Zitting
>            Priority: Minor
>
> We see the following test failure every now and then:
> junit.framework.AssertionFailedError: Exception 'session has been closed' expected
> 	at junit.framework.Assert.fail(Assert.java:47)
> 	at org.apache.jackrabbit.core.data.GarbageCollectorTest.testCloseSessionWhileRunningGc(GarbageCollectorTest.java:68)
> See https://builds.apache.org/job/Jackrabbit-trunk/1686/ for one example.

--
This message is automatically generated by JIRA.
If you think it was sent incorrectly, please contact your JIRA administrators: https://issues.apache.org/jira/secure/ContactAdministrators!default.jspa
For more information on JIRA, see: http://www.atlassian.com/software/jira

        

From dev-return-34012-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 17:28:09 2012
Return-Path: <dev-return-34012-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5DD2B931D
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 17:28:09 +0000 (UTC)
Received: (qmail 9231 invoked by uid 500); 31 Jan 2012 17:27:47 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 7881 invoked by uid 500); 31 Jan 2012 17:27:45 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 7467 invoked by uid 99); 31 Jan 2012 17:27:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 17:27:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of julian.reschke@gmx.de designates 213.165.64.22 as permitted sender)
Received: from [213.165.64.22] (HELO mailout-de.gmx.net) (213.165.64.22)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 31 Jan 2012 17:27:37 +0000
Received: (qmail invoked by alias); 31 Jan 2012 17:27:12 -0000
Received: from mail.greenbytes.de (EHLO [192.168.1.140]) [217.91.35.233]
  by mail.gmx.net (mp034) with SMTP; 31 Jan 2012 18:27:12 +0100
X-Authenticated: #1915285
X-Provags-ID: V01U2FsdGVkX1/YexBdDyvY4/y3ibtMLq596IWVOe3MnuIyeTH6HB
	oIYm2tT1AkTRfp
Message-ID: <4F28246F.4070707@gmx.de>
Date: Tue, 31 Jan 2012 18:27:11 +0100
From: Julian Reschke <julian.reschke@gmx.de>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: dev@jackrabbit.apache.org
CC: Thomas Mueller <mueller@adobe.com>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <CB4DD726.23A01%mueller@adobe.com>
In-Reply-To: <CB4DD726.23A01%mueller@adobe.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Y-GMX-Trusted: 0

On 2012-01-31 17:42, Thomas Mueller wrote:
> Hi,
>
> I would prefer we stick with what we know: Java.
>
> If we need immutable collections: I'm sure there are libraries for Java
> that provide such features.

The Java collections fwk allows turning any collection into an immutable 
collection, no?

From dev-return-34013-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 17:32:41 2012
Return-Path: <dev-return-34013-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B32209B8B
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 17:32:41 +0000 (UTC)
Received: (qmail 33888 invoked by uid 500); 31 Jan 2012 17:32:38 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 32758 invoked by uid 500); 31 Jan 2012 17:32:35 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 32670 invoked by uid 99); 31 Jan 2012 17:32:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 17:32:35 +0000
X-ASF-Spam-Status: No, hits=-0.7 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 74.125.82.170 as permitted sender)
Received: from [74.125.82.170] (HELO mail-we0-f170.google.com) (74.125.82.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 16:56:54 +0000
Received: by werm1 with SMTP id m1so408012wer.1
        for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:56:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=2Ad/o+SdC9U5Q+pT/CTvarDaYD3jaje6ZU6eGSQl+/U=;
        b=AHBwTyd0N+iW4NzGPuCjg66GzNKQM+Ab/UXAlD6pREZJ5hLOUmw2dMg5tKyXsiQxzw
         jAEaQUKlcHScMq3xDe2+1yUAJUGSP7noR7aRAeq7WIC6EJ3E9pidQCdizmOsn2CJRd+y
         phpQbHprY3KNvZp0XIPbg1NmfKkl/JeKPKOOU=
Received: by 10.216.132.148 with SMTP id o20mr1286779wei.33.1328028974190;
 Tue, 31 Jan 2012 08:56:14 -0800 (PST)
MIME-Version: 1.0
Received: by 10.180.106.71 with HTTP; Tue, 31 Jan 2012 08:55:54 -0800 (PST)
In-Reply-To: <4F27F1B9.4050902@apache.org>
References: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com>
 <4F27F1B9.4050902@apache.org>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Tue, 31 Jan 2012 17:55:54 +0100
Message-ID: <CAOFYJNY+jPO+P8g+k_ciOtYg+WE27=SV7ytT7hYsyj6uiYmE3g@mail.gmail.com>
Subject: Re: [VOTE] Release Apache Jackrabbit 2.2.11
To: dev@jackrabbit.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Tue, Jan 31, 2012 at 2:50 PM, Michael D=FCrig <mduerig@apache.org> wrote=
:
> testCloseSessionWhileRunningGc(org.apache.jackrabbit.core.data.GarbageCol=
lectorTest)

That's JCR-3097 [1]. I added 2.2.11 to the "Affects Versions" field of
that bug, so I'd say we can treat it as a known, non-blocking issue.

[1] https://issues.apache.org/jira/browse/JCR-3097

BR,

Jukka Zitting

From dev-return-34014-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 17:36:05 2012
Return-Path: <dev-return-34014-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 656F19E0C
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 17:36:05 +0000 (UTC)
Received: (qmail 52412 invoked by uid 500); 31 Jan 2012 17:36:05 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 52367 invoked by uid 500); 31 Jan 2012 17:36:04 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 52360 invoked by uid 99); 31 Jan 2012 17:36:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 17:36:04 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [64.18.1.39] (HELO exprod6og117.obsmtp.com) (64.18.1.39)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 17:35:54 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob117.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTygmZNFNJiJ+8JuAnSRZApcdZGUgomUx@postini.com; Tue, 31 Jan 2012 09:35:33 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VHXc0Y021795
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 09:33:38 -0800 (PST)
Received: from nahub01.corp.adobe.com (nahub01.corp.adobe.com [10.8.189.97])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VHZVMM001675
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 09:35:31 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub01.corp.adobe.com
 (10.8.189.97) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 09:35:31 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 17:35:29 +0000
Message-ID: <4F282661.5030208@apache.org>
Date: Tue, 31 Jan 2012 17:35:29 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [VOTE] Release Apache Jackrabbit 2.2.11
References: <CAOFYJNb0pPtXP=Wdy+gE1=bPEjBO_L+s6HHaXmfwgDJmnqmSKg@mail.gmail.com> <4F27F1B9.4050902@apache.org> <CAOFYJNY+jPO+P8g+k_ciOtYg+WE27=SV7ytT7hYsyj6uiYmE3g@mail.gmail.com>
In-Reply-To: <CAOFYJNY+jPO+P8g+k_ciOtYg+WE27=SV7ytT7hYsyj6uiYmE3g@mail.gmail.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org



On 31.1.12 16:55, Jukka Zitting wrote:
> Hi,
>
> On Tue, Jan 31, 2012 at 2:50 PM, Michael Drig<mduerig@apache.org>  wrote:
>> testCloseSessionWhileRunningGc(org.apache.jackrabbit.core.data.GarbageCollectorTest)
>
> That's JCR-3097 [1]. I added 2.2.11 to the "Affects Versions" field of
> that bug, so I'd say we can treat it as a known, non-blocking issue.
>
> [1] https://issues.apache.org/jira/browse/JCR-3097
>

Ok ack. So regard my vote as a +1.

Michael

From dev-return-34015-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 17:44:26 2012
Return-Path: <dev-return-34015-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 964379982
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 17:44:26 +0000 (UTC)
Received: (qmail 90571 invoked by uid 500); 31 Jan 2012 17:44:26 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 90489 invoked by uid 500); 31 Jan 2012 17:44:25 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 90482 invoked by uid 99); 31 Jan 2012 17:44:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 17:44:25 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.181] (HELO exprod6og101.obsmtp.com) (64.18.1.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 17:44:19 +0000
Received: from outbound-smtp-2.corp.adobe.com ([193.104.215.16]) by exprod6ob101.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTygoXte7+bT7L7bNJari8tetj48Av+uw@postini.com; Tue, 31 Jan 2012 09:43:58 PST
Received: from inner-relay-4.eur.adobe.com (inner-relay-4b [10.128.4.237])
	by outbound-smtp-2.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VHhvbR005838
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 09:43:57 -0800 (PST)
Received: from nacas03.corp.adobe.com (nacas03.corp.adobe.com [10.8.189.121])
	by inner-relay-4.eur.adobe.com (8.12.10/8.12.9) with ESMTP id q0VHenQL004746
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 09:43:56 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nacas03.corp.adobe.com
 (10.8.189.121) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan
 2012 09:43:42 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 17:43:39 +0000
Message-ID: <4F28284B.2040609@apache.org>
Date: Tue, 31 Jan 2012 17:43:39 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <CB4DD726.23A01%mueller@adobe.com> <4F28246F.4070707@gmx.de>
In-Reply-To: <4F28246F.4070707@gmx.de>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 7bit



On 31.1.12 17:27, Julian Reschke wrote:
> On 2012-01-31 17:42, Thomas Mueller wrote:
>> Hi,
>>
>> I would prefer we stick with what we know: Java.
>>
>> If we need immutable collections: I'm sure there are libraries for Java
>> that provide such features.
>
> The Java collections fwk allows turning any collection into an immutable
> collection, no?

I was referring to immutable collections in functional settings (aka 
persistence [1]).

Michael

[1] http://en.wikipedia.org/wiki/Persistent_data_structure

From dev-return-34016-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org  Tue Jan 31 18:12:38 2012
Return-Path: <dev-return-34016-apmail-jackrabbit-dev-archive=jackrabbit.apache.org@jackrabbit.apache.org>
X-Original-To: apmail-jackrabbit-dev-archive@www.apache.org
Delivered-To: apmail-jackrabbit-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1D0689843
	for <apmail-jackrabbit-dev-archive@www.apache.org>; Tue, 31 Jan 2012 18:12:38 +0000 (UTC)
Received: (qmail 67928 invoked by uid 500); 31 Jan 2012 18:12:37 -0000
Delivered-To: apmail-jackrabbit-dev-archive@jackrabbit.apache.org
Received: (qmail 67846 invoked by uid 500); 31 Jan 2012 18:12:37 -0000
Mailing-List: contact dev-help@jackrabbit.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:dev-help@jackrabbit.apache.org>
List-Unsubscribe: <mailto:dev-unsubscribe@jackrabbit.apache.org>
List-Post: <mailto:dev@jackrabbit.apache.org>
List-Id: <dev.jackrabbit.apache.org>
Reply-To: dev@jackrabbit.apache.org
Delivered-To: mailing list dev@jackrabbit.apache.org
Received: (qmail 67839 invoked by uid 99); 31 Jan 2012 18:12:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 18:12:36 +0000
X-ASF-Spam-Status: No, hits=-1.6 required=5.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.1.39] (HELO exprod6og117.obsmtp.com) (64.18.1.39)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 31 Jan 2012 18:12:28 +0000
Received: from outbound-smtp-1.corp.adobe.com ([192.150.11.134]) by exprod6ob117.postini.com ([64.18.5.12]) with SMTP
	ID DSNKTygu96nbVFAVZ6M/IoBK6fTtWeN5HtMa@postini.com; Tue, 31 Jan 2012 10:12:07 PST
Received: from inner-relay-1.corp.adobe.com ([153.32.1.51])
	by outbound-smtp-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VGrb0Y016454
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:53:37 -0800 (PST)
Received: from nahub02.corp.adobe.com (nahub02.corp.adobe.com [10.8.189.98])
	by inner-relay-1.corp.adobe.com (8.12.10/8.12.10) with ESMTP id q0VGtUMM014619
	for <dev@jackrabbit.apache.org>; Tue, 31 Jan 2012 08:55:31 -0800 (PST)
Received: from eurcas01.eur.adobe.com (10.128.4.27) by nahub02.corp.adobe.com
 (10.8.189.98) with Microsoft SMTP Server (TLS) id 8.3.192.1; Tue, 31 Jan 2012
 08:55:30 -0800
Received: from susi.local (10.136.141.40) by eurcas01.eur.adobe.com
 (10.128.4.111) with Microsoft SMTP Server id 8.3.192.1; Tue, 31 Jan 2012
 16:55:29 +0000
Message-ID: <4F281D00.6080109@apache.org>
Date: Tue, 31 Jan 2012 16:55:28 +0000
From: =?ISO-8859-1?Q?Michael_D=FCrig?= <mduerig@apache.org>
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20111222 Thunderbird/9.0.1
MIME-Version: 1.0
To: <dev@jackrabbit.apache.org>
Subject: Re: [jr3 Microkernel] compiler settings in pom.xml
References: <FDA78E7E-3328-4343-A506-F13C63A7D9E4@adobe.com> <CAOFYJNbtGOu-e59m8jqcDjvnSjrGOtQmvoJngeP1ZBq9so+6hw@mail.gmail.com> <4F27EB26.1070007@apache.org> <CAOFYJNYoCcR2u7C1dL+k_w_+QLF5GmK5PP+VHP8O_+=3YwjLHw@mail.gmail.com> <3BE576AB-CD8D-4D22-8CFA-2CB06D017B64@adobe.com> <4F27FF11.50808@apache.org> <B940D549-B1F8-4264-8B1F-A9BFFCE17210@adobe.com> <4F2815F7.8040206@apache.org> <7A2D30F9-F6DC-4D10-BA7D-FCC4CBEEDE95@adobe.com>
In-Reply-To: <7A2D30F9-F6DC-4D10-BA7D-FCC4CBEEDE95@adobe.com>
Content-Type: text/plain; charset="ISO-8859-1"; format=flowed
Content-Transfer-Encoding: 8bit



On 31.1.12 16:29, Felix Meschberger wrote:
> Hi,
>
> Am 31.01.2012 um 17:25 schrieb Michael Drig:
>
>>
>>
>> On 31.1.12 16:11, Felix Meschberger wrote:
>>> Hi,
>>>
>>> Am 31.01.2012 um 15:47 schrieb Michael Drig:
>>>
>>>> OTOH, sticking with Java might leave us lagging behind, entrapped in
>>>> never ending concurrency night mares and memory contention issues.
>>>
>>> This is probably and simply not true: It is not the language's fault that developers are not adhering to fundamental concurrency tenets like for example immutable objects ... In fact it is a long-standing recommendation to strive for immutable objects.
>> Which includes the whole Java collection framework: mutability around
>> every corner ready to bite...
>
> Well, this framework is built around this --- after all a collection is here to be modified.

There *is* such things as immutable collections. They are known to be 
sound under concurrency and much easier to reason about than their 
mutable counterparts and they are widely and successfully used in the 
functional programming community. As I said in another reply: learning 
other languages (and its concepts) can be a real eye opener...

Michael

>
> But then they knew what they did and documented it ...
>
> Regards
> Felix

