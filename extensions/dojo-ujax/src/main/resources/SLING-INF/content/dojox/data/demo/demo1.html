<!--
  This file is a demo of multiple dojo.data aware widgets using different datastore implementations for displaying data.
-->
<html>
<head>
	<title>Demo of Multiple Widgets using the µjax Data Store</title>
	<style type="text/css">
		@import "../../../dijit/themes/tundra/tundra.css";
		@import "../../../dojo/resources/dojo.css";
		@import "../../../dijit/tests/css/dijitTests.css";
    @import "../../../dojox/grid/_grid/tundraGrid.css";
	</style>

	<script type="text/javascript" src="../../../dojo/dojo.js" djConfig="isDebug: true, parseOnLoad: true, usePlainJson: true"></script>
	<script type="text/javascript">
		dojo.require("dojo.parser");
		dojo.require("dijit.form.ComboBox");
		dojo.require("dijit.Tree");
		dojo.require("dojox.data.SlingNodeStore");
    dojo.require("dojox.data.SlingPropertyStore");
    dojo.require("dojox.grid._data.model");
    dojo.require("dojox.grid.Grid");
    dojo.require("dojox.grid._data.editors");
	</script>
</head>

<body class="tundra">
	<h1>
		DEMO:  µjax Data Store
	</h1>

  <!-- the data store -->
  <div dojoType="dojox.data.SlingPropertyStore" url="/dojo" jsId="propertyStore">
        <script type="dojo/connect" event="onSet" args="item,attr,oldVal,newVal">
        console.debug("About to change "+attr+" from "+oldVal+" to "+newVal);
        // Save the record with dojo.xhrPost or your favorite remote method
       </script>
  </div>
  <div dojoType="dojox.data.SlingNodeStore" url="/" jsId="nodeStore"></div>
  

  
  <h3>
		Widgets using µjaxStore:
	</h3>
	<blockquote>
  <table width="100%">
    <tbody>
      <tr>
        <td>
        
	<b>Tree (only root and folders):</b><br>
   	<div dojoType="dijit.Tree" id="tree1" store="nodeStore" query="{ query: { 'jcr:primaryType' : ['nt:folder', 'rep:root'] } }"></div>
    
        </td>
        <td>
        
         <b>Tree (only root and folders and files):</b><br>
  <div dojoType="dijit.Tree" id="tree2" store="nodeStore" query="{ query: { 'jcr:primaryType' : ['nt:folder', 'rep:root', 'nt:file'] } }"></div>

        </td>
        <td>
        
          <b>Tree (complete):</b><br>
  <div dojoType="dijit.Tree" id="tree3" store="nodeStore"></div>

        
        </td>
      </tr>
    </tbody>
  </table>
 

  
    <!-- the data model (for the grid) -->
  <div dojoType="dojox.grid.data.DojoData" jsId="propertyModel" 
    store="propertyStore" clientSort="true"> 
  </div>
  
  <script type="text/javascript">
  var tableview = {
    cells: [
      [
        {name: "URI", field:"uri"},
        {name: "Name", field: "name", width:"200px" },
        {name: "Value", field: "value", width:"200px", editor:dojox.grid.editors.TextBox, field:2 }
      ]
    ]
  };
  
  var tablestructure = [ tableview ];
  </script>
  
  <div id="grid" dojoType="dojox.Grid" model="propertyModel" structure="tablestructure"></div>
</body>
</html>
